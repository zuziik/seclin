#line 1 "tmp/generated_definitions.conf"
































































































#line 158


#line 196

































































































































































































































#line 275061 "tmp/all_interfaces.conf"

#line 1 "policy/modules/contrib/xen.te"

#line 1
	
#line 1
		module xen 1.14.0;
#line 1

#line 1
		require {
#line 1
			role system_r;
#line 1
			
#line 1
	class security { compute_av compute_create compute_member check_context load_policy compute_relabel compute_user setenforce setbool setsecparam setcheckreqprot read_policy validate_trans };
#line 1
	class process { fork transition sigchld sigkill sigstop signull signal ptrace getsched setsched getsession getpgid setpgid getcap setcap share getattr setexec setfscreate noatsecure siginh setrlimit rlimitinh dyntransition setcurrent execmem execstack execheap setkeycreate setsockcreate };
#line 1
	class system { ipc_info syslog_read syslog_mod syslog_console module_request module_load halt reboot status start stop enable disable reload };
#line 1
	class capability { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
#line 1
	class filesystem { mount remount unmount getattr relabelfrom relabelto transition associate quotamod quotaget };
#line 1
	class file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
#line 1
	class dir { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton add_name remove_name reparent search rmdir open audit_access execmod };
#line 1
	class fd { use };
#line 1
	class lnk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class chr_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
#line 1
	class blk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class sock_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class fifo_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class tcp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom node_bind name_connect };
#line 1
	class udp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 1
	class rawip_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 1
	class node { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send enforce_dest dccp_recv dccp_send recvfrom sendto };
#line 1
	class netif { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send dccp_recv dccp_send ingress egress };
#line 1
	class netlink_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class packet_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class key_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class unix_stream_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom };
#line 1
	class unix_dgram_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class sem { create destroy getattr setattr read write associate unix_read unix_write };
#line 1
	class msg { send receive };
#line 1
	class msgq { create destroy getattr setattr read write associate unix_read unix_write enqueue };
#line 1
	class shm { create destroy getattr setattr read write associate unix_read unix_write lock };
#line 1
	class ipc { create destroy getattr setattr read write associate unix_read unix_write };
#line 1
	class netlink_route_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_firewall_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_tcpdiag_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_nflog_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_xfrm_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_selinux_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_audit_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write nlmsg_relay nlmsg_readpriv nlmsg_tty_audit };
#line 1
	class netlink_ip6fw_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_dnrt_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class association { sendto recvfrom setcontext polmatch };
#line 1
	class netlink_kobject_uevent_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class appletalk_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class packet { send recv relabelto flow_in flow_out forward_in forward_out };
#line 1
	class key { view read write search link setattr create };
#line 1
	class dccp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind name_connect };
#line 1
	class memprotect { mmap_zero };
#line 1
	class peer { recv };
#line 1
	class capability2 { mac_override mac_admin syslog wake_alarm block_suspend audit_read };
#line 1
	class kernel_service { use_as_override create_files_as };
#line 1
	class tun_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind attach_queue };
#line 1
	class binder { impersonate call set_context_mgr transfer };
#line 1
	class netlink_iscsi_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_fib_lookup_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_connector_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_netfilter_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_generic_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_scsitransport_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_rdma_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_crypto_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class cap_userns { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
#line 1
	class cap2_userns { mac_override mac_admin syslog wake_alarm block_suspend audit_read };
#line 1

#line 1

#line 1
			
#line 1
				sensitivity s0;
#line 1

#line 1
				category c0;
#line 1
category c1;
#line 1
category c2;
#line 1
category c3;
#line 1
category c4;
#line 1
category c5;
#line 1
category c6;
#line 1
category c7;
#line 1
category c8;
#line 1
category c9;
#line 1
category c10;
#line 1
category c11;
#line 1
category c12;
#line 1
category c13;
#line 1
category c14;
#line 1
category c15;
#line 1
category c16;
#line 1
category c17;
#line 1
category c18;
#line 1
category c19;
#line 1
category c20;
#line 1
category c21;
#line 1
category c22;
#line 1
category c23;
#line 1
category c24;
#line 1
category c25;
#line 1
category c26;
#line 1
category c27;
#line 1
category c28;
#line 1
category c29;
#line 1
category c30;
#line 1
category c31;
#line 1
category c32;
#line 1
category c33;
#line 1
category c34;
#line 1
category c35;
#line 1
category c36;
#line 1
category c37;
#line 1
category c38;
#line 1
category c39;
#line 1
category c40;
#line 1
category c41;
#line 1
category c42;
#line 1
category c43;
#line 1
category c44;
#line 1
category c45;
#line 1
category c46;
#line 1
category c47;
#line 1
category c48;
#line 1
category c49;
#line 1
category c50;
#line 1
category c51;
#line 1
category c52;
#line 1
category c53;
#line 1
category c54;
#line 1
category c55;
#line 1
category c56;
#line 1
category c57;
#line 1
category c58;
#line 1
category c59;
#line 1
category c60;
#line 1
category c61;
#line 1
category c62;
#line 1
category c63;
#line 1
category c64;
#line 1
category c65;
#line 1
category c66;
#line 1
category c67;
#line 1
category c68;
#line 1
category c69;
#line 1
category c70;
#line 1
category c71;
#line 1
category c72;
#line 1
category c73;
#line 1
category c74;
#line 1
category c75;
#line 1
category c76;
#line 1
category c77;
#line 1
category c78;
#line 1
category c79;
#line 1
category c80;
#line 1
category c81;
#line 1
category c82;
#line 1
category c83;
#line 1
category c84;
#line 1
category c85;
#line 1
category c86;
#line 1
category c87;
#line 1
category c88;
#line 1
category c89;
#line 1
category c90;
#line 1
category c91;
#line 1
category c92;
#line 1
category c93;
#line 1
category c94;
#line 1
category c95;
#line 1
category c96;
#line 1
category c97;
#line 1
category c98;
#line 1
category c99;
#line 1
category c100;
#line 1
category c101;
#line 1
category c102;
#line 1
category c103;
#line 1
category c104;
#line 1
category c105;
#line 1
category c106;
#line 1
category c107;
#line 1
category c108;
#line 1
category c109;
#line 1
category c110;
#line 1
category c111;
#line 1
category c112;
#line 1
category c113;
#line 1
category c114;
#line 1
category c115;
#line 1
category c116;
#line 1
category c117;
#line 1
category c118;
#line 1
category c119;
#line 1
category c120;
#line 1
category c121;
#line 1
category c122;
#line 1
category c123;
#line 1
category c124;
#line 1
category c125;
#line 1
category c126;
#line 1
category c127;
#line 1
category c128;
#line 1
category c129;
#line 1
category c130;
#line 1
category c131;
#line 1
category c132;
#line 1
category c133;
#line 1
category c134;
#line 1
category c135;
#line 1
category c136;
#line 1
category c137;
#line 1
category c138;
#line 1
category c139;
#line 1
category c140;
#line 1
category c141;
#line 1
category c142;
#line 1
category c143;
#line 1
category c144;
#line 1
category c145;
#line 1
category c146;
#line 1
category c147;
#line 1
category c148;
#line 1
category c149;
#line 1
category c150;
#line 1
category c151;
#line 1
category c152;
#line 1
category c153;
#line 1
category c154;
#line 1
category c155;
#line 1
category c156;
#line 1
category c157;
#line 1
category c158;
#line 1
category c159;
#line 1
category c160;
#line 1
category c161;
#line 1
category c162;
#line 1
category c163;
#line 1
category c164;
#line 1
category c165;
#line 1
category c166;
#line 1
category c167;
#line 1
category c168;
#line 1
category c169;
#line 1
category c170;
#line 1
category c171;
#line 1
category c172;
#line 1
category c173;
#line 1
category c174;
#line 1
category c175;
#line 1
category c176;
#line 1
category c177;
#line 1
category c178;
#line 1
category c179;
#line 1
category c180;
#line 1
category c181;
#line 1
category c182;
#line 1
category c183;
#line 1
category c184;
#line 1
category c185;
#line 1
category c186;
#line 1
category c187;
#line 1
category c188;
#line 1
category c189;
#line 1
category c190;
#line 1
category c191;
#line 1
category c192;
#line 1
category c193;
#line 1
category c194;
#line 1
category c195;
#line 1
category c196;
#line 1
category c197;
#line 1
category c198;
#line 1
category c199;
#line 1
category c200;
#line 1
category c201;
#line 1
category c202;
#line 1
category c203;
#line 1
category c204;
#line 1
category c205;
#line 1
category c206;
#line 1
category c207;
#line 1
category c208;
#line 1
category c209;
#line 1
category c210;
#line 1
category c211;
#line 1
category c212;
#line 1
category c213;
#line 1
category c214;
#line 1
category c215;
#line 1
category c216;
#line 1
category c217;
#line 1
category c218;
#line 1
category c219;
#line 1
category c220;
#line 1
category c221;
#line 1
category c222;
#line 1
category c223;
#line 1
category c224;
#line 1
category c225;
#line 1
category c226;
#line 1
category c227;
#line 1
category c228;
#line 1
category c229;
#line 1
category c230;
#line 1
category c231;
#line 1
category c232;
#line 1
category c233;
#line 1
category c234;
#line 1
category c235;
#line 1
category c236;
#line 1
category c237;
#line 1
category c238;
#line 1
category c239;
#line 1
category c240;
#line 1
category c241;
#line 1
category c242;
#line 1
category c243;
#line 1
category c244;
#line 1
category c245;
#line 1
category c246;
#line 1
category c247;
#line 1
category c248;
#line 1
category c249;
#line 1
category c250;
#line 1
category c251;
#line 1
category c252;
#line 1
category c253;
#line 1
category c254;
#line 1
category c255;
#line 1
category c256;
#line 1
category c257;
#line 1
category c258;
#line 1
category c259;
#line 1
category c260;
#line 1
category c261;
#line 1
category c262;
#line 1
category c263;
#line 1
category c264;
#line 1
category c265;
#line 1
category c266;
#line 1
category c267;
#line 1
category c268;
#line 1
category c269;
#line 1
category c270;
#line 1
category c271;
#line 1
category c272;
#line 1
category c273;
#line 1
category c274;
#line 1
category c275;
#line 1
category c276;
#line 1
category c277;
#line 1
category c278;
#line 1
category c279;
#line 1
category c280;
#line 1
category c281;
#line 1
category c282;
#line 1
category c283;
#line 1
category c284;
#line 1
category c285;
#line 1
category c286;
#line 1
category c287;
#line 1
category c288;
#line 1
category c289;
#line 1
category c290;
#line 1
category c291;
#line 1
category c292;
#line 1
category c293;
#line 1
category c294;
#line 1
category c295;
#line 1
category c296;
#line 1
category c297;
#line 1
category c298;
#line 1
category c299;
#line 1
category c300;
#line 1
category c301;
#line 1
category c302;
#line 1
category c303;
#line 1
category c304;
#line 1
category c305;
#line 1
category c306;
#line 1
category c307;
#line 1
category c308;
#line 1
category c309;
#line 1
category c310;
#line 1
category c311;
#line 1
category c312;
#line 1
category c313;
#line 1
category c314;
#line 1
category c315;
#line 1
category c316;
#line 1
category c317;
#line 1
category c318;
#line 1
category c319;
#line 1
category c320;
#line 1
category c321;
#line 1
category c322;
#line 1
category c323;
#line 1
category c324;
#line 1
category c325;
#line 1
category c326;
#line 1
category c327;
#line 1
category c328;
#line 1
category c329;
#line 1
category c330;
#line 1
category c331;
#line 1
category c332;
#line 1
category c333;
#line 1
category c334;
#line 1
category c335;
#line 1
category c336;
#line 1
category c337;
#line 1
category c338;
#line 1
category c339;
#line 1
category c340;
#line 1
category c341;
#line 1
category c342;
#line 1
category c343;
#line 1
category c344;
#line 1
category c345;
#line 1
category c346;
#line 1
category c347;
#line 1
category c348;
#line 1
category c349;
#line 1
category c350;
#line 1
category c351;
#line 1
category c352;
#line 1
category c353;
#line 1
category c354;
#line 1
category c355;
#line 1
category c356;
#line 1
category c357;
#line 1
category c358;
#line 1
category c359;
#line 1
category c360;
#line 1
category c361;
#line 1
category c362;
#line 1
category c363;
#line 1
category c364;
#line 1
category c365;
#line 1
category c366;
#line 1
category c367;
#line 1
category c368;
#line 1
category c369;
#line 1
category c370;
#line 1
category c371;
#line 1
category c372;
#line 1
category c373;
#line 1
category c374;
#line 1
category c375;
#line 1
category c376;
#line 1
category c377;
#line 1
category c378;
#line 1
category c379;
#line 1
category c380;
#line 1
category c381;
#line 1
category c382;
#line 1
category c383;
#line 1
category c384;
#line 1
category c385;
#line 1
category c386;
#line 1
category c387;
#line 1
category c388;
#line 1
category c389;
#line 1
category c390;
#line 1
category c391;
#line 1
category c392;
#line 1
category c393;
#line 1
category c394;
#line 1
category c395;
#line 1
category c396;
#line 1
category c397;
#line 1
category c398;
#line 1
category c399;
#line 1
category c400;
#line 1
category c401;
#line 1
category c402;
#line 1
category c403;
#line 1
category c404;
#line 1
category c405;
#line 1
category c406;
#line 1
category c407;
#line 1
category c408;
#line 1
category c409;
#line 1
category c410;
#line 1
category c411;
#line 1
category c412;
#line 1
category c413;
#line 1
category c414;
#line 1
category c415;
#line 1
category c416;
#line 1
category c417;
#line 1
category c418;
#line 1
category c419;
#line 1
category c420;
#line 1
category c421;
#line 1
category c422;
#line 1
category c423;
#line 1
category c424;
#line 1
category c425;
#line 1
category c426;
#line 1
category c427;
#line 1
category c428;
#line 1
category c429;
#line 1
category c430;
#line 1
category c431;
#line 1
category c432;
#line 1
category c433;
#line 1
category c434;
#line 1
category c435;
#line 1
category c436;
#line 1
category c437;
#line 1
category c438;
#line 1
category c439;
#line 1
category c440;
#line 1
category c441;
#line 1
category c442;
#line 1
category c443;
#line 1
category c444;
#line 1
category c445;
#line 1
category c446;
#line 1
category c447;
#line 1
category c448;
#line 1
category c449;
#line 1
category c450;
#line 1
category c451;
#line 1
category c452;
#line 1
category c453;
#line 1
category c454;
#line 1
category c455;
#line 1
category c456;
#line 1
category c457;
#line 1
category c458;
#line 1
category c459;
#line 1
category c460;
#line 1
category c461;
#line 1
category c462;
#line 1
category c463;
#line 1
category c464;
#line 1
category c465;
#line 1
category c466;
#line 1
category c467;
#line 1
category c468;
#line 1
category c469;
#line 1
category c470;
#line 1
category c471;
#line 1
category c472;
#line 1
category c473;
#line 1
category c474;
#line 1
category c475;
#line 1
category c476;
#line 1
category c477;
#line 1
category c478;
#line 1
category c479;
#line 1
category c480;
#line 1
category c481;
#line 1
category c482;
#line 1
category c483;
#line 1
category c484;
#line 1
category c485;
#line 1
category c486;
#line 1
category c487;
#line 1
category c488;
#line 1
category c489;
#line 1
category c490;
#line 1
category c491;
#line 1
category c492;
#line 1
category c493;
#line 1
category c494;
#line 1
category c495;
#line 1
category c496;
#line 1
category c497;
#line 1
category c498;
#line 1
category c499;
#line 1
category c500;
#line 1
category c501;
#line 1
category c502;
#line 1
category c503;
#line 1
category c504;
#line 1
category c505;
#line 1
category c506;
#line 1
category c507;
#line 1
category c508;
#line 1
category c509;
#line 1
category c510;
#line 1
category c511;
#line 1
category c512;
#line 1
category c513;
#line 1
category c514;
#line 1
category c515;
#line 1
category c516;
#line 1
category c517;
#line 1
category c518;
#line 1
category c519;
#line 1
category c520;
#line 1
category c521;
#line 1
category c522;
#line 1
category c523;
#line 1
category c524;
#line 1
category c525;
#line 1
category c526;
#line 1
category c527;
#line 1
category c528;
#line 1
category c529;
#line 1
category c530;
#line 1
category c531;
#line 1
category c532;
#line 1
category c533;
#line 1
category c534;
#line 1
category c535;
#line 1
category c536;
#line 1
category c537;
#line 1
category c538;
#line 1
category c539;
#line 1
category c540;
#line 1
category c541;
#line 1
category c542;
#line 1
category c543;
#line 1
category c544;
#line 1
category c545;
#line 1
category c546;
#line 1
category c547;
#line 1
category c548;
#line 1
category c549;
#line 1
category c550;
#line 1
category c551;
#line 1
category c552;
#line 1
category c553;
#line 1
category c554;
#line 1
category c555;
#line 1
category c556;
#line 1
category c557;
#line 1
category c558;
#line 1
category c559;
#line 1
category c560;
#line 1
category c561;
#line 1
category c562;
#line 1
category c563;
#line 1
category c564;
#line 1
category c565;
#line 1
category c566;
#line 1
category c567;
#line 1
category c568;
#line 1
category c569;
#line 1
category c570;
#line 1
category c571;
#line 1
category c572;
#line 1
category c573;
#line 1
category c574;
#line 1
category c575;
#line 1
category c576;
#line 1
category c577;
#line 1
category c578;
#line 1
category c579;
#line 1
category c580;
#line 1
category c581;
#line 1
category c582;
#line 1
category c583;
#line 1
category c584;
#line 1
category c585;
#line 1
category c586;
#line 1
category c587;
#line 1
category c588;
#line 1
category c589;
#line 1
category c590;
#line 1
category c591;
#line 1
category c592;
#line 1
category c593;
#line 1
category c594;
#line 1
category c595;
#line 1
category c596;
#line 1
category c597;
#line 1
category c598;
#line 1
category c599;
#line 1
category c600;
#line 1
category c601;
#line 1
category c602;
#line 1
category c603;
#line 1
category c604;
#line 1
category c605;
#line 1
category c606;
#line 1
category c607;
#line 1
category c608;
#line 1
category c609;
#line 1
category c610;
#line 1
category c611;
#line 1
category c612;
#line 1
category c613;
#line 1
category c614;
#line 1
category c615;
#line 1
category c616;
#line 1
category c617;
#line 1
category c618;
#line 1
category c619;
#line 1
category c620;
#line 1
category c621;
#line 1
category c622;
#line 1
category c623;
#line 1
category c624;
#line 1
category c625;
#line 1
category c626;
#line 1
category c627;
#line 1
category c628;
#line 1
category c629;
#line 1
category c630;
#line 1
category c631;
#line 1
category c632;
#line 1
category c633;
#line 1
category c634;
#line 1
category c635;
#line 1
category c636;
#line 1
category c637;
#line 1
category c638;
#line 1
category c639;
#line 1
category c640;
#line 1
category c641;
#line 1
category c642;
#line 1
category c643;
#line 1
category c644;
#line 1
category c645;
#line 1
category c646;
#line 1
category c647;
#line 1
category c648;
#line 1
category c649;
#line 1
category c650;
#line 1
category c651;
#line 1
category c652;
#line 1
category c653;
#line 1
category c654;
#line 1
category c655;
#line 1
category c656;
#line 1
category c657;
#line 1
category c658;
#line 1
category c659;
#line 1
category c660;
#line 1
category c661;
#line 1
category c662;
#line 1
category c663;
#line 1
category c664;
#line 1
category c665;
#line 1
category c666;
#line 1
category c667;
#line 1
category c668;
#line 1
category c669;
#line 1
category c670;
#line 1
category c671;
#line 1
category c672;
#line 1
category c673;
#line 1
category c674;
#line 1
category c675;
#line 1
category c676;
#line 1
category c677;
#line 1
category c678;
#line 1
category c679;
#line 1
category c680;
#line 1
category c681;
#line 1
category c682;
#line 1
category c683;
#line 1
category c684;
#line 1
category c685;
#line 1
category c686;
#line 1
category c687;
#line 1
category c688;
#line 1
category c689;
#line 1
category c690;
#line 1
category c691;
#line 1
category c692;
#line 1
category c693;
#line 1
category c694;
#line 1
category c695;
#line 1
category c696;
#line 1
category c697;
#line 1
category c698;
#line 1
category c699;
#line 1
category c700;
#line 1
category c701;
#line 1
category c702;
#line 1
category c703;
#line 1
category c704;
#line 1
category c705;
#line 1
category c706;
#line 1
category c707;
#line 1
category c708;
#line 1
category c709;
#line 1
category c710;
#line 1
category c711;
#line 1
category c712;
#line 1
category c713;
#line 1
category c714;
#line 1
category c715;
#line 1
category c716;
#line 1
category c717;
#line 1
category c718;
#line 1
category c719;
#line 1
category c720;
#line 1
category c721;
#line 1
category c722;
#line 1
category c723;
#line 1
category c724;
#line 1
category c725;
#line 1
category c726;
#line 1
category c727;
#line 1
category c728;
#line 1
category c729;
#line 1
category c730;
#line 1
category c731;
#line 1
category c732;
#line 1
category c733;
#line 1
category c734;
#line 1
category c735;
#line 1
category c736;
#line 1
category c737;
#line 1
category c738;
#line 1
category c739;
#line 1
category c740;
#line 1
category c741;
#line 1
category c742;
#line 1
category c743;
#line 1
category c744;
#line 1
category c745;
#line 1
category c746;
#line 1
category c747;
#line 1
category c748;
#line 1
category c749;
#line 1
category c750;
#line 1
category c751;
#line 1
category c752;
#line 1
category c753;
#line 1
category c754;
#line 1
category c755;
#line 1
category c756;
#line 1
category c757;
#line 1
category c758;
#line 1
category c759;
#line 1
category c760;
#line 1
category c761;
#line 1
category c762;
#line 1
category c763;
#line 1
category c764;
#line 1
category c765;
#line 1
category c766;
#line 1
category c767;
#line 1
category c768;
#line 1
category c769;
#line 1
category c770;
#line 1
category c771;
#line 1
category c772;
#line 1
category c773;
#line 1
category c774;
#line 1
category c775;
#line 1
category c776;
#line 1
category c777;
#line 1
category c778;
#line 1
category c779;
#line 1
category c780;
#line 1
category c781;
#line 1
category c782;
#line 1
category c783;
#line 1
category c784;
#line 1
category c785;
#line 1
category c786;
#line 1
category c787;
#line 1
category c788;
#line 1
category c789;
#line 1
category c790;
#line 1
category c791;
#line 1
category c792;
#line 1
category c793;
#line 1
category c794;
#line 1
category c795;
#line 1
category c796;
#line 1
category c797;
#line 1
category c798;
#line 1
category c799;
#line 1
category c800;
#line 1
category c801;
#line 1
category c802;
#line 1
category c803;
#line 1
category c804;
#line 1
category c805;
#line 1
category c806;
#line 1
category c807;
#line 1
category c808;
#line 1
category c809;
#line 1
category c810;
#line 1
category c811;
#line 1
category c812;
#line 1
category c813;
#line 1
category c814;
#line 1
category c815;
#line 1
category c816;
#line 1
category c817;
#line 1
category c818;
#line 1
category c819;
#line 1
category c820;
#line 1
category c821;
#line 1
category c822;
#line 1
category c823;
#line 1
category c824;
#line 1
category c825;
#line 1
category c826;
#line 1
category c827;
#line 1
category c828;
#line 1
category c829;
#line 1
category c830;
#line 1
category c831;
#line 1
category c832;
#line 1
category c833;
#line 1
category c834;
#line 1
category c835;
#line 1
category c836;
#line 1
category c837;
#line 1
category c838;
#line 1
category c839;
#line 1
category c840;
#line 1
category c841;
#line 1
category c842;
#line 1
category c843;
#line 1
category c844;
#line 1
category c845;
#line 1
category c846;
#line 1
category c847;
#line 1
category c848;
#line 1
category c849;
#line 1
category c850;
#line 1
category c851;
#line 1
category c852;
#line 1
category c853;
#line 1
category c854;
#line 1
category c855;
#line 1
category c856;
#line 1
category c857;
#line 1
category c858;
#line 1
category c859;
#line 1
category c860;
#line 1
category c861;
#line 1
category c862;
#line 1
category c863;
#line 1
category c864;
#line 1
category c865;
#line 1
category c866;
#line 1
category c867;
#line 1
category c868;
#line 1
category c869;
#line 1
category c870;
#line 1
category c871;
#line 1
category c872;
#line 1
category c873;
#line 1
category c874;
#line 1
category c875;
#line 1
category c876;
#line 1
category c877;
#line 1
category c878;
#line 1
category c879;
#line 1
category c880;
#line 1
category c881;
#line 1
category c882;
#line 1
category c883;
#line 1
category c884;
#line 1
category c885;
#line 1
category c886;
#line 1
category c887;
#line 1
category c888;
#line 1
category c889;
#line 1
category c890;
#line 1
category c891;
#line 1
category c892;
#line 1
category c893;
#line 1
category c894;
#line 1
category c895;
#line 1
category c896;
#line 1
category c897;
#line 1
category c898;
#line 1
category c899;
#line 1
category c900;
#line 1
category c901;
#line 1
category c902;
#line 1
category c903;
#line 1
category c904;
#line 1
category c905;
#line 1
category c906;
#line 1
category c907;
#line 1
category c908;
#line 1
category c909;
#line 1
category c910;
#line 1
category c911;
#line 1
category c912;
#line 1
category c913;
#line 1
category c914;
#line 1
category c915;
#line 1
category c916;
#line 1
category c917;
#line 1
category c918;
#line 1
category c919;
#line 1
category c920;
#line 1
category c921;
#line 1
category c922;
#line 1
category c923;
#line 1
category c924;
#line 1
category c925;
#line 1
category c926;
#line 1
category c927;
#line 1
category c928;
#line 1
category c929;
#line 1
category c930;
#line 1
category c931;
#line 1
category c932;
#line 1
category c933;
#line 1
category c934;
#line 1
category c935;
#line 1
category c936;
#line 1
category c937;
#line 1
category c938;
#line 1
category c939;
#line 1
category c940;
#line 1
category c941;
#line 1
category c942;
#line 1
category c943;
#line 1
category c944;
#line 1
category c945;
#line 1
category c946;
#line 1
category c947;
#line 1
category c948;
#line 1
category c949;
#line 1
category c950;
#line 1
category c951;
#line 1
category c952;
#line 1
category c953;
#line 1
category c954;
#line 1
category c955;
#line 1
category c956;
#line 1
category c957;
#line 1
category c958;
#line 1
category c959;
#line 1
category c960;
#line 1
category c961;
#line 1
category c962;
#line 1
category c963;
#line 1
category c964;
#line 1
category c965;
#line 1
category c966;
#line 1
category c967;
#line 1
category c968;
#line 1
category c969;
#line 1
category c970;
#line 1
category c971;
#line 1
category c972;
#line 1
category c973;
#line 1
category c974;
#line 1
category c975;
#line 1
category c976;
#line 1
category c977;
#line 1
category c978;
#line 1
category c979;
#line 1
category c980;
#line 1
category c981;
#line 1
category c982;
#line 1
category c983;
#line 1
category c984;
#line 1
category c985;
#line 1
category c986;
#line 1
category c987;
#line 1
category c988;
#line 1
category c989;
#line 1
category c990;
#line 1
category c991;
#line 1
category c992;
#line 1
category c993;
#line 1
category c994;
#line 1
category c995;
#line 1
category c996;
#line 1
category c997;
#line 1
category c998;
#line 1
category c999;
#line 1
category c1000;
#line 1
category c1001;
#line 1
category c1002;
#line 1
category c1003;
#line 1
category c1004;
#line 1
category c1005;
#line 1
category c1006;
#line 1
category c1007;
#line 1
category c1008;
#line 1
category c1009;
#line 1
category c1010;
#line 1
category c1011;
#line 1
category c1012;
#line 1
category c1013;
#line 1
category c1014;
#line 1
category c1015;
#line 1
category c1016;
#line 1
category c1017;
#line 1
category c1018;
#line 1
category c1019;
#line 1
category c1020;
#line 1
category c1021;
#line 1
category c1022;
#line 1
category c1023;
#line 1

#line 1
			
#line 1

#line 1
			
#line 1
		}
#line 1
	
#line 1


########################################
#
# Declarations
#

## <desc>
##	<p>
##	Determine whether xend can
##	run blktapctrl and tapdisk.
## </p>
## </desc>

#line 14
	bool xend_run_blktap false;
#line 14


## <desc>
##	<p>
##	Determine whether xen can
##	use fusefs file systems.
##	</p>
## </desc>

#line 22
	bool xen_use_fusefs false;
#line 22


## <desc>
##	<p>
##	Determine whether xen can
##	use nfs file systems.
##	</p>
## </desc>

#line 30
	bool xen_use_nfs false;
#line 30


## <desc>
##	<p>
##	Determine whether xen can
##	use samba file systems.
##	</p>
## </desc>

#line 38
	bool xen_use_samba false;
#line 38


type blktap_t;
type blktap_exec_t;
 	 	
#line 42
##### begin domain_type(blktap_t) depth: 1
#line 42
 	
#line 42
	# start with basic domain
#line 42
	 	 	
#line 42
##### begin domain_base_type(blktap_t) depth: 2
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		attribute domain;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	typeattribute blktap_t domain;
#line 42

#line 42
	 	
#line 42
##### end domain_base_type(blktap_t) depth: 1
#line 42
 	
#line 42

#line 42
	
#line 42

#line 42
	# send init a sigchld and signull
#line 42
	
#line 42
	optional {
#line 42
		
#line 42
		 	 	
#line 42
##### begin init_sigchld(blktap_t) depth: 2
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type init_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	allow blktap_t init_t:process sigchld;
#line 42

#line 42
	 	
#line 42
##### end init_sigchld(blktap_t) depth: 1
#line 42
 	
#line 42
		 	 	
#line 42
##### begin init_signull(blktap_t) depth: 2
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type init_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	allow blktap_t init_t:process signull;
#line 42

#line 42
	 	
#line 42
##### end init_signull(blktap_t) depth: 1
#line 42
 	
#line 42
	
#line 42
	} # end optional
#line 42

#line 42

#line 42
	# these seem questionable:
#line 42

#line 42
	
#line 42
	optional {
#line 42
		
#line 42
		 	 	
#line 42
##### begin rpm_use_fds(blktap_t) depth: 2
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type rpm_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	allow blktap_t rpm_t:fd use;
#line 42

#line 42
	 	
#line 42
##### end rpm_use_fds(blktap_t) depth: 1
#line 42
 	
#line 42
		 	 	
#line 42
##### begin rpm_read_pipes(blktap_t) depth: 2
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type rpm_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	allow blktap_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 42

#line 42
	 	
#line 42
##### end rpm_read_pipes(blktap_t) depth: 1
#line 42
 	
#line 42
	
#line 42
	} # end optional
#line 42

#line 42

#line 42
	
#line 42
	optional {
#line 42
		
#line 42
		 	 	
#line 42
##### begin selinux_dontaudit_getattr_fs(blktap_t) depth: 2
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type security_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	dontaudit blktap_t security_t:filesystem getattr;
#line 42

#line 42
	 	 	
#line 42
##### begin dev_dontaudit_getattr_sysfs(blktap_t) depth: 3
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type sysfs_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	dontaudit blktap_t sysfs_t:filesystem getattr;
#line 42

#line 42
	 	
#line 42
##### end dev_dontaudit_getattr_sysfs(blktap_t) depth: 2
#line 42
 	
#line 42
	 	 	
#line 42
##### begin dev_dontaudit_search_sysfs(blktap_t) depth: 3
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type sysfs_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	dontaudit blktap_t sysfs_t:dir { getattr search open };
#line 42

#line 42
	 	
#line 42
##### end dev_dontaudit_search_sysfs(blktap_t) depth: 2
#line 42
 	
#line 42

#line 42
	 	
#line 42
##### end selinux_dontaudit_getattr_fs(blktap_t) depth: 1
#line 42
 	
#line 42
		 	 	
#line 42
##### begin selinux_dontaudit_read_fs(blktap_t) depth: 2
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type security_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	dontaudit blktap_t security_t:dir { getattr search open };
#line 42
	dontaudit blktap_t security_t:file { getattr open read lock ioctl };
#line 42

#line 42
	 	
#line 42
##### end selinux_dontaudit_read_fs(blktap_t) depth: 1
#line 42
 	
#line 42
	
#line 42
	} # end optional
#line 42

#line 42

#line 42
	
#line 42
	optional {
#line 42
		
#line 42
		 	 	
#line 42
##### begin seutil_dontaudit_read_config(blktap_t) depth: 2
#line 42
 	
#line 42
	
#line 42
	
#line 42
		require {
#line 42
			
#line 42
		type selinux_config_t;
#line 42
	
#line 42
		} # end require
#line 42
	
#line 42

#line 42

#line 42
	dontaudit blktap_t selinux_config_t:dir { getattr search open };
#line 42
	dontaudit blktap_t selinux_config_t:file { getattr open read lock ioctl };
#line 42

#line 42
	 	
#line 42
##### end seutil_dontaudit_read_config(blktap_t) depth: 1
#line 42
 	
#line 42
	
#line 42
	} # end optional
#line 42

#line 42

#line 42
	 	
#line 42
##### end domain_type(blktap_t) depth: 0
#line 42
 	
 	 	
#line 43
##### begin domain_entry_file(blktap_t,blktap_exec_t) depth: 1
#line 43
 	
#line 43
	
#line 43
	
#line 43
		require {
#line 43
			
#line 43
		attribute entry_type;
#line 43
	
#line 43
		} # end require
#line 43
	
#line 43

#line 43

#line 43
	allow blktap_t blktap_exec_t:file entrypoint;
#line 43
	allow blktap_t blktap_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 43

#line 43
	typeattribute blktap_exec_t entry_type;
#line 43

#line 43
	 	 	
#line 43
##### begin corecmd_executable_file(blktap_exec_t) depth: 2
#line 43
 	
#line 43
	
#line 43
	
#line 43
		require {
#line 43
			
#line 43
		attribute exec_type;
#line 43
	
#line 43
		} # end require
#line 43
	
#line 43

#line 43

#line 43
	typeattribute blktap_exec_t exec_type;
#line 43

#line 43
	 	 	
#line 43
##### begin files_type(blktap_exec_t) depth: 3
#line 43
 	
#line 43
	
#line 43
	
#line 43
		require {
#line 43
			
#line 43
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 43
	
#line 43
		} # end require
#line 43
	
#line 43

#line 43

#line 43
	typeattribute blktap_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 43

#line 43
	 	
#line 43
##### end files_type(blktap_exec_t) depth: 2
#line 43
 	
#line 43

#line 43
	 	
#line 43
##### end corecmd_executable_file(blktap_exec_t) depth: 1
#line 43
 	
#line 43

#line 43
	 	
#line 43
##### end domain_entry_file(blktap_t,blktap_exec_t) depth: 0
#line 43
 	
role system_r types blktap_t;

type blktap_var_run_t;
 	 	
#line 47
##### begin files_pid_file(blktap_var_run_t) depth: 1
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute pidfile;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_type(blktap_var_run_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute blktap_var_run_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(blktap_var_run_t) depth: 1
#line 47
 	
#line 47
	typeattribute blktap_var_run_t pidfile;
#line 47

#line 47
	 	
#line 47
##### end files_pid_file(blktap_var_run_t) depth: 0
#line 47
 	

type evtchnd_t;
type evtchnd_exec_t;
 	 	
#line 51
##### begin init_daemon_domain(evtchnd_t,evtchnd_exec_t) depth: 1
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type initrc_t;
#line 51
		type init_t;
#line 51
		role system_r;
#line 51
		attribute daemon;
#line 51
		attribute initrc_transition_domain;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	typeattribute evtchnd_t daemon;
#line 51

#line 51
	 	 	
#line 51
##### begin domain_type(evtchnd_t) depth: 2
#line 51
 	
#line 51
	# start with basic domain
#line 51
	 	 	
#line 51
##### begin domain_base_type(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		attribute domain;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	typeattribute evtchnd_t domain;
#line 51

#line 51
	 	
#line 51
##### end domain_base_type(evtchnd_t) depth: 2
#line 51
 	
#line 51

#line 51
	
#line 51

#line 51
	# send init a sigchld and signull
#line 51
	
#line 51
	optional {
#line 51
		
#line 51
		 	 	
#line 51
##### begin init_sigchld(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type init_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t init_t:process sigchld;
#line 51

#line 51
	 	
#line 51
##### end init_sigchld(evtchnd_t) depth: 2
#line 51
 	
#line 51
		 	 	
#line 51
##### begin init_signull(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type init_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t init_t:process signull;
#line 51

#line 51
	 	
#line 51
##### end init_signull(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	} # end optional
#line 51

#line 51

#line 51
	# these seem questionable:
#line 51

#line 51
	
#line 51
	optional {
#line 51
		
#line 51
		 	 	
#line 51
##### begin rpm_use_fds(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type rpm_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t rpm_t:fd use;
#line 51

#line 51
	 	
#line 51
##### end rpm_use_fds(evtchnd_t) depth: 2
#line 51
 	
#line 51
		 	 	
#line 51
##### begin rpm_read_pipes(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type rpm_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 51

#line 51
	 	
#line 51
##### end rpm_read_pipes(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	} # end optional
#line 51

#line 51

#line 51
	
#line 51
	optional {
#line 51
		
#line 51
		 	 	
#line 51
##### begin selinux_dontaudit_getattr_fs(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type security_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	dontaudit evtchnd_t security_t:filesystem getattr;
#line 51

#line 51
	 	 	
#line 51
##### begin dev_dontaudit_getattr_sysfs(evtchnd_t) depth: 4
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type sysfs_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	dontaudit evtchnd_t sysfs_t:filesystem getattr;
#line 51

#line 51
	 	
#line 51
##### end dev_dontaudit_getattr_sysfs(evtchnd_t) depth: 3
#line 51
 	
#line 51
	 	 	
#line 51
##### begin dev_dontaudit_search_sysfs(evtchnd_t) depth: 4
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type sysfs_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	dontaudit evtchnd_t sysfs_t:dir { getattr search open };
#line 51

#line 51
	 	
#line 51
##### end dev_dontaudit_search_sysfs(evtchnd_t) depth: 3
#line 51
 	
#line 51

#line 51
	 	
#line 51
##### end selinux_dontaudit_getattr_fs(evtchnd_t) depth: 2
#line 51
 	
#line 51
		 	 	
#line 51
##### begin selinux_dontaudit_read_fs(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type security_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	dontaudit evtchnd_t security_t:dir { getattr search open };
#line 51
	dontaudit evtchnd_t security_t:file { getattr open read lock ioctl };
#line 51

#line 51
	 	
#line 51
##### end selinux_dontaudit_read_fs(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	} # end optional
#line 51

#line 51

#line 51
	
#line 51
	optional {
#line 51
		
#line 51
		 	 	
#line 51
##### begin seutil_dontaudit_read_config(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type selinux_config_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	dontaudit evtchnd_t selinux_config_t:dir { getattr search open };
#line 51
	dontaudit evtchnd_t selinux_config_t:file { getattr open read lock ioctl };
#line 51

#line 51
	 	
#line 51
##### end seutil_dontaudit_read_config(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	} # end optional
#line 51

#line 51

#line 51
	 	
#line 51
##### end domain_type(evtchnd_t) depth: 1
#line 51
 	
#line 51
	 	 	
#line 51
##### begin domain_entry_file(evtchnd_t,evtchnd_exec_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		attribute entry_type;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t evtchnd_exec_t:file entrypoint;
#line 51
	allow evtchnd_t evtchnd_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 51

#line 51
	typeattribute evtchnd_exec_t entry_type;
#line 51

#line 51
	 	 	
#line 51
##### begin corecmd_executable_file(evtchnd_exec_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		attribute exec_type;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	typeattribute evtchnd_exec_t exec_type;
#line 51

#line 51
	 	 	
#line 51
##### begin files_type(evtchnd_exec_t) depth: 4
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	typeattribute evtchnd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 51

#line 51
	 	
#line 51
##### end files_type(evtchnd_exec_t) depth: 3
#line 51
 	
#line 51

#line 51
	 	
#line 51
##### end corecmd_executable_file(evtchnd_exec_t) depth: 2
#line 51
 	
#line 51

#line 51
	 	
#line 51
##### end domain_entry_file(evtchnd_t,evtchnd_exec_t) depth: 1
#line 51
 	
#line 51

#line 51
	role system_r types evtchnd_t;
#line 51

#line 51
	
#line 51
	
#line 51
	
#line 51
	allow initrc_t evtchnd_exec_t:file { getattr open read execute };
#line 51
	allow initrc_t evtchnd_t:process transition;
#line 51
	dontaudit initrc_t evtchnd_t:process { noatsecure siginh rlimitinh };
#line 51

#line 51
	type_transition initrc_t evtchnd_exec_t:process evtchnd_t;
#line 51

#line 51

#line 51
	allow evtchnd_t initrc_t:fd use;
#line 51
	allow evtchnd_t initrc_t:fifo_file { open { getattr read write append ioctl lock } };
#line 51
	allow evtchnd_t initrc_t:process sigchld;
#line 51

#line 51

#line 51
	
#line 51

#line 51
	# daemons started from init will
#line 51
	# inherit fds from init for the console
#line 51
	 	 	
#line 51
##### begin init_dontaudit_use_fds(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type init_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	dontaudit evtchnd_t init_t:fd use;
#line 51

#line 51
	 	
#line 51
##### end init_dontaudit_use_fds(evtchnd_t) depth: 1
#line 51
 	
#line 51
	 	 	
#line 51
##### begin term_dontaudit_use_console(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type console_device_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	dontaudit evtchnd_t console_device_t:chr_file { getattr open read write append ioctl lock };
#line 51

#line 51
	 	
#line 51
##### end term_dontaudit_use_console(evtchnd_t) depth: 1
#line 51
 	
#line 51

#line 51
	# init script ptys are the stdin/out/err
#line 51
	# when using run_init
#line 51
	 	 	
#line 51
##### begin init_use_script_ptys(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type initrc_devpts_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	 	 	
#line 51
##### begin term_list_ptys(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type devpts_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	 	 	
#line 51
##### begin dev_list_all_dev_nodes(evtchnd_t) depth: 4
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type device_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	
#line 51
	allow evtchnd_t device_t:dir { getattr search open };
#line 51
	allow evtchnd_t device_t:dir { getattr search open read lock ioctl };
#line 51

#line 51
	
#line 51
	allow evtchnd_t device_t:dir { getattr search open };
#line 51
	allow evtchnd_t device_t:lnk_file { getattr read };
#line 51

#line 51

#line 51
	 	
#line 51
##### end dev_list_all_dev_nodes(evtchnd_t) depth: 3
#line 51
 	
#line 51
	allow evtchnd_t devpts_t:dir { getattr search open read lock ioctl };
#line 51

#line 51
	 	
#line 51
##### end term_list_ptys(evtchnd_t) depth: 2
#line 51
 	
#line 51
	allow evtchnd_t initrc_devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 51

#line 51
	 	
#line 51
##### end init_use_script_ptys(evtchnd_t) depth: 1
#line 51
 	
#line 51

#line 51
	
#line 51
		 	 	
#line 51
##### begin userdom_dontaudit_use_user_terminals(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type user_tty_device_t, user_devpts_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	dontaudit evtchnd_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 51
	dontaudit evtchnd_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 51

#line 51
	 	
#line 51
##### end userdom_dontaudit_use_user_terminals(evtchnd_t) depth: 1
#line 51
 	
#line 51
	
#line 51

#line 51
	
#line 51

#line 51
	
#line 51
	optional {
#line 51
		
#line 51
		 	 	
#line 51
##### begin nscd_use(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		
#line 51
bool nscd_use_shm;
#line 51

#line 51
  
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51
	if (nscd_use_shm) {
#line 51
		
#line 51
		 	 	
#line 51
##### begin nscd_shm_use(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type nscd_t, nscd_var_run_t;
#line 51
		class nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 51

#line 51
	allow evtchnd_t nscd_t:nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 51
	allow evtchnd_t nscd_t:fd use;
#line 51

#line 51
	 	 	
#line 51
##### begin files_search_pids(evtchnd_t) depth: 4
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type var_t, var_run_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t var_run_t:lnk_file { getattr read };
#line 51
	
#line 51
	allow evtchnd_t var_t:dir { getattr search open };
#line 51
	allow evtchnd_t var_run_t:dir { getattr search open };
#line 51

#line 51

#line 51
	 	
#line 51
##### end files_search_pids(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	allow evtchnd_t nscd_var_run_t:dir { getattr search open };
#line 51
	allow evtchnd_t nscd_var_run_t:sock_file { getattr write open append };
#line 51
	allow evtchnd_t nscd_t:unix_stream_socket connectto;
#line 51

#line 51
	dontaudit evtchnd_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 51

#line 51
	allow evtchnd_t nscd_var_run_t:dir { getattr search open read lock ioctl };
#line 51
	allow evtchnd_t nscd_var_run_t:sock_file { getattr open read };
#line 51

#line 51
	 	
#line 51
##### end nscd_shm_use(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	} else {
#line 51
		
#line 51
		 	 	
#line 51
##### begin nscd_socket_use(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type nscd_t, nscd_var_run_t;
#line 51
		class nscd { getserv getpwd getgrp gethost shmempwd shmemgrp shmemhost shmemserv };
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 51

#line 51
	allow evtchnd_t nscd_t:nscd { getpwd getgrp gethost };
#line 51

#line 51
	dontaudit evtchnd_t nscd_t:fd use;
#line 51
	dontaudit evtchnd_t nscd_t:nscd { getserv shmempwd shmemgrp shmemhost shmemserv };
#line 51

#line 51
	 	 	
#line 51
##### begin files_search_pids(evtchnd_t) depth: 4
#line 51
 	
#line 51
	
#line 51
	
#line 51
		require {
#line 51
			
#line 51
		type var_t, var_run_t;
#line 51
	
#line 51
		} # end require
#line 51
	
#line 51

#line 51

#line 51
	allow evtchnd_t var_run_t:lnk_file { getattr read };
#line 51
	
#line 51
	allow evtchnd_t var_t:dir { getattr search open };
#line 51
	allow evtchnd_t var_run_t:dir { getattr search open };
#line 51

#line 51

#line 51
	 	
#line 51
##### end files_search_pids(evtchnd_t) depth: 3
#line 51
 	
#line 51
	
#line 51
	allow evtchnd_t nscd_var_run_t:dir { getattr search open };
#line 51
	allow evtchnd_t nscd_var_run_t:sock_file { getattr write open append };
#line 51
	allow evtchnd_t nscd_t:unix_stream_socket connectto;
#line 51

#line 51
	dontaudit evtchnd_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 51

#line 51
	
#line 51
	allow nscd_t evtchnd_t:dir { getattr search open read lock ioctl };
#line 51
	allow nscd_t evtchnd_t:file { getattr open read lock ioctl };
#line 51
	allow nscd_t evtchnd_t:lnk_file { getattr read };
#line 51
	allow nscd_t evtchnd_t:process getattr;
#line 51

#line 51

#line 51
	 	
#line 51
##### end nscd_socket_use(evtchnd_t) depth: 2
#line 51
 	
#line 51
	
#line 51
	}
#line 51

#line 51

#line 51
	 	
#line 51
##### end nscd_use(evtchnd_t) depth: 1
#line 51
 	
#line 51
	
#line 51
	} # end optional
#line 51

#line 51

#line 51
	 	
#line 51
##### end init_daemon_domain(evtchnd_t,evtchnd_exec_t) depth: 0
#line 51
 	

type evtchnd_var_log_t;
 	 	
#line 54
##### begin logging_log_file(evtchnd_var_log_t) depth: 1
#line 54
 	
#line 54
	
#line 54
	
#line 54
		require {
#line 54
			
#line 54
		attribute logfile;
#line 54
	
#line 54
		} # end require
#line 54
	
#line 54

#line 54

#line 54
	 	 	
#line 54
##### begin files_type(evtchnd_var_log_t) depth: 2
#line 54
 	
#line 54
	
#line 54
	
#line 54
		require {
#line 54
			
#line 54
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 54
	
#line 54
		} # end require
#line 54
	
#line 54

#line 54

#line 54
	typeattribute evtchnd_var_log_t file_type, non_security_file_type, non_auth_file_type;
#line 54

#line 54
	 	
#line 54
##### end files_type(evtchnd_var_log_t) depth: 1
#line 54
 	
#line 54
	 	 	
#line 54
##### begin files_associate_tmp(evtchnd_var_log_t) depth: 2
#line 54
 	
#line 54
	
#line 54
	
#line 54
		require {
#line 54
			
#line 54
		type tmp_t;
#line 54
	
#line 54
		} # end require
#line 54
	
#line 54

#line 54

#line 54
	allow evtchnd_var_log_t tmp_t:filesystem associate;
#line 54

#line 54
	 	
#line 54
##### end files_associate_tmp(evtchnd_var_log_t) depth: 1
#line 54
 	
#line 54
	 	 	
#line 54
##### begin fs_associate_tmpfs(evtchnd_var_log_t) depth: 2
#line 54
 	
#line 54
	
#line 54
	
#line 54
		require {
#line 54
			
#line 54
		type tmpfs_t;
#line 54
	
#line 54
		} # end require
#line 54
	
#line 54

#line 54

#line 54
	allow evtchnd_var_log_t tmpfs_t:filesystem associate;
#line 54

#line 54
	 	
#line 54
##### end fs_associate_tmpfs(evtchnd_var_log_t) depth: 1
#line 54
 	
#line 54
	typeattribute evtchnd_var_log_t logfile;
#line 54

#line 54
	 	
#line 54
##### end logging_log_file(evtchnd_var_log_t) depth: 0
#line 54
 	

type evtchnd_var_run_t;
 	 	
#line 57
##### begin files_pid_file(evtchnd_var_run_t) depth: 1
#line 57
 	
#line 57
	
#line 57
	
#line 57
		require {
#line 57
			
#line 57
		attribute pidfile;
#line 57
	
#line 57
		} # end require
#line 57
	
#line 57

#line 57

#line 57
	 	 	
#line 57
##### begin files_type(evtchnd_var_run_t) depth: 2
#line 57
 	
#line 57
	
#line 57
	
#line 57
		require {
#line 57
			
#line 57
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 57
	
#line 57
		} # end require
#line 57
	
#line 57

#line 57

#line 57
	typeattribute evtchnd_var_run_t file_type, non_security_file_type, non_auth_file_type;
#line 57

#line 57
	 	
#line 57
##### end files_type(evtchnd_var_run_t) depth: 1
#line 57
 	
#line 57
	typeattribute evtchnd_var_run_t pidfile;
#line 57

#line 57
	 	
#line 57
##### end files_pid_file(evtchnd_var_run_t) depth: 0
#line 57
 	

type xen_devpts_t;
 	 	
#line 60
##### begin term_pty(xen_devpts_t) depth: 1
#line 60
 	
#line 60
	
#line 60
	
#line 60
		require {
#line 60
			
#line 60
		attribute ptynode;
#line 60
		type devpts_t;
#line 60
	
#line 60
		} # end require
#line 60
	
#line 60

#line 60

#line 60
	 	 	
#line 60
##### begin dev_node(xen_devpts_t) depth: 2
#line 60
 	
#line 60
	
#line 60
	
#line 60
		require {
#line 60
			
#line 60
		attribute device_node;
#line 60
	
#line 60
		} # end require
#line 60
	
#line 60

#line 60

#line 60
	typeattribute xen_devpts_t device_node;
#line 60

#line 60
	 	
#line 60
##### end dev_node(xen_devpts_t) depth: 1
#line 60
 	
#line 60
	allow xen_devpts_t devpts_t:filesystem associate;
#line 60
	typeattribute xen_devpts_t ptynode;
#line 60

#line 60
	 	
#line 60
##### end term_pty(xen_devpts_t) depth: 0
#line 60
 	
 	 	
#line 61
##### begin files_type(xen_devpts_t) depth: 1
#line 61
 	
#line 61
	
#line 61
	
#line 61
		require {
#line 61
			
#line 61
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 61
	
#line 61
		} # end require
#line 61
	
#line 61

#line 61

#line 61
	typeattribute xen_devpts_t file_type, non_security_file_type, non_auth_file_type;
#line 61

#line 61
	 	
#line 61
##### end files_type(xen_devpts_t) depth: 0
#line 61
 	

type xen_image_t; # customizable
 	 	
#line 64
##### begin files_type(xen_image_t) depth: 1
#line 64
 	
#line 64
	
#line 64
	
#line 64
		require {
#line 64
			
#line 64
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 64
	
#line 64
		} # end require
#line 64
	
#line 64

#line 64

#line 64
	typeattribute xen_image_t file_type, non_security_file_type, non_auth_file_type;
#line 64

#line 64
	 	
#line 64
##### end files_type(xen_image_t) depth: 0
#line 64
 	
 	 	
#line 65
##### begin dev_node(xen_image_t) depth: 1
#line 65
 	
#line 65
	
#line 65
	
#line 65
		require {
#line 65
			
#line 65
		attribute device_node;
#line 65
	
#line 65
		} # end require
#line 65
	
#line 65

#line 65

#line 65
	typeattribute xen_image_t device_node;
#line 65

#line 65
	 	
#line 65
##### end dev_node(xen_image_t) depth: 0
#line 65
 	


#line 67
	optional {
#line 67
		
#line 67
	 	 	
#line 67
##### begin virt_image(xen_image_t) depth: 1
#line 67
 	
#line 67
	
#line 67
	
#line 67
		require {
#line 67
			
#line 67
		attribute virt_image_type;
#line 67
	
#line 67
		} # end require
#line 67
	
#line 67

#line 67

#line 67
	typeattribute xen_image_t virt_image_type;
#line 67
	 	 	
#line 67
##### begin files_type(xen_image_t) depth: 2
#line 67
 	
#line 67
	
#line 67
	
#line 67
		require {
#line 67
			
#line 67
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 67
	
#line 67
		} # end require
#line 67
	
#line 67

#line 67

#line 67
	typeattribute xen_image_t file_type, non_security_file_type, non_auth_file_type;
#line 67

#line 67
	 	
#line 67
##### end files_type(xen_image_t) depth: 1
#line 67
 	
#line 67
	 	 	
#line 67
##### begin dev_node(xen_image_t) depth: 2
#line 67
 	
#line 67
	
#line 67
	
#line 67
		require {
#line 67
			
#line 67
		attribute device_node;
#line 67
	
#line 67
		} # end require
#line 67
	
#line 67

#line 67

#line 67
	typeattribute xen_image_t device_node;
#line 67

#line 67
	 	
#line 67
##### end dev_node(xen_image_t) depth: 1
#line 67
 	
#line 67

#line 67
	 	
#line 67
##### end virt_image(xen_image_t) depth: 0
#line 67
 	
#line 67

#line 67
	} # end optional
#line 69


type xenctl_t;
 	 	
#line 72
##### begin files_type(xenctl_t) depth: 1
#line 72
 	
#line 72
	
#line 72
	
#line 72
		require {
#line 72
			
#line 72
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 72
	
#line 72
		} # end require
#line 72
	
#line 72

#line 72

#line 72
	typeattribute xenctl_t file_type, non_security_file_type, non_auth_file_type;
#line 72

#line 72
	 	
#line 72
##### end files_type(xenctl_t) depth: 0
#line 72
 	

type xend_t;
type xend_exec_t;
 	 	
#line 76
##### begin init_daemon_domain(xend_t,xend_exec_t) depth: 1
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type initrc_t;
#line 76
		type init_t;
#line 76
		role system_r;
#line 76
		attribute daemon;
#line 76
		attribute initrc_transition_domain;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	typeattribute xend_t daemon;
#line 76

#line 76
	 	 	
#line 76
##### begin domain_type(xend_t) depth: 2
#line 76
 	
#line 76
	# start with basic domain
#line 76
	 	 	
#line 76
##### begin domain_base_type(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		attribute domain;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	typeattribute xend_t domain;
#line 76

#line 76
	 	
#line 76
##### end domain_base_type(xend_t) depth: 2
#line 76
 	
#line 76

#line 76
	
#line 76

#line 76
	# send init a sigchld and signull
#line 76
	
#line 76
	optional {
#line 76
		
#line 76
		 	 	
#line 76
##### begin init_sigchld(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type init_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t init_t:process sigchld;
#line 76

#line 76
	 	
#line 76
##### end init_sigchld(xend_t) depth: 2
#line 76
 	
#line 76
		 	 	
#line 76
##### begin init_signull(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type init_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t init_t:process signull;
#line 76

#line 76
	 	
#line 76
##### end init_signull(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	} # end optional
#line 76

#line 76

#line 76
	# these seem questionable:
#line 76

#line 76
	
#line 76
	optional {
#line 76
		
#line 76
		 	 	
#line 76
##### begin rpm_use_fds(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type rpm_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t rpm_t:fd use;
#line 76

#line 76
	 	
#line 76
##### end rpm_use_fds(xend_t) depth: 2
#line 76
 	
#line 76
		 	 	
#line 76
##### begin rpm_read_pipes(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type rpm_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 76

#line 76
	 	
#line 76
##### end rpm_read_pipes(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	} # end optional
#line 76

#line 76

#line 76
	
#line 76
	optional {
#line 76
		
#line 76
		 	 	
#line 76
##### begin selinux_dontaudit_getattr_fs(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type security_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	dontaudit xend_t security_t:filesystem getattr;
#line 76

#line 76
	 	 	
#line 76
##### begin dev_dontaudit_getattr_sysfs(xend_t) depth: 4
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type sysfs_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	dontaudit xend_t sysfs_t:filesystem getattr;
#line 76

#line 76
	 	
#line 76
##### end dev_dontaudit_getattr_sysfs(xend_t) depth: 3
#line 76
 	
#line 76
	 	 	
#line 76
##### begin dev_dontaudit_search_sysfs(xend_t) depth: 4
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type sysfs_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	dontaudit xend_t sysfs_t:dir { getattr search open };
#line 76

#line 76
	 	
#line 76
##### end dev_dontaudit_search_sysfs(xend_t) depth: 3
#line 76
 	
#line 76

#line 76
	 	
#line 76
##### end selinux_dontaudit_getattr_fs(xend_t) depth: 2
#line 76
 	
#line 76
		 	 	
#line 76
##### begin selinux_dontaudit_read_fs(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type security_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	dontaudit xend_t security_t:dir { getattr search open };
#line 76
	dontaudit xend_t security_t:file { getattr open read lock ioctl };
#line 76

#line 76
	 	
#line 76
##### end selinux_dontaudit_read_fs(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	} # end optional
#line 76

#line 76

#line 76
	
#line 76
	optional {
#line 76
		
#line 76
		 	 	
#line 76
##### begin seutil_dontaudit_read_config(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type selinux_config_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	dontaudit xend_t selinux_config_t:dir { getattr search open };
#line 76
	dontaudit xend_t selinux_config_t:file { getattr open read lock ioctl };
#line 76

#line 76
	 	
#line 76
##### end seutil_dontaudit_read_config(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	} # end optional
#line 76

#line 76

#line 76
	 	
#line 76
##### end domain_type(xend_t) depth: 1
#line 76
 	
#line 76
	 	 	
#line 76
##### begin domain_entry_file(xend_t,xend_exec_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		attribute entry_type;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t xend_exec_t:file entrypoint;
#line 76
	allow xend_t xend_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 76

#line 76
	typeattribute xend_exec_t entry_type;
#line 76

#line 76
	 	 	
#line 76
##### begin corecmd_executable_file(xend_exec_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		attribute exec_type;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	typeattribute xend_exec_t exec_type;
#line 76

#line 76
	 	 	
#line 76
##### begin files_type(xend_exec_t) depth: 4
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	typeattribute xend_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 76

#line 76
	 	
#line 76
##### end files_type(xend_exec_t) depth: 3
#line 76
 	
#line 76

#line 76
	 	
#line 76
##### end corecmd_executable_file(xend_exec_t) depth: 2
#line 76
 	
#line 76

#line 76
	 	
#line 76
##### end domain_entry_file(xend_t,xend_exec_t) depth: 1
#line 76
 	
#line 76

#line 76
	role system_r types xend_t;
#line 76

#line 76
	
#line 76
	
#line 76
	
#line 76
	allow initrc_t xend_exec_t:file { getattr open read execute };
#line 76
	allow initrc_t xend_t:process transition;
#line 76
	dontaudit initrc_t xend_t:process { noatsecure siginh rlimitinh };
#line 76

#line 76
	type_transition initrc_t xend_exec_t:process xend_t;
#line 76

#line 76

#line 76
	allow xend_t initrc_t:fd use;
#line 76
	allow xend_t initrc_t:fifo_file { open { getattr read write append ioctl lock } };
#line 76
	allow xend_t initrc_t:process sigchld;
#line 76

#line 76

#line 76
	
#line 76

#line 76
	# daemons started from init will
#line 76
	# inherit fds from init for the console
#line 76
	 	 	
#line 76
##### begin init_dontaudit_use_fds(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type init_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	dontaudit xend_t init_t:fd use;
#line 76

#line 76
	 	
#line 76
##### end init_dontaudit_use_fds(xend_t) depth: 1
#line 76
 	
#line 76
	 	 	
#line 76
##### begin term_dontaudit_use_console(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type console_device_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	dontaudit xend_t console_device_t:chr_file { getattr open read write append ioctl lock };
#line 76

#line 76
	 	
#line 76
##### end term_dontaudit_use_console(xend_t) depth: 1
#line 76
 	
#line 76

#line 76
	# init script ptys are the stdin/out/err
#line 76
	# when using run_init
#line 76
	 	 	
#line 76
##### begin init_use_script_ptys(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type initrc_devpts_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	 	 	
#line 76
##### begin term_list_ptys(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type devpts_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	 	 	
#line 76
##### begin dev_list_all_dev_nodes(xend_t) depth: 4
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type device_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	
#line 76
	allow xend_t device_t:dir { getattr search open };
#line 76
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 76

#line 76
	
#line 76
	allow xend_t device_t:dir { getattr search open };
#line 76
	allow xend_t device_t:lnk_file { getattr read };
#line 76

#line 76

#line 76
	 	
#line 76
##### end dev_list_all_dev_nodes(xend_t) depth: 3
#line 76
 	
#line 76
	allow xend_t devpts_t:dir { getattr search open read lock ioctl };
#line 76

#line 76
	 	
#line 76
##### end term_list_ptys(xend_t) depth: 2
#line 76
 	
#line 76
	allow xend_t initrc_devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 76

#line 76
	 	
#line 76
##### end init_use_script_ptys(xend_t) depth: 1
#line 76
 	
#line 76

#line 76
	
#line 76
		 	 	
#line 76
##### begin userdom_dontaudit_use_user_terminals(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type user_tty_device_t, user_devpts_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	dontaudit xend_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 76
	dontaudit xend_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 76

#line 76
	 	
#line 76
##### end userdom_dontaudit_use_user_terminals(xend_t) depth: 1
#line 76
 	
#line 76
	
#line 76

#line 76
	
#line 76

#line 76
	
#line 76
	optional {
#line 76
		
#line 76
		 	 	
#line 76
##### begin nscd_use(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		
#line 76
bool nscd_use_shm;
#line 76

#line 76
  
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76
	if (nscd_use_shm) {
#line 76
		
#line 76
		 	 	
#line 76
##### begin nscd_shm_use(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type nscd_t, nscd_var_run_t;
#line 76
		class nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 76

#line 76
	allow xend_t nscd_t:nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 76
	allow xend_t nscd_t:fd use;
#line 76

#line 76
	 	 	
#line 76
##### begin files_search_pids(xend_t) depth: 4
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type var_t, var_run_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t var_run_t:lnk_file { getattr read };
#line 76
	
#line 76
	allow xend_t var_t:dir { getattr search open };
#line 76
	allow xend_t var_run_t:dir { getattr search open };
#line 76

#line 76

#line 76
	 	
#line 76
##### end files_search_pids(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	allow xend_t nscd_var_run_t:dir { getattr search open };
#line 76
	allow xend_t nscd_var_run_t:sock_file { getattr write open append };
#line 76
	allow xend_t nscd_t:unix_stream_socket connectto;
#line 76

#line 76
	dontaudit xend_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 76

#line 76
	allow xend_t nscd_var_run_t:dir { getattr search open read lock ioctl };
#line 76
	allow xend_t nscd_var_run_t:sock_file { getattr open read };
#line 76

#line 76
	 	
#line 76
##### end nscd_shm_use(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	} else {
#line 76
		
#line 76
		 	 	
#line 76
##### begin nscd_socket_use(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type nscd_t, nscd_var_run_t;
#line 76
		class nscd { getserv getpwd getgrp gethost shmempwd shmemgrp shmemhost shmemserv };
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 76

#line 76
	allow xend_t nscd_t:nscd { getpwd getgrp gethost };
#line 76

#line 76
	dontaudit xend_t nscd_t:fd use;
#line 76
	dontaudit xend_t nscd_t:nscd { getserv shmempwd shmemgrp shmemhost shmemserv };
#line 76

#line 76
	 	 	
#line 76
##### begin files_search_pids(xend_t) depth: 4
#line 76
 	
#line 76
	
#line 76
	
#line 76
		require {
#line 76
			
#line 76
		type var_t, var_run_t;
#line 76
	
#line 76
		} # end require
#line 76
	
#line 76

#line 76

#line 76
	allow xend_t var_run_t:lnk_file { getattr read };
#line 76
	
#line 76
	allow xend_t var_t:dir { getattr search open };
#line 76
	allow xend_t var_run_t:dir { getattr search open };
#line 76

#line 76

#line 76
	 	
#line 76
##### end files_search_pids(xend_t) depth: 3
#line 76
 	
#line 76
	
#line 76
	allow xend_t nscd_var_run_t:dir { getattr search open };
#line 76
	allow xend_t nscd_var_run_t:sock_file { getattr write open append };
#line 76
	allow xend_t nscd_t:unix_stream_socket connectto;
#line 76

#line 76
	dontaudit xend_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 76

#line 76
	
#line 76
	allow nscd_t xend_t:dir { getattr search open read lock ioctl };
#line 76
	allow nscd_t xend_t:file { getattr open read lock ioctl };
#line 76
	allow nscd_t xend_t:lnk_file { getattr read };
#line 76
	allow nscd_t xend_t:process getattr;
#line 76

#line 76

#line 76
	 	
#line 76
##### end nscd_socket_use(xend_t) depth: 2
#line 76
 	
#line 76
	
#line 76
	}
#line 76

#line 76

#line 76
	 	
#line 76
##### end nscd_use(xend_t) depth: 1
#line 76
 	
#line 76
	
#line 76
	} # end optional
#line 76

#line 76

#line 76
	 	
#line 76
##### end init_daemon_domain(xend_t,xend_exec_t) depth: 0
#line 76
 	

type xend_tmp_t;
 	 	
#line 79
##### begin files_tmp_file(xend_tmp_t) depth: 1
#line 79
 	
#line 79
	
#line 79
	
#line 79
		require {
#line 79
			
#line 79
		attribute tmpfile;
#line 79
		type tmp_t;
#line 79
	
#line 79
		} # end require
#line 79
	
#line 79

#line 79

#line 79
	 	 	
#line 79
##### begin files_type(xend_tmp_t) depth: 2
#line 79
 	
#line 79
	
#line 79
	
#line 79
		require {
#line 79
			
#line 79
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 79
	
#line 79
		} # end require
#line 79
	
#line 79

#line 79

#line 79
	typeattribute xend_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 79

#line 79
	 	
#line 79
##### end files_type(xend_tmp_t) depth: 1
#line 79
 	
#line 79
	 	 	
#line 79
##### begin files_poly_member(xend_tmp_t) depth: 2
#line 79
 	
#line 79
	
#line 79
	
#line 79
		require {
#line 79
			
#line 79
		attribute polymember;
#line 79
	
#line 79
		} # end require
#line 79
	
#line 79

#line 79

#line 79
	 	 	
#line 79
##### begin files_type(xend_tmp_t) depth: 3
#line 79
 	
#line 79
	
#line 79
	
#line 79
		require {
#line 79
			
#line 79
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 79
	
#line 79
		} # end require
#line 79
	
#line 79

#line 79

#line 79
	typeattribute xend_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 79

#line 79
	 	
#line 79
##### end files_type(xend_tmp_t) depth: 2
#line 79
 	
#line 79
	typeattribute xend_tmp_t polymember;
#line 79

#line 79
	 	
#line 79
##### end files_poly_member(xend_tmp_t) depth: 1
#line 79
 	
#line 79
	typeattribute xend_tmp_t tmpfile;
#line 79

#line 79
	 	
#line 79
##### end files_tmp_file(xend_tmp_t) depth: 0
#line 79
 	

type xend_var_lib_t;
 	 	
#line 82
##### begin files_type(xend_var_lib_t) depth: 1
#line 82
 	
#line 82
	
#line 82
	
#line 82
		require {
#line 82
			
#line 82
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 82
	
#line 82
		} # end require
#line 82
	
#line 82

#line 82

#line 82
	typeattribute xend_var_lib_t file_type, non_security_file_type, non_auth_file_type;
#line 82

#line 82
	 	
#line 82
##### end files_type(xend_var_lib_t) depth: 0
#line 82
 	
 	 	
#line 83
##### begin files_mountpoint(xend_var_lib_t) depth: 1
#line 83
 	
#line 83
	
#line 83
	
#line 83
		require {
#line 83
			
#line 83
		attribute mountpoint;
#line 83
	
#line 83
		} # end require
#line 83
	
#line 83

#line 83

#line 83
	 	 	
#line 83
##### begin files_type(xend_var_lib_t) depth: 2
#line 83
 	
#line 83
	
#line 83
	
#line 83
		require {
#line 83
			
#line 83
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 83
	
#line 83
		} # end require
#line 83
	
#line 83

#line 83

#line 83
	typeattribute xend_var_lib_t file_type, non_security_file_type, non_auth_file_type;
#line 83

#line 83
	 	
#line 83
##### end files_type(xend_var_lib_t) depth: 1
#line 83
 	
#line 83
	typeattribute xend_var_lib_t mountpoint;
#line 83

#line 83
	 	
#line 83
##### end files_mountpoint(xend_var_lib_t) depth: 0
#line 83
 	

type xend_var_log_t;
 	 	
#line 86
##### begin logging_log_file(xend_var_log_t) depth: 1
#line 86
 	
#line 86
	
#line 86
	
#line 86
		require {
#line 86
			
#line 86
		attribute logfile;
#line 86
	
#line 86
		} # end require
#line 86
	
#line 86

#line 86

#line 86
	 	 	
#line 86
##### begin files_type(xend_var_log_t) depth: 2
#line 86
 	
#line 86
	
#line 86
	
#line 86
		require {
#line 86
			
#line 86
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 86
	
#line 86
		} # end require
#line 86
	
#line 86

#line 86

#line 86
	typeattribute xend_var_log_t file_type, non_security_file_type, non_auth_file_type;
#line 86

#line 86
	 	
#line 86
##### end files_type(xend_var_log_t) depth: 1
#line 86
 	
#line 86
	 	 	
#line 86
##### begin files_associate_tmp(xend_var_log_t) depth: 2
#line 86
 	
#line 86
	
#line 86
	
#line 86
		require {
#line 86
			
#line 86
		type tmp_t;
#line 86
	
#line 86
		} # end require
#line 86
	
#line 86

#line 86

#line 86
	allow xend_var_log_t tmp_t:filesystem associate;
#line 86

#line 86
	 	
#line 86
##### end files_associate_tmp(xend_var_log_t) depth: 1
#line 86
 	
#line 86
	 	 	
#line 86
##### begin fs_associate_tmpfs(xend_var_log_t) depth: 2
#line 86
 	
#line 86
	
#line 86
	
#line 86
		require {
#line 86
			
#line 86
		type tmpfs_t;
#line 86
	
#line 86
		} # end require
#line 86
	
#line 86

#line 86

#line 86
	allow xend_var_log_t tmpfs_t:filesystem associate;
#line 86

#line 86
	 	
#line 86
##### end fs_associate_tmpfs(xend_var_log_t) depth: 1
#line 86
 	
#line 86
	typeattribute xend_var_log_t logfile;
#line 86

#line 86
	 	
#line 86
##### end logging_log_file(xend_var_log_t) depth: 0
#line 86
 	

type xen_lock_t;
 	 	
#line 89
##### begin files_lock_file(xen_lock_t) depth: 1
#line 89
 	
#line 89
	
#line 89
	
#line 89
		require {
#line 89
			
#line 89
		attribute lockfile;
#line 89
	
#line 89
		} # end require
#line 89
	
#line 89

#line 89

#line 89
	 	 	
#line 89
##### begin files_type(xen_lock_t) depth: 2
#line 89
 	
#line 89
	
#line 89
	
#line 89
		require {
#line 89
			
#line 89
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 89
	
#line 89
		} # end require
#line 89
	
#line 89

#line 89

#line 89
	typeattribute xen_lock_t file_type, non_security_file_type, non_auth_file_type;
#line 89

#line 89
	 	
#line 89
##### end files_type(xen_lock_t) depth: 1
#line 89
 	
#line 89
	typeattribute xen_lock_t lockfile;
#line 89

#line 89
	 	
#line 89
##### end files_lock_file(xen_lock_t) depth: 0
#line 89
 	

type xend_var_run_t;
 	 	
#line 92
##### begin files_pid_file(xend_var_run_t) depth: 1
#line 92
 	
#line 92
	
#line 92
	
#line 92
		require {
#line 92
			
#line 92
		attribute pidfile;
#line 92
	
#line 92
		} # end require
#line 92
	
#line 92

#line 92

#line 92
	 	 	
#line 92
##### begin files_type(xend_var_run_t) depth: 2
#line 92
 	
#line 92
	
#line 92
	
#line 92
		require {
#line 92
			
#line 92
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 92
	
#line 92
		} # end require
#line 92
	
#line 92

#line 92

#line 92
	typeattribute xend_var_run_t file_type, non_security_file_type, non_auth_file_type;
#line 92

#line 92
	 	
#line 92
##### end files_type(xend_var_run_t) depth: 1
#line 92
 	
#line 92
	typeattribute xend_var_run_t pidfile;
#line 92

#line 92
	 	
#line 92
##### end files_pid_file(xend_var_run_t) depth: 0
#line 92
 	
 	 	
#line 93
##### begin files_mountpoint(xend_var_run_t) depth: 1
#line 93
 	
#line 93
	
#line 93
	
#line 93
		require {
#line 93
			
#line 93
		attribute mountpoint;
#line 93
	
#line 93
		} # end require
#line 93
	
#line 93

#line 93

#line 93
	 	 	
#line 93
##### begin files_type(xend_var_run_t) depth: 2
#line 93
 	
#line 93
	
#line 93
	
#line 93
		require {
#line 93
			
#line 93
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 93
	
#line 93
		} # end require
#line 93
	
#line 93

#line 93

#line 93
	typeattribute xend_var_run_t file_type, non_security_file_type, non_auth_file_type;
#line 93

#line 93
	 	
#line 93
##### end files_type(xend_var_run_t) depth: 1
#line 93
 	
#line 93
	typeattribute xend_var_run_t mountpoint;
#line 93

#line 93
	 	
#line 93
##### end files_mountpoint(xend_var_run_t) depth: 0
#line 93
 	

type xenstored_t;
type xenstored_exec_t;
 	 	
#line 97
##### begin init_daemon_domain(xenstored_t,xenstored_exec_t) depth: 1
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type initrc_t;
#line 97
		type init_t;
#line 97
		role system_r;
#line 97
		attribute daemon;
#line 97
		attribute initrc_transition_domain;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	typeattribute xenstored_t daemon;
#line 97

#line 97
	 	 	
#line 97
##### begin domain_type(xenstored_t) depth: 2
#line 97
 	
#line 97
	# start with basic domain
#line 97
	 	 	
#line 97
##### begin domain_base_type(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		attribute domain;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	typeattribute xenstored_t domain;
#line 97

#line 97
	 	
#line 97
##### end domain_base_type(xenstored_t) depth: 2
#line 97
 	
#line 97

#line 97
	
#line 97

#line 97
	# send init a sigchld and signull
#line 97
	
#line 97
	optional {
#line 97
		
#line 97
		 	 	
#line 97
##### begin init_sigchld(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type init_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t init_t:process sigchld;
#line 97

#line 97
	 	
#line 97
##### end init_sigchld(xenstored_t) depth: 2
#line 97
 	
#line 97
		 	 	
#line 97
##### begin init_signull(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type init_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t init_t:process signull;
#line 97

#line 97
	 	
#line 97
##### end init_signull(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	} # end optional
#line 97

#line 97

#line 97
	# these seem questionable:
#line 97

#line 97
	
#line 97
	optional {
#line 97
		
#line 97
		 	 	
#line 97
##### begin rpm_use_fds(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type rpm_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t rpm_t:fd use;
#line 97

#line 97
	 	
#line 97
##### end rpm_use_fds(xenstored_t) depth: 2
#line 97
 	
#line 97
		 	 	
#line 97
##### begin rpm_read_pipes(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type rpm_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 97

#line 97
	 	
#line 97
##### end rpm_read_pipes(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	} # end optional
#line 97

#line 97

#line 97
	
#line 97
	optional {
#line 97
		
#line 97
		 	 	
#line 97
##### begin selinux_dontaudit_getattr_fs(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type security_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	dontaudit xenstored_t security_t:filesystem getattr;
#line 97

#line 97
	 	 	
#line 97
##### begin dev_dontaudit_getattr_sysfs(xenstored_t) depth: 4
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type sysfs_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	dontaudit xenstored_t sysfs_t:filesystem getattr;
#line 97

#line 97
	 	
#line 97
##### end dev_dontaudit_getattr_sysfs(xenstored_t) depth: 3
#line 97
 	
#line 97
	 	 	
#line 97
##### begin dev_dontaudit_search_sysfs(xenstored_t) depth: 4
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type sysfs_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	dontaudit xenstored_t sysfs_t:dir { getattr search open };
#line 97

#line 97
	 	
#line 97
##### end dev_dontaudit_search_sysfs(xenstored_t) depth: 3
#line 97
 	
#line 97

#line 97
	 	
#line 97
##### end selinux_dontaudit_getattr_fs(xenstored_t) depth: 2
#line 97
 	
#line 97
		 	 	
#line 97
##### begin selinux_dontaudit_read_fs(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type security_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	dontaudit xenstored_t security_t:dir { getattr search open };
#line 97
	dontaudit xenstored_t security_t:file { getattr open read lock ioctl };
#line 97

#line 97
	 	
#line 97
##### end selinux_dontaudit_read_fs(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	} # end optional
#line 97

#line 97

#line 97
	
#line 97
	optional {
#line 97
		
#line 97
		 	 	
#line 97
##### begin seutil_dontaudit_read_config(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type selinux_config_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	dontaudit xenstored_t selinux_config_t:dir { getattr search open };
#line 97
	dontaudit xenstored_t selinux_config_t:file { getattr open read lock ioctl };
#line 97

#line 97
	 	
#line 97
##### end seutil_dontaudit_read_config(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	} # end optional
#line 97

#line 97

#line 97
	 	
#line 97
##### end domain_type(xenstored_t) depth: 1
#line 97
 	
#line 97
	 	 	
#line 97
##### begin domain_entry_file(xenstored_t,xenstored_exec_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		attribute entry_type;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t xenstored_exec_t:file entrypoint;
#line 97
	allow xenstored_t xenstored_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 97

#line 97
	typeattribute xenstored_exec_t entry_type;
#line 97

#line 97
	 	 	
#line 97
##### begin corecmd_executable_file(xenstored_exec_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		attribute exec_type;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	typeattribute xenstored_exec_t exec_type;
#line 97

#line 97
	 	 	
#line 97
##### begin files_type(xenstored_exec_t) depth: 4
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	typeattribute xenstored_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 97

#line 97
	 	
#line 97
##### end files_type(xenstored_exec_t) depth: 3
#line 97
 	
#line 97

#line 97
	 	
#line 97
##### end corecmd_executable_file(xenstored_exec_t) depth: 2
#line 97
 	
#line 97

#line 97
	 	
#line 97
##### end domain_entry_file(xenstored_t,xenstored_exec_t) depth: 1
#line 97
 	
#line 97

#line 97
	role system_r types xenstored_t;
#line 97

#line 97
	
#line 97
	
#line 97
	
#line 97
	allow initrc_t xenstored_exec_t:file { getattr open read execute };
#line 97
	allow initrc_t xenstored_t:process transition;
#line 97
	dontaudit initrc_t xenstored_t:process { noatsecure siginh rlimitinh };
#line 97

#line 97
	type_transition initrc_t xenstored_exec_t:process xenstored_t;
#line 97

#line 97

#line 97
	allow xenstored_t initrc_t:fd use;
#line 97
	allow xenstored_t initrc_t:fifo_file { open { getattr read write append ioctl lock } };
#line 97
	allow xenstored_t initrc_t:process sigchld;
#line 97

#line 97

#line 97
	
#line 97

#line 97
	# daemons started from init will
#line 97
	# inherit fds from init for the console
#line 97
	 	 	
#line 97
##### begin init_dontaudit_use_fds(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type init_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	dontaudit xenstored_t init_t:fd use;
#line 97

#line 97
	 	
#line 97
##### end init_dontaudit_use_fds(xenstored_t) depth: 1
#line 97
 	
#line 97
	 	 	
#line 97
##### begin term_dontaudit_use_console(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type console_device_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	dontaudit xenstored_t console_device_t:chr_file { getattr open read write append ioctl lock };
#line 97

#line 97
	 	
#line 97
##### end term_dontaudit_use_console(xenstored_t) depth: 1
#line 97
 	
#line 97

#line 97
	# init script ptys are the stdin/out/err
#line 97
	# when using run_init
#line 97
	 	 	
#line 97
##### begin init_use_script_ptys(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type initrc_devpts_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	 	 	
#line 97
##### begin term_list_ptys(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type devpts_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	 	 	
#line 97
##### begin dev_list_all_dev_nodes(xenstored_t) depth: 4
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type device_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	
#line 97
	allow xenstored_t device_t:dir { getattr search open };
#line 97
	allow xenstored_t device_t:dir { getattr search open read lock ioctl };
#line 97

#line 97
	
#line 97
	allow xenstored_t device_t:dir { getattr search open };
#line 97
	allow xenstored_t device_t:lnk_file { getattr read };
#line 97

#line 97

#line 97
	 	
#line 97
##### end dev_list_all_dev_nodes(xenstored_t) depth: 3
#line 97
 	
#line 97
	allow xenstored_t devpts_t:dir { getattr search open read lock ioctl };
#line 97

#line 97
	 	
#line 97
##### end term_list_ptys(xenstored_t) depth: 2
#line 97
 	
#line 97
	allow xenstored_t initrc_devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 97

#line 97
	 	
#line 97
##### end init_use_script_ptys(xenstored_t) depth: 1
#line 97
 	
#line 97

#line 97
	
#line 97
		 	 	
#line 97
##### begin userdom_dontaudit_use_user_terminals(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type user_tty_device_t, user_devpts_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	dontaudit xenstored_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 97
	dontaudit xenstored_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 97

#line 97
	 	
#line 97
##### end userdom_dontaudit_use_user_terminals(xenstored_t) depth: 1
#line 97
 	
#line 97
	
#line 97

#line 97
	
#line 97

#line 97
	
#line 97
	optional {
#line 97
		
#line 97
		 	 	
#line 97
##### begin nscd_use(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		
#line 97
bool nscd_use_shm;
#line 97

#line 97
  
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97
	if (nscd_use_shm) {
#line 97
		
#line 97
		 	 	
#line 97
##### begin nscd_shm_use(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type nscd_t, nscd_var_run_t;
#line 97
		class nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 97

#line 97
	allow xenstored_t nscd_t:nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 97
	allow xenstored_t nscd_t:fd use;
#line 97

#line 97
	 	 	
#line 97
##### begin files_search_pids(xenstored_t) depth: 4
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type var_t, var_run_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t var_run_t:lnk_file { getattr read };
#line 97
	
#line 97
	allow xenstored_t var_t:dir { getattr search open };
#line 97
	allow xenstored_t var_run_t:dir { getattr search open };
#line 97

#line 97

#line 97
	 	
#line 97
##### end files_search_pids(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	allow xenstored_t nscd_var_run_t:dir { getattr search open };
#line 97
	allow xenstored_t nscd_var_run_t:sock_file { getattr write open append };
#line 97
	allow xenstored_t nscd_t:unix_stream_socket connectto;
#line 97

#line 97
	dontaudit xenstored_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 97

#line 97
	allow xenstored_t nscd_var_run_t:dir { getattr search open read lock ioctl };
#line 97
	allow xenstored_t nscd_var_run_t:sock_file { getattr open read };
#line 97

#line 97
	 	
#line 97
##### end nscd_shm_use(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	} else {
#line 97
		
#line 97
		 	 	
#line 97
##### begin nscd_socket_use(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type nscd_t, nscd_var_run_t;
#line 97
		class nscd { getserv getpwd getgrp gethost shmempwd shmemgrp shmemhost shmemserv };
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 97

#line 97
	allow xenstored_t nscd_t:nscd { getpwd getgrp gethost };
#line 97

#line 97
	dontaudit xenstored_t nscd_t:fd use;
#line 97
	dontaudit xenstored_t nscd_t:nscd { getserv shmempwd shmemgrp shmemhost shmemserv };
#line 97

#line 97
	 	 	
#line 97
##### begin files_search_pids(xenstored_t) depth: 4
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		type var_t, var_run_t;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	allow xenstored_t var_run_t:lnk_file { getattr read };
#line 97
	
#line 97
	allow xenstored_t var_t:dir { getattr search open };
#line 97
	allow xenstored_t var_run_t:dir { getattr search open };
#line 97

#line 97

#line 97
	 	
#line 97
##### end files_search_pids(xenstored_t) depth: 3
#line 97
 	
#line 97
	
#line 97
	allow xenstored_t nscd_var_run_t:dir { getattr search open };
#line 97
	allow xenstored_t nscd_var_run_t:sock_file { getattr write open append };
#line 97
	allow xenstored_t nscd_t:unix_stream_socket connectto;
#line 97

#line 97
	dontaudit xenstored_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 97

#line 97
	
#line 97
	allow nscd_t xenstored_t:dir { getattr search open read lock ioctl };
#line 97
	allow nscd_t xenstored_t:file { getattr open read lock ioctl };
#line 97
	allow nscd_t xenstored_t:lnk_file { getattr read };
#line 97
	allow nscd_t xenstored_t:process getattr;
#line 97

#line 97

#line 97
	 	
#line 97
##### end nscd_socket_use(xenstored_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	}
#line 97

#line 97

#line 97
	 	
#line 97
##### end nscd_use(xenstored_t) depth: 1
#line 97
 	
#line 97
	
#line 97
	} # end optional
#line 97

#line 97

#line 97
	 	
#line 97
##### end init_daemon_domain(xenstored_t,xenstored_exec_t) depth: 0
#line 97
 	

type xenstored_tmp_t;
 	 	
#line 100
##### begin files_tmp_file(xenstored_tmp_t) depth: 1
#line 100
 	
#line 100
	
#line 100
	
#line 100
		require {
#line 100
			
#line 100
		attribute tmpfile;
#line 100
		type tmp_t;
#line 100
	
#line 100
		} # end require
#line 100
	
#line 100

#line 100

#line 100
	 	 	
#line 100
##### begin files_type(xenstored_tmp_t) depth: 2
#line 100
 	
#line 100
	
#line 100
	
#line 100
		require {
#line 100
			
#line 100
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 100
	
#line 100
		} # end require
#line 100
	
#line 100

#line 100

#line 100
	typeattribute xenstored_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 100

#line 100
	 	
#line 100
##### end files_type(xenstored_tmp_t) depth: 1
#line 100
 	
#line 100
	 	 	
#line 100
##### begin files_poly_member(xenstored_tmp_t) depth: 2
#line 100
 	
#line 100
	
#line 100
	
#line 100
		require {
#line 100
			
#line 100
		attribute polymember;
#line 100
	
#line 100
		} # end require
#line 100
	
#line 100

#line 100

#line 100
	 	 	
#line 100
##### begin files_type(xenstored_tmp_t) depth: 3
#line 100
 	
#line 100
	
#line 100
	
#line 100
		require {
#line 100
			
#line 100
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 100
	
#line 100
		} # end require
#line 100
	
#line 100

#line 100

#line 100
	typeattribute xenstored_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 100

#line 100
	 	
#line 100
##### end files_type(xenstored_tmp_t) depth: 2
#line 100
 	
#line 100
	typeattribute xenstored_tmp_t polymember;
#line 100

#line 100
	 	
#line 100
##### end files_poly_member(xenstored_tmp_t) depth: 1
#line 100
 	
#line 100
	typeattribute xenstored_tmp_t tmpfile;
#line 100

#line 100
	 	
#line 100
##### end files_tmp_file(xenstored_tmp_t) depth: 0
#line 100
 	

type xenstored_var_lib_t;
 	 	
#line 103
##### begin files_type(xenstored_var_lib_t) depth: 1
#line 103
 	
#line 103
	
#line 103
	
#line 103
		require {
#line 103
			
#line 103
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 103
	
#line 103
		} # end require
#line 103
	
#line 103

#line 103

#line 103
	typeattribute xenstored_var_lib_t file_type, non_security_file_type, non_auth_file_type;
#line 103

#line 103
	 	
#line 103
##### end files_type(xenstored_var_lib_t) depth: 0
#line 103
 	
 	 	
#line 104
##### begin files_mountpoint(xenstored_var_lib_t) depth: 1
#line 104
 	
#line 104
	
#line 104
	
#line 104
		require {
#line 104
			
#line 104
		attribute mountpoint;
#line 104
	
#line 104
		} # end require
#line 104
	
#line 104

#line 104

#line 104
	 	 	
#line 104
##### begin files_type(xenstored_var_lib_t) depth: 2
#line 104
 	
#line 104
	
#line 104
	
#line 104
		require {
#line 104
			
#line 104
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 104
	
#line 104
		} # end require
#line 104
	
#line 104

#line 104

#line 104
	typeattribute xenstored_var_lib_t file_type, non_security_file_type, non_auth_file_type;
#line 104

#line 104
	 	
#line 104
##### end files_type(xenstored_var_lib_t) depth: 1
#line 104
 	
#line 104
	typeattribute xenstored_var_lib_t mountpoint;
#line 104

#line 104
	 	
#line 104
##### end files_mountpoint(xenstored_var_lib_t) depth: 0
#line 104
 	

type xenstored_var_log_t;
 	 	
#line 107
##### begin logging_log_file(xenstored_var_log_t) depth: 1
#line 107
 	
#line 107
	
#line 107
	
#line 107
		require {
#line 107
			
#line 107
		attribute logfile;
#line 107
	
#line 107
		} # end require
#line 107
	
#line 107

#line 107

#line 107
	 	 	
#line 107
##### begin files_type(xenstored_var_log_t) depth: 2
#line 107
 	
#line 107
	
#line 107
	
#line 107
		require {
#line 107
			
#line 107
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 107
	
#line 107
		} # end require
#line 107
	
#line 107

#line 107

#line 107
	typeattribute xenstored_var_log_t file_type, non_security_file_type, non_auth_file_type;
#line 107

#line 107
	 	
#line 107
##### end files_type(xenstored_var_log_t) depth: 1
#line 107
 	
#line 107
	 	 	
#line 107
##### begin files_associate_tmp(xenstored_var_log_t) depth: 2
#line 107
 	
#line 107
	
#line 107
	
#line 107
		require {
#line 107
			
#line 107
		type tmp_t;
#line 107
	
#line 107
		} # end require
#line 107
	
#line 107

#line 107

#line 107
	allow xenstored_var_log_t tmp_t:filesystem associate;
#line 107

#line 107
	 	
#line 107
##### end files_associate_tmp(xenstored_var_log_t) depth: 1
#line 107
 	
#line 107
	 	 	
#line 107
##### begin fs_associate_tmpfs(xenstored_var_log_t) depth: 2
#line 107
 	
#line 107
	
#line 107
	
#line 107
		require {
#line 107
			
#line 107
		type tmpfs_t;
#line 107
	
#line 107
		} # end require
#line 107
	
#line 107

#line 107

#line 107
	allow xenstored_var_log_t tmpfs_t:filesystem associate;
#line 107

#line 107
	 	
#line 107
##### end fs_associate_tmpfs(xenstored_var_log_t) depth: 1
#line 107
 	
#line 107
	typeattribute xenstored_var_log_t logfile;
#line 107

#line 107
	 	
#line 107
##### end logging_log_file(xenstored_var_log_t) depth: 0
#line 107
 	

type xenstored_var_run_t;
 	 	
#line 110
##### begin files_pid_file(xenstored_var_run_t) depth: 1
#line 110
 	
#line 110
	
#line 110
	
#line 110
		require {
#line 110
			
#line 110
		attribute pidfile;
#line 110
	
#line 110
		} # end require
#line 110
	
#line 110

#line 110

#line 110
	 	 	
#line 110
##### begin files_type(xenstored_var_run_t) depth: 2
#line 110
 	
#line 110
	
#line 110
	
#line 110
		require {
#line 110
			
#line 110
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 110
	
#line 110
		} # end require
#line 110
	
#line 110

#line 110

#line 110
	typeattribute xenstored_var_run_t file_type, non_security_file_type, non_auth_file_type;
#line 110

#line 110
	 	
#line 110
##### end files_type(xenstored_var_run_t) depth: 1
#line 110
 	
#line 110
	typeattribute xenstored_var_run_t pidfile;
#line 110

#line 110
	 	
#line 110
##### end files_pid_file(xenstored_var_run_t) depth: 0
#line 110
 	
 	 	
#line 111
##### begin init_daemon_pid_file(xenstored_var_run_t,dir,"xenstored") depth: 1
#line 111
 	
#line 111
	
#line 111
	
#line 111
		require {
#line 111
			
#line 111
		attribute daemonpidfile;
#line 111
		type initrc_t;
#line 111
	
#line 111
		} # end require
#line 111
	
#line 111

#line 111

#line 111
	typeattribute xenstored_var_run_t daemonpidfile;
#line 111

#line 111
	 	 	
#line 111
##### begin files_pid_file(xenstored_var_run_t) depth: 2
#line 111
 	
#line 111
	
#line 111
	
#line 111
		require {
#line 111
			
#line 111
		attribute pidfile;
#line 111
	
#line 111
		} # end require
#line 111
	
#line 111

#line 111

#line 111
	 	 	
#line 111
##### begin files_type(xenstored_var_run_t) depth: 3
#line 111
 	
#line 111
	
#line 111
	
#line 111
		require {
#line 111
			
#line 111
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 111
	
#line 111
		} # end require
#line 111
	
#line 111

#line 111

#line 111
	typeattribute xenstored_var_run_t file_type, non_security_file_type, non_auth_file_type;
#line 111

#line 111
	 	
#line 111
##### end files_type(xenstored_var_run_t) depth: 2
#line 111
 	
#line 111
	typeattribute xenstored_var_run_t pidfile;
#line 111

#line 111
	 	
#line 111
##### end files_pid_file(xenstored_var_run_t) depth: 1
#line 111
 	
#line 111
	 	 	
#line 111
##### begin files_pid_filetrans(initrc_t,xenstored_var_run_t,dir,"xenstored") depth: 2
#line 111
 	
#line 111
	
#line 111
	
#line 111
		require {
#line 111
			
#line 111
		type var_t, var_run_t;
#line 111
	
#line 111
		} # end require
#line 111
	
#line 111

#line 111

#line 111
	allow initrc_t var_t:dir { getattr search open };
#line 111
	allow initrc_t var_run_t:lnk_file { getattr read };
#line 111
	
#line 111
	allow initrc_t var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 111
	type_transition initrc_t var_run_t:dir xenstored_var_run_t "xenstored";
#line 111

#line 111

#line 111
	 	
#line 111
##### end files_pid_filetrans(initrc_t,xenstored_var_run_t,dir,"xenstored") depth: 1
#line 111
 	
#line 111

#line 111
	 	
#line 111
##### end init_daemon_pid_file(xenstored_var_run_t,dir,"xenstored") depth: 0
#line 111
 	

type xenconsoled_t;
type xenconsoled_exec_t;
 	 	
#line 115
##### begin init_daemon_domain(xenconsoled_t,xenconsoled_exec_t) depth: 1
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type initrc_t;
#line 115
		type init_t;
#line 115
		role system_r;
#line 115
		attribute daemon;
#line 115
		attribute initrc_transition_domain;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	typeattribute xenconsoled_t daemon;
#line 115

#line 115
	 	 	
#line 115
##### begin domain_type(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	# start with basic domain
#line 115
	 	 	
#line 115
##### begin domain_base_type(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		attribute domain;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	typeattribute xenconsoled_t domain;
#line 115

#line 115
	 	
#line 115
##### end domain_base_type(xenconsoled_t) depth: 2
#line 115
 	
#line 115

#line 115
	
#line 115

#line 115
	# send init a sigchld and signull
#line 115
	
#line 115
	optional {
#line 115
		
#line 115
		 	 	
#line 115
##### begin init_sigchld(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type init_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t init_t:process sigchld;
#line 115

#line 115
	 	
#line 115
##### end init_sigchld(xenconsoled_t) depth: 2
#line 115
 	
#line 115
		 	 	
#line 115
##### begin init_signull(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type init_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t init_t:process signull;
#line 115

#line 115
	 	
#line 115
##### end init_signull(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	} # end optional
#line 115

#line 115

#line 115
	# these seem questionable:
#line 115

#line 115
	
#line 115
	optional {
#line 115
		
#line 115
		 	 	
#line 115
##### begin rpm_use_fds(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type rpm_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t rpm_t:fd use;
#line 115

#line 115
	 	
#line 115
##### end rpm_use_fds(xenconsoled_t) depth: 2
#line 115
 	
#line 115
		 	 	
#line 115
##### begin rpm_read_pipes(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type rpm_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 115

#line 115
	 	
#line 115
##### end rpm_read_pipes(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	} # end optional
#line 115

#line 115

#line 115
	
#line 115
	optional {
#line 115
		
#line 115
		 	 	
#line 115
##### begin selinux_dontaudit_getattr_fs(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type security_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	dontaudit xenconsoled_t security_t:filesystem getattr;
#line 115

#line 115
	 	 	
#line 115
##### begin dev_dontaudit_getattr_sysfs(xenconsoled_t) depth: 4
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type sysfs_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	dontaudit xenconsoled_t sysfs_t:filesystem getattr;
#line 115

#line 115
	 	
#line 115
##### end dev_dontaudit_getattr_sysfs(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	 	 	
#line 115
##### begin dev_dontaudit_search_sysfs(xenconsoled_t) depth: 4
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type sysfs_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	dontaudit xenconsoled_t sysfs_t:dir { getattr search open };
#line 115

#line 115
	 	
#line 115
##### end dev_dontaudit_search_sysfs(xenconsoled_t) depth: 3
#line 115
 	
#line 115

#line 115
	 	
#line 115
##### end selinux_dontaudit_getattr_fs(xenconsoled_t) depth: 2
#line 115
 	
#line 115
		 	 	
#line 115
##### begin selinux_dontaudit_read_fs(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type security_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	dontaudit xenconsoled_t security_t:dir { getattr search open };
#line 115
	dontaudit xenconsoled_t security_t:file { getattr open read lock ioctl };
#line 115

#line 115
	 	
#line 115
##### end selinux_dontaudit_read_fs(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	} # end optional
#line 115

#line 115

#line 115
	
#line 115
	optional {
#line 115
		
#line 115
		 	 	
#line 115
##### begin seutil_dontaudit_read_config(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type selinux_config_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	dontaudit xenconsoled_t selinux_config_t:dir { getattr search open };
#line 115
	dontaudit xenconsoled_t selinux_config_t:file { getattr open read lock ioctl };
#line 115

#line 115
	 	
#line 115
##### end seutil_dontaudit_read_config(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	} # end optional
#line 115

#line 115

#line 115
	 	
#line 115
##### end domain_type(xenconsoled_t) depth: 1
#line 115
 	
#line 115
	 	 	
#line 115
##### begin domain_entry_file(xenconsoled_t,xenconsoled_exec_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		attribute entry_type;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t xenconsoled_exec_t:file entrypoint;
#line 115
	allow xenconsoled_t xenconsoled_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 115

#line 115
	typeattribute xenconsoled_exec_t entry_type;
#line 115

#line 115
	 	 	
#line 115
##### begin corecmd_executable_file(xenconsoled_exec_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		attribute exec_type;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	typeattribute xenconsoled_exec_t exec_type;
#line 115

#line 115
	 	 	
#line 115
##### begin files_type(xenconsoled_exec_t) depth: 4
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	typeattribute xenconsoled_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 115

#line 115
	 	
#line 115
##### end files_type(xenconsoled_exec_t) depth: 3
#line 115
 	
#line 115

#line 115
	 	
#line 115
##### end corecmd_executable_file(xenconsoled_exec_t) depth: 2
#line 115
 	
#line 115

#line 115
	 	
#line 115
##### end domain_entry_file(xenconsoled_t,xenconsoled_exec_t) depth: 1
#line 115
 	
#line 115

#line 115
	role system_r types xenconsoled_t;
#line 115

#line 115
	
#line 115
	
#line 115
	
#line 115
	allow initrc_t xenconsoled_exec_t:file { getattr open read execute };
#line 115
	allow initrc_t xenconsoled_t:process transition;
#line 115
	dontaudit initrc_t xenconsoled_t:process { noatsecure siginh rlimitinh };
#line 115

#line 115
	type_transition initrc_t xenconsoled_exec_t:process xenconsoled_t;
#line 115

#line 115

#line 115
	allow xenconsoled_t initrc_t:fd use;
#line 115
	allow xenconsoled_t initrc_t:fifo_file { open { getattr read write append ioctl lock } };
#line 115
	allow xenconsoled_t initrc_t:process sigchld;
#line 115

#line 115

#line 115
	
#line 115

#line 115
	# daemons started from init will
#line 115
	# inherit fds from init for the console
#line 115
	 	 	
#line 115
##### begin init_dontaudit_use_fds(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type init_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	dontaudit xenconsoled_t init_t:fd use;
#line 115

#line 115
	 	
#line 115
##### end init_dontaudit_use_fds(xenconsoled_t) depth: 1
#line 115
 	
#line 115
	 	 	
#line 115
##### begin term_dontaudit_use_console(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type console_device_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	dontaudit xenconsoled_t console_device_t:chr_file { getattr open read write append ioctl lock };
#line 115

#line 115
	 	
#line 115
##### end term_dontaudit_use_console(xenconsoled_t) depth: 1
#line 115
 	
#line 115

#line 115
	# init script ptys are the stdin/out/err
#line 115
	# when using run_init
#line 115
	 	 	
#line 115
##### begin init_use_script_ptys(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type initrc_devpts_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	 	 	
#line 115
##### begin term_list_ptys(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type devpts_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	 	 	
#line 115
##### begin dev_list_all_dev_nodes(xenconsoled_t) depth: 4
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type device_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	
#line 115
	allow xenconsoled_t device_t:dir { getattr search open };
#line 115
	allow xenconsoled_t device_t:dir { getattr search open read lock ioctl };
#line 115

#line 115
	
#line 115
	allow xenconsoled_t device_t:dir { getattr search open };
#line 115
	allow xenconsoled_t device_t:lnk_file { getattr read };
#line 115

#line 115

#line 115
	 	
#line 115
##### end dev_list_all_dev_nodes(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	allow xenconsoled_t devpts_t:dir { getattr search open read lock ioctl };
#line 115

#line 115
	 	
#line 115
##### end term_list_ptys(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	allow xenconsoled_t initrc_devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 115

#line 115
	 	
#line 115
##### end init_use_script_ptys(xenconsoled_t) depth: 1
#line 115
 	
#line 115

#line 115
	
#line 115
		 	 	
#line 115
##### begin userdom_dontaudit_use_user_terminals(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type user_tty_device_t, user_devpts_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	dontaudit xenconsoled_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 115
	dontaudit xenconsoled_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 115

#line 115
	 	
#line 115
##### end userdom_dontaudit_use_user_terminals(xenconsoled_t) depth: 1
#line 115
 	
#line 115
	
#line 115

#line 115
	
#line 115

#line 115
	
#line 115
	optional {
#line 115
		
#line 115
		 	 	
#line 115
##### begin nscd_use(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		
#line 115
bool nscd_use_shm;
#line 115

#line 115
  
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115
	if (nscd_use_shm) {
#line 115
		
#line 115
		 	 	
#line 115
##### begin nscd_shm_use(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type nscd_t, nscd_var_run_t;
#line 115
		class nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 115

#line 115
	allow xenconsoled_t nscd_t:nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 115
	allow xenconsoled_t nscd_t:fd use;
#line 115

#line 115
	 	 	
#line 115
##### begin files_search_pids(xenconsoled_t) depth: 4
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type var_t, var_run_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t var_run_t:lnk_file { getattr read };
#line 115
	
#line 115
	allow xenconsoled_t var_t:dir { getattr search open };
#line 115
	allow xenconsoled_t var_run_t:dir { getattr search open };
#line 115

#line 115

#line 115
	 	
#line 115
##### end files_search_pids(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	allow xenconsoled_t nscd_var_run_t:dir { getattr search open };
#line 115
	allow xenconsoled_t nscd_var_run_t:sock_file { getattr write open append };
#line 115
	allow xenconsoled_t nscd_t:unix_stream_socket connectto;
#line 115

#line 115
	dontaudit xenconsoled_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 115

#line 115
	allow xenconsoled_t nscd_var_run_t:dir { getattr search open read lock ioctl };
#line 115
	allow xenconsoled_t nscd_var_run_t:sock_file { getattr open read };
#line 115

#line 115
	 	
#line 115
##### end nscd_shm_use(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	} else {
#line 115
		
#line 115
		 	 	
#line 115
##### begin nscd_socket_use(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type nscd_t, nscd_var_run_t;
#line 115
		class nscd { getserv getpwd getgrp gethost shmempwd shmemgrp shmemhost shmemserv };
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 115

#line 115
	allow xenconsoled_t nscd_t:nscd { getpwd getgrp gethost };
#line 115

#line 115
	dontaudit xenconsoled_t nscd_t:fd use;
#line 115
	dontaudit xenconsoled_t nscd_t:nscd { getserv shmempwd shmemgrp shmemhost shmemserv };
#line 115

#line 115
	 	 	
#line 115
##### begin files_search_pids(xenconsoled_t) depth: 4
#line 115
 	
#line 115
	
#line 115
	
#line 115
		require {
#line 115
			
#line 115
		type var_t, var_run_t;
#line 115
	
#line 115
		} # end require
#line 115
	
#line 115

#line 115

#line 115
	allow xenconsoled_t var_run_t:lnk_file { getattr read };
#line 115
	
#line 115
	allow xenconsoled_t var_t:dir { getattr search open };
#line 115
	allow xenconsoled_t var_run_t:dir { getattr search open };
#line 115

#line 115

#line 115
	 	
#line 115
##### end files_search_pids(xenconsoled_t) depth: 3
#line 115
 	
#line 115
	
#line 115
	allow xenconsoled_t nscd_var_run_t:dir { getattr search open };
#line 115
	allow xenconsoled_t nscd_var_run_t:sock_file { getattr write open append };
#line 115
	allow xenconsoled_t nscd_t:unix_stream_socket connectto;
#line 115

#line 115
	dontaudit xenconsoled_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 115

#line 115
	
#line 115
	allow nscd_t xenconsoled_t:dir { getattr search open read lock ioctl };
#line 115
	allow nscd_t xenconsoled_t:file { getattr open read lock ioctl };
#line 115
	allow nscd_t xenconsoled_t:lnk_file { getattr read };
#line 115
	allow nscd_t xenconsoled_t:process getattr;
#line 115

#line 115

#line 115
	 	
#line 115
##### end nscd_socket_use(xenconsoled_t) depth: 2
#line 115
 	
#line 115
	
#line 115
	}
#line 115

#line 115

#line 115
	 	
#line 115
##### end nscd_use(xenconsoled_t) depth: 1
#line 115
 	
#line 115
	
#line 115
	} # end optional
#line 115

#line 115

#line 115
	 	
#line 115
##### end init_daemon_domain(xenconsoled_t,xenconsoled_exec_t) depth: 0
#line 115
 	

type xenconsoled_var_run_t;
 	 	
#line 118
##### begin files_pid_file(xenconsoled_var_run_t) depth: 1
#line 118
 	
#line 118
	
#line 118
	
#line 118
		require {
#line 118
			
#line 118
		attribute pidfile;
#line 118
	
#line 118
		} # end require
#line 118
	
#line 118

#line 118

#line 118
	 	 	
#line 118
##### begin files_type(xenconsoled_var_run_t) depth: 2
#line 118
 	
#line 118
	
#line 118
	
#line 118
		require {
#line 118
			
#line 118
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 118
	
#line 118
		} # end require
#line 118
	
#line 118

#line 118

#line 118
	typeattribute xenconsoled_var_run_t file_type, non_security_file_type, non_auth_file_type;
#line 118

#line 118
	 	
#line 118
##### end files_type(xenconsoled_var_run_t) depth: 1
#line 118
 	
#line 118
	typeattribute xenconsoled_var_run_t pidfile;
#line 118

#line 118
	 	
#line 118
##### end files_pid_file(xenconsoled_var_run_t) depth: 0
#line 118
 	

type xm_t;
type xm_exec_t;
 	 	
#line 122
##### begin init_system_domain(xm_t,xm_exec_t) depth: 1
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type initrc_t;
#line 122
		role system_r;
#line 122
		attribute systemprocess;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute xm_t systemprocess;
#line 122
	 	 	
#line 122
##### begin application_domain(xm_t,xm_exec_t) depth: 2
#line 122
 	
#line 122
	 	 	
#line 122
##### begin application_type(xm_t) depth: 3
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute application_domain_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute xm_t application_domain_type;
#line 122

#line 122
	# start with basic domain
#line 122
	 	 	
#line 122
##### begin domain_type(xm_t) depth: 4
#line 122
 	
#line 122
	# start with basic domain
#line 122
	 	 	
#line 122
##### begin domain_base_type(xm_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute domain;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute xm_t domain;
#line 122

#line 122
	 	
#line 122
##### end domain_base_type(xm_t) depth: 4
#line 122
 	
#line 122

#line 122
	
#line 122

#line 122
	# send init a sigchld and signull
#line 122
	
#line 122
	optional {
#line 122
		
#line 122
		 	 	
#line 122
##### begin init_sigchld(xm_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type init_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	allow xm_t init_t:process sigchld;
#line 122

#line 122
	 	
#line 122
##### end init_sigchld(xm_t) depth: 4
#line 122
 	
#line 122
		 	 	
#line 122
##### begin init_signull(xm_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type init_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	allow xm_t init_t:process signull;
#line 122

#line 122
	 	
#line 122
##### end init_signull(xm_t) depth: 4
#line 122
 	
#line 122
	
#line 122
	} # end optional
#line 122

#line 122

#line 122
	# these seem questionable:
#line 122

#line 122
	
#line 122
	optional {
#line 122
		
#line 122
		 	 	
#line 122
##### begin rpm_use_fds(xm_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type rpm_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	allow xm_t rpm_t:fd use;
#line 122

#line 122
	 	
#line 122
##### end rpm_use_fds(xm_t) depth: 4
#line 122
 	
#line 122
		 	 	
#line 122
##### begin rpm_read_pipes(xm_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type rpm_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	allow xm_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 122

#line 122
	 	
#line 122
##### end rpm_read_pipes(xm_t) depth: 4
#line 122
 	
#line 122
	
#line 122
	} # end optional
#line 122

#line 122

#line 122
	
#line 122
	optional {
#line 122
		
#line 122
		 	 	
#line 122
##### begin selinux_dontaudit_getattr_fs(xm_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type security_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	dontaudit xm_t security_t:filesystem getattr;
#line 122

#line 122
	 	 	
#line 122
##### begin dev_dontaudit_getattr_sysfs(xm_t) depth: 6
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type sysfs_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	dontaudit xm_t sysfs_t:filesystem getattr;
#line 122

#line 122
	 	
#line 122
##### end dev_dontaudit_getattr_sysfs(xm_t) depth: 5
#line 122
 	
#line 122
	 	 	
#line 122
##### begin dev_dontaudit_search_sysfs(xm_t) depth: 6
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type sysfs_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	dontaudit xm_t sysfs_t:dir { getattr search open };
#line 122

#line 122
	 	
#line 122
##### end dev_dontaudit_search_sysfs(xm_t) depth: 5
#line 122
 	
#line 122

#line 122
	 	
#line 122
##### end selinux_dontaudit_getattr_fs(xm_t) depth: 4
#line 122
 	
#line 122
		 	 	
#line 122
##### begin selinux_dontaudit_read_fs(xm_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type security_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	dontaudit xm_t security_t:dir { getattr search open };
#line 122
	dontaudit xm_t security_t:file { getattr open read lock ioctl };
#line 122

#line 122
	 	
#line 122
##### end selinux_dontaudit_read_fs(xm_t) depth: 4
#line 122
 	
#line 122
	
#line 122
	} # end optional
#line 122

#line 122

#line 122
	
#line 122
	optional {
#line 122
		
#line 122
		 	 	
#line 122
##### begin seutil_dontaudit_read_config(xm_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		type selinux_config_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	dontaudit xm_t selinux_config_t:dir { getattr search open };
#line 122
	dontaudit xm_t selinux_config_t:file { getattr open read lock ioctl };
#line 122

#line 122
	 	
#line 122
##### end seutil_dontaudit_read_config(xm_t) depth: 4
#line 122
 	
#line 122
	
#line 122
	} # end optional
#line 122

#line 122

#line 122
	 	
#line 122
##### end domain_type(xm_t) depth: 3
#line 122
 	
#line 122

#line 122
	 	
#line 122
##### end application_type(xm_t) depth: 2
#line 122
 	
#line 122
	 	 	
#line 122
##### begin application_executable_file(xm_exec_t) depth: 3
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute application_exec_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute xm_exec_t application_exec_type;
#line 122

#line 122
	 	 	
#line 122
##### begin corecmd_executable_file(xm_exec_t) depth: 4
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute exec_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute xm_exec_t exec_type;
#line 122

#line 122
	 	 	
#line 122
##### begin files_type(xm_exec_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute xm_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 122

#line 122
	 	
#line 122
##### end files_type(xm_exec_t) depth: 4
#line 122
 	
#line 122

#line 122
	 	
#line 122
##### end corecmd_executable_file(xm_exec_t) depth: 3
#line 122
 	
#line 122

#line 122
	 	
#line 122
##### end application_executable_file(xm_exec_t) depth: 2
#line 122
 	
#line 122
	 	 	
#line 122
##### begin domain_entry_file(xm_t,xm_exec_t) depth: 3
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute entry_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	allow xm_t xm_exec_t:file entrypoint;
#line 122
	allow xm_t xm_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 122

#line 122
	typeattribute xm_exec_t entry_type;
#line 122

#line 122
	 	 	
#line 122
##### begin corecmd_executable_file(xm_exec_t) depth: 4
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute exec_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute xm_exec_t exec_type;
#line 122

#line 122
	 	 	
#line 122
##### begin files_type(xm_exec_t) depth: 5
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute xm_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 122

#line 122
	 	
#line 122
##### end files_type(xm_exec_t) depth: 4
#line 122
 	
#line 122

#line 122
	 	
#line 122
##### end corecmd_executable_file(xm_exec_t) depth: 3
#line 122
 	
#line 122

#line 122
	 	
#line 122
##### end domain_entry_file(xm_t,xm_exec_t) depth: 2
#line 122
 	
#line 122

#line 122
	 	
#line 122
##### end application_domain(xm_t,xm_exec_t) depth: 1
#line 122
 	
#line 122

#line 122
	role system_r types xm_t;
#line 122

#line 122
	
#line 122
	
#line 122
	
#line 122
	allow initrc_t xm_exec_t:file { getattr open read execute };
#line 122
	allow initrc_t xm_t:process transition;
#line 122
	dontaudit initrc_t xm_t:process { noatsecure siginh rlimitinh };
#line 122

#line 122
	type_transition initrc_t xm_exec_t:process xm_t;
#line 122

#line 122

#line 122
	allow xm_t initrc_t:fd use;
#line 122
	allow xm_t initrc_t:fifo_file { open { getattr read write append ioctl lock } };
#line 122
	allow xm_t initrc_t:process sigchld;
#line 122

#line 122

#line 122
	
#line 122

#line 122
	 	
#line 122
##### end init_system_domain(xm_t,xm_exec_t) depth: 0
#line 122
 	

########################################
#
# blktap local policy
#


#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		
#line 129
bool xend_run_blktap;
#line 129

#line 129
  
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129
	if (xend_run_blktap) {
#line 129
		
#line 129
	
#line 129
	
#line 129
	
#line 129
	allow xend_t blktap_exec_t:file { getattr open read execute };
#line 129
	allow xend_t blktap_t:process transition;
#line 129
	dontaudit xend_t blktap_t:process { noatsecure siginh rlimitinh };
#line 129

#line 129
	type_transition xend_t blktap_exec_t:process blktap_t;
#line 129

#line 129

#line 129
	allow blktap_t xend_t:fd use;
#line 129
	allow blktap_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 129
	allow blktap_t xend_t:process sigchld;
#line 129

#line 129

#line 129
	allow blktap_t self:fifo_file { read write };
#line 129

#line 129
	 	 	
#line 129
##### begin dev_read_sysfs(blktap_t) depth: 1
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type sysfs_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	
#line 129
	allow blktap_t sysfs_t:dir { getattr search open };
#line 129
	allow blktap_t sysfs_t:file { getattr open read lock ioctl };
#line 129

#line 129
	
#line 129
	allow blktap_t sysfs_t:dir { getattr search open };
#line 129
	allow blktap_t sysfs_t:lnk_file { getattr read };
#line 129

#line 129

#line 129
	
#line 129
	allow blktap_t sysfs_t:dir { getattr search open };
#line 129
	allow blktap_t sysfs_t:dir { getattr search open read lock ioctl };
#line 129

#line 129

#line 129
	 	
#line 129
##### end dev_read_sysfs(blktap_t) depth: 0
#line 129
 	
#line 129
	 	 	
#line 129
##### begin dev_rw_xen(blktap_t) depth: 1
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type device_t, xen_device_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	
#line 129
	allow blktap_t device_t:dir { getattr search open };
#line 129
	allow blktap_t xen_device_t:chr_file { getattr open read write append ioctl lock };
#line 129

#line 129

#line 129
	 	
#line 129
##### end dev_rw_xen(blktap_t) depth: 0
#line 129
 	
#line 129

#line 129
	 	 	
#line 129
##### begin files_read_etc_files(blktap_t) depth: 1
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type etc_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	allow blktap_t etc_t:dir { getattr search open read lock ioctl };
#line 129
	
#line 129
	allow blktap_t etc_t:dir { getattr search open };
#line 129
	allow blktap_t etc_t:file { getattr open read lock ioctl };
#line 129

#line 129
	
#line 129
	allow blktap_t etc_t:dir { getattr search open };
#line 129
	allow blktap_t etc_t:lnk_file { getattr read };
#line 129

#line 129

#line 129
	 	
#line 129
##### end files_read_etc_files(blktap_t) depth: 0
#line 129
 	
#line 129

#line 129
	 	 	
#line 129
##### begin logging_send_syslog_msg(blktap_t) depth: 1
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type syslogd_t, syslogd_var_run_t, devlog_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	allow blktap_t devlog_t:sock_file { getattr write open append };
#line 129

#line 129
	# systemd journal socket is in /run/systemd/journal/dev-log
#line 129
	 	 	
#line 129
##### begin init_search_run(blktap_t) depth: 2
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type init_var_run_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	 	 	
#line 129
##### begin files_search_pids(blktap_t) depth: 3
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type var_t, var_run_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	allow blktap_t var_run_t:lnk_file { getattr read };
#line 129
	
#line 129
	allow blktap_t var_t:dir { getattr search open };
#line 129
	allow blktap_t var_run_t:dir { getattr search open };
#line 129

#line 129

#line 129
	 	
#line 129
##### end files_search_pids(blktap_t) depth: 2
#line 129
 	
#line 129
	allow blktap_t init_var_run_t:dir { getattr search open };
#line 129

#line 129
	 	
#line 129
##### end init_search_run(blktap_t) depth: 1
#line 129
 	
#line 129
	allow blktap_t syslogd_var_run_t:dir { getattr search open };
#line 129

#line 129
	# the type of socket depends on the syslog daemon
#line 129
	allow blktap_t syslogd_t:unix_dgram_socket sendto;
#line 129
	allow blktap_t syslogd_t:unix_stream_socket connectto;
#line 129
	allow blktap_t self:unix_dgram_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 129
	allow blktap_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 129

#line 129
	# If syslog is down, the glibc syslog() function
#line 129
	# will write to the console.
#line 129
	 	 	
#line 129
##### begin term_write_console(blktap_t) depth: 2
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type console_device_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	 	 	
#line 129
##### begin dev_list_all_dev_nodes(blktap_t) depth: 3
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type device_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	
#line 129
	allow blktap_t device_t:dir { getattr search open };
#line 129
	allow blktap_t device_t:dir { getattr search open read lock ioctl };
#line 129

#line 129
	
#line 129
	allow blktap_t device_t:dir { getattr search open };
#line 129
	allow blktap_t device_t:lnk_file { getattr read };
#line 129

#line 129

#line 129
	 	
#line 129
##### end dev_list_all_dev_nodes(blktap_t) depth: 2
#line 129
 	
#line 129
	allow blktap_t console_device_t:chr_file { getattr open write append lock ioctl };
#line 129

#line 129
	 	
#line 129
##### end term_write_console(blktap_t) depth: 1
#line 129
 	
#line 129
	 	 	
#line 129
##### begin term_dontaudit_read_console(blktap_t) depth: 2
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type console_device_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	dontaudit blktap_t console_device_t:chr_file { getattr open read lock ioctl };
#line 129

#line 129
	 	
#line 129
##### end term_dontaudit_read_console(blktap_t) depth: 1
#line 129
 	
#line 129

#line 129
	# because systemd is now using /run/systemd/journal/dev-log
#line 129
	 	 	
#line 129
##### begin init_search_pid_dirs(blktap_t) depth: 2
#line 129
 	
#line 129
    
#line 129
	
#line 129
		require {
#line 129
			
#line 129
        type init_var_run_t;
#line 129
    
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
    allow blktap_t init_var_run_t:dir { getattr search open };
#line 129

#line 129
	 	
#line 129
##### end init_search_pid_dirs(blktap_t) depth: 1
#line 129
 	
#line 129

#line 129
	 	
#line 129
##### end logging_send_syslog_msg(blktap_t) depth: 0
#line 129
 	
#line 129

#line 129
	 	 	
#line 129
##### begin miscfiles_read_localization(blktap_t) depth: 1
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type locale_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	 	 	
#line 129
##### begin files_read_etc_symlinks(blktap_t) depth: 2
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type etc_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	
#line 129
	allow blktap_t etc_t:dir { getattr search open };
#line 129
	allow blktap_t etc_t:lnk_file { getattr read };
#line 129

#line 129

#line 129
	 	
#line 129
##### end files_read_etc_symlinks(blktap_t) depth: 1
#line 129
 	
#line 129
	 	 	
#line 129
##### begin files_search_usr(blktap_t) depth: 2
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type usr_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	allow blktap_t usr_t:dir { getattr search open };
#line 129

#line 129
	 	
#line 129
##### end files_search_usr(blktap_t) depth: 1
#line 129
 	
#line 129
	allow blktap_t locale_t:dir { getattr search open read lock ioctl };
#line 129
	
#line 129
	allow blktap_t locale_t:dir { getattr search open };
#line 129
	allow blktap_t locale_t:file { getattr open read lock ioctl };
#line 129

#line 129
	
#line 129
	allow blktap_t locale_t:dir { getattr search open };
#line 129
	allow blktap_t locale_t:lnk_file { getattr read };
#line 129

#line 129

#line 129
	 	
#line 129
##### end miscfiles_read_localization(blktap_t) depth: 0
#line 129
 	
#line 129

#line 129
	 	 	
#line 129
##### begin xen_stream_connect_xenstore(blktap_t) depth: 1
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type xenstored_t, xenstored_var_run_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	 	 	
#line 129
##### begin files_search_pids(blktap_t) depth: 2
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type var_t, var_run_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	allow blktap_t var_run_t:lnk_file { getattr read };
#line 129
	
#line 129
	allow blktap_t var_t:dir { getattr search open };
#line 129
	allow blktap_t var_run_t:dir { getattr search open };
#line 129

#line 129

#line 129
	 	
#line 129
##### end files_search_pids(blktap_t) depth: 1
#line 129
 	
#line 129
	
#line 129
	allow blktap_t xenstored_var_run_t:dir { getattr search open };
#line 129
	allow blktap_t xenstored_var_run_t:sock_file { getattr write open append };
#line 129
	allow blktap_t xenstored_t:unix_stream_socket connectto;
#line 129

#line 129

#line 129
	 	
#line 129
##### end xen_stream_connect_xenstore(blktap_t) depth: 0
#line 129
 	
#line 129

#line 129
	} else {
#line 129
		
#line 129
	dontaudit xend_t blktap_exec_t:file { execute execute_no_trans };
#line 129

#line 129
	}
#line 146


#######################################
#
# evtchnd local policy
#


#line 153
	allow evtchnd_t evtchnd_var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 153
	allow evtchnd_t evtchnd_var_log_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 153


#line 154
	allow evtchnd_t evtchnd_var_log_t:dir { getattr search open };
#line 154
	allow evtchnd_t evtchnd_var_log_t:file { getattr open append lock ioctl };
#line 154


#line 155
	allow evtchnd_t evtchnd_var_log_t:dir { getattr search open lock ioctl write add_name };
#line 155
	allow evtchnd_t evtchnd_var_log_t:file { getattr create open };
#line 155


#line 156
	allow evtchnd_t evtchnd_var_log_t:dir { getattr search open };
#line 156
	allow evtchnd_t evtchnd_var_log_t:file { setattr };
#line 156

 	 	
#line 157
##### begin logging_log_filetrans(evtchnd_t,evtchnd_var_log_t,{ file dir }) depth: 1
#line 157
 	
#line 157
	
#line 157
	
#line 157
		require {
#line 157
			
#line 157
		type var_log_t;
#line 157
	
#line 157
		} # end require
#line 157
	
#line 157

#line 157

#line 157
	 	 	
#line 157
##### begin files_search_var(evtchnd_t) depth: 2
#line 157
 	
#line 157
	
#line 157
	
#line 157
		require {
#line 157
			
#line 157
		type var_t;
#line 157
	
#line 157
		} # end require
#line 157
	
#line 157

#line 157

#line 157
	allow evtchnd_t var_t:dir { getattr search open };
#line 157

#line 157
	 	
#line 157
##### end files_search_var(evtchnd_t) depth: 1
#line 157
 	
#line 157
	
#line 157
	allow evtchnd_t var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 157
	type_transition evtchnd_t var_log_t:{ file dir } evtchnd_var_log_t ;
#line 157

#line 157
	allow evtchnd_t var_log_t:lnk_file { getattr read };
#line 157

#line 157
	 	
#line 157
##### end logging_log_filetrans(evtchnd_t,evtchnd_var_log_t,{ file dir }) depth: 0
#line 157
 	


#line 159
	allow evtchnd_t evtchnd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 159
	allow evtchnd_t evtchnd_var_run_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 159


#line 160
	allow evtchnd_t evtchnd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 160
	allow evtchnd_t evtchnd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 160


#line 161
	allow evtchnd_t evtchnd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 161
	allow evtchnd_t evtchnd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 161

 	 	
#line 162
##### begin files_pid_filetrans(evtchnd_t,evtchnd_var_run_t,{ file sock_file dir }) depth: 1
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type var_t, var_run_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow evtchnd_t var_t:dir { getattr search open };
#line 162
	allow evtchnd_t var_run_t:lnk_file { getattr read };
#line 162
	
#line 162
	allow evtchnd_t var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 162
	type_transition evtchnd_t var_run_t:{ file sock_file dir } evtchnd_var_run_t ;
#line 162

#line 162

#line 162
	 	
#line 162
##### end files_pid_filetrans(evtchnd_t,evtchnd_var_run_t,{ file sock_file dir }) depth: 0
#line 162
 	

########################################
#
# xend local policy
#

allow xend_t self:capability { dac_override ipc_lock net_admin setuid sys_admin sys_nice sys_tty_config net_raw sys_resource sys_rawio };
dontaudit xend_t self:capability { sys_ptrace };
allow xend_t self:process { setrlimit signal sigkill };
dontaudit xend_t self:process ptrace;
allow xend_t self:fifo_file { open { getattr read write append ioctl lock } };
allow xend_t self:unix_stream_socket { accept listen };
allow xend_t self:tcp_socket { accept listen };
allow xend_t self:packet_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
allow xend_t self:tun_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };

# for lsscsi
 	 	
#line 180
##### begin storage_getattr_fixed_disk_dev(xend_t) depth: 1
#line 180
 	
#line 180
	
#line 180
	
#line 180
		require {
#line 180
			
#line 180
		type fixed_disk_device_t;
#line 180
	
#line 180
		} # end require
#line 180
	
#line 180

#line 180

#line 180
	 	 	
#line 180
##### begin dev_list_all_dev_nodes(xend_t) depth: 2
#line 180
 	
#line 180
	
#line 180
	
#line 180
		require {
#line 180
			
#line 180
		type device_t;
#line 180
	
#line 180
		} # end require
#line 180
	
#line 180

#line 180

#line 180
	
#line 180
	allow xend_t device_t:dir { getattr search open };
#line 180
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 180

#line 180
	
#line 180
	allow xend_t device_t:dir { getattr search open };
#line 180
	allow xend_t device_t:lnk_file { getattr read };
#line 180

#line 180

#line 180
	 	
#line 180
##### end dev_list_all_dev_nodes(xend_t) depth: 1
#line 180
 	
#line 180
	allow xend_t fixed_disk_device_t:blk_file getattr;
#line 180

#line 180
	 	
#line 180
##### end storage_getattr_fixed_disk_dev(xend_t) depth: 0
#line 180
 	

allow xend_t xen_image_t:dir { getattr search open read lock ioctl };

#line 183
	allow xend_t xen_image_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 183
	allow xend_t xen_image_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 183


#line 184
	allow xend_t xen_image_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 184
	allow xend_t xen_image_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 184


#line 185
	allow xend_t xen_image_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 185
	allow xend_t xen_image_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 185


#line 186
	allow xend_t xen_image_t:dir { getattr search open };
#line 186
	allow xend_t xen_image_t:lnk_file { getattr read };
#line 186


#line 187
	allow xend_t xen_image_t:dir { getattr search open };
#line 187
	allow xend_t xen_image_t:sock_file { getattr open read };
#line 187


#line 188
	allow xend_t xen_image_t:dir { getattr search open };
#line 188
	allow xend_t xen_image_t:chr_file { getattr open read write append ioctl lock };
#line 188


#line 189
	allow xend_t xen_image_t:dir { getattr search open };
#line 189
	allow xend_t xen_image_t:blk_file { getattr open read write append ioctl lock };
#line 189

 	 	
#line 190
##### begin fs_hugetlbfs_filetrans(xend_t,xen_image_t,file) depth: 1
#line 190
 	
#line 190
	
#line 190
	
#line 190
		require {
#line 190
			
#line 190
		type hugetlbfs_t;
#line 190
	
#line 190
		} # end require
#line 190
	
#line 190

#line 190

#line 190
	allow xen_image_t hugetlbfs_t:filesystem associate;
#line 190
	
#line 190
	allow xend_t hugetlbfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 190
	type_transition xend_t hugetlbfs_t:file xen_image_t ;
#line 190

#line 190

#line 190
	 	
#line 190
##### end fs_hugetlbfs_filetrans(xend_t,xen_image_t,file) depth: 0
#line 190
 	

allow xend_t xenctl_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
 	 	
#line 193
##### begin dev_filetrans(xend_t,xenctl_t,fifo_file) depth: 1
#line 193
 	
#line 193
	
#line 193
	
#line 193
		require {
#line 193
			
#line 193
		type device_t;
#line 193
	
#line 193
		} # end require
#line 193
	
#line 193

#line 193

#line 193
	
#line 193
	allow xend_t device_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 193
	type_transition xend_t device_t:fifo_file xenctl_t ;
#line 193

#line 193

#line 193
	 	 	
#line 193
##### begin dev_associate(xenctl_t) depth: 2
#line 193
 	
#line 193
	
#line 193
	
#line 193
		require {
#line 193
			
#line 193
		type device_t;
#line 193
	
#line 193
		} # end require
#line 193
	
#line 193

#line 193

#line 193
	allow xenctl_t device_t:filesystem associate;
#line 193
	 	 	
#line 193
##### begin fs_associate_tmpfs(xenctl_t) depth: 3
#line 193
 	
#line 193
	
#line 193
	
#line 193
		require {
#line 193
			
#line 193
		type tmpfs_t;
#line 193
	
#line 193
		} # end require
#line 193
	
#line 193

#line 193

#line 193
	allow xenctl_t tmpfs_t:filesystem associate;
#line 193

#line 193
	 	
#line 193
##### end fs_associate_tmpfs(xenctl_t) depth: 2
#line 193
 		#For backwards compatibility
#line 193

#line 193
	 	
#line 193
##### end dev_associate(xenctl_t) depth: 1
#line 193
 	
#line 193
	 	 	
#line 193
##### begin files_associate_tmp(xenctl_t) depth: 2
#line 193
 	
#line 193
	
#line 193
	
#line 193
		require {
#line 193
			
#line 193
		type tmp_t;
#line 193
	
#line 193
		} # end require
#line 193
	
#line 193

#line 193

#line 193
	allow xenctl_t tmp_t:filesystem associate;
#line 193

#line 193
	 	
#line 193
##### end files_associate_tmp(xenctl_t) depth: 1
#line 193
 	
#line 193

#line 193
	 	
#line 193
##### end dev_filetrans(xend_t,xenctl_t,fifo_file) depth: 0
#line 193
 	


#line 195
	allow xend_t xend_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 195
	allow xend_t xend_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 195


#line 196
	allow xend_t xend_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 196
	allow xend_t xend_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 196

 	 	
#line 197
##### begin files_tmp_filetrans(xend_t,xend_tmp_t,{ file dir }) depth: 1
#line 197
 	
#line 197
	
#line 197
	
#line 197
		require {
#line 197
			
#line 197
		type tmp_t;
#line 197
	
#line 197
		} # end require
#line 197
	
#line 197

#line 197

#line 197
	
#line 197
	allow xend_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 197
	type_transition xend_t tmp_t:{ file dir } xend_tmp_t ;
#line 197

#line 197

#line 197
	 	
#line 197
##### end files_tmp_filetrans(xend_t,xend_tmp_t,{ file dir }) depth: 0
#line 197
 	


#line 199
	allow xend_t xend_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 199
	allow xend_t xend_var_run_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 199


#line 200
	allow xend_t xend_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 200
	allow xend_t xend_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 200


#line 201
	allow xend_t xend_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 201
	allow xend_t xend_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 201


#line 202
	allow xend_t xend_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 202
	allow xend_t xend_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 202

 	 	
#line 203
##### begin files_pid_filetrans(xend_t,xend_var_run_t,{ file sock_file fifo_file dir }) depth: 1
#line 203
 	
#line 203
	
#line 203
	
#line 203
		require {
#line 203
			
#line 203
		type var_t, var_run_t;
#line 203
	
#line 203
		} # end require
#line 203
	
#line 203

#line 203

#line 203
	allow xend_t var_t:dir { getattr search open };
#line 203
	allow xend_t var_run_t:lnk_file { getattr read };
#line 203
	
#line 203
	allow xend_t var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 203
	type_transition xend_t var_run_t:{ file sock_file fifo_file dir } xend_var_run_t ;
#line 203

#line 203

#line 203
	 	
#line 203
##### end files_pid_filetrans(xend_t,xend_var_run_t,{ file sock_file fifo_file dir }) depth: 0
#line 203
 	


#line 205
	allow xend_t xend_var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 205
	allow xend_t xend_var_log_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 205


#line 206
	allow xend_t xend_var_log_t:dir { getattr search open };
#line 206
	allow xend_t xend_var_log_t:file { getattr open append lock ioctl };
#line 206


#line 207
	allow xend_t xend_var_log_t:dir { getattr search open lock ioctl write add_name };
#line 207
	allow xend_t xend_var_log_t:file { getattr create open };
#line 207


#line 208
	allow xend_t xend_var_log_t:dir { getattr search open };
#line 208
	allow xend_t xend_var_log_t:file { setattr };
#line 208


#line 209
	allow xend_t xend_var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 209
	allow xend_t xend_var_log_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 209

 	 	
#line 210
##### begin logging_log_filetrans(xend_t,xend_var_log_t,{ sock_file file dir }) depth: 1
#line 210
 	
#line 210
	
#line 210
	
#line 210
		require {
#line 210
			
#line 210
		type var_log_t;
#line 210
	
#line 210
		} # end require
#line 210
	
#line 210

#line 210

#line 210
	 	 	
#line 210
##### begin files_search_var(xend_t) depth: 2
#line 210
 	
#line 210
	
#line 210
	
#line 210
		require {
#line 210
			
#line 210
		type var_t;
#line 210
	
#line 210
		} # end require
#line 210
	
#line 210

#line 210

#line 210
	allow xend_t var_t:dir { getattr search open };
#line 210

#line 210
	 	
#line 210
##### end files_search_var(xend_t) depth: 1
#line 210
 	
#line 210
	
#line 210
	allow xend_t var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 210
	type_transition xend_t var_log_t:{ sock_file file dir } xend_var_log_t ;
#line 210

#line 210
	allow xend_t var_log_t:lnk_file { getattr read };
#line 210

#line 210
	 	
#line 210
##### end logging_log_filetrans(xend_t,xend_var_log_t,{ sock_file file dir }) depth: 0
#line 210
 	


#line 212
	allow xend_t xend_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 212
	allow xend_t xend_var_lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 212


#line 213
	allow xend_t xend_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 213
	allow xend_t xend_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 213


#line 214
	allow xend_t xend_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 214
	allow xend_t xend_var_lib_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 214


#line 215
	allow xend_t xend_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 215
	allow xend_t xend_var_lib_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 215

 	 	
#line 216
##### begin files_var_lib_filetrans(xend_t,xend_var_lib_t,{ file dir }) depth: 1
#line 216
 	
#line 216
	
#line 216
	
#line 216
		require {
#line 216
			
#line 216
		type var_t, var_lib_t;
#line 216
	
#line 216
		} # end require
#line 216
	
#line 216

#line 216

#line 216
	allow xend_t var_t:dir { getattr search open };
#line 216
	
#line 216
	allow xend_t var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 216
	type_transition xend_t var_lib_t:{ file dir } xend_var_lib_t ;
#line 216

#line 216

#line 216
	 	
#line 216
##### end files_var_lib_filetrans(xend_t,xend_var_lib_t,{ file dir }) depth: 0
#line 216
 	


#line 218
	allow xend_t xenstored_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 218
	allow xend_t xenstored_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 218


allow xend_t xenstored_var_lib_t:dir { getattr search open read lock ioctl };


#line 222
	
#line 222
	
#line 222
	allow xend_t xenconsoled_exec_t:file { getattr open read execute };
#line 222
	allow xend_t xenconsoled_t:process transition;
#line 222
	dontaudit xend_t xenconsoled_t:process { noatsecure siginh rlimitinh };
#line 222

#line 222
	type_transition xend_t xenconsoled_exec_t:process xenconsoled_t;
#line 222

#line 222

#line 222
	allow xenconsoled_t xend_t:fd use;
#line 222
	allow xenconsoled_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 222
	allow xenconsoled_t xend_t:process sigchld;
#line 222


#line 223
	
#line 223
	
#line 223
	allow xend_t xenstored_exec_t:file { getattr open read execute };
#line 223
	allow xend_t xenstored_t:process transition;
#line 223
	dontaudit xend_t xenstored_t:process { noatsecure siginh rlimitinh };
#line 223

#line 223
	type_transition xend_t xenstored_exec_t:process xenstored_t;
#line 223

#line 223

#line 223
	allow xenstored_t xend_t:fd use;
#line 223
	allow xenstored_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 223
	allow xenstored_t xend_t:process sigchld;
#line 223


 	 	
#line 225
##### begin xen_stream_connect_xenstore(xend_t) depth: 1
#line 225
 	
#line 225
	
#line 225
	
#line 225
		require {
#line 225
			
#line 225
		type xenstored_t, xenstored_var_run_t;
#line 225
	
#line 225
		} # end require
#line 225
	
#line 225

#line 225

#line 225
	 	 	
#line 225
##### begin files_search_pids(xend_t) depth: 2
#line 225
 	
#line 225
	
#line 225
	
#line 225
		require {
#line 225
			
#line 225
		type var_t, var_run_t;
#line 225
	
#line 225
		} # end require
#line 225
	
#line 225

#line 225

#line 225
	allow xend_t var_run_t:lnk_file { getattr read };
#line 225
	
#line 225
	allow xend_t var_t:dir { getattr search open };
#line 225
	allow xend_t var_run_t:dir { getattr search open };
#line 225

#line 225

#line 225
	 	
#line 225
##### end files_search_pids(xend_t) depth: 1
#line 225
 	
#line 225
	
#line 225
	allow xend_t xenstored_var_run_t:dir { getattr search open };
#line 225
	allow xend_t xenstored_var_run_t:sock_file { getattr write open append };
#line 225
	allow xend_t xenstored_t:unix_stream_socket connectto;
#line 225

#line 225

#line 225
	 	
#line 225
##### end xen_stream_connect_xenstore(xend_t) depth: 0
#line 225
 	

 	 	
#line 227
##### begin kernel_read_kernel_sysctls(xend_t) depth: 1
#line 227
 	
#line 227
	
#line 227
	
#line 227
		require {
#line 227
			
#line 227
		type proc_t, sysctl_t, sysctl_kernel_t;
#line 227
	
#line 227
		} # end require
#line 227
	
#line 227

#line 227

#line 227
	
#line 227
	allow xend_t { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 227
	allow xend_t sysctl_kernel_t:file { getattr open read lock ioctl };
#line 227

#line 227

#line 227
	
#line 227
	allow xend_t { proc_t sysctl_t }:dir { getattr search open };
#line 227
	allow xend_t sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 227

#line 227

#line 227
	 	
#line 227
##### end kernel_read_kernel_sysctls(xend_t) depth: 0
#line 227
 	
 	 	
#line 228
##### begin kernel_read_vm_sysctls(xend_t) depth: 1
#line 228
 	
#line 228
	
#line 228
	
#line 228
		require {
#line 228
			
#line 228
		type proc_t, sysctl_t, sysctl_vm_t;
#line 228
	
#line 228
		} # end require
#line 228
	
#line 228

#line 228

#line 228
	
#line 228
	allow xend_t { proc_t sysctl_t sysctl_vm_t }:dir { getattr search open };
#line 228
	allow xend_t sysctl_vm_t:file { getattr open read lock ioctl };
#line 228

#line 228

#line 228
	
#line 228
	allow xend_t { proc_t sysctl_t }:dir { getattr search open };
#line 228
	allow xend_t sysctl_vm_t:dir { getattr search open read lock ioctl };
#line 228

#line 228

#line 228
	 	
#line 228
##### end kernel_read_vm_sysctls(xend_t) depth: 0
#line 228
 	
 	 	
#line 229
##### begin kernel_read_system_state(xend_t) depth: 1
#line 229
 	
#line 229
	
#line 229
	
#line 229
		require {
#line 229
			
#line 229
		type proc_t;
#line 229
	
#line 229
		} # end require
#line 229
	
#line 229

#line 229

#line 229
	
#line 229
	allow xend_t proc_t:dir { getattr search open };
#line 229
	allow xend_t proc_t:file { getattr open read lock ioctl };
#line 229

#line 229
	
#line 229
	allow xend_t proc_t:dir { getattr search open };
#line 229
	allow xend_t proc_t:lnk_file { getattr read };
#line 229

#line 229

#line 229
	
#line 229
	allow xend_t proc_t:dir { getattr search open };
#line 229
	allow xend_t proc_t:dir { getattr search open read lock ioctl };
#line 229

#line 229

#line 229
	 	
#line 229
##### end kernel_read_system_state(xend_t) depth: 0
#line 229
 	
 	 	
#line 230
##### begin kernel_write_xen_state(xend_t) depth: 1
#line 230
 	
#line 230
	
#line 230
	
#line 230
		require {
#line 230
			
#line 230
		type proc_t, proc_xen_t;
#line 230
	
#line 230
		} # end require
#line 230
	
#line 230

#line 230

#line 230
	
#line 230
	allow xend_t { proc_t proc_xen_t }:dir { getattr search open };
#line 230
	allow xend_t proc_xen_t:file { getattr open write append lock ioctl };
#line 230

#line 230

#line 230
	 	
#line 230
##### end kernel_write_xen_state(xend_t) depth: 0
#line 230
 	
 	 	
#line 231
##### begin kernel_read_xen_state(xend_t) depth: 1
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type proc_t, proc_xen_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	
#line 231
	allow xend_t { proc_t proc_xen_t }:dir { getattr search open };
#line 231
	allow xend_t proc_xen_t:file { getattr open read lock ioctl };
#line 231

#line 231
	
#line 231
	allow xend_t { proc_t proc_xen_t }:dir { getattr search open };
#line 231
	allow xend_t proc_xen_t:lnk_file { getattr read };
#line 231

#line 231

#line 231
	
#line 231
	allow xend_t proc_t:dir { getattr search open };
#line 231
	allow xend_t proc_xen_t:dir { getattr search open read lock ioctl };
#line 231

#line 231

#line 231
	 	
#line 231
##### end kernel_read_xen_state(xend_t) depth: 0
#line 231
 	
 	 	
#line 232
##### begin kernel_rw_net_sysctls(xend_t) depth: 1
#line 232
 	
#line 232
	
#line 232
	
#line 232
		require {
#line 232
			
#line 232
		type proc_t, sysctl_t, sysctl_net_t;
#line 232
	
#line 232
		} # end require
#line 232
	
#line 232

#line 232

#line 232
	
#line 232
	allow xend_t { proc_t sysctl_t sysctl_net_t }:dir { getattr search open };
#line 232
	allow xend_t sysctl_net_t:file { getattr open read write append ioctl lock };
#line 232

#line 232

#line 232
	
#line 232
	allow xend_t { proc_t sysctl_t }:dir { getattr search open };
#line 232
	allow xend_t sysctl_net_t:dir { getattr search open read lock ioctl };
#line 232

#line 232

#line 232
	 	
#line 232
##### end kernel_rw_net_sysctls(xend_t) depth: 0
#line 232
 	
 	 	
#line 233
##### begin kernel_read_network_state(xend_t) depth: 1
#line 233
 	
#line 233
	
#line 233
	
#line 233
		require {
#line 233
			
#line 233
		type proc_t, proc_net_t;
#line 233
	
#line 233
		} # end require
#line 233
	
#line 233

#line 233

#line 233
	
#line 233
	allow xend_t { proc_t proc_net_t }:dir { getattr search open };
#line 233
	allow xend_t proc_net_t:file { getattr open read lock ioctl };
#line 233

#line 233
	
#line 233
	allow xend_t { proc_t proc_net_t }:dir { getattr search open };
#line 233
	allow xend_t proc_net_t:lnk_file { getattr read };
#line 233

#line 233

#line 233
	
#line 233
	allow xend_t proc_t:dir { getattr search open };
#line 233
	allow xend_t proc_net_t:dir { getattr search open read lock ioctl };
#line 233

#line 233

#line 233
	 	
#line 233
##### end kernel_read_network_state(xend_t) depth: 0
#line 233
 	

 	 	
#line 235
##### begin corecmd_exec_bin(xend_t) depth: 1
#line 235
 	
#line 235
	
#line 235
	
#line 235
		require {
#line 235
			
#line 235
		type bin_t;
#line 235
	
#line 235
		} # end require
#line 235
	
#line 235

#line 235

#line 235
	
#line 235
	allow xend_t bin_t:dir { getattr search open };
#line 235
	allow xend_t bin_t:lnk_file { getattr read };
#line 235

#line 235
	
#line 235
	allow xend_t bin_t:dir { getattr search open };
#line 235
	allow xend_t bin_t:dir { getattr search open read lock ioctl };
#line 235

#line 235
	allow xend_t bin_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 235

#line 235
	 	
#line 235
##### end corecmd_exec_bin(xend_t) depth: 0
#line 235
 	
 	 	
#line 236
##### begin corecmd_exec_shell(xend_t) depth: 1
#line 236
 	
#line 236
	
#line 236
	
#line 236
		require {
#line 236
			
#line 236
		type bin_t, shell_exec_t;
#line 236
	
#line 236
		} # end require
#line 236
	
#line 236

#line 236

#line 236
	
#line 236
	allow xend_t bin_t:dir { getattr search open };
#line 236
	allow xend_t bin_t:dir { getattr search open read lock ioctl };
#line 236

#line 236
	
#line 236
	allow xend_t bin_t:dir { getattr search open };
#line 236
	allow xend_t bin_t:lnk_file { getattr read };
#line 236

#line 236
	allow xend_t shell_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 236

#line 236
	 	
#line 236
##### end corecmd_exec_shell(xend_t) depth: 0
#line 236
 	

 	 	
#line 238
##### begin corenet_all_recvfrom_unlabeled(xend_t) depth: 1
#line 238
 	
#line 238
	 	 	
#line 238
##### begin kernel_tcp_recvfrom_unlabeled(xend_t) depth: 2
#line 238
 	
#line 238
	
#line 238
	
#line 238
		require {
#line 238
			
#line 238
		type unlabeled_t;
#line 238
	
#line 238
		} # end require
#line 238
	
#line 238

#line 238

#line 238
	allow xend_t unlabeled_t:tcp_socket recvfrom;
#line 238

#line 238
	 	
#line 238
##### end kernel_tcp_recvfrom_unlabeled(xend_t) depth: 1
#line 238
 	
#line 238
	 	 	
#line 238
##### begin kernel_udp_recvfrom_unlabeled(xend_t) depth: 2
#line 238
 	
#line 238
	
#line 238
	
#line 238
		require {
#line 238
			
#line 238
		type unlabeled_t;
#line 238
	
#line 238
		} # end require
#line 238
	
#line 238

#line 238

#line 238
	allow xend_t unlabeled_t:udp_socket recvfrom;
#line 238

#line 238
	 	
#line 238
##### end kernel_udp_recvfrom_unlabeled(xend_t) depth: 1
#line 238
 	
#line 238
	 	 	
#line 238
##### begin kernel_raw_recvfrom_unlabeled(xend_t) depth: 2
#line 238
 	
#line 238
	
#line 238
	
#line 238
		require {
#line 238
			
#line 238
		type unlabeled_t;
#line 238
	
#line 238
		} # end require
#line 238
	
#line 238

#line 238

#line 238
	allow xend_t unlabeled_t:rawip_socket recvfrom;
#line 238

#line 238
	 	
#line 238
##### end kernel_raw_recvfrom_unlabeled(xend_t) depth: 1
#line 238
 	
#line 238
	 	 	
#line 238
##### begin kernel_recvfrom_unlabeled_peer(xend_t) depth: 2
#line 238
 	
#line 238
	
#line 238
	
#line 238
		require {
#line 238
			
#line 238
		type unlabeled_t;
#line 238
	
#line 238
		} # end require
#line 238
	
#line 238

#line 238

#line 238
	allow xend_t unlabeled_t:peer recv;
#line 238

#line 238
	 	
#line 238
##### end kernel_recvfrom_unlabeled_peer(xend_t) depth: 1
#line 238
 	
#line 238

#line 238
	# XXX - at some point the oubound/send access check will be removed
#line 238
	# but for right now we need to keep this in place so as not to break
#line 238
	# older systems
#line 238
	 	 	
#line 238
##### begin kernel_sendrecv_unlabeled_association(xend_t) depth: 2
#line 238
 	
#line 238
	
#line 238
	
#line 238
		require {
#line 238
			
#line 238
		type unlabeled_t;
#line 238
	
#line 238
		} # end require
#line 238
	
#line 238

#line 238

#line 238
	allow xend_t unlabeled_t:association { sendto recvfrom };
#line 238

#line 238
	 	
#line 238
##### end kernel_sendrecv_unlabeled_association(xend_t) depth: 1
#line 238
 	
#line 238

#line 238
	 	
#line 238
##### end corenet_all_recvfrom_unlabeled(xend_t) depth: 0
#line 238
 	
 	 	
#line 239
##### begin corenet_all_recvfrom_netlabel(xend_t) depth: 1
#line 239
 	
#line 239
	
#line 239
	
#line 239
		require {
#line 239
			
#line 239
		type netlabel_peer_t;
#line 239
	
#line 239
		} # end require
#line 239
	
#line 239

#line 239

#line 239
	allow xend_t netlabel_peer_t:peer recv;
#line 239
	allow xend_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 239

#line 239
	 	
#line 239
##### end corenet_all_recvfrom_netlabel(xend_t) depth: 0
#line 239
 	
 	 	
#line 240
##### begin corenet_tcp_sendrecv_generic_if(xend_t) depth: 1
#line 240
 	
#line 240
	
#line 240
	
#line 240
		require {
#line 240
			
#line 240
		type netif_t;
#line 240
	
#line 240
		} # end require
#line 240
	
#line 240

#line 240

#line 240
	allow xend_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 240

#line 240
	 	
#line 240
##### end corenet_tcp_sendrecv_generic_if(xend_t) depth: 0
#line 240
 	
 	 	
#line 241
##### begin corenet_tcp_sendrecv_generic_node(xend_t) depth: 1
#line 241
 	
#line 241
	
#line 241
	
#line 241
		require {
#line 241
			
#line 241
		type node_t;
#line 241
	
#line 241
		} # end require
#line 241
	
#line 241

#line 241

#line 241
	allow xend_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 241

#line 241
	 	
#line 241
##### end corenet_tcp_sendrecv_generic_node(xend_t) depth: 0
#line 241
 	
 	 	
#line 242
##### begin corenet_tcp_sendrecv_all_ports(xend_t) depth: 1
#line 242
 	
#line 242
	
#line 242
	
#line 242
		require {
#line 242
			
#line 242
		attribute port_type;
#line 242
	
#line 242
		} # end require
#line 242
	
#line 242

#line 242

#line 242
	allow xend_t port_type:tcp_socket { send_msg recv_msg };
#line 242

#line 242
	 	
#line 242
##### end corenet_tcp_sendrecv_all_ports(xend_t) depth: 0
#line 242
 	
 	 	
#line 243
##### begin corenet_tcp_bind_generic_node(xend_t) depth: 1
#line 243
 	
#line 243
	
#line 243
	
#line 243
		require {
#line 243
			
#line 243
		type node_t;
#line 243
	
#line 243
		} # end require
#line 243
	
#line 243

#line 243

#line 243
	allow xend_t node_t:tcp_socket node_bind;
#line 243

#line 243
	 	
#line 243
##### end corenet_tcp_bind_generic_node(xend_t) depth: 0
#line 243
 	

 	 	
#line 245
##### begin corenet_sendrecv_xen_server_packets(xend_t) depth: 1
#line 245
 	
#line 245
	 	 	
#line 245
##### begin corenet_send_xen_server_packets(xend_t) depth: 2
#line 245
 	
#line 245
	
#line 245
	
#line 245
		require {
#line 245
			
#line 245
		type xen_server_packet_t;
#line 245
	
#line 245
		} # end require
#line 245
	
#line 245

#line 245

#line 245
	allow xend_t xen_server_packet_t:packet send;
#line 245

#line 245
	 	
#line 245
##### end corenet_send_xen_server_packets(xend_t) depth: 1
#line 245
 	
#line 245
	 	 	
#line 245
##### begin corenet_receive_xen_server_packets(xend_t) depth: 2
#line 245
 	
#line 245
	
#line 245
	
#line 245
		require {
#line 245
			
#line 245
		type xen_server_packet_t;
#line 245
	
#line 245
		} # end require
#line 245
	
#line 245

#line 245

#line 245
	allow xend_t xen_server_packet_t:packet recv;
#line 245

#line 245
	 	
#line 245
##### end corenet_receive_xen_server_packets(xend_t) depth: 1
#line 245
 	
#line 245

#line 245
	 	
#line 245
##### end corenet_sendrecv_xen_server_packets(xend_t) depth: 0
#line 245
 	
 	 	
#line 246
##### begin corenet_tcp_bind_xen_port(xend_t) depth: 1
#line 246
 	
#line 246
	
#line 246
	
#line 246
		require {
#line 246
			
#line 246
		type xen_port_t;
#line 246
	
#line 246
		} # end require
#line 246
	
#line 246

#line 246

#line 246
	allow xend_t xen_port_t:tcp_socket name_bind;
#line 246
	
#line 246

#line 246
	 	
#line 246
##### end corenet_tcp_bind_xen_port(xend_t) depth: 0
#line 246
 	

 	 	
#line 248
##### begin corenet_sendrecv_soundd_server_packets(xend_t) depth: 1
#line 248
 	
#line 248
	 	 	
#line 248
##### begin corenet_send_soundd_server_packets(xend_t) depth: 2
#line 248
 	
#line 248
	
#line 248
	
#line 248
		require {
#line 248
			
#line 248
		type soundd_server_packet_t;
#line 248
	
#line 248
		} # end require
#line 248
	
#line 248

#line 248

#line 248
	allow xend_t soundd_server_packet_t:packet send;
#line 248

#line 248
	 	
#line 248
##### end corenet_send_soundd_server_packets(xend_t) depth: 1
#line 248
 	
#line 248
	 	 	
#line 248
##### begin corenet_receive_soundd_server_packets(xend_t) depth: 2
#line 248
 	
#line 248
	
#line 248
	
#line 248
		require {
#line 248
			
#line 248
		type soundd_server_packet_t;
#line 248
	
#line 248
		} # end require
#line 248
	
#line 248

#line 248

#line 248
	allow xend_t soundd_server_packet_t:packet recv;
#line 248

#line 248
	 	
#line 248
##### end corenet_receive_soundd_server_packets(xend_t) depth: 1
#line 248
 	
#line 248

#line 248
	 	
#line 248
##### end corenet_sendrecv_soundd_server_packets(xend_t) depth: 0
#line 248
 	
 	 	
#line 249
##### begin corenet_tcp_bind_soundd_port(xend_t) depth: 1
#line 249
 	
#line 249
	
#line 249
	
#line 249
		require {
#line 249
			
#line 249
		type soundd_port_t;
#line 249
	
#line 249
		} # end require
#line 249
	
#line 249

#line 249

#line 249
	allow xend_t soundd_port_t:tcp_socket name_bind;
#line 249
	
#line 249

#line 249
	 	
#line 249
##### end corenet_tcp_bind_soundd_port(xend_t) depth: 0
#line 249
 	

 	 	
#line 251
##### begin corenet_sendrecv_generic_server_packets(xend_t) depth: 1
#line 251
 	
#line 251
	 	 	
#line 251
##### begin corenet_send_generic_server_packets(xend_t) depth: 2
#line 251
 	
#line 251
	
#line 251
	
#line 251
		require {
#line 251
			
#line 251
		type server_packet_t;
#line 251
	
#line 251
		} # end require
#line 251
	
#line 251

#line 251

#line 251
	allow xend_t server_packet_t:packet send;
#line 251

#line 251
	 	
#line 251
##### end corenet_send_generic_server_packets(xend_t) depth: 1
#line 251
 	
#line 251
	 	 	
#line 251
##### begin corenet_receive_generic_server_packets(xend_t) depth: 2
#line 251
 	
#line 251
	
#line 251
	
#line 251
		require {
#line 251
			
#line 251
		type server_packet_t;
#line 251
	
#line 251
		} # end require
#line 251
	
#line 251

#line 251

#line 251
	allow xend_t server_packet_t:packet recv;
#line 251

#line 251
	 	
#line 251
##### end corenet_receive_generic_server_packets(xend_t) depth: 1
#line 251
 	
#line 251

#line 251
	 	
#line 251
##### end corenet_sendrecv_generic_server_packets(xend_t) depth: 0
#line 251
 	
 	 	
#line 252
##### begin corenet_tcp_bind_generic_port(xend_t) depth: 1
#line 252
 	
#line 252
	
#line 252
	
#line 252
		require {
#line 252
			
#line 252
		type port_t;
#line 252
		attribute defined_port_type;
#line 252
	
#line 252
		} # end require
#line 252
	
#line 252

#line 252

#line 252
	allow xend_t port_t:tcp_socket name_bind;
#line 252
	dontaudit xend_t defined_port_type:tcp_socket name_bind;
#line 252

#line 252
	 	
#line 252
##### end corenet_tcp_bind_generic_port(xend_t) depth: 0
#line 252
 	

 	 	
#line 254
##### begin corenet_sendrecv_vnc_server_packets(xend_t) depth: 1
#line 254
 	
#line 254
	 	 	
#line 254
##### begin corenet_send_vnc_server_packets(xend_t) depth: 2
#line 254
 	
#line 254
	
#line 254
	
#line 254
		require {
#line 254
			
#line 254
		type vnc_server_packet_t;
#line 254
	
#line 254
		} # end require
#line 254
	
#line 254

#line 254

#line 254
	allow xend_t vnc_server_packet_t:packet send;
#line 254

#line 254
	 	
#line 254
##### end corenet_send_vnc_server_packets(xend_t) depth: 1
#line 254
 	
#line 254
	 	 	
#line 254
##### begin corenet_receive_vnc_server_packets(xend_t) depth: 2
#line 254
 	
#line 254
	
#line 254
	
#line 254
		require {
#line 254
			
#line 254
		type vnc_server_packet_t;
#line 254
	
#line 254
		} # end require
#line 254
	
#line 254

#line 254

#line 254
	allow xend_t vnc_server_packet_t:packet recv;
#line 254

#line 254
	 	
#line 254
##### end corenet_receive_vnc_server_packets(xend_t) depth: 1
#line 254
 	
#line 254

#line 254
	 	
#line 254
##### end corenet_sendrecv_vnc_server_packets(xend_t) depth: 0
#line 254
 	
 	 	
#line 255
##### begin corenet_tcp_bind_vnc_port(xend_t) depth: 1
#line 255
 	
#line 255
	
#line 255
	
#line 255
		require {
#line 255
			
#line 255
		type vnc_port_t;
#line 255
	
#line 255
		} # end require
#line 255
	
#line 255

#line 255

#line 255
	allow xend_t vnc_port_t:tcp_socket name_bind;
#line 255
	
#line 255

#line 255
	 	
#line 255
##### end corenet_tcp_bind_vnc_port(xend_t) depth: 0
#line 255
 	

 	 	
#line 257
##### begin corenet_sendrecv_xserver_client_packets(xend_t) depth: 1
#line 257
 	
#line 257
	 	 	
#line 257
##### begin corenet_send_xserver_client_packets(xend_t) depth: 2
#line 257
 	
#line 257
	
#line 257
	
#line 257
		require {
#line 257
			
#line 257
		type xserver_client_packet_t;
#line 257
	
#line 257
		} # end require
#line 257
	
#line 257

#line 257

#line 257
	allow xend_t xserver_client_packet_t:packet send;
#line 257

#line 257
	 	
#line 257
##### end corenet_send_xserver_client_packets(xend_t) depth: 1
#line 257
 	
#line 257
	 	 	
#line 257
##### begin corenet_receive_xserver_client_packets(xend_t) depth: 2
#line 257
 	
#line 257
	
#line 257
	
#line 257
		require {
#line 257
			
#line 257
		type xserver_client_packet_t;
#line 257
	
#line 257
		} # end require
#line 257
	
#line 257

#line 257

#line 257
	allow xend_t xserver_client_packet_t:packet recv;
#line 257

#line 257
	 	
#line 257
##### end corenet_receive_xserver_client_packets(xend_t) depth: 1
#line 257
 	
#line 257

#line 257
	 	
#line 257
##### end corenet_sendrecv_xserver_client_packets(xend_t) depth: 0
#line 257
 	
 	 	
#line 258
##### begin corenet_tcp_connect_xserver_port(xend_t) depth: 1
#line 258
 	
#line 258
	
#line 258
	
#line 258
		require {
#line 258
			
#line 258
		type xserver_port_t;
#line 258
	
#line 258
		} # end require
#line 258
	
#line 258

#line 258

#line 258
	allow xend_t xserver_port_t:tcp_socket name_connect;
#line 258

#line 258
	 	
#line 258
##### end corenet_tcp_connect_xserver_port(xend_t) depth: 0
#line 258
 	

 	 	
#line 260
##### begin corenet_sendrecv_xen_client_packets(xend_t) depth: 1
#line 260
 	
#line 260
	 	 	
#line 260
##### begin corenet_send_xen_client_packets(xend_t) depth: 2
#line 260
 	
#line 260
	
#line 260
	
#line 260
		require {
#line 260
			
#line 260
		type xen_client_packet_t;
#line 260
	
#line 260
		} # end require
#line 260
	
#line 260

#line 260

#line 260
	allow xend_t xen_client_packet_t:packet send;
#line 260

#line 260
	 	
#line 260
##### end corenet_send_xen_client_packets(xend_t) depth: 1
#line 260
 	
#line 260
	 	 	
#line 260
##### begin corenet_receive_xen_client_packets(xend_t) depth: 2
#line 260
 	
#line 260
	
#line 260
	
#line 260
		require {
#line 260
			
#line 260
		type xen_client_packet_t;
#line 260
	
#line 260
		} # end require
#line 260
	
#line 260

#line 260

#line 260
	allow xend_t xen_client_packet_t:packet recv;
#line 260

#line 260
	 	
#line 260
##### end corenet_receive_xen_client_packets(xend_t) depth: 1
#line 260
 	
#line 260

#line 260
	 	
#line 260
##### end corenet_sendrecv_xen_client_packets(xend_t) depth: 0
#line 260
 	
 	 	
#line 261
##### begin corenet_tcp_connect_xen_port(xend_t) depth: 1
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type xen_port_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow xend_t xen_port_t:tcp_socket name_connect;
#line 261

#line 261
	 	
#line 261
##### end corenet_tcp_connect_xen_port(xend_t) depth: 0
#line 261
 	

 	 	
#line 263
##### begin corenet_rw_tun_tap_dev(xend_t) depth: 1
#line 263
 	
#line 263
	
#line 263
	
#line 263
		require {
#line 263
			
#line 263
		type tun_tap_device_t;
#line 263
	
#line 263
		} # end require
#line 263
	
#line 263

#line 263

#line 263
	 	 	
#line 263
##### begin dev_list_all_dev_nodes(xend_t) depth: 2
#line 263
 	
#line 263
	
#line 263
	
#line 263
		require {
#line 263
			
#line 263
		type device_t;
#line 263
	
#line 263
		} # end require
#line 263
	
#line 263

#line 263

#line 263
	
#line 263
	allow xend_t device_t:dir { getattr search open };
#line 263
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 263

#line 263
	
#line 263
	allow xend_t device_t:dir { getattr search open };
#line 263
	allow xend_t device_t:lnk_file { getattr read };
#line 263

#line 263

#line 263
	 	
#line 263
##### end dev_list_all_dev_nodes(xend_t) depth: 1
#line 263
 	
#line 263
	allow xend_t tun_tap_device_t:chr_file { getattr open read write append ioctl lock };
#line 263

#line 263
	 	
#line 263
##### end corenet_rw_tun_tap_dev(xend_t) depth: 0
#line 263
 	

 	 	
#line 265
##### begin dev_getattr_all_chr_files(xend_t) depth: 1
#line 265
 	
#line 265
	
#line 265
	
#line 265
		require {
#line 265
			
#line 265
		attribute device_node;
#line 265
	
#line 265
		} # end require
#line 265
	
#line 265

#line 265

#line 265
	
#line 265
	allow xend_t device_t:dir { getattr search open };
#line 265
	allow xend_t device_node:chr_file { getattr };
#line 265

#line 265

#line 265
	 	
#line 265
##### end dev_getattr_all_chr_files(xend_t) depth: 0
#line 265
 	
 	 	
#line 266
##### begin dev_read_urand(xend_t) depth: 1
#line 266
 	
#line 266
	
#line 266
	
#line 266
		require {
#line 266
			
#line 266
		type device_t, urandom_device_t;
#line 266
	
#line 266
		} # end require
#line 266
	
#line 266

#line 266

#line 266
	
#line 266
	allow xend_t device_t:dir { getattr search open };
#line 266
	allow xend_t urandom_device_t:chr_file { getattr open read lock ioctl };
#line 266

#line 266

#line 266
	 	
#line 266
##### end dev_read_urand(xend_t) depth: 0
#line 266
 	
 	 	
#line 267
##### begin dev_filetrans_xen(xend_t) depth: 1
#line 267
 	
#line 267
	
#line 267
	
#line 267
		require {
#line 267
			
#line 267
		type device_t, xen_device_t;
#line 267
	
#line 267
		} # end require
#line 267
	
#line 267

#line 267

#line 267
	
#line 267
	allow xend_t device_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 267
	type_transition xend_t device_t:chr_file xen_device_t ;
#line 267

#line 267

#line 267
	 	
#line 267
##### end dev_filetrans_xen(xend_t) depth: 0
#line 267
 	
 	 	
#line 268
##### begin dev_rw_sysfs(xend_t) depth: 1
#line 268
 	
#line 268
	
#line 268
	
#line 268
		require {
#line 268
			
#line 268
		type sysfs_t;
#line 268
	
#line 268
		} # end require
#line 268
	
#line 268

#line 268

#line 268
	
#line 268
	allow xend_t sysfs_t:dir { getattr search open };
#line 268
	allow xend_t sysfs_t:file { getattr open read write append ioctl lock };
#line 268

#line 268
	
#line 268
	allow xend_t sysfs_t:dir { getattr search open };
#line 268
	allow xend_t sysfs_t:lnk_file { getattr read };
#line 268

#line 268

#line 268
	
#line 268
	allow xend_t sysfs_t:dir { getattr search open };
#line 268
	allow xend_t sysfs_t:dir { getattr search open read lock ioctl };
#line 268

#line 268

#line 268
	 	
#line 268
##### end dev_rw_sysfs(xend_t) depth: 0
#line 268
 	
 	 	
#line 269
##### begin dev_rw_xen(xend_t) depth: 1
#line 269
 	
#line 269
	
#line 269
	
#line 269
		require {
#line 269
			
#line 269
		type device_t, xen_device_t;
#line 269
	
#line 269
		} # end require
#line 269
	
#line 269

#line 269

#line 269
	
#line 269
	allow xend_t device_t:dir { getattr search open };
#line 269
	allow xend_t xen_device_t:chr_file { getattr open read write append ioctl lock };
#line 269

#line 269

#line 269
	 	
#line 269
##### end dev_rw_xen(xend_t) depth: 0
#line 269
 	

 	 	
#line 271
##### begin domain_dontaudit_read_all_domains_state(xend_t) depth: 1
#line 271
 	
#line 271
	
#line 271
	
#line 271
		require {
#line 271
			
#line 271
		attribute domain;
#line 271
	
#line 271
		} # end require
#line 271
	
#line 271

#line 271

#line 271
	dontaudit xend_t domain:dir { getattr search open read lock ioctl };
#line 271
	dontaudit xend_t domain:lnk_file { getattr read };
#line 271
	dontaudit xend_t domain:file { getattr open read lock ioctl };
#line 271

#line 271
	# cjp: these should be removed:
#line 271
	dontaudit xend_t domain:sock_file { getattr open read };
#line 271
	dontaudit xend_t domain:fifo_file { getattr open read lock ioctl };
#line 271

#line 271
	 	
#line 271
##### end domain_dontaudit_read_all_domains_state(xend_t) depth: 0
#line 271
 	
 	 	
#line 272
##### begin domain_dontaudit_ptrace_all_domains(xend_t) depth: 1
#line 272
 	
#line 272
	
#line 272
	
#line 272
		require {
#line 272
			
#line 272
		attribute domain;
#line 272
	
#line 272
		} # end require
#line 272
	
#line 272

#line 272

#line 272
	dontaudit xend_t domain:process ptrace;
#line 272

#line 272
	 	
#line 272
##### end domain_dontaudit_ptrace_all_domains(xend_t) depth: 0
#line 272
 	

 	 	
#line 274
##### begin files_read_etc_files(xend_t) depth: 1
#line 274
 	
#line 274
	
#line 274
	
#line 274
		require {
#line 274
			
#line 274
		type etc_t;
#line 274
	
#line 274
		} # end require
#line 274
	
#line 274

#line 274

#line 274
	allow xend_t etc_t:dir { getattr search open read lock ioctl };
#line 274
	
#line 274
	allow xend_t etc_t:dir { getattr search open };
#line 274
	allow xend_t etc_t:file { getattr open read lock ioctl };
#line 274

#line 274
	
#line 274
	allow xend_t etc_t:dir { getattr search open };
#line 274
	allow xend_t etc_t:lnk_file { getattr read };
#line 274

#line 274

#line 274
	 	
#line 274
##### end files_read_etc_files(xend_t) depth: 0
#line 274
 	
 	 	
#line 275
##### begin files_read_kernel_symbol_table(xend_t) depth: 1
#line 275
 	
#line 275
	
#line 275
	
#line 275
		require {
#line 275
			
#line 275
		type boot_t, system_map_t;
#line 275
	
#line 275
		} # end require
#line 275
	
#line 275

#line 275

#line 275
	allow xend_t boot_t:dir { getattr search open read lock ioctl };
#line 275
	
#line 275
	allow xend_t boot_t:dir { getattr search open };
#line 275
	allow xend_t system_map_t:file { getattr open read lock ioctl };
#line 275

#line 275

#line 275
	 	
#line 275
##### end files_read_kernel_symbol_table(xend_t) depth: 0
#line 275
 	
 	 	
#line 276
##### begin files_read_kernel_img(xend_t) depth: 1
#line 276
 	
#line 276
	
#line 276
	
#line 276
		require {
#line 276
			
#line 276
		type boot_t;
#line 276
	
#line 276
		} # end require
#line 276
	
#line 276

#line 276

#line 276
	allow xend_t boot_t:dir { getattr search open read lock ioctl };
#line 276
	
#line 276
	allow xend_t boot_t:dir { getattr search open };
#line 276
	allow xend_t boot_t:file { getattr open read lock ioctl };
#line 276

#line 276
	
#line 276
	allow xend_t boot_t:dir { getattr search open };
#line 276
	allow xend_t boot_t:lnk_file { getattr read };
#line 276

#line 276

#line 276
	 	
#line 276
##### end files_read_kernel_img(xend_t) depth: 0
#line 276
 	
 	 	
#line 277
##### begin files_manage_etc_runtime_files(xend_t) depth: 1
#line 277
 	
#line 277
	
#line 277
	
#line 277
		require {
#line 277
			
#line 277
		type etc_t, etc_runtime_t;
#line 277
	
#line 277
		} # end require
#line 277
	
#line 277

#line 277

#line 277
	
#line 277
	allow xend_t { etc_t etc_runtime_t }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 277
	allow xend_t etc_runtime_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 277

#line 277

#line 277
	 	
#line 277
##### end files_manage_etc_runtime_files(xend_t) depth: 0
#line 277
 	
 	 	
#line 278
##### begin files_etc_filetrans_etc_runtime(xend_t,file) depth: 1
#line 278
 	
#line 278
	
#line 278
	
#line 278
		require {
#line 278
			
#line 278
		type etc_t, etc_runtime_t;
#line 278
	
#line 278
		} # end require
#line 278
	
#line 278

#line 278

#line 278
	
#line 278
	allow xend_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 278
	type_transition xend_t etc_t:file etc_runtime_t ;
#line 278

#line 278

#line 278
	 	
#line 278
##### end files_etc_filetrans_etc_runtime(xend_t,file) depth: 0
#line 278
 	
 	 	
#line 279
##### begin files_read_usr_files(xend_t) depth: 1
#line 279
 	
#line 279
	
#line 279
	
#line 279
		require {
#line 279
			
#line 279
		type usr_t;
#line 279
	
#line 279
		} # end require
#line 279
	
#line 279

#line 279

#line 279
	allow xend_t usr_t:dir { getattr search open read lock ioctl };
#line 279
	
#line 279
	allow xend_t usr_t:dir { getattr search open };
#line 279
	allow xend_t usr_t:file { getattr open read lock ioctl };
#line 279

#line 279
	
#line 279
	allow xend_t usr_t:dir { getattr search open };
#line 279
	allow xend_t usr_t:lnk_file { getattr read };
#line 279

#line 279

#line 279
	 	
#line 279
##### end files_read_usr_files(xend_t) depth: 0
#line 279
 	
 	 	
#line 280
##### begin files_read_default_symlinks(xend_t) depth: 1
#line 280
 	
#line 280
	
#line 280
	
#line 280
		require {
#line 280
			
#line 280
		type default_t;
#line 280
	
#line 280
		} # end require
#line 280
	
#line 280

#line 280

#line 280
	allow xend_t default_t:lnk_file { getattr read };
#line 280

#line 280
	 	
#line 280
##### end files_read_default_symlinks(xend_t) depth: 0
#line 280
 	
 	 	
#line 281
##### begin files_search_mnt(xend_t) depth: 1
#line 281
 	
#line 281
	
#line 281
	
#line 281
		require {
#line 281
			
#line 281
		type mnt_t;
#line 281
	
#line 281
		} # end require
#line 281
	
#line 281

#line 281

#line 281
	allow xend_t mnt_t:dir { getattr search open };
#line 281

#line 281
	 	
#line 281
##### end files_search_mnt(xend_t) depth: 0
#line 281
 	

 	 	
#line 283
##### begin fs_getattr_all_fs(xend_t) depth: 1
#line 283
 	
#line 283
	
#line 283
	
#line 283
		require {
#line 283
			
#line 283
		attribute filesystem_type;
#line 283
	
#line 283
		} # end require
#line 283
	
#line 283

#line 283

#line 283
	allow xend_t filesystem_type:filesystem getattr;
#line 283
	 	 	
#line 283
##### begin files_getattr_all_file_type_fs(xend_t) depth: 2
#line 283
 	
#line 283
	
#line 283
	
#line 283
		require {
#line 283
			
#line 283
		attribute file_type;
#line 283
	
#line 283
		} # end require
#line 283
	
#line 283

#line 283

#line 283
	allow xend_t file_type:filesystem getattr;
#line 283

#line 283
	 	
#line 283
##### end files_getattr_all_file_type_fs(xend_t) depth: 1
#line 283
 	
#line 283

#line 283
	 	
#line 283
##### end fs_getattr_all_fs(xend_t) depth: 0
#line 283
 	
 	 	
#line 284
##### begin fs_list_auto_mountpoints(xend_t) depth: 1
#line 284
 	
#line 284
	
#line 284
	
#line 284
		require {
#line 284
			
#line 284
		type autofs_t;
#line 284
	
#line 284
		} # end require
#line 284
	
#line 284

#line 284

#line 284
	allow xend_t autofs_t:dir { getattr search open read lock ioctl };
#line 284

#line 284
	 	
#line 284
##### end fs_list_auto_mountpoints(xend_t) depth: 0
#line 284
 	
 	 	
#line 285
##### begin fs_read_dos_files(xend_t) depth: 1
#line 285
 	
#line 285
	
#line 285
	
#line 285
		require {
#line 285
			
#line 285
		type dosfs_t;
#line 285
	
#line 285
		} # end require
#line 285
	
#line 285

#line 285

#line 285
	
#line 285
	allow xend_t dosfs_t:dir { getattr search open };
#line 285
	allow xend_t dosfs_t:file { getattr open read lock ioctl };
#line 285

#line 285

#line 285
	 	
#line 285
##### end fs_read_dos_files(xend_t) depth: 0
#line 285
 	
 	 	
#line 286
##### begin fs_read_removable_blk_files(xend_t) depth: 1
#line 286
 	
#line 286
	
#line 286
	
#line 286
		require {
#line 286
			
#line 286
		type removable_t;
#line 286
	
#line 286
		} # end require
#line 286
	
#line 286

#line 286

#line 286
	allow xend_t removable_t:dir { getattr search open read lock ioctl };
#line 286
	
#line 286
	allow xend_t removable_t:dir { getattr search open };
#line 286
	allow xend_t removable_t:blk_file { getattr open read lock ioctl };
#line 286

#line 286

#line 286
	 	
#line 286
##### end fs_read_removable_blk_files(xend_t) depth: 0
#line 286
 	
 	 	
#line 287
##### begin fs_manage_xenfs_dirs(xend_t) depth: 1
#line 287
 	
#line 287
	
#line 287
	
#line 287
		require {
#line 287
			
#line 287
		type xenfs_t;
#line 287
	
#line 287
		} # end require
#line 287
	
#line 287

#line 287

#line 287
	allow xend_t xenfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 287

#line 287
	 	
#line 287
##### end fs_manage_xenfs_dirs(xend_t) depth: 0
#line 287
 	
 	 	
#line 288
##### begin fs_manage_xenfs_files(xend_t) depth: 1
#line 288
 	
#line 288
	
#line 288
	
#line 288
		require {
#line 288
			
#line 288
		type xenfs_t;
#line 288
	
#line 288
		} # end require
#line 288
	
#line 288

#line 288

#line 288
	
#line 288
	allow xend_t xenfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 288
	allow xend_t xenfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 288

#line 288

#line 288
	 	
#line 288
##### end fs_manage_xenfs_files(xend_t) depth: 0
#line 288
 	

 	 	
#line 290
##### begin storage_read_scsi_generic(xend_t) depth: 1
#line 290
 	
#line 290
	
#line 290
	
#line 290
		require {
#line 290
			
#line 290
		attribute scsi_generic_read;
#line 290
		type scsi_generic_device_t;
#line 290
	
#line 290
		} # end require
#line 290
	
#line 290

#line 290

#line 290
	 	 	
#line 290
##### begin dev_list_all_dev_nodes(xend_t) depth: 2
#line 290
 	
#line 290
	
#line 290
	
#line 290
		require {
#line 290
			
#line 290
		type device_t;
#line 290
	
#line 290
		} # end require
#line 290
	
#line 290

#line 290

#line 290
	
#line 290
	allow xend_t device_t:dir { getattr search open };
#line 290
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 290

#line 290
	
#line 290
	allow xend_t device_t:dir { getattr search open };
#line 290
	allow xend_t device_t:lnk_file { getattr read };
#line 290

#line 290

#line 290
	 	
#line 290
##### end dev_list_all_dev_nodes(xend_t) depth: 1
#line 290
 	
#line 290
	allow xend_t scsi_generic_device_t:chr_file { getattr open read lock ioctl };
#line 290
	typeattribute xend_t scsi_generic_read;
#line 290

#line 290
	 	
#line 290
##### end storage_read_scsi_generic(xend_t) depth: 0
#line 290
 	

 	 	
#line 292
##### begin term_setattr_generic_ptys(xend_t) depth: 1
#line 292
 	
#line 292
	
#line 292
	
#line 292
		require {
#line 292
			
#line 292
		type devpts_t;
#line 292
	
#line 292
		} # end require
#line 292
	
#line 292

#line 292

#line 292
	allow xend_t devpts_t:chr_file setattr;
#line 292

#line 292
	 	
#line 292
##### end term_setattr_generic_ptys(xend_t) depth: 0
#line 292
 	
 	 	
#line 293
##### begin term_getattr_all_ptys(xend_t) depth: 1
#line 293
 	
#line 293
	
#line 293
	
#line 293
		require {
#line 293
			
#line 293
		attribute ptynode;
#line 293
		type devpts_t;
#line 293
	
#line 293
		} # end require
#line 293
	
#line 293

#line 293

#line 293
	 	 	
#line 293
##### begin dev_list_all_dev_nodes(xend_t) depth: 2
#line 293
 	
#line 293
	
#line 293
	
#line 293
		require {
#line 293
			
#line 293
		type device_t;
#line 293
	
#line 293
		} # end require
#line 293
	
#line 293

#line 293

#line 293
	
#line 293
	allow xend_t device_t:dir { getattr search open };
#line 293
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 293

#line 293
	
#line 293
	allow xend_t device_t:dir { getattr search open };
#line 293
	allow xend_t device_t:lnk_file { getattr read };
#line 293

#line 293

#line 293
	 	
#line 293
##### end dev_list_all_dev_nodes(xend_t) depth: 1
#line 293
 	
#line 293
	allow xend_t devpts_t:dir { getattr search open read lock ioctl };
#line 293
	allow xend_t ptynode:chr_file getattr;
#line 293

#line 293
	 	
#line 293
##### end term_getattr_all_ptys(xend_t) depth: 0
#line 293
 	
 	 	
#line 294
##### begin term_setattr_all_ptys(xend_t) depth: 1
#line 294
 	
#line 294
	
#line 294
	
#line 294
		require {
#line 294
			
#line 294
		attribute ptynode;
#line 294
		type devpts_t;
#line 294
	
#line 294
		} # end require
#line 294
	
#line 294

#line 294

#line 294
	 	 	
#line 294
##### begin dev_list_all_dev_nodes(xend_t) depth: 2
#line 294
 	
#line 294
	
#line 294
	
#line 294
		require {
#line 294
			
#line 294
		type device_t;
#line 294
	
#line 294
		} # end require
#line 294
	
#line 294

#line 294

#line 294
	
#line 294
	allow xend_t device_t:dir { getattr search open };
#line 294
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 294

#line 294
	
#line 294
	allow xend_t device_t:dir { getattr search open };
#line 294
	allow xend_t device_t:lnk_file { getattr read };
#line 294

#line 294

#line 294
	 	
#line 294
##### end dev_list_all_dev_nodes(xend_t) depth: 1
#line 294
 	
#line 294
	allow xend_t devpts_t:dir { getattr search open read lock ioctl };
#line 294
	allow xend_t ptynode:chr_file setattr;
#line 294

#line 294
	 	
#line 294
##### end term_setattr_all_ptys(xend_t) depth: 0
#line 294
 	
 	 	
#line 295
##### begin term_use_generic_ptys(xend_t) depth: 1
#line 295
 	
#line 295
	
#line 295
	
#line 295
		require {
#line 295
			
#line 295
		type devpts_t;
#line 295
	
#line 295
		} # end require
#line 295
	
#line 295

#line 295

#line 295
	 	 	
#line 295
##### begin dev_list_all_dev_nodes(xend_t) depth: 2
#line 295
 	
#line 295
	
#line 295
	
#line 295
		require {
#line 295
			
#line 295
		type device_t;
#line 295
	
#line 295
		} # end require
#line 295
	
#line 295

#line 295

#line 295
	
#line 295
	allow xend_t device_t:dir { getattr search open };
#line 295
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 295

#line 295
	
#line 295
	allow xend_t device_t:dir { getattr search open };
#line 295
	allow xend_t device_t:lnk_file { getattr read };
#line 295

#line 295

#line 295
	 	
#line 295
##### end dev_list_all_dev_nodes(xend_t) depth: 1
#line 295
 	
#line 295
	allow xend_t devpts_t:dir { getattr search open read lock ioctl };
#line 295
	allow xend_t devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 295

#line 295
	 	
#line 295
##### end term_use_generic_ptys(xend_t) depth: 0
#line 295
 	
 	 	
#line 296
##### begin term_use_ptmx(xend_t) depth: 1
#line 296
 	
#line 296
	
#line 296
	
#line 296
		require {
#line 296
			
#line 296
		type ptmx_t;
#line 296
	
#line 296
		} # end require
#line 296
	
#line 296

#line 296

#line 296
	 	 	
#line 296
##### begin dev_list_all_dev_nodes(xend_t) depth: 2
#line 296
 	
#line 296
	
#line 296
	
#line 296
		require {
#line 296
			
#line 296
		type device_t;
#line 296
	
#line 296
		} # end require
#line 296
	
#line 296

#line 296

#line 296
	
#line 296
	allow xend_t device_t:dir { getattr search open };
#line 296
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 296

#line 296
	
#line 296
	allow xend_t device_t:dir { getattr search open };
#line 296
	allow xend_t device_t:lnk_file { getattr read };
#line 296

#line 296

#line 296
	 	
#line 296
##### end dev_list_all_dev_nodes(xend_t) depth: 1
#line 296
 	
#line 296
	allow xend_t ptmx_t:chr_file { getattr open read write append ioctl lock };
#line 296

#line 296
	 	
#line 296
##### end term_use_ptmx(xend_t) depth: 0
#line 296
 	
 	 	
#line 297
##### begin term_getattr_pty_fs(xend_t) depth: 1
#line 297
 	
#line 297
	
#line 297
	
#line 297
		require {
#line 297
			
#line 297
		type devpts_t;
#line 297
	
#line 297
		} # end require
#line 297
	
#line 297

#line 297

#line 297
	allow xend_t devpts_t:filesystem getattr;
#line 297

#line 297
	 	
#line 297
##### end term_getattr_pty_fs(xend_t) depth: 0
#line 297
 	

 	 	
#line 299
##### begin init_stream_connect_script(xend_t) depth: 1
#line 299
 	
#line 299
	
#line 299
	
#line 299
		require {
#line 299
			
#line 299
		type initrc_t;
#line 299
	
#line 299
		} # end require
#line 299
	
#line 299

#line 299

#line 299
	allow xend_t initrc_t:unix_stream_socket connectto;
#line 299

#line 299
	 	
#line 299
##### end init_stream_connect_script(xend_t) depth: 0
#line 299
 	

 	 	
#line 301
##### begin locallogin_dontaudit_use_fds(xend_t) depth: 1
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type local_login_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	dontaudit xend_t local_login_t:fd use;
#line 301

#line 301
	 	
#line 301
##### end locallogin_dontaudit_use_fds(xend_t) depth: 0
#line 301
 	

 	 	
#line 303
##### begin logging_send_syslog_msg(xend_t) depth: 1
#line 303
 	
#line 303
	
#line 303
	
#line 303
		require {
#line 303
			
#line 303
		type syslogd_t, syslogd_var_run_t, devlog_t;
#line 303
	
#line 303
		} # end require
#line 303
	
#line 303

#line 303

#line 303
	allow xend_t devlog_t:sock_file { getattr write open append };
#line 303

#line 303
	# systemd journal socket is in /run/systemd/journal/dev-log
#line 303
	 	 	
#line 303
##### begin init_search_run(xend_t) depth: 2
#line 303
 	
#line 303
	
#line 303
	
#line 303
		require {
#line 303
			
#line 303
		type init_var_run_t;
#line 303
	
#line 303
		} # end require
#line 303
	
#line 303

#line 303

#line 303
	 	 	
#line 303
##### begin files_search_pids(xend_t) depth: 3
#line 303
 	
#line 303
	
#line 303
	
#line 303
		require {
#line 303
			
#line 303
		type var_t, var_run_t;
#line 303
	
#line 303
		} # end require
#line 303
	
#line 303

#line 303

#line 303
	allow xend_t var_run_t:lnk_file { getattr read };
#line 303
	
#line 303
	allow xend_t var_t:dir { getattr search open };
#line 303
	allow xend_t var_run_t:dir { getattr search open };
#line 303

#line 303

#line 303
	 	
#line 303
##### end files_search_pids(xend_t) depth: 2
#line 303
 	
#line 303
	allow xend_t init_var_run_t:dir { getattr search open };
#line 303

#line 303
	 	
#line 303
##### end init_search_run(xend_t) depth: 1
#line 303
 	
#line 303
	allow xend_t syslogd_var_run_t:dir { getattr search open };
#line 303

#line 303
	# the type of socket depends on the syslog daemon
#line 303
	allow xend_t syslogd_t:unix_dgram_socket sendto;
#line 303
	allow xend_t syslogd_t:unix_stream_socket connectto;
#line 303
	allow xend_t self:unix_dgram_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 303
	allow xend_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 303

#line 303
	# If syslog is down, the glibc syslog() function
#line 303
	# will write to the console.
#line 303
	 	 	
#line 303
##### begin term_write_console(xend_t) depth: 2
#line 303
 	
#line 303
	
#line 303
	
#line 303
		require {
#line 303
			
#line 303
		type console_device_t;
#line 303
	
#line 303
		} # end require
#line 303
	
#line 303

#line 303

#line 303
	 	 	
#line 303
##### begin dev_list_all_dev_nodes(xend_t) depth: 3
#line 303
 	
#line 303
	
#line 303
	
#line 303
		require {
#line 303
			
#line 303
		type device_t;
#line 303
	
#line 303
		} # end require
#line 303
	
#line 303

#line 303

#line 303
	
#line 303
	allow xend_t device_t:dir { getattr search open };
#line 303
	allow xend_t device_t:dir { getattr search open read lock ioctl };
#line 303

#line 303
	
#line 303
	allow xend_t device_t:dir { getattr search open };
#line 303
	allow xend_t device_t:lnk_file { getattr read };
#line 303

#line 303

#line 303
	 	
#line 303
##### end dev_list_all_dev_nodes(xend_t) depth: 2
#line 303
 	
#line 303
	allow xend_t console_device_t:chr_file { getattr open write append lock ioctl };
#line 303

#line 303
	 	
#line 303
##### end term_write_console(xend_t) depth: 1
#line 303
 	
#line 303
	 	 	
#line 303
##### begin term_dontaudit_read_console(xend_t) depth: 2
#line 303
 	
#line 303
	
#line 303
	
#line 303
		require {
#line 303
			
#line 303
		type console_device_t;
#line 303
	
#line 303
		} # end require
#line 303
	
#line 303

#line 303

#line 303
	dontaudit xend_t console_device_t:chr_file { getattr open read lock ioctl };
#line 303

#line 303
	 	
#line 303
##### end term_dontaudit_read_console(xend_t) depth: 1
#line 303
 	
#line 303

#line 303
	# because systemd is now using /run/systemd/journal/dev-log
#line 303
	 	 	
#line 303
##### begin init_search_pid_dirs(xend_t) depth: 2
#line 303
 	
#line 303
    
#line 303
	
#line 303
		require {
#line 303
			
#line 303
        type init_var_run_t;
#line 303
    
#line 303
		} # end require
#line 303
	
#line 303

#line 303

#line 303
    allow xend_t init_var_run_t:dir { getattr search open };
#line 303

#line 303
	 	
#line 303
##### end init_search_pid_dirs(xend_t) depth: 1
#line 303
 	
#line 303

#line 303
	 	
#line 303
##### end logging_send_syslog_msg(xend_t) depth: 0
#line 303
 	

 	 	
#line 305
##### begin miscfiles_read_localization(xend_t) depth: 1
#line 305
 	
#line 305
	
#line 305
	
#line 305
		require {
#line 305
			
#line 305
		type locale_t;
#line 305
	
#line 305
		} # end require
#line 305
	
#line 305

#line 305

#line 305
	 	 	
#line 305
##### begin files_read_etc_symlinks(xend_t) depth: 2
#line 305
 	
#line 305
	
#line 305
	
#line 305
		require {
#line 305
			
#line 305
		type etc_t;
#line 305
	
#line 305
		} # end require
#line 305
	
#line 305

#line 305

#line 305
	
#line 305
	allow xend_t etc_t:dir { getattr search open };
#line 305
	allow xend_t etc_t:lnk_file { getattr read };
#line 305

#line 305

#line 305
	 	
#line 305
##### end files_read_etc_symlinks(xend_t) depth: 1
#line 305
 	
#line 305
	 	 	
#line 305
##### begin files_search_usr(xend_t) depth: 2
#line 305
 	
#line 305
	
#line 305
	
#line 305
		require {
#line 305
			
#line 305
		type usr_t;
#line 305
	
#line 305
		} # end require
#line 305
	
#line 305

#line 305

#line 305
	allow xend_t usr_t:dir { getattr search open };
#line 305

#line 305
	 	
#line 305
##### end files_search_usr(xend_t) depth: 1
#line 305
 	
#line 305
	allow xend_t locale_t:dir { getattr search open read lock ioctl };
#line 305
	
#line 305
	allow xend_t locale_t:dir { getattr search open };
#line 305
	allow xend_t locale_t:file { getattr open read lock ioctl };
#line 305

#line 305
	
#line 305
	allow xend_t locale_t:dir { getattr search open };
#line 305
	allow xend_t locale_t:lnk_file { getattr read };
#line 305

#line 305

#line 305
	 	
#line 305
##### end miscfiles_read_localization(xend_t) depth: 0
#line 305
 	
 	 	
#line 306
##### begin miscfiles_read_hwdata(xend_t) depth: 1
#line 306
 	
#line 306
	
#line 306
	
#line 306
		require {
#line 306
			
#line 306
		type hwdata_t;
#line 306
	
#line 306
		} # end require
#line 306
	
#line 306

#line 306

#line 306
	allow xend_t hwdata_t:dir { getattr search open read lock ioctl };
#line 306
	
#line 306
	allow xend_t hwdata_t:dir { getattr search open };
#line 306
	allow xend_t hwdata_t:file { getattr open read lock ioctl };
#line 306

#line 306
	
#line 306
	allow xend_t hwdata_t:dir { getattr search open };
#line 306
	allow xend_t hwdata_t:lnk_file { getattr read };
#line 306

#line 306

#line 306
	 	
#line 306
##### end miscfiles_read_hwdata(xend_t) depth: 0
#line 306
 	

 	 	
#line 308
##### begin sysnet_domtrans_dhcpc(xend_t) depth: 1
#line 308
 	
#line 308
	
#line 308
	
#line 308
		require {
#line 308
			
#line 308
		type dhcpc_t, dhcpc_exec_t;
#line 308
	
#line 308
		} # end require
#line 308
	
#line 308

#line 308

#line 308
	 	 	
#line 308
##### begin corecmd_search_bin(xend_t) depth: 2
#line 308
 	
#line 308
	
#line 308
	
#line 308
		require {
#line 308
			
#line 308
		type bin_t;
#line 308
	
#line 308
		} # end require
#line 308
	
#line 308

#line 308

#line 308
	
#line 308
	allow xend_t bin_t:dir { getattr search open };
#line 308
	allow xend_t bin_t:dir { getattr search open };
#line 308

#line 308

#line 308
	 	
#line 308
##### end corecmd_search_bin(xend_t) depth: 1
#line 308
 	
#line 308
	
#line 308
	
#line 308
	
#line 308
	allow xend_t dhcpc_exec_t:file { getattr open read execute };
#line 308
	allow xend_t dhcpc_t:process transition;
#line 308
	dontaudit xend_t dhcpc_t:process { noatsecure siginh rlimitinh };
#line 308

#line 308
	type_transition xend_t dhcpc_exec_t:process dhcpc_t;
#line 308

#line 308

#line 308
	allow dhcpc_t xend_t:fd use;
#line 308
	allow dhcpc_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 308
	allow dhcpc_t xend_t:process sigchld;
#line 308

#line 308

#line 308
	 	
#line 308
##### end sysnet_domtrans_dhcpc(xend_t) depth: 0
#line 308
 	
 	 	
#line 309
##### begin sysnet_signal_dhcpc(xend_t) depth: 1
#line 309
 	
#line 309
	
#line 309
	
#line 309
		require {
#line 309
			
#line 309
		type dhcpc_t;
#line 309
	
#line 309
		} # end require
#line 309
	
#line 309

#line 309

#line 309
	allow xend_t dhcpc_t:process signal;
#line 309

#line 309
	 	
#line 309
##### end sysnet_signal_dhcpc(xend_t) depth: 0
#line 309
 	
 	 	
#line 310
##### begin sysnet_domtrans_ifconfig(xend_t) depth: 1
#line 310
 	
#line 310
	
#line 310
	
#line 310
		require {
#line 310
			
#line 310
		type ifconfig_t, ifconfig_exec_t;
#line 310
	
#line 310
		} # end require
#line 310
	
#line 310

#line 310

#line 310
	 	 	
#line 310
##### begin corecmd_search_bin(xend_t) depth: 2
#line 310
 	
#line 310
	
#line 310
	
#line 310
		require {
#line 310
			
#line 310
		type bin_t;
#line 310
	
#line 310
		} # end require
#line 310
	
#line 310

#line 310

#line 310
	
#line 310
	allow xend_t bin_t:dir { getattr search open };
#line 310
	allow xend_t bin_t:dir { getattr search open };
#line 310

#line 310

#line 310
	 	
#line 310
##### end corecmd_search_bin(xend_t) depth: 1
#line 310
 	
#line 310
	
#line 310
	
#line 310
	
#line 310
	allow xend_t ifconfig_exec_t:file { getattr open read execute };
#line 310
	allow xend_t ifconfig_t:process transition;
#line 310
	dontaudit xend_t ifconfig_t:process { noatsecure siginh rlimitinh };
#line 310

#line 310
	type_transition xend_t ifconfig_exec_t:process ifconfig_t;
#line 310

#line 310

#line 310
	allow ifconfig_t xend_t:fd use;
#line 310
	allow ifconfig_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 310
	allow ifconfig_t xend_t:process sigchld;
#line 310

#line 310

#line 310
	 	
#line 310
##### end sysnet_domtrans_ifconfig(xend_t) depth: 0
#line 310
 	
 	 	
#line 311
##### begin sysnet_dns_name_resolve(xend_t) depth: 1
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type net_conf_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t self:tcp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 311
	allow xend_t self:udp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 311
	allow xend_t self:netlink_route_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } nlmsg_read };
#line 311

#line 311
	 	 	
#line 311
##### begin corenet_all_recvfrom_unlabeled(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin kernel_tcp_recvfrom_unlabeled(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type unlabeled_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t unlabeled_t:tcp_socket recvfrom;
#line 311

#line 311
	 	
#line 311
##### end kernel_tcp_recvfrom_unlabeled(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin kernel_udp_recvfrom_unlabeled(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type unlabeled_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t unlabeled_t:udp_socket recvfrom;
#line 311

#line 311
	 	
#line 311
##### end kernel_udp_recvfrom_unlabeled(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin kernel_raw_recvfrom_unlabeled(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type unlabeled_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t unlabeled_t:rawip_socket recvfrom;
#line 311

#line 311
	 	
#line 311
##### end kernel_raw_recvfrom_unlabeled(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin kernel_recvfrom_unlabeled_peer(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type unlabeled_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t unlabeled_t:peer recv;
#line 311

#line 311
	 	
#line 311
##### end kernel_recvfrom_unlabeled_peer(xend_t) depth: 2
#line 311
 	
#line 311

#line 311
	# XXX - at some point the oubound/send access check will be removed
#line 311
	# but for right now we need to keep this in place so as not to break
#line 311
	# older systems
#line 311
	 	 	
#line 311
##### begin kernel_sendrecv_unlabeled_association(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type unlabeled_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t unlabeled_t:association { sendto recvfrom };
#line 311

#line 311
	 	
#line 311
##### end kernel_sendrecv_unlabeled_association(xend_t) depth: 2
#line 311
 	
#line 311

#line 311
	 	
#line 311
##### end corenet_all_recvfrom_unlabeled(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_all_recvfrom_netlabel(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type netlabel_peer_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t netlabel_peer_t:peer recv;
#line 311
	allow xend_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 311

#line 311
	 	
#line 311
##### end corenet_all_recvfrom_netlabel(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_tcp_sendrecv_generic_if(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type netif_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 311

#line 311
	 	
#line 311
##### end corenet_tcp_sendrecv_generic_if(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_sendrecv_generic_if(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_send_generic_if(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type netif_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t netif_t:netif { udp_send egress };
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_send_generic_if(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_receive_generic_if(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type netif_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t netif_t:netif { udp_recv ingress };
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_receive_generic_if(xend_t) depth: 2
#line 311
 	
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_sendrecv_generic_if(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_tcp_sendrecv_generic_node(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type node_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 311

#line 311
	 	
#line 311
##### end corenet_tcp_sendrecv_generic_node(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_sendrecv_generic_node(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_send_generic_node(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type node_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t node_t:node { udp_send sendto };
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_send_generic_node(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_receive_generic_node(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type node_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t node_t:node { udp_recv recvfrom };
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_receive_generic_node(xend_t) depth: 2
#line 311
 	
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_sendrecv_generic_node(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_tcp_sendrecv_dns_port(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type dns_port_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t dns_port_t:tcp_socket { send_msg recv_msg };
#line 311

#line 311
	 	
#line 311
##### end corenet_tcp_sendrecv_dns_port(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_sendrecv_dns_port(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_send_dns_port(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type dns_port_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t dns_port_t:udp_socket send_msg;
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_send_dns_port(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_udp_receive_dns_port(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type dns_port_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t dns_port_t:udp_socket recv_msg;
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_receive_dns_port(xend_t) depth: 2
#line 311
 	
#line 311

#line 311
	 	
#line 311
##### end corenet_udp_sendrecv_dns_port(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_tcp_connect_dns_port(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type dns_port_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t dns_port_t:tcp_socket name_connect;
#line 311

#line 311
	 	
#line 311
##### end corenet_tcp_connect_dns_port(xend_t) depth: 1
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_sendrecv_dns_client_packets(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_send_dns_client_packets(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type dns_client_packet_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t dns_client_packet_t:packet send;
#line 311

#line 311
	 	
#line 311
##### end corenet_send_dns_client_packets(xend_t) depth: 2
#line 311
 	
#line 311
	 	 	
#line 311
##### begin corenet_receive_dns_client_packets(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type dns_client_packet_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t dns_client_packet_t:packet recv;
#line 311

#line 311
	 	
#line 311
##### end corenet_receive_dns_client_packets(xend_t) depth: 2
#line 311
 	
#line 311

#line 311
	 	
#line 311
##### end corenet_sendrecv_dns_client_packets(xend_t) depth: 1
#line 311
 	
#line 311

#line 311
	 	 	
#line 311
##### begin sysnet_read_config(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type net_conf_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	 	 	
#line 311
##### begin files_search_etc(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type etc_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t etc_t:dir { getattr search open };
#line 311

#line 311
	 	
#line 311
##### end files_search_etc(xend_t) depth: 2
#line 311
 	
#line 311
	allow xend_t net_conf_t:file { getattr open read lock ioctl };
#line 311

#line 311
	
#line 311
		 	 	
#line 311
##### begin files_search_pids(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type var_t, var_run_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t var_run_t:lnk_file { getattr read };
#line 311
	
#line 311
	allow xend_t var_t:dir { getattr search open };
#line 311
	allow xend_t var_run_t:dir { getattr search open };
#line 311

#line 311

#line 311
	 	
#line 311
##### end files_search_pids(xend_t) depth: 2
#line 311
 	
#line 311
		allow xend_t net_conf_t:dir { getattr search open read lock ioctl };
#line 311
		
#line 311
	allow xend_t net_conf_t:dir { getattr search open };
#line 311
	allow xend_t net_conf_t:file { getattr open read lock ioctl };
#line 311

#line 311
	
#line 311

#line 311
	
#line 311

#line 311
	 	
#line 311
##### end sysnet_read_config(xend_t) depth: 1
#line 311
 	
#line 311

#line 311
	
#line 311
	optional {
#line 311
		
#line 311
		 	 	
#line 311
##### begin avahi_stream_connect(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type avahi_t, avahi_var_run_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	 	 	
#line 311
##### begin files_search_pids(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type var_t, var_run_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t var_run_t:lnk_file { getattr read };
#line 311
	
#line 311
	allow xend_t var_t:dir { getattr search open };
#line 311
	allow xend_t var_run_t:dir { getattr search open };
#line 311

#line 311

#line 311
	 	
#line 311
##### end files_search_pids(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	allow xend_t avahi_var_run_t:dir { getattr search open };
#line 311
	allow xend_t avahi_var_run_t:sock_file { getattr write open append };
#line 311
	allow xend_t avahi_t:unix_stream_socket connectto;
#line 311

#line 311

#line 311
	 	
#line 311
##### end avahi_stream_connect(xend_t) depth: 1
#line 311
 	
#line 311
	
#line 311
	} # end optional
#line 311

#line 311

#line 311
	
#line 311
	optional {
#line 311
		
#line 311
		 	 	
#line 311
##### begin nscd_use(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		
#line 311
bool nscd_use_shm;
#line 311

#line 311
  
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311
	if (nscd_use_shm) {
#line 311
		
#line 311
		 	 	
#line 311
##### begin nscd_shm_use(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type nscd_t, nscd_var_run_t;
#line 311
		class nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 311

#line 311
	allow xend_t nscd_t:nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 311
	allow xend_t nscd_t:fd use;
#line 311

#line 311
	 	 	
#line 311
##### begin files_search_pids(xend_t) depth: 4
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type var_t, var_run_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t var_run_t:lnk_file { getattr read };
#line 311
	
#line 311
	allow xend_t var_t:dir { getattr search open };
#line 311
	allow xend_t var_run_t:dir { getattr search open };
#line 311

#line 311

#line 311
	 	
#line 311
##### end files_search_pids(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	allow xend_t nscd_var_run_t:dir { getattr search open };
#line 311
	allow xend_t nscd_var_run_t:sock_file { getattr write open append };
#line 311
	allow xend_t nscd_t:unix_stream_socket connectto;
#line 311

#line 311
	dontaudit xend_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 311

#line 311
	allow xend_t nscd_var_run_t:dir { getattr search open read lock ioctl };
#line 311
	allow xend_t nscd_var_run_t:sock_file { getattr open read };
#line 311

#line 311
	 	
#line 311
##### end nscd_shm_use(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	} else {
#line 311
		
#line 311
		 	 	
#line 311
##### begin nscd_socket_use(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type nscd_t, nscd_var_run_t;
#line 311
		class nscd { getserv getpwd getgrp gethost shmempwd shmemgrp shmemhost shmemserv };
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 311

#line 311
	allow xend_t nscd_t:nscd { getpwd getgrp gethost };
#line 311

#line 311
	dontaudit xend_t nscd_t:fd use;
#line 311
	dontaudit xend_t nscd_t:nscd { getserv shmempwd shmemgrp shmemhost shmemserv };
#line 311

#line 311
	 	 	
#line 311
##### begin files_search_pids(xend_t) depth: 4
#line 311
 	
#line 311
	
#line 311
	
#line 311
		require {
#line 311
			
#line 311
		type var_t, var_run_t;
#line 311
	
#line 311
		} # end require
#line 311
	
#line 311

#line 311

#line 311
	allow xend_t var_run_t:lnk_file { getattr read };
#line 311
	
#line 311
	allow xend_t var_t:dir { getattr search open };
#line 311
	allow xend_t var_run_t:dir { getattr search open };
#line 311

#line 311

#line 311
	 	
#line 311
##### end files_search_pids(xend_t) depth: 3
#line 311
 	
#line 311
	
#line 311
	allow xend_t nscd_var_run_t:dir { getattr search open };
#line 311
	allow xend_t nscd_var_run_t:sock_file { getattr write open append };
#line 311
	allow xend_t nscd_t:unix_stream_socket connectto;
#line 311

#line 311
	dontaudit xend_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 311

#line 311
	
#line 311
	allow nscd_t xend_t:dir { getattr search open read lock ioctl };
#line 311
	allow nscd_t xend_t:file { getattr open read lock ioctl };
#line 311
	allow nscd_t xend_t:lnk_file { getattr read };
#line 311
	allow nscd_t xend_t:process getattr;
#line 311

#line 311

#line 311
	 	
#line 311
##### end nscd_socket_use(xend_t) depth: 2
#line 311
 	
#line 311
	
#line 311
	}
#line 311

#line 311

#line 311
	 	
#line 311
##### end nscd_use(xend_t) depth: 1
#line 311
 	
#line 311
	
#line 311
	} # end optional
#line 311

#line 311

#line 311
	 	
#line 311
##### end sysnet_dns_name_resolve(xend_t) depth: 0
#line 311
 	
 	 	
#line 312
##### begin sysnet_delete_dhcpc_pid(xend_t) depth: 1
#line 312
 	
#line 312
	
#line 312
	
#line 312
		require {
#line 312
			
#line 312
		type dhcpc_var_run_t;
#line 312
	
#line 312
		} # end require
#line 312
	
#line 312

#line 312

#line 312
	allow xend_t dhcpc_var_run_t:file unlink;
#line 312

#line 312
	 	
#line 312
##### end sysnet_delete_dhcpc_pid(xend_t) depth: 0
#line 312
 	
 	 	
#line 313
##### begin sysnet_read_dhcpc_pid(xend_t) depth: 1
#line 313
 	
#line 313
	
#line 313
	
#line 313
		require {
#line 313
			
#line 313
		type dhcpc_var_run_t;
#line 313
	
#line 313
		} # end require
#line 313
	
#line 313

#line 313

#line 313
	 	 	
#line 313
##### begin files_list_pids(xend_t) depth: 2
#line 313
 	
#line 313
	
#line 313
	
#line 313
		require {
#line 313
			
#line 313
		type var_t, var_run_t;
#line 313
	
#line 313
		} # end require
#line 313
	
#line 313

#line 313

#line 313
	allow xend_t var_run_t:lnk_file { getattr read };
#line 313
	
#line 313
	allow xend_t var_t:dir { getattr search open };
#line 313
	allow xend_t var_run_t:dir { getattr search open read lock ioctl };
#line 313

#line 313

#line 313
	 	
#line 313
##### end files_list_pids(xend_t) depth: 1
#line 313
 	
#line 313
	allow xend_t dhcpc_var_run_t:file { getattr open read lock ioctl };
#line 313

#line 313
	 	
#line 313
##### end sysnet_read_dhcpc_pid(xend_t) depth: 0
#line 313
 	
 	 	
#line 314
##### begin sysnet_rw_dhcp_config(xend_t) depth: 1
#line 314
 	
#line 314
	
#line 314
	
#line 314
		require {
#line 314
			
#line 314
		type dhcp_etc_t;
#line 314
	
#line 314
		} # end require
#line 314
	
#line 314

#line 314

#line 314
	 	 	
#line 314
##### begin files_search_etc(xend_t) depth: 2
#line 314
 	
#line 314
	
#line 314
	
#line 314
		require {
#line 314
			
#line 314
		type etc_t;
#line 314
	
#line 314
		} # end require
#line 314
	
#line 314

#line 314

#line 314
	allow xend_t etc_t:dir { getattr search open };
#line 314

#line 314
	 	
#line 314
##### end files_search_etc(xend_t) depth: 1
#line 314
 	
#line 314
	allow xend_t dhcp_etc_t:file { getattr open read write append ioctl lock };
#line 314

#line 314
	 	
#line 314
##### end sysnet_rw_dhcp_config(xend_t) depth: 0
#line 314
 	

 	 	
#line 316
##### begin userdom_dontaudit_search_user_home_dirs(xend_t) depth: 1
#line 316
 	
#line 316
	
#line 316
	
#line 316
		require {
#line 316
			
#line 316
		type user_home_dir_t;
#line 316
	
#line 316
		} # end require
#line 316
	
#line 316

#line 316

#line 316
	dontaudit xend_t user_home_dir_t:dir { getattr search open };
#line 316

#line 316
	 	
#line 316
##### end userdom_dontaudit_search_user_home_dirs(xend_t) depth: 0
#line 316
 	


#line 318
	
#line 318
	
#line 318
		require {
#line 318
			
#line 318
		
#line 318
bool xen_use_fusefs;
#line 318

#line 318
  
#line 318
	
#line 318
		} # end require
#line 318
	
#line 318

#line 318
	if (xen_use_fusefs) {
#line 318
		
#line 318
	 	 	
#line 318
##### begin fs_manage_fusefs_dirs(xend_t) depth: 1
#line 318
 	
#line 318
	
#line 318
	
#line 318
		require {
#line 318
			
#line 318
		type fusefs_t;
#line 318
	
#line 318
		} # end require
#line 318
	
#line 318

#line 318

#line 318
	allow xend_t fusefs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 318

#line 318
	 	
#line 318
##### end fs_manage_fusefs_dirs(xend_t) depth: 0
#line 318
 	
#line 318
	 	 	
#line 318
##### begin fs_manage_fusefs_files(xend_t) depth: 1
#line 318
 	
#line 318
	
#line 318
	
#line 318
		require {
#line 318
			
#line 318
		type fusefs_t;
#line 318
	
#line 318
		} # end require
#line 318
	
#line 318

#line 318

#line 318
	
#line 318
	allow xend_t fusefs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 318
	allow xend_t fusefs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 318

#line 318

#line 318
	 	
#line 318
##### end fs_manage_fusefs_files(xend_t) depth: 0
#line 318
 	
#line 318
	 	 	
#line 318
##### begin fs_read_fusefs_symlinks(xend_t) depth: 1
#line 318
 	
#line 318
	
#line 318
	
#line 318
		require {
#line 318
			
#line 318
		type fusefs_t;
#line 318
	
#line 318
		} # end require
#line 318
	
#line 318

#line 318

#line 318
	allow xend_t fusefs_t:dir { getattr search open read lock ioctl };
#line 318
	
#line 318
	allow xend_t fusefs_t:dir { getattr search open };
#line 318
	allow xend_t fusefs_t:lnk_file { getattr read };
#line 318

#line 318

#line 318
	 	
#line 318
##### end fs_read_fusefs_symlinks(xend_t) depth: 0
#line 318
 	
#line 318

#line 318
	}
#line 322



#line 324
	
#line 324
	
#line 324
		require {
#line 324
			
#line 324
		
#line 324
bool xen_use_nfs;
#line 324

#line 324
  
#line 324
	
#line 324
		} # end require
#line 324
	
#line 324

#line 324
	if (xen_use_nfs) {
#line 324
		
#line 324
	 	 	
#line 324
##### begin fs_manage_nfs_dirs(xend_t) depth: 1
#line 324
 	
#line 324
	
#line 324
	
#line 324
		require {
#line 324
			
#line 324
		type nfs_t;
#line 324
	
#line 324
		} # end require
#line 324
	
#line 324

#line 324

#line 324
	allow xend_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 324

#line 324
	 	
#line 324
##### end fs_manage_nfs_dirs(xend_t) depth: 0
#line 324
 	
#line 324
	 	 	
#line 324
##### begin fs_manage_nfs_files(xend_t) depth: 1
#line 324
 	
#line 324
	
#line 324
	
#line 324
		require {
#line 324
			
#line 324
		type nfs_t;
#line 324
	
#line 324
		} # end require
#line 324
	
#line 324

#line 324

#line 324
	
#line 324
	allow xend_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 324
	allow xend_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 324

#line 324

#line 324
	 	
#line 324
##### end fs_manage_nfs_files(xend_t) depth: 0
#line 324
 	
#line 324
	 	 	
#line 324
##### begin fs_read_nfs_symlinks(xend_t) depth: 1
#line 324
 	
#line 324
	
#line 324
	
#line 324
		require {
#line 324
			
#line 324
		type nfs_t;
#line 324
	
#line 324
		} # end require
#line 324
	
#line 324

#line 324

#line 324
	allow xend_t nfs_t:dir { getattr search open read lock ioctl };
#line 324
	
#line 324
	allow xend_t nfs_t:dir { getattr search open };
#line 324
	allow xend_t nfs_t:lnk_file { getattr read };
#line 324

#line 324

#line 324
	 	
#line 324
##### end fs_read_nfs_symlinks(xend_t) depth: 0
#line 324
 	
#line 324

#line 324
	}
#line 328



#line 330
	
#line 330
	
#line 330
		require {
#line 330
			
#line 330
		
#line 330
bool xen_use_samba;
#line 330

#line 330
  
#line 330
	
#line 330
		} # end require
#line 330
	
#line 330

#line 330
	if (xen_use_samba) {
#line 330
		
#line 330
	 	 	
#line 330
##### begin fs_manage_cifs_dirs(xend_t) depth: 1
#line 330
 	
#line 330
	
#line 330
	
#line 330
		require {
#line 330
			
#line 330
		type cifs_t;
#line 330
	
#line 330
		} # end require
#line 330
	
#line 330

#line 330

#line 330
	allow xend_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 330

#line 330
	 	
#line 330
##### end fs_manage_cifs_dirs(xend_t) depth: 0
#line 330
 	
#line 330
	 	 	
#line 330
##### begin fs_manage_cifs_files(xend_t) depth: 1
#line 330
 	
#line 330
	
#line 330
	
#line 330
		require {
#line 330
			
#line 330
		type cifs_t;
#line 330
	
#line 330
		} # end require
#line 330
	
#line 330

#line 330

#line 330
	
#line 330
	allow xend_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 330
	allow xend_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 330

#line 330

#line 330
	 	
#line 330
##### end fs_manage_cifs_files(xend_t) depth: 0
#line 330
 	
#line 330
	 	 	
#line 330
##### begin fs_read_cifs_symlinks(xend_t) depth: 1
#line 330
 	
#line 330
	
#line 330
	
#line 330
		require {
#line 330
			
#line 330
		type cifs_t;
#line 330
	
#line 330
		} # end require
#line 330
	
#line 330

#line 330

#line 330
	allow xend_t cifs_t:dir { getattr search open read lock ioctl };
#line 330
	
#line 330
	allow xend_t cifs_t:dir { getattr search open };
#line 330
	allow xend_t cifs_t:lnk_file { getattr read };
#line 330

#line 330

#line 330
	 	
#line 330
##### end fs_read_cifs_symlinks(xend_t) depth: 0
#line 330
 	
#line 330

#line 330
	}
#line 334



#line 336
	optional {
#line 336
		
#line 336
	 	 	
#line 336
##### begin brctl_domtrans(xend_t) depth: 1
#line 336
 	
#line 336
	
#line 336
	
#line 336
		require {
#line 336
			
#line 336
		type brctl_t, brctl_exec_t;
#line 336
	
#line 336
		} # end require
#line 336
	
#line 336

#line 336

#line 336
	 	 	
#line 336
##### begin corecmd_search_bin(xend_t) depth: 2
#line 336
 	
#line 336
	
#line 336
	
#line 336
		require {
#line 336
			
#line 336
		type bin_t;
#line 336
	
#line 336
		} # end require
#line 336
	
#line 336

#line 336

#line 336
	
#line 336
	allow xend_t bin_t:dir { getattr search open };
#line 336
	allow xend_t bin_t:dir { getattr search open };
#line 336

#line 336

#line 336
	 	
#line 336
##### end corecmd_search_bin(xend_t) depth: 1
#line 336
 	
#line 336
	
#line 336
	
#line 336
	
#line 336
	allow xend_t brctl_exec_t:file { getattr open read execute };
#line 336
	allow xend_t brctl_t:process transition;
#line 336
	dontaudit xend_t brctl_t:process { noatsecure siginh rlimitinh };
#line 336

#line 336
	type_transition xend_t brctl_exec_t:process brctl_t;
#line 336

#line 336

#line 336
	allow brctl_t xend_t:fd use;
#line 336
	allow brctl_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 336
	allow brctl_t xend_t:process sigchld;
#line 336

#line 336

#line 336
	 	
#line 336
##### end brctl_domtrans(xend_t) depth: 0
#line 336
 	
#line 336

#line 336
	} # end optional
#line 338



#line 340
	optional {
#line 340
		
#line 340
	 	 	
#line 340
##### begin consoletype_exec(xend_t) depth: 1
#line 340
 	
#line 340
	
#line 340
	
#line 340
		require {
#line 340
			
#line 340
		type consoletype_exec_t;
#line 340
	
#line 340
		} # end require
#line 340
	
#line 340

#line 340

#line 340
	 	 	
#line 340
##### begin corecmd_search_bin(xend_t) depth: 2
#line 340
 	
#line 340
	
#line 340
	
#line 340
		require {
#line 340
			
#line 340
		type bin_t;
#line 340
	
#line 340
		} # end require
#line 340
	
#line 340

#line 340

#line 340
	
#line 340
	allow xend_t bin_t:dir { getattr search open };
#line 340
	allow xend_t bin_t:dir { getattr search open };
#line 340

#line 340

#line 340
	 	
#line 340
##### end corecmd_search_bin(xend_t) depth: 1
#line 340
 	
#line 340
	allow xend_t consoletype_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 340

#line 340
	 	
#line 340
##### end consoletype_exec(xend_t) depth: 0
#line 340
 	
#line 340

#line 340
	} # end optional
#line 342



#line 344
	optional {
#line 344
		
#line 344
	 	 	
#line 344
##### begin lvm_domtrans(xend_t) depth: 1
#line 344
 	
#line 344
	
#line 344
	
#line 344
		require {
#line 344
			
#line 344
		type lvm_t, lvm_exec_t;
#line 344
	
#line 344
		} # end require
#line 344
	
#line 344

#line 344

#line 344
	 	 	
#line 344
##### begin corecmd_search_bin(xend_t) depth: 2
#line 344
 	
#line 344
	
#line 344
	
#line 344
		require {
#line 344
			
#line 344
		type bin_t;
#line 344
	
#line 344
		} # end require
#line 344
	
#line 344

#line 344

#line 344
	
#line 344
	allow xend_t bin_t:dir { getattr search open };
#line 344
	allow xend_t bin_t:dir { getattr search open };
#line 344

#line 344

#line 344
	 	
#line 344
##### end corecmd_search_bin(xend_t) depth: 1
#line 344
 	
#line 344
	
#line 344
	
#line 344
	
#line 344
	allow xend_t lvm_exec_t:file { getattr open read execute };
#line 344
	allow xend_t lvm_t:process transition;
#line 344
	dontaudit xend_t lvm_t:process { noatsecure siginh rlimitinh };
#line 344

#line 344
	type_transition xend_t lvm_exec_t:process lvm_t;
#line 344

#line 344

#line 344
	allow lvm_t xend_t:fd use;
#line 344
	allow lvm_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 344
	allow lvm_t xend_t:process sigchld;
#line 344

#line 344

#line 344
	 	
#line 344
##### end lvm_domtrans(xend_t) depth: 0
#line 344
 	
#line 344

#line 344
	} # end optional
#line 346



#line 348
	optional {
#line 348
		
#line 348
	 	 	
#line 348
##### begin mount_domtrans(xend_t) depth: 1
#line 348
 	
#line 348
	
#line 348
	
#line 348
		require {
#line 348
			
#line 348
		type mount_t, mount_exec_t;
#line 348
	
#line 348
		} # end require
#line 348
	
#line 348

#line 348

#line 348
	
#line 348
	
#line 348
	
#line 348
	allow xend_t mount_exec_t:file { getattr open read execute };
#line 348
	allow xend_t mount_t:process transition;
#line 348
	dontaudit xend_t mount_t:process { noatsecure siginh rlimitinh };
#line 348

#line 348
	type_transition xend_t mount_exec_t:process mount_t;
#line 348

#line 348

#line 348
	allow mount_t xend_t:fd use;
#line 348
	allow mount_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 348
	allow mount_t xend_t:process sigchld;
#line 348

#line 348

#line 348
	 	
#line 348
##### end mount_domtrans(xend_t) depth: 0
#line 348
 	
#line 348

#line 348
	} # end optional
#line 350



#line 352
	optional {
#line 352
		
#line 352
	 	 	
#line 352
##### begin netutils_domtrans(xend_t) depth: 1
#line 352
 	
#line 352
	
#line 352
	
#line 352
		require {
#line 352
			
#line 352
		type netutils_t, netutils_exec_t;
#line 352
	
#line 352
		} # end require
#line 352
	
#line 352

#line 352

#line 352
	 	 	
#line 352
##### begin corecmd_search_bin(xend_t) depth: 2
#line 352
 	
#line 352
	
#line 352
	
#line 352
		require {
#line 352
			
#line 352
		type bin_t;
#line 352
	
#line 352
		} # end require
#line 352
	
#line 352

#line 352

#line 352
	
#line 352
	allow xend_t bin_t:dir { getattr search open };
#line 352
	allow xend_t bin_t:dir { getattr search open };
#line 352

#line 352

#line 352
	 	
#line 352
##### end corecmd_search_bin(xend_t) depth: 1
#line 352
 	
#line 352
	
#line 352
	
#line 352
	
#line 352
	allow xend_t netutils_exec_t:file { getattr open read execute };
#line 352
	allow xend_t netutils_t:process transition;
#line 352
	dontaudit xend_t netutils_t:process { noatsecure siginh rlimitinh };
#line 352

#line 352
	type_transition xend_t netutils_exec_t:process netutils_t;
#line 352

#line 352

#line 352
	allow netutils_t xend_t:fd use;
#line 352
	allow netutils_t xend_t:fifo_file { open { getattr read write append ioctl lock } };
#line 352
	allow netutils_t xend_t:process sigchld;
#line 352

#line 352

#line 352
	 	
#line 352
##### end netutils_domtrans(xend_t) depth: 0
#line 352
 	
#line 352

#line 352
	} # end optional
#line 354



#line 356
	optional {
#line 356
		
#line 356
	 	 	
#line 356
##### begin ptchown_exec(xend_t) depth: 1
#line 356
 	
#line 356
	
#line 356
	
#line 356
		require {
#line 356
			
#line 356
		type ptchown_exec_t;
#line 356
	
#line 356
		} # end require
#line 356
	
#line 356

#line 356

#line 356
	 	 	
#line 356
##### begin corecmd_search_bin(xend_t) depth: 2
#line 356
 	
#line 356
	
#line 356
	
#line 356
		require {
#line 356
			
#line 356
		type bin_t;
#line 356
	
#line 356
		} # end require
#line 356
	
#line 356

#line 356

#line 356
	
#line 356
	allow xend_t bin_t:dir { getattr search open };
#line 356
	allow xend_t bin_t:dir { getattr search open };
#line 356

#line 356

#line 356
	 	
#line 356
##### end corecmd_search_bin(xend_t) depth: 1
#line 356
 	
#line 356
	allow xend_t ptchown_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 356

#line 356
	 	
#line 356
##### end ptchown_exec(xend_t) depth: 0
#line 356
 	
#line 356

#line 356
	} # end optional
#line 358



#line 360
	optional {
#line 360
		
#line 360
	 	 	
#line 360
##### begin virt_search_images(xend_t) depth: 1
#line 360
 	
#line 360
	
#line 360
	
#line 360
		require {
#line 360
			
#line 360
		attribute virt_image_type;
#line 360
	
#line 360
		} # end require
#line 360
	
#line 360

#line 360

#line 360
	 	 	
#line 360
##### begin virt_search_lib(xend_t) depth: 2
#line 360
 	
#line 360
	
#line 360
	
#line 360
		require {
#line 360
			
#line 360
		type virt_var_lib_t;
#line 360
	
#line 360
		} # end require
#line 360
	
#line 360

#line 360

#line 360
	 	 	
#line 360
##### begin files_search_var_lib(xend_t) depth: 3
#line 360
 	
#line 360
	
#line 360
	
#line 360
		require {
#line 360
			
#line 360
		type var_t, var_lib_t;
#line 360
	
#line 360
		} # end require
#line 360
	
#line 360

#line 360

#line 360
	
#line 360
	allow xend_t var_t:dir { getattr search open };
#line 360
	allow xend_t var_lib_t:dir { getattr search open };
#line 360

#line 360

#line 360
	 	
#line 360
##### end files_search_var_lib(xend_t) depth: 2
#line 360
 	
#line 360
	allow xend_t virt_var_lib_t:dir { getattr search open };
#line 360

#line 360
	 	
#line 360
##### end virt_search_lib(xend_t) depth: 1
#line 360
 	
#line 360
	allow xend_t virt_image_type:dir { getattr search open };
#line 360

#line 360
	 	
#line 360
##### end virt_search_images(xend_t) depth: 0
#line 360
 	
#line 360
	 	 	
#line 360
##### begin virt_read_config(xend_t) depth: 1
#line 360
 	
#line 360
	
#line 360
	
#line 360
		require {
#line 360
			
#line 360
		type virt_etc_t, virt_etc_rw_t;
#line 360
	
#line 360
		} # end require
#line 360
	
#line 360

#line 360

#line 360
	 	 	
#line 360
##### begin files_search_etc(xend_t) depth: 2
#line 360
 	
#line 360
	
#line 360
	
#line 360
		require {
#line 360
			
#line 360
		type etc_t;
#line 360
	
#line 360
		} # end require
#line 360
	
#line 360

#line 360

#line 360
	allow xend_t etc_t:dir { getattr search open };
#line 360

#line 360
	 	
#line 360
##### end files_search_etc(xend_t) depth: 1
#line 360
 	
#line 360
	allow xend_t { virt_etc_t virt_etc_rw_t }:dir { getattr search open read lock ioctl };
#line 360
	
#line 360
	allow xend_t virt_etc_t:dir { getattr search open };
#line 360
	allow xend_t virt_etc_t:file { getattr open read lock ioctl };
#line 360

#line 360
	
#line 360
	allow xend_t virt_etc_rw_t:dir { getattr search open };
#line 360
	allow xend_t virt_etc_rw_t:file { getattr open read lock ioctl };
#line 360

#line 360
	
#line 360
	allow xend_t virt_etc_rw_t:dir { getattr search open };
#line 360
	allow xend_t virt_etc_rw_t:lnk_file { getattr read };
#line 360

#line 360

#line 360
	 	
#line 360
##### end virt_read_config(xend_t) depth: 0
#line 360
 	
#line 360

#line 360
	} # end optional
#line 363


########################################
#
# Xen console local policy
#

allow xenconsoled_t self:capability { dac_override fsetid ipc_lock };
allow xenconsoled_t self:process setrlimit;
allow xenconsoled_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
allow xenconsoled_t self:fifo_file { open { getattr read write append ioctl lock } };

allow xenconsoled_t xen_devpts_t:chr_file { { { getattr read write append ioctl } open } { setattr } };


#line 377
	allow xenconsoled_t xend_var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 377
	allow xenconsoled_t xend_var_log_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 377


#line 378
	allow xenconsoled_t xend_var_log_t:dir { getattr search open };
#line 378
	allow xenconsoled_t xend_var_log_t:file { getattr open append lock ioctl };
#line 378


#line 379
	allow xenconsoled_t xend_var_log_t:dir { getattr search open lock ioctl write add_name };
#line 379
	allow xenconsoled_t xend_var_log_t:file { getattr create open };
#line 379


#line 380
	allow xenconsoled_t xend_var_log_t:dir { getattr search open };
#line 380
	allow xenconsoled_t xend_var_log_t:file { setattr };
#line 380



#line 382
	allow xenconsoled_t xenconsoled_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 382
	allow xenconsoled_t xenconsoled_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 382


#line 383
	allow xenconsoled_t xenconsoled_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 383
	allow xenconsoled_t xenconsoled_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 383

 	 	
#line 384
##### begin files_pid_filetrans(xenconsoled_t,xenconsoled_var_run_t,{ file sock_file }) depth: 1
#line 384
 	
#line 384
	
#line 384
	
#line 384
		require {
#line 384
			
#line 384
		type var_t, var_run_t;
#line 384
	
#line 384
		} # end require
#line 384
	
#line 384

#line 384

#line 384
	allow xenconsoled_t var_t:dir { getattr search open };
#line 384
	allow xenconsoled_t var_run_t:lnk_file { getattr read };
#line 384
	
#line 384
	allow xenconsoled_t var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 384
	type_transition xenconsoled_t var_run_t:{ file sock_file } xenconsoled_var_run_t ;
#line 384

#line 384

#line 384
	 	
#line 384
##### end files_pid_filetrans(xenconsoled_t,xenconsoled_var_run_t,{ file sock_file }) depth: 0
#line 384
 	

 	 	
#line 386
##### begin kernel_read_kernel_sysctls(xenconsoled_t) depth: 1
#line 386
 	
#line 386
	
#line 386
	
#line 386
		require {
#line 386
			
#line 386
		type proc_t, sysctl_t, sysctl_kernel_t;
#line 386
	
#line 386
		} # end require
#line 386
	
#line 386

#line 386

#line 386
	
#line 386
	allow xenconsoled_t { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 386
	allow xenconsoled_t sysctl_kernel_t:file { getattr open read lock ioctl };
#line 386

#line 386

#line 386
	
#line 386
	allow xenconsoled_t { proc_t sysctl_t }:dir { getattr search open };
#line 386
	allow xenconsoled_t sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 386

#line 386

#line 386
	 	
#line 386
##### end kernel_read_kernel_sysctls(xenconsoled_t) depth: 0
#line 386
 	
 	 	
#line 387
##### begin kernel_write_xen_state(xenconsoled_t) depth: 1
#line 387
 	
#line 387
	
#line 387
	
#line 387
		require {
#line 387
			
#line 387
		type proc_t, proc_xen_t;
#line 387
	
#line 387
		} # end require
#line 387
	
#line 387

#line 387

#line 387
	
#line 387
	allow xenconsoled_t { proc_t proc_xen_t }:dir { getattr search open };
#line 387
	allow xenconsoled_t proc_xen_t:file { getattr open write append lock ioctl };
#line 387

#line 387

#line 387
	 	
#line 387
##### end kernel_write_xen_state(xenconsoled_t) depth: 0
#line 387
 	
 	 	
#line 388
##### begin kernel_read_xen_state(xenconsoled_t) depth: 1
#line 388
 	
#line 388
	
#line 388
	
#line 388
		require {
#line 388
			
#line 388
		type proc_t, proc_xen_t;
#line 388
	
#line 388
		} # end require
#line 388
	
#line 388

#line 388

#line 388
	
#line 388
	allow xenconsoled_t { proc_t proc_xen_t }:dir { getattr search open };
#line 388
	allow xenconsoled_t proc_xen_t:file { getattr open read lock ioctl };
#line 388

#line 388
	
#line 388
	allow xenconsoled_t { proc_t proc_xen_t }:dir { getattr search open };
#line 388
	allow xenconsoled_t proc_xen_t:lnk_file { getattr read };
#line 388

#line 388

#line 388
	
#line 388
	allow xenconsoled_t proc_t:dir { getattr search open };
#line 388
	allow xenconsoled_t proc_xen_t:dir { getattr search open read lock ioctl };
#line 388

#line 388

#line 388
	 	
#line 388
##### end kernel_read_xen_state(xenconsoled_t) depth: 0
#line 388
 	

 	 	
#line 390
##### begin dev_rw_xen(xenconsoled_t) depth: 1
#line 390
 	
#line 390
	
#line 390
	
#line 390
		require {
#line 390
			
#line 390
		type device_t, xen_device_t;
#line 390
	
#line 390
		} # end require
#line 390
	
#line 390

#line 390

#line 390
	
#line 390
	allow xenconsoled_t device_t:dir { getattr search open };
#line 390
	allow xenconsoled_t xen_device_t:chr_file { getattr open read write append ioctl lock };
#line 390

#line 390

#line 390
	 	
#line 390
##### end dev_rw_xen(xenconsoled_t) depth: 0
#line 390
 	
 	 	
#line 391
##### begin dev_filetrans_xen(xenconsoled_t) depth: 1
#line 391
 	
#line 391
	
#line 391
	
#line 391
		require {
#line 391
			
#line 391
		type device_t, xen_device_t;
#line 391
	
#line 391
		} # end require
#line 391
	
#line 391

#line 391

#line 391
	
#line 391
	allow xenconsoled_t device_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 391
	type_transition xenconsoled_t device_t:chr_file xen_device_t ;
#line 391

#line 391

#line 391
	 	
#line 391
##### end dev_filetrans_xen(xenconsoled_t) depth: 0
#line 391
 	
 	 	
#line 392
##### begin dev_rw_sysfs(xenconsoled_t) depth: 1
#line 392
 	
#line 392
	
#line 392
	
#line 392
		require {
#line 392
			
#line 392
		type sysfs_t;
#line 392
	
#line 392
		} # end require
#line 392
	
#line 392

#line 392

#line 392
	
#line 392
	allow xenconsoled_t sysfs_t:dir { getattr search open };
#line 392
	allow xenconsoled_t sysfs_t:file { getattr open read write append ioctl lock };
#line 392

#line 392
	
#line 392
	allow xenconsoled_t sysfs_t:dir { getattr search open };
#line 392
	allow xenconsoled_t sysfs_t:lnk_file { getattr read };
#line 392

#line 392

#line 392
	
#line 392
	allow xenconsoled_t sysfs_t:dir { getattr search open };
#line 392
	allow xenconsoled_t sysfs_t:dir { getattr search open read lock ioctl };
#line 392

#line 392

#line 392
	 	
#line 392
##### end dev_rw_sysfs(xenconsoled_t) depth: 0
#line 392
 	

 	 	
#line 394
##### begin domain_dontaudit_ptrace_all_domains(xenconsoled_t) depth: 1
#line 394
 	
#line 394
	
#line 394
	
#line 394
		require {
#line 394
			
#line 394
		attribute domain;
#line 394
	
#line 394
		} # end require
#line 394
	
#line 394

#line 394

#line 394
	dontaudit xenconsoled_t domain:process ptrace;
#line 394

#line 394
	 	
#line 394
##### end domain_dontaudit_ptrace_all_domains(xenconsoled_t) depth: 0
#line 394
 	

 	 	
#line 396
##### begin files_read_etc_files(xenconsoled_t) depth: 1
#line 396
 	
#line 396
	
#line 396
	
#line 396
		require {
#line 396
			
#line 396
		type etc_t;
#line 396
	
#line 396
		} # end require
#line 396
	
#line 396

#line 396

#line 396
	allow xenconsoled_t etc_t:dir { getattr search open read lock ioctl };
#line 396
	
#line 396
	allow xenconsoled_t etc_t:dir { getattr search open };
#line 396
	allow xenconsoled_t etc_t:file { getattr open read lock ioctl };
#line 396

#line 396
	
#line 396
	allow xenconsoled_t etc_t:dir { getattr search open };
#line 396
	allow xenconsoled_t etc_t:lnk_file { getattr read };
#line 396

#line 396

#line 396
	 	
#line 396
##### end files_read_etc_files(xenconsoled_t) depth: 0
#line 396
 	
 	 	
#line 397
##### begin files_read_usr_files(xenconsoled_t) depth: 1
#line 397
 	
#line 397
	
#line 397
	
#line 397
		require {
#line 397
			
#line 397
		type usr_t;
#line 397
	
#line 397
		} # end require
#line 397
	
#line 397

#line 397

#line 397
	allow xenconsoled_t usr_t:dir { getattr search open read lock ioctl };
#line 397
	
#line 397
	allow xenconsoled_t usr_t:dir { getattr search open };
#line 397
	allow xenconsoled_t usr_t:file { getattr open read lock ioctl };
#line 397

#line 397
	
#line 397
	allow xenconsoled_t usr_t:dir { getattr search open };
#line 397
	allow xenconsoled_t usr_t:lnk_file { getattr read };
#line 397

#line 397

#line 397
	 	
#line 397
##### end files_read_usr_files(xenconsoled_t) depth: 0
#line 397
 	

 	 	
#line 399
##### begin fs_list_tmpfs(xenconsoled_t) depth: 1
#line 399
 	
#line 399
	
#line 399
	
#line 399
		require {
#line 399
			
#line 399
		type tmpfs_t;
#line 399
	
#line 399
		} # end require
#line 399
	
#line 399

#line 399

#line 399
	allow xenconsoled_t tmpfs_t:dir { getattr search open read lock ioctl };
#line 399

#line 399
	 	
#line 399
##### end fs_list_tmpfs(xenconsoled_t) depth: 0
#line 399
 	
 	 	
#line 400
##### begin fs_manage_xenfs_dirs(xenconsoled_t) depth: 1
#line 400
 	
#line 400
	
#line 400
	
#line 400
		require {
#line 400
			
#line 400
		type xenfs_t;
#line 400
	
#line 400
		} # end require
#line 400
	
#line 400

#line 400

#line 400
	allow xenconsoled_t xenfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 400

#line 400
	 	
#line 400
##### end fs_manage_xenfs_dirs(xenconsoled_t) depth: 0
#line 400
 	
 	 	
#line 401
##### begin fs_manage_xenfs_files(xenconsoled_t) depth: 1
#line 401
 	
#line 401
	
#line 401
	
#line 401
		require {
#line 401
			
#line 401
		type xenfs_t;
#line 401
	
#line 401
		} # end require
#line 401
	
#line 401

#line 401

#line 401
	
#line 401
	allow xenconsoled_t xenfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 401
	allow xenconsoled_t xenfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 401

#line 401

#line 401
	 	
#line 401
##### end fs_manage_xenfs_files(xenconsoled_t) depth: 0
#line 401
 	

 	 	
#line 403
##### begin term_create_pty(xenconsoled_t,xen_devpts_t) depth: 1
#line 403
 	
#line 403
	
#line 403
	
#line 403
		require {
#line 403
			
#line 403
		type bsdpty_device_t, devpts_t, ptmx_t;
#line 403
	
#line 403
		} # end require
#line 403
	
#line 403

#line 403

#line 403
	 	 	
#line 403
##### begin dev_list_all_dev_nodes(xenconsoled_t) depth: 2
#line 403
 	
#line 403
	
#line 403
	
#line 403
		require {
#line 403
			
#line 403
		type device_t;
#line 403
	
#line 403
		} # end require
#line 403
	
#line 403

#line 403

#line 403
	
#line 403
	allow xenconsoled_t device_t:dir { getattr search open };
#line 403
	allow xenconsoled_t device_t:dir { getattr search open read lock ioctl };
#line 403

#line 403
	
#line 403
	allow xenconsoled_t device_t:dir { getattr search open };
#line 403
	allow xenconsoled_t device_t:lnk_file { getattr read };
#line 403

#line 403

#line 403
	 	
#line 403
##### end dev_list_all_dev_nodes(xenconsoled_t) depth: 1
#line 403
 	
#line 403
	allow xenconsoled_t ptmx_t:chr_file { getattr open read write append ioctl lock };
#line 403

#line 403
	allow xenconsoled_t devpts_t:dir { getattr search open read lock ioctl };
#line 403
	allow xenconsoled_t devpts_t:filesystem getattr;
#line 403
	dontaudit xenconsoled_t bsdpty_device_t:chr_file { getattr read write };
#line 403
	type_transition xenconsoled_t devpts_t:chr_file xen_devpts_t;
#line 403

#line 403
	 	
#line 403
##### end term_create_pty(xenconsoled_t,xen_devpts_t) depth: 0
#line 403
 	
 	 	
#line 404
##### begin term_use_generic_ptys(xenconsoled_t) depth: 1
#line 404
 	
#line 404
	
#line 404
	
#line 404
		require {
#line 404
			
#line 404
		type devpts_t;
#line 404
	
#line 404
		} # end require
#line 404
	
#line 404

#line 404

#line 404
	 	 	
#line 404
##### begin dev_list_all_dev_nodes(xenconsoled_t) depth: 2
#line 404
 	
#line 404
	
#line 404
	
#line 404
		require {
#line 404
			
#line 404
		type device_t;
#line 404
	
#line 404
		} # end require
#line 404
	
#line 404

#line 404

#line 404
	
#line 404
	allow xenconsoled_t device_t:dir { getattr search open };
#line 404
	allow xenconsoled_t device_t:dir { getattr search open read lock ioctl };
#line 404

#line 404
	
#line 404
	allow xenconsoled_t device_t:dir { getattr search open };
#line 404
	allow xenconsoled_t device_t:lnk_file { getattr read };
#line 404

#line 404

#line 404
	 	
#line 404
##### end dev_list_all_dev_nodes(xenconsoled_t) depth: 1
#line 404
 	
#line 404
	allow xenconsoled_t devpts_t:dir { getattr search open read lock ioctl };
#line 404
	allow xenconsoled_t devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 404

#line 404
	 	
#line 404
##### end term_use_generic_ptys(xenconsoled_t) depth: 0
#line 404
 	
 	 	
#line 405
##### begin term_use_console(xenconsoled_t) depth: 1
#line 405
 	
#line 405
	
#line 405
	
#line 405
		require {
#line 405
			
#line 405
		type console_device_t;
#line 405
	
#line 405
		} # end require
#line 405
	
#line 405

#line 405

#line 405
	 	 	
#line 405
##### begin dev_list_all_dev_nodes(xenconsoled_t) depth: 2
#line 405
 	
#line 405
	
#line 405
	
#line 405
		require {
#line 405
			
#line 405
		type device_t;
#line 405
	
#line 405
		} # end require
#line 405
	
#line 405

#line 405

#line 405
	
#line 405
	allow xenconsoled_t device_t:dir { getattr search open };
#line 405
	allow xenconsoled_t device_t:dir { getattr search open read lock ioctl };
#line 405

#line 405
	
#line 405
	allow xenconsoled_t device_t:dir { getattr search open };
#line 405
	allow xenconsoled_t device_t:lnk_file { getattr read };
#line 405

#line 405

#line 405
	 	
#line 405
##### end dev_list_all_dev_nodes(xenconsoled_t) depth: 1
#line 405
 	
#line 405
	allow xenconsoled_t console_device_t:chr_file { getattr open read write append ioctl lock };
#line 405

#line 405
	 	
#line 405
##### end term_use_console(xenconsoled_t) depth: 0
#line 405
 	

 	 	
#line 407
##### begin init_use_fds(xenconsoled_t) depth: 1
#line 407
 	
#line 407
	
#line 407
	
#line 407
		require {
#line 407
			
#line 407
		type init_t;
#line 407
	
#line 407
		} # end require
#line 407
	
#line 407

#line 407

#line 407
	allow xenconsoled_t init_t:fd use;
#line 407

#line 407
	 	
#line 407
##### end init_use_fds(xenconsoled_t) depth: 0
#line 407
 	
 	 	
#line 408
##### begin init_use_script_ptys(xenconsoled_t) depth: 1
#line 408
 	
#line 408
	
#line 408
	
#line 408
		require {
#line 408
			
#line 408
		type initrc_devpts_t;
#line 408
	
#line 408
		} # end require
#line 408
	
#line 408

#line 408

#line 408
	 	 	
#line 408
##### begin term_list_ptys(xenconsoled_t) depth: 2
#line 408
 	
#line 408
	
#line 408
	
#line 408
		require {
#line 408
			
#line 408
		type devpts_t;
#line 408
	
#line 408
		} # end require
#line 408
	
#line 408

#line 408

#line 408
	 	 	
#line 408
##### begin dev_list_all_dev_nodes(xenconsoled_t) depth: 3
#line 408
 	
#line 408
	
#line 408
	
#line 408
		require {
#line 408
			
#line 408
		type device_t;
#line 408
	
#line 408
		} # end require
#line 408
	
#line 408

#line 408

#line 408
	
#line 408
	allow xenconsoled_t device_t:dir { getattr search open };
#line 408
	allow xenconsoled_t device_t:dir { getattr search open read lock ioctl };
#line 408

#line 408
	
#line 408
	allow xenconsoled_t device_t:dir { getattr search open };
#line 408
	allow xenconsoled_t device_t:lnk_file { getattr read };
#line 408

#line 408

#line 408
	 	
#line 408
##### end dev_list_all_dev_nodes(xenconsoled_t) depth: 2
#line 408
 	
#line 408
	allow xenconsoled_t devpts_t:dir { getattr search open read lock ioctl };
#line 408

#line 408
	 	
#line 408
##### end term_list_ptys(xenconsoled_t) depth: 1
#line 408
 	
#line 408
	allow xenconsoled_t initrc_devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 408

#line 408
	 	
#line 408
##### end init_use_script_ptys(xenconsoled_t) depth: 0
#line 408
 	

 	 	
#line 410
##### begin logging_search_logs(xenconsoled_t) depth: 1
#line 410
 	
#line 410
	
#line 410
	
#line 410
		require {
#line 410
			
#line 410
		type var_log_t;
#line 410
	
#line 410
		} # end require
#line 410
	
#line 410

#line 410

#line 410
	 	 	
#line 410
##### begin files_search_var(xenconsoled_t) depth: 2
#line 410
 	
#line 410
	
#line 410
	
#line 410
		require {
#line 410
			
#line 410
		type var_t;
#line 410
	
#line 410
		} # end require
#line 410
	
#line 410

#line 410

#line 410
	allow xenconsoled_t var_t:dir { getattr search open };
#line 410

#line 410
	 	
#line 410
##### end files_search_var(xenconsoled_t) depth: 1
#line 410
 	
#line 410
	allow xenconsoled_t var_log_t:dir { getattr search open };
#line 410
	allow xenconsoled_t var_log_t:lnk_file { getattr read };
#line 410

#line 410
	 	
#line 410
##### end logging_search_logs(xenconsoled_t) depth: 0
#line 410
 	

 	 	
#line 412
##### begin miscfiles_read_localization(xenconsoled_t) depth: 1
#line 412
 	
#line 412
	
#line 412
	
#line 412
		require {
#line 412
			
#line 412
		type locale_t;
#line 412
	
#line 412
		} # end require
#line 412
	
#line 412

#line 412

#line 412
	 	 	
#line 412
##### begin files_read_etc_symlinks(xenconsoled_t) depth: 2
#line 412
 	
#line 412
	
#line 412
	
#line 412
		require {
#line 412
			
#line 412
		type etc_t;
#line 412
	
#line 412
		} # end require
#line 412
	
#line 412

#line 412

#line 412
	
#line 412
	allow xenconsoled_t etc_t:dir { getattr search open };
#line 412
	allow xenconsoled_t etc_t:lnk_file { getattr read };
#line 412

#line 412

#line 412
	 	
#line 412
##### end files_read_etc_symlinks(xenconsoled_t) depth: 1
#line 412
 	
#line 412
	 	 	
#line 412
##### begin files_search_usr(xenconsoled_t) depth: 2
#line 412
 	
#line 412
	
#line 412
	
#line 412
		require {
#line 412
			
#line 412
		type usr_t;
#line 412
	
#line 412
		} # end require
#line 412
	
#line 412

#line 412

#line 412
	allow xenconsoled_t usr_t:dir { getattr search open };
#line 412

#line 412
	 	
#line 412
##### end files_search_usr(xenconsoled_t) depth: 1
#line 412
 	
#line 412
	allow xenconsoled_t locale_t:dir { getattr search open read lock ioctl };
#line 412
	
#line 412
	allow xenconsoled_t locale_t:dir { getattr search open };
#line 412
	allow xenconsoled_t locale_t:file { getattr open read lock ioctl };
#line 412

#line 412
	
#line 412
	allow xenconsoled_t locale_t:dir { getattr search open };
#line 412
	allow xenconsoled_t locale_t:lnk_file { getattr read };
#line 412

#line 412

#line 412
	 	
#line 412
##### end miscfiles_read_localization(xenconsoled_t) depth: 0
#line 412
 	

 	 	
#line 414
##### begin xen_stream_connect_xenstore(xenconsoled_t) depth: 1
#line 414
 	
#line 414
	
#line 414
	
#line 414
		require {
#line 414
			
#line 414
		type xenstored_t, xenstored_var_run_t;
#line 414
	
#line 414
		} # end require
#line 414
	
#line 414

#line 414

#line 414
	 	 	
#line 414
##### begin files_search_pids(xenconsoled_t) depth: 2
#line 414
 	
#line 414
	
#line 414
	
#line 414
		require {
#line 414
			
#line 414
		type var_t, var_run_t;
#line 414
	
#line 414
		} # end require
#line 414
	
#line 414

#line 414

#line 414
	allow xenconsoled_t var_run_t:lnk_file { getattr read };
#line 414
	
#line 414
	allow xenconsoled_t var_t:dir { getattr search open };
#line 414
	allow xenconsoled_t var_run_t:dir { getattr search open };
#line 414

#line 414

#line 414
	 	
#line 414
##### end files_search_pids(xenconsoled_t) depth: 1
#line 414
 	
#line 414
	
#line 414
	allow xenconsoled_t xenstored_var_run_t:dir { getattr search open };
#line 414
	allow xenconsoled_t xenstored_var_run_t:sock_file { getattr write open append };
#line 414
	allow xenconsoled_t xenstored_t:unix_stream_socket connectto;
#line 414

#line 414

#line 414
	 	
#line 414
##### end xen_stream_connect_xenstore(xenconsoled_t) depth: 0
#line 414
 	


#line 416
	optional {
#line 416
		
#line 416
	 	 	
#line 416
##### begin ptchown_domtrans(xenconsoled_t) depth: 1
#line 416
 	
#line 416
	
#line 416
	
#line 416
		require {
#line 416
			
#line 416
		type ptchown_t, ptchown_exec_t;
#line 416
	
#line 416
		} # end require
#line 416
	
#line 416

#line 416

#line 416
	 	 	
#line 416
##### begin corecmd_search_bin(xenconsoled_t) depth: 2
#line 416
 	
#line 416
	
#line 416
	
#line 416
		require {
#line 416
			
#line 416
		type bin_t;
#line 416
	
#line 416
		} # end require
#line 416
	
#line 416

#line 416

#line 416
	
#line 416
	allow xenconsoled_t bin_t:dir { getattr search open };
#line 416
	allow xenconsoled_t bin_t:dir { getattr search open };
#line 416

#line 416

#line 416
	 	
#line 416
##### end corecmd_search_bin(xenconsoled_t) depth: 1
#line 416
 	
#line 416
	
#line 416
	
#line 416
	
#line 416
	allow xenconsoled_t ptchown_exec_t:file { getattr open read execute };
#line 416
	allow xenconsoled_t ptchown_t:process transition;
#line 416
	dontaudit xenconsoled_t ptchown_t:process { noatsecure siginh rlimitinh };
#line 416

#line 416
	type_transition xenconsoled_t ptchown_exec_t:process ptchown_t;
#line 416

#line 416

#line 416
	allow ptchown_t xenconsoled_t:fd use;
#line 416
	allow ptchown_t xenconsoled_t:fifo_file { open { getattr read write append ioctl lock } };
#line 416
	allow ptchown_t xenconsoled_t:process sigchld;
#line 416

#line 416

#line 416
	 	
#line 416
##### end ptchown_domtrans(xenconsoled_t) depth: 0
#line 416
 	
#line 416

#line 416
	} # end optional
#line 418


########################################
#
# Xen store local policy
#

allow xenstored_t self:capability { dac_override ipc_lock sys_resource };
allow xenstored_t self:unix_stream_socket { accept listen };


#line 428
	allow xenstored_t xenstored_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 428
	allow xenstored_t xenstored_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 428


#line 429
	allow xenstored_t xenstored_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 429
	allow xenstored_t xenstored_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 429

 	 	
#line 430
##### begin files_tmp_filetrans(xenstored_t,xenstored_tmp_t,{ file dir }) depth: 1
#line 430
 	
#line 430
	
#line 430
	
#line 430
		require {
#line 430
			
#line 430
		type tmp_t;
#line 430
	
#line 430
		} # end require
#line 430
	
#line 430

#line 430

#line 430
	
#line 430
	allow xenstored_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 430
	type_transition xenstored_t tmp_t:{ file dir } xenstored_tmp_t ;
#line 430

#line 430

#line 430
	 	
#line 430
##### end files_tmp_filetrans(xenstored_t,xenstored_tmp_t,{ file dir }) depth: 0
#line 430
 	


#line 432
	allow xenstored_t xenstored_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 432
	allow xenstored_t xenstored_var_run_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 432


#line 433
	allow xenstored_t xenstored_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 433
	allow xenstored_t xenstored_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 433


#line 434
	allow xenstored_t xenstored_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 434
	allow xenstored_t xenstored_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 434

 	 	
#line 435
##### begin files_pid_filetrans(xenstored_t,xenstored_var_run_t,{ file sock_file dir }) depth: 1
#line 435
 	
#line 435
	
#line 435
	
#line 435
		require {
#line 435
			
#line 435
		type var_t, var_run_t;
#line 435
	
#line 435
		} # end require
#line 435
	
#line 435

#line 435

#line 435
	allow xenstored_t var_t:dir { getattr search open };
#line 435
	allow xenstored_t var_run_t:lnk_file { getattr read };
#line 435
	
#line 435
	allow xenstored_t var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 435
	type_transition xenstored_t var_run_t:{ file sock_file dir } xenstored_var_run_t ;
#line 435

#line 435

#line 435
	 	
#line 435
##### end files_pid_filetrans(xenstored_t,xenstored_var_run_t,{ file sock_file dir }) depth: 0
#line 435
 	


#line 437
	allow xenstored_t xenstored_var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 437
	allow xenstored_t xenstored_var_log_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 437


#line 438
	allow xenstored_t xenstored_var_log_t:dir { getattr search open };
#line 438
	allow xenstored_t xenstored_var_log_t:file { getattr open append lock ioctl };
#line 438


#line 439
	allow xenstored_t xenstored_var_log_t:dir { getattr search open lock ioctl write add_name };
#line 439
	allow xenstored_t xenstored_var_log_t:file { getattr create open };
#line 439


#line 440
	allow xenstored_t xenstored_var_log_t:dir { getattr search open };
#line 440
	allow xenstored_t xenstored_var_log_t:file { setattr };
#line 440


#line 441
	allow xenstored_t xenstored_var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 441
	allow xenstored_t xenstored_var_log_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 441

 	 	
#line 442
##### begin logging_log_filetrans(xenstored_t,xenstored_var_log_t,{ sock_file file dir }) depth: 1
#line 442
 	
#line 442
	
#line 442
	
#line 442
		require {
#line 442
			
#line 442
		type var_log_t;
#line 442
	
#line 442
		} # end require
#line 442
	
#line 442

#line 442

#line 442
	 	 	
#line 442
##### begin files_search_var(xenstored_t) depth: 2
#line 442
 	
#line 442
	
#line 442
	
#line 442
		require {
#line 442
			
#line 442
		type var_t;
#line 442
	
#line 442
		} # end require
#line 442
	
#line 442

#line 442

#line 442
	allow xenstored_t var_t:dir { getattr search open };
#line 442

#line 442
	 	
#line 442
##### end files_search_var(xenstored_t) depth: 1
#line 442
 	
#line 442
	
#line 442
	allow xenstored_t var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 442
	type_transition xenstored_t var_log_t:{ sock_file file dir } xenstored_var_log_t ;
#line 442

#line 442
	allow xenstored_t var_log_t:lnk_file { getattr read };
#line 442

#line 442
	 	
#line 442
##### end logging_log_filetrans(xenstored_t,xenstored_var_log_t,{ sock_file file dir }) depth: 0
#line 442
 	


#line 444
	allow xenstored_t xenstored_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 444
	allow xenstored_t xenstored_var_lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 444


#line 445
	allow xenstored_t xenstored_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 445
	allow xenstored_t xenstored_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 445


#line 446
	allow xenstored_t xenstored_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 446
	allow xenstored_t xenstored_var_lib_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 446

 	 	
#line 447
##### begin files_var_lib_filetrans(xenstored_t,xenstored_var_lib_t,{ file dir sock_file }) depth: 1
#line 447
 	
#line 447
	
#line 447
	
#line 447
		require {
#line 447
			
#line 447
		type var_t, var_lib_t;
#line 447
	
#line 447
		} # end require
#line 447
	
#line 447

#line 447

#line 447
	allow xenstored_t var_t:dir { getattr search open };
#line 447
	
#line 447
	allow xenstored_t var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 447
	type_transition xenstored_t var_lib_t:{ file dir sock_file } xenstored_var_lib_t ;
#line 447

#line 447

#line 447
	 	
#line 447
##### end files_var_lib_filetrans(xenstored_t,xenstored_var_lib_t,{ file dir sock_file }) depth: 0
#line 447
 	


#line 449
	allow xenstored_t evtchnd_var_run_t:dir { getattr search open };
#line 449
	allow xenstored_t evtchnd_var_run_t:sock_file { getattr write open append };
#line 449
	allow xenstored_t evtchnd_t:unix_stream_socket connectto;
#line 449


 	 	
#line 451
##### begin kernel_write_xen_state(xenstored_t) depth: 1
#line 451
 	
#line 451
	
#line 451
	
#line 451
		require {
#line 451
			
#line 451
		type proc_t, proc_xen_t;
#line 451
	
#line 451
		} # end require
#line 451
	
#line 451

#line 451

#line 451
	
#line 451
	allow xenstored_t { proc_t proc_xen_t }:dir { getattr search open };
#line 451
	allow xenstored_t proc_xen_t:file { getattr open write append lock ioctl };
#line 451

#line 451

#line 451
	 	
#line 451
##### end kernel_write_xen_state(xenstored_t) depth: 0
#line 451
 	
 	 	
#line 452
##### begin kernel_read_xen_state(xenstored_t) depth: 1
#line 452
 	
#line 452
	
#line 452
	
#line 452
		require {
#line 452
			
#line 452
		type proc_t, proc_xen_t;
#line 452
	
#line 452
		} # end require
#line 452
	
#line 452

#line 452

#line 452
	
#line 452
	allow xenstored_t { proc_t proc_xen_t }:dir { getattr search open };
#line 452
	allow xenstored_t proc_xen_t:file { getattr open read lock ioctl };
#line 452

#line 452
	
#line 452
	allow xenstored_t { proc_t proc_xen_t }:dir { getattr search open };
#line 452
	allow xenstored_t proc_xen_t:lnk_file { getattr read };
#line 452

#line 452

#line 452
	
#line 452
	allow xenstored_t proc_t:dir { getattr search open };
#line 452
	allow xenstored_t proc_xen_t:dir { getattr search open read lock ioctl };
#line 452

#line 452

#line 452
	 	
#line 452
##### end kernel_read_xen_state(xenstored_t) depth: 0
#line 452
 	

 	 	
#line 454
##### begin dev_filetrans_xen(xenstored_t) depth: 1
#line 454
 	
#line 454
	
#line 454
	
#line 454
		require {
#line 454
			
#line 454
		type device_t, xen_device_t;
#line 454
	
#line 454
		} # end require
#line 454
	
#line 454

#line 454

#line 454
	
#line 454
	allow xenstored_t device_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 454
	type_transition xenstored_t device_t:chr_file xen_device_t ;
#line 454

#line 454

#line 454
	 	
#line 454
##### end dev_filetrans_xen(xenstored_t) depth: 0
#line 454
 	
 	 	
#line 455
##### begin dev_rw_xen(xenstored_t) depth: 1
#line 455
 	
#line 455
	
#line 455
	
#line 455
		require {
#line 455
			
#line 455
		type device_t, xen_device_t;
#line 455
	
#line 455
		} # end require
#line 455
	
#line 455

#line 455

#line 455
	
#line 455
	allow xenstored_t device_t:dir { getattr search open };
#line 455
	allow xenstored_t xen_device_t:chr_file { getattr open read write append ioctl lock };
#line 455

#line 455

#line 455
	 	
#line 455
##### end dev_rw_xen(xenstored_t) depth: 0
#line 455
 	
 	 	
#line 456
##### begin dev_read_sysfs(xenstored_t) depth: 1
#line 456
 	
#line 456
	
#line 456
	
#line 456
		require {
#line 456
			
#line 456
		type sysfs_t;
#line 456
	
#line 456
		} # end require
#line 456
	
#line 456

#line 456

#line 456
	
#line 456
	allow xenstored_t sysfs_t:dir { getattr search open };
#line 456
	allow xenstored_t sysfs_t:file { getattr open read lock ioctl };
#line 456

#line 456
	
#line 456
	allow xenstored_t sysfs_t:dir { getattr search open };
#line 456
	allow xenstored_t sysfs_t:lnk_file { getattr read };
#line 456

#line 456

#line 456
	
#line 456
	allow xenstored_t sysfs_t:dir { getattr search open };
#line 456
	allow xenstored_t sysfs_t:dir { getattr search open read lock ioctl };
#line 456

#line 456

#line 456
	 	
#line 456
##### end dev_read_sysfs(xenstored_t) depth: 0
#line 456
 	

 	 	
#line 458
##### begin files_read_etc_files(xenstored_t) depth: 1
#line 458
 	
#line 458
	
#line 458
	
#line 458
		require {
#line 458
			
#line 458
		type etc_t;
#line 458
	
#line 458
		} # end require
#line 458
	
#line 458

#line 458

#line 458
	allow xenstored_t etc_t:dir { getattr search open read lock ioctl };
#line 458
	
#line 458
	allow xenstored_t etc_t:dir { getattr search open };
#line 458
	allow xenstored_t etc_t:file { getattr open read lock ioctl };
#line 458

#line 458
	
#line 458
	allow xenstored_t etc_t:dir { getattr search open };
#line 458
	allow xenstored_t etc_t:lnk_file { getattr read };
#line 458

#line 458

#line 458
	 	
#line 458
##### end files_read_etc_files(xenstored_t) depth: 0
#line 458
 	
 	 	
#line 459
##### begin files_read_usr_files(xenstored_t) depth: 1
#line 459
 	
#line 459
	
#line 459
	
#line 459
		require {
#line 459
			
#line 459
		type usr_t;
#line 459
	
#line 459
		} # end require
#line 459
	
#line 459

#line 459

#line 459
	allow xenstored_t usr_t:dir { getattr search open read lock ioctl };
#line 459
	
#line 459
	allow xenstored_t usr_t:dir { getattr search open };
#line 459
	allow xenstored_t usr_t:file { getattr open read lock ioctl };
#line 459

#line 459
	
#line 459
	allow xenstored_t usr_t:dir { getattr search open };
#line 459
	allow xenstored_t usr_t:lnk_file { getattr read };
#line 459

#line 459

#line 459
	 	
#line 459
##### end files_read_usr_files(xenstored_t) depth: 0
#line 459
 	
 	 	
#line 460
##### begin corecmd_search_bin(xenstored_t) depth: 1
#line 460
 	
#line 460
	
#line 460
	
#line 460
		require {
#line 460
			
#line 460
		type bin_t;
#line 460
	
#line 460
		} # end require
#line 460
	
#line 460

#line 460

#line 460
	
#line 460
	allow xenstored_t bin_t:dir { getattr search open };
#line 460
	allow xenstored_t bin_t:dir { getattr search open };
#line 460

#line 460

#line 460
	 	
#line 460
##### end corecmd_search_bin(xenstored_t) depth: 0
#line 460
 	

 	 	
#line 462
##### begin fs_search_xenfs(xenstored_t) depth: 1
#line 462
 	
#line 462
	
#line 462
	
#line 462
		require {
#line 462
			
#line 462
		type xenfs_t;
#line 462
	
#line 462
		} # end require
#line 462
	
#line 462

#line 462

#line 462
	allow xenstored_t xenfs_t:dir { getattr search open };
#line 462

#line 462
	 	
#line 462
##### end fs_search_xenfs(xenstored_t) depth: 0
#line 462
 	
 	 	
#line 463
##### begin fs_manage_xenfs_files(xenstored_t) depth: 1
#line 463
 	
#line 463
	
#line 463
	
#line 463
		require {
#line 463
			
#line 463
		type xenfs_t;
#line 463
	
#line 463
		} # end require
#line 463
	
#line 463

#line 463

#line 463
	
#line 463
	allow xenstored_t xenfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 463
	allow xenstored_t xenfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 463

#line 463

#line 463
	 	
#line 463
##### end fs_manage_xenfs_files(xenstored_t) depth: 0
#line 463
 	

 	 	
#line 465
##### begin term_use_generic_ptys(xenstored_t) depth: 1
#line 465
 	
#line 465
	
#line 465
	
#line 465
		require {
#line 465
			
#line 465
		type devpts_t;
#line 465
	
#line 465
		} # end require
#line 465
	
#line 465

#line 465

#line 465
	 	 	
#line 465
##### begin dev_list_all_dev_nodes(xenstored_t) depth: 2
#line 465
 	
#line 465
	
#line 465
	
#line 465
		require {
#line 465
			
#line 465
		type device_t;
#line 465
	
#line 465
		} # end require
#line 465
	
#line 465

#line 465

#line 465
	
#line 465
	allow xenstored_t device_t:dir { getattr search open };
#line 465
	allow xenstored_t device_t:dir { getattr search open read lock ioctl };
#line 465

#line 465
	
#line 465
	allow xenstored_t device_t:dir { getattr search open };
#line 465
	allow xenstored_t device_t:lnk_file { getattr read };
#line 465

#line 465

#line 465
	 	
#line 465
##### end dev_list_all_dev_nodes(xenstored_t) depth: 1
#line 465
 	
#line 465
	allow xenstored_t devpts_t:dir { getattr search open read lock ioctl };
#line 465
	allow xenstored_t devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 465

#line 465
	 	
#line 465
##### end term_use_generic_ptys(xenstored_t) depth: 0
#line 465
 	

 	 	
#line 467
##### begin init_use_fds(xenstored_t) depth: 1
#line 467
 	
#line 467
	
#line 467
	
#line 467
		require {
#line 467
			
#line 467
		type init_t;
#line 467
	
#line 467
		} # end require
#line 467
	
#line 467

#line 467

#line 467
	allow xenstored_t init_t:fd use;
#line 467

#line 467
	 	
#line 467
##### end init_use_fds(xenstored_t) depth: 0
#line 467
 	
 	 	
#line 468
##### begin init_use_script_ptys(xenstored_t) depth: 1
#line 468
 	
#line 468
	
#line 468
	
#line 468
		require {
#line 468
			
#line 468
		type initrc_devpts_t;
#line 468
	
#line 468
		} # end require
#line 468
	
#line 468

#line 468

#line 468
	 	 	
#line 468
##### begin term_list_ptys(xenstored_t) depth: 2
#line 468
 	
#line 468
	
#line 468
	
#line 468
		require {
#line 468
			
#line 468
		type devpts_t;
#line 468
	
#line 468
		} # end require
#line 468
	
#line 468

#line 468

#line 468
	 	 	
#line 468
##### begin dev_list_all_dev_nodes(xenstored_t) depth: 3
#line 468
 	
#line 468
	
#line 468
	
#line 468
		require {
#line 468
			
#line 468
		type device_t;
#line 468
	
#line 468
		} # end require
#line 468
	
#line 468

#line 468

#line 468
	
#line 468
	allow xenstored_t device_t:dir { getattr search open };
#line 468
	allow xenstored_t device_t:dir { getattr search open read lock ioctl };
#line 468

#line 468
	
#line 468
	allow xenstored_t device_t:dir { getattr search open };
#line 468
	allow xenstored_t device_t:lnk_file { getattr read };
#line 468

#line 468

#line 468
	 	
#line 468
##### end dev_list_all_dev_nodes(xenstored_t) depth: 2
#line 468
 	
#line 468
	allow xenstored_t devpts_t:dir { getattr search open read lock ioctl };
#line 468

#line 468
	 	
#line 468
##### end term_list_ptys(xenstored_t) depth: 1
#line 468
 	
#line 468
	allow xenstored_t initrc_devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 468

#line 468
	 	
#line 468
##### end init_use_script_ptys(xenstored_t) depth: 0
#line 468
 	

 	 	
#line 470
##### begin logging_send_syslog_msg(xenstored_t) depth: 1
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type syslogd_t, syslogd_var_run_t, devlog_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	allow xenstored_t devlog_t:sock_file { getattr write open append };
#line 470

#line 470
	# systemd journal socket is in /run/systemd/journal/dev-log
#line 470
	 	 	
#line 470
##### begin init_search_run(xenstored_t) depth: 2
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type init_var_run_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	 	 	
#line 470
##### begin files_search_pids(xenstored_t) depth: 3
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type var_t, var_run_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	allow xenstored_t var_run_t:lnk_file { getattr read };
#line 470
	
#line 470
	allow xenstored_t var_t:dir { getattr search open };
#line 470
	allow xenstored_t var_run_t:dir { getattr search open };
#line 470

#line 470

#line 470
	 	
#line 470
##### end files_search_pids(xenstored_t) depth: 2
#line 470
 	
#line 470
	allow xenstored_t init_var_run_t:dir { getattr search open };
#line 470

#line 470
	 	
#line 470
##### end init_search_run(xenstored_t) depth: 1
#line 470
 	
#line 470
	allow xenstored_t syslogd_var_run_t:dir { getattr search open };
#line 470

#line 470
	# the type of socket depends on the syslog daemon
#line 470
	allow xenstored_t syslogd_t:unix_dgram_socket sendto;
#line 470
	allow xenstored_t syslogd_t:unix_stream_socket connectto;
#line 470
	allow xenstored_t self:unix_dgram_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 470
	allow xenstored_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 470

#line 470
	# If syslog is down, the glibc syslog() function
#line 470
	# will write to the console.
#line 470
	 	 	
#line 470
##### begin term_write_console(xenstored_t) depth: 2
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type console_device_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	 	 	
#line 470
##### begin dev_list_all_dev_nodes(xenstored_t) depth: 3
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type device_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	
#line 470
	allow xenstored_t device_t:dir { getattr search open };
#line 470
	allow xenstored_t device_t:dir { getattr search open read lock ioctl };
#line 470

#line 470
	
#line 470
	allow xenstored_t device_t:dir { getattr search open };
#line 470
	allow xenstored_t device_t:lnk_file { getattr read };
#line 470

#line 470

#line 470
	 	
#line 470
##### end dev_list_all_dev_nodes(xenstored_t) depth: 2
#line 470
 	
#line 470
	allow xenstored_t console_device_t:chr_file { getattr open write append lock ioctl };
#line 470

#line 470
	 	
#line 470
##### end term_write_console(xenstored_t) depth: 1
#line 470
 	
#line 470
	 	 	
#line 470
##### begin term_dontaudit_read_console(xenstored_t) depth: 2
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type console_device_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	dontaudit xenstored_t console_device_t:chr_file { getattr open read lock ioctl };
#line 470

#line 470
	 	
#line 470
##### end term_dontaudit_read_console(xenstored_t) depth: 1
#line 470
 	
#line 470

#line 470
	# because systemd is now using /run/systemd/journal/dev-log
#line 470
	 	 	
#line 470
##### begin init_search_pid_dirs(xenstored_t) depth: 2
#line 470
 	
#line 470
    
#line 470
	
#line 470
		require {
#line 470
			
#line 470
        type init_var_run_t;
#line 470
    
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
    allow xenstored_t init_var_run_t:dir { getattr search open };
#line 470

#line 470
	 	
#line 470
##### end init_search_pid_dirs(xenstored_t) depth: 1
#line 470
 	
#line 470

#line 470
	 	
#line 470
##### end logging_send_syslog_msg(xenstored_t) depth: 0
#line 470
 	

 	 	
#line 472
##### begin miscfiles_read_localization(xenstored_t) depth: 1
#line 472
 	
#line 472
	
#line 472
	
#line 472
		require {
#line 472
			
#line 472
		type locale_t;
#line 472
	
#line 472
		} # end require
#line 472
	
#line 472

#line 472

#line 472
	 	 	
#line 472
##### begin files_read_etc_symlinks(xenstored_t) depth: 2
#line 472
 	
#line 472
	
#line 472
	
#line 472
		require {
#line 472
			
#line 472
		type etc_t;
#line 472
	
#line 472
		} # end require
#line 472
	
#line 472

#line 472

#line 472
	
#line 472
	allow xenstored_t etc_t:dir { getattr search open };
#line 472
	allow xenstored_t etc_t:lnk_file { getattr read };
#line 472

#line 472

#line 472
	 	
#line 472
##### end files_read_etc_symlinks(xenstored_t) depth: 1
#line 472
 	
#line 472
	 	 	
#line 472
##### begin files_search_usr(xenstored_t) depth: 2
#line 472
 	
#line 472
	
#line 472
	
#line 472
		require {
#line 472
			
#line 472
		type usr_t;
#line 472
	
#line 472
		} # end require
#line 472
	
#line 472

#line 472

#line 472
	allow xenstored_t usr_t:dir { getattr search open };
#line 472

#line 472
	 	
#line 472
##### end files_search_usr(xenstored_t) depth: 1
#line 472
 	
#line 472
	allow xenstored_t locale_t:dir { getattr search open read lock ioctl };
#line 472
	
#line 472
	allow xenstored_t locale_t:dir { getattr search open };
#line 472
	allow xenstored_t locale_t:file { getattr open read lock ioctl };
#line 472

#line 472
	
#line 472
	allow xenstored_t locale_t:dir { getattr search open };
#line 472
	allow xenstored_t locale_t:lnk_file { getattr read };
#line 472

#line 472

#line 472
	 	
#line 472
##### end miscfiles_read_localization(xenstored_t) depth: 0
#line 472
 	

 	 	
#line 474
##### begin xen_append_log(xenstored_t) depth: 1
#line 474
 	
#line 474
	
#line 474
	
#line 474
		require {
#line 474
			
#line 474
		type xend_var_log_t;
#line 474
	
#line 474
		} # end require
#line 474
	
#line 474

#line 474

#line 474
	 	 	
#line 474
##### begin logging_search_logs(xenstored_t) depth: 2
#line 474
 	
#line 474
	
#line 474
	
#line 474
		require {
#line 474
			
#line 474
		type var_log_t;
#line 474
	
#line 474
		} # end require
#line 474
	
#line 474

#line 474

#line 474
	 	 	
#line 474
##### begin files_search_var(xenstored_t) depth: 3
#line 474
 	
#line 474
	
#line 474
	
#line 474
		require {
#line 474
			
#line 474
		type var_t;
#line 474
	
#line 474
		} # end require
#line 474
	
#line 474

#line 474

#line 474
	allow xenstored_t var_t:dir { getattr search open };
#line 474

#line 474
	 	
#line 474
##### end files_search_var(xenstored_t) depth: 2
#line 474
 	
#line 474
	allow xenstored_t var_log_t:dir { getattr search open };
#line 474
	allow xenstored_t var_log_t:lnk_file { getattr read };
#line 474

#line 474
	 	
#line 474
##### end logging_search_logs(xenstored_t) depth: 1
#line 474
 	
#line 474
	
#line 474
	allow xenstored_t xend_var_log_t:dir { getattr search open };
#line 474
	allow xenstored_t xend_var_log_t:file { getattr open append lock ioctl };
#line 474

#line 474
	dontaudit xenstored_t xend_var_log_t:file write;
#line 474

#line 474
	 	
#line 474
##### end xen_append_log(xenstored_t) depth: 0
#line 474
 	

########################################
#
# xm local policy
#

allow xm_t self:capability { dac_override setpcap net_admin ipc_lock sys_nice sys_tty_config };
allow xm_t self:process { getcap getsched setsched setcap signal sigkill };
allow xm_t self:fifo_file { open { getattr read write append ioctl lock } };
allow xm_t self:unix_stream_socket { accept connectto listen };
allow xm_t self:tcp_socket { accept listen };

allow xm_t xend_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };

 	 	
#line 489
##### begin files_lock_filetrans(xm_t,xen_lock_t,file) depth: 1
#line 489
 	
#line 489
	
#line 489
	
#line 489
		require {
#line 489
			
#line 489
		type var_t, var_lock_t;
#line 489
	
#line 489
		} # end require
#line 489
	
#line 489

#line 489

#line 489
	allow xm_t var_t:dir { getattr search open };
#line 489
	allow xm_t var_lock_t:lnk_file { getattr read };
#line 489
	
#line 489
	allow xm_t var_lock_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 489
	type_transition xm_t var_lock_t:file xen_lock_t ;
#line 489

#line 489

#line 489
	 	
#line 489
##### end files_lock_filetrans(xm_t,xen_lock_t,file) depth: 0
#line 489
 	
allow xm_t xen_lock_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
 	 	
#line 491
##### begin domain_use_interactive_fds(xm_t) depth: 1
#line 491
 	
#line 491
	
#line 491
	
#line 491
		require {
#line 491
			
#line 491
		attribute privfd;
#line 491
	
#line 491
		} # end require
#line 491
	
#line 491

#line 491

#line 491
	allow xm_t privfd:fd use;
#line 491

#line 491
	 	
#line 491
##### end domain_use_interactive_fds(xm_t) depth: 0
#line 491
 	

 	 	
#line 493
##### begin userdom_dontaudit_search_user_home_content(xm_t) depth: 1
#line 493
 	
#line 493
	
#line 493
	
#line 493
		require {
#line 493
			
#line 493
		type user_home_t;
#line 493
	
#line 493
		} # end require
#line 493
	
#line 493

#line 493

#line 493
	dontaudit xm_t user_home_t:dir { getattr search open };
#line 493

#line 493
	 	
#line 493
##### end userdom_dontaudit_search_user_home_content(xm_t) depth: 0
#line 493
 	

# for vif-bridge to write to /run/xen-hotplug/iptables
# maybe we need a different label for /run/xen-hotplug
 	 	
#line 497
##### begin udev_manage_pid_files(xm_t) depth: 1
#line 497
 	
#line 497
	
#line 497
	
#line 497
		require {
#line 497
			
#line 497
		type udev_var_run_t;
#line 497
	
#line 497
		} # end require
#line 497
	
#line 497

#line 497

#line 497
	 	 	
#line 497
##### begin files_search_pids(xm_t) depth: 2
#line 497
 	
#line 497
	
#line 497
	
#line 497
		require {
#line 497
			
#line 497
		type var_t, var_run_t;
#line 497
	
#line 497
		} # end require
#line 497
	
#line 497

#line 497

#line 497
	allow xm_t var_run_t:lnk_file { getattr read };
#line 497
	
#line 497
	allow xm_t var_t:dir { getattr search open };
#line 497
	allow xm_t var_run_t:dir { getattr search open };
#line 497

#line 497

#line 497
	 	
#line 497
##### end files_search_pids(xm_t) depth: 1
#line 497
 	
#line 497
	
#line 497
	allow xm_t udev_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 497
	allow xm_t udev_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 497

#line 497

#line 497
	 	
#line 497
##### end udev_manage_pid_files(xm_t) depth: 0
#line 497
 	


#line 499
	allow xm_t xend_var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 499
	allow xm_t xend_var_log_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 499



#line 501
	allow xm_t xend_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 501
	allow xm_t xend_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 501


#line 502
	allow xm_t xend_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 502
	allow xm_t xend_var_lib_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 502


#line 503
	allow xm_t xend_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 503
	allow xm_t xend_var_lib_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 503



#line 505
	allow xm_t xen_image_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 505
	allow xm_t xen_image_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 505


#line 506
	allow xm_t self:capability mknod;
#line 506
	allow xm_t xen_image_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 506
	allow xm_t xen_image_t:blk_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 506


#line 507
	allow xm_t xen_image_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 507
	allow xm_t xen_image_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 507



#line 509
	allow xm_t xenstored_var_run_t:dir { getattr search open };
#line 509
	allow xm_t xenstored_var_run_t:file { getattr open read lock ioctl };
#line 509


 	 	
#line 511
##### begin xen_manage_image_dirs(xm_t) depth: 1
#line 511
 	
#line 511
	
#line 511
	
#line 511
		require {
#line 511
			
#line 511
		type xend_var_lib_t;
#line 511
	
#line 511
		} # end require
#line 511
	
#line 511

#line 511

#line 511
	 	 	
#line 511
##### begin files_search_var_lib(xm_t) depth: 2
#line 511
 	
#line 511
	
#line 511
	
#line 511
		require {
#line 511
			
#line 511
		type var_t, var_lib_t;
#line 511
	
#line 511
		} # end require
#line 511
	
#line 511

#line 511

#line 511
	
#line 511
	allow xm_t var_t:dir { getattr search open };
#line 511
	allow xm_t var_lib_t:dir { getattr search open };
#line 511

#line 511

#line 511
	 	
#line 511
##### end files_search_var_lib(xm_t) depth: 1
#line 511
 	
#line 511
	
#line 511
	allow xm_t xend_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 511
	allow xm_t xend_var_lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 511

#line 511

#line 511
	 	
#line 511
##### end xen_manage_image_dirs(xm_t) depth: 0
#line 511
 	
 	 	
#line 512
##### begin xen_append_log(xm_t) depth: 1
#line 512
 	
#line 512
	
#line 512
	
#line 512
		require {
#line 512
			
#line 512
		type xend_var_log_t;
#line 512
	
#line 512
		} # end require
#line 512
	
#line 512

#line 512

#line 512
	 	 	
#line 512
##### begin logging_search_logs(xm_t) depth: 2
#line 512
 	
#line 512
	
#line 512
	
#line 512
		require {
#line 512
			
#line 512
		type var_log_t;
#line 512
	
#line 512
		} # end require
#line 512
	
#line 512

#line 512

#line 512
	 	 	
#line 512
##### begin files_search_var(xm_t) depth: 3
#line 512
 	
#line 512
	
#line 512
	
#line 512
		require {
#line 512
			
#line 512
		type var_t;
#line 512
	
#line 512
		} # end require
#line 512
	
#line 512

#line 512

#line 512
	allow xm_t var_t:dir { getattr search open };
#line 512

#line 512
	 	
#line 512
##### end files_search_var(xm_t) depth: 2
#line 512
 	
#line 512
	allow xm_t var_log_t:dir { getattr search open };
#line 512
	allow xm_t var_log_t:lnk_file { getattr read };
#line 512

#line 512
	 	
#line 512
##### end logging_search_logs(xm_t) depth: 1
#line 512
 	
#line 512
	
#line 512
	allow xm_t xend_var_log_t:dir { getattr search open };
#line 512
	allow xm_t xend_var_log_t:file { getattr open append lock ioctl };
#line 512

#line 512
	dontaudit xm_t xend_var_log_t:file write;
#line 512

#line 512
	 	
#line 512
##### end xen_append_log(xm_t) depth: 0
#line 512
 	
 	 	
#line 513
##### begin xen_domtrans(xm_t) depth: 1
#line 513
 	
#line 513
	
#line 513
	
#line 513
		require {
#line 513
			
#line 513
		type xend_t, xend_exec_t;
#line 513
	
#line 513
		} # end require
#line 513
	
#line 513

#line 513

#line 513
	 	 	
#line 513
##### begin corecmd_search_bin(xm_t) depth: 2
#line 513
 	
#line 513
	
#line 513
	
#line 513
		require {
#line 513
			
#line 513
		type bin_t;
#line 513
	
#line 513
		} # end require
#line 513
	
#line 513

#line 513

#line 513
	
#line 513
	allow xm_t bin_t:dir { getattr search open };
#line 513
	allow xm_t bin_t:dir { getattr search open };
#line 513

#line 513

#line 513
	 	
#line 513
##### end corecmd_search_bin(xm_t) depth: 1
#line 513
 	
#line 513
	
#line 513
	
#line 513
	
#line 513
	allow xm_t xend_exec_t:file { getattr open read execute };
#line 513
	allow xm_t xend_t:process transition;
#line 513
	dontaudit xm_t xend_t:process { noatsecure siginh rlimitinh };
#line 513

#line 513
	type_transition xm_t xend_exec_t:process xend_t;
#line 513

#line 513

#line 513
	allow xend_t xm_t:fd use;
#line 513
	allow xend_t xm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 513
	allow xend_t xm_t:process sigchld;
#line 513

#line 513

#line 513
	 	
#line 513
##### end xen_domtrans(xm_t) depth: 0
#line 513
 	
 	 	
#line 514
##### begin xen_stream_connect(xm_t) depth: 1
#line 514
 	
#line 514
	
#line 514
	
#line 514
		require {
#line 514
			
#line 514
		type xend_t, xend_var_run_t, xend_var_lib_t;
#line 514
	
#line 514
		} # end require
#line 514
	
#line 514

#line 514

#line 514
	 	 	
#line 514
##### begin files_search_pids(xm_t) depth: 2
#line 514
 	
#line 514
	
#line 514
	
#line 514
		require {
#line 514
			
#line 514
		type var_t, var_run_t;
#line 514
	
#line 514
		} # end require
#line 514
	
#line 514

#line 514

#line 514
	allow xm_t var_run_t:lnk_file { getattr read };
#line 514
	
#line 514
	allow xm_t var_t:dir { getattr search open };
#line 514
	allow xm_t var_run_t:dir { getattr search open };
#line 514

#line 514

#line 514
	 	
#line 514
##### end files_search_pids(xm_t) depth: 1
#line 514
 	
#line 514
	
#line 514
	allow xm_t xend_var_run_t:dir { getattr search open };
#line 514
	allow xm_t xend_var_run_t:sock_file { getattr write open append };
#line 514
	allow xm_t xend_t:unix_stream_socket connectto;
#line 514

#line 514

#line 514
	 	 	
#line 514
##### begin files_search_var_lib(xm_t) depth: 2
#line 514
 	
#line 514
	
#line 514
	
#line 514
		require {
#line 514
			
#line 514
		type var_t, var_lib_t;
#line 514
	
#line 514
		} # end require
#line 514
	
#line 514

#line 514

#line 514
	
#line 514
	allow xm_t var_t:dir { getattr search open };
#line 514
	allow xm_t var_lib_t:dir { getattr search open };
#line 514

#line 514

#line 514
	 	
#line 514
##### end files_search_var_lib(xm_t) depth: 1
#line 514
 	
#line 514
	
#line 514
	allow xm_t xend_var_lib_t:dir { getattr search open };
#line 514
	allow xm_t xend_var_lib_t:sock_file { getattr write open append };
#line 514
	allow xm_t xend_t:unix_stream_socket connectto;
#line 514

#line 514

#line 514
	 	
#line 514
##### end xen_stream_connect(xm_t) depth: 0
#line 514
 	
 	 	
#line 515
##### begin xen_stream_connect_xenstore(xm_t) depth: 1
#line 515
 	
#line 515
	
#line 515
	
#line 515
		require {
#line 515
			
#line 515
		type xenstored_t, xenstored_var_run_t;
#line 515
	
#line 515
		} # end require
#line 515
	
#line 515

#line 515

#line 515
	 	 	
#line 515
##### begin files_search_pids(xm_t) depth: 2
#line 515
 	
#line 515
	
#line 515
	
#line 515
		require {
#line 515
			
#line 515
		type var_t, var_run_t;
#line 515
	
#line 515
		} # end require
#line 515
	
#line 515

#line 515

#line 515
	allow xm_t var_run_t:lnk_file { getattr read };
#line 515
	
#line 515
	allow xm_t var_t:dir { getattr search open };
#line 515
	allow xm_t var_run_t:dir { getattr search open };
#line 515

#line 515

#line 515
	 	
#line 515
##### end files_search_pids(xm_t) depth: 1
#line 515
 	
#line 515
	
#line 515
	allow xm_t xenstored_var_run_t:dir { getattr search open };
#line 515
	allow xm_t xenstored_var_run_t:sock_file { getattr write open append };
#line 515
	allow xm_t xenstored_t:unix_stream_socket connectto;
#line 515

#line 515

#line 515
	 	
#line 515
##### end xen_stream_connect_xenstore(xm_t) depth: 0
#line 515
 	

allow xm_t xm_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };

 	 	
#line 519
##### begin kernel_load_module(xm_t) depth: 1
#line 519
 	
#line 519
	
#line 519
	
#line 519
		require {
#line 519
			
#line 519
		attribute can_load_kernmodule;
#line 519
	
#line 519
		} # end require
#line 519
	
#line 519

#line 519

#line 519
	typeattribute xm_t can_load_kernmodule;
#line 519

#line 519
	 	
#line 519
##### end kernel_load_module(xm_t) depth: 0
#line 519
 	
 	 	
#line 520
##### begin kernel_request_load_module(xm_t) depth: 1
#line 520
 	
#line 520
	
#line 520
	
#line 520
		require {
#line 520
			
#line 520
		type kernel_t;
#line 520
	
#line 520
		} # end require
#line 520
	
#line 520

#line 520

#line 520
	allow xm_t kernel_t:system module_request;
#line 520

#line 520
	 	
#line 520
##### end kernel_request_load_module(xm_t) depth: 0
#line 520
 	
 	 	
#line 521
##### begin files_read_kernel_img(xm_t) depth: 1
#line 521
 	
#line 521
	
#line 521
	
#line 521
		require {
#line 521
			
#line 521
		type boot_t;
#line 521
	
#line 521
		} # end require
#line 521
	
#line 521

#line 521

#line 521
	allow xm_t boot_t:dir { getattr search open read lock ioctl };
#line 521
	
#line 521
	allow xm_t boot_t:dir { getattr search open };
#line 521
	allow xm_t boot_t:file { getattr open read lock ioctl };
#line 521

#line 521
	
#line 521
	allow xm_t boot_t:dir { getattr search open };
#line 521
	allow xm_t boot_t:lnk_file { getattr read };
#line 521

#line 521

#line 521
	 	
#line 521
##### end files_read_kernel_img(xm_t) depth: 0
#line 521
 	
 	 	
#line 522
##### begin kernel_read_system_state(xm_t) depth: 1
#line 522
 	
#line 522
	
#line 522
	
#line 522
		require {
#line 522
			
#line 522
		type proc_t;
#line 522
	
#line 522
		} # end require
#line 522
	
#line 522

#line 522

#line 522
	
#line 522
	allow xm_t proc_t:dir { getattr search open };
#line 522
	allow xm_t proc_t:file { getattr open read lock ioctl };
#line 522

#line 522
	
#line 522
	allow xm_t proc_t:dir { getattr search open };
#line 522
	allow xm_t proc_t:lnk_file { getattr read };
#line 522

#line 522

#line 522
	
#line 522
	allow xm_t proc_t:dir { getattr search open };
#line 522
	allow xm_t proc_t:dir { getattr search open read lock ioctl };
#line 522

#line 522

#line 522
	 	
#line 522
##### end kernel_read_system_state(xm_t) depth: 0
#line 522
 	
 	 	
#line 523
##### begin kernel_read_network_state(xm_t) depth: 1
#line 523
 	
#line 523
	
#line 523
	
#line 523
		require {
#line 523
			
#line 523
		type proc_t, proc_net_t;
#line 523
	
#line 523
		} # end require
#line 523
	
#line 523

#line 523

#line 523
	
#line 523
	allow xm_t { proc_t proc_net_t }:dir { getattr search open };
#line 523
	allow xm_t proc_net_t:file { getattr open read lock ioctl };
#line 523

#line 523
	
#line 523
	allow xm_t { proc_t proc_net_t }:dir { getattr search open };
#line 523
	allow xm_t proc_net_t:lnk_file { getattr read };
#line 523

#line 523

#line 523
	
#line 523
	allow xm_t proc_t:dir { getattr search open };
#line 523
	allow xm_t proc_net_t:dir { getattr search open read lock ioctl };
#line 523

#line 523

#line 523
	 	
#line 523
##### end kernel_read_network_state(xm_t) depth: 0
#line 523
 	
 	 	
#line 524
##### begin kernel_read_kernel_sysctls(xm_t) depth: 1
#line 524
 	
#line 524
	
#line 524
	
#line 524
		require {
#line 524
			
#line 524
		type proc_t, sysctl_t, sysctl_kernel_t;
#line 524
	
#line 524
		} # end require
#line 524
	
#line 524

#line 524

#line 524
	
#line 524
	allow xm_t { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 524
	allow xm_t sysctl_kernel_t:file { getattr open read lock ioctl };
#line 524

#line 524

#line 524
	
#line 524
	allow xm_t { proc_t sysctl_t }:dir { getattr search open };
#line 524
	allow xm_t sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 524

#line 524

#line 524
	 	
#line 524
##### end kernel_read_kernel_sysctls(xm_t) depth: 0
#line 524
 	
 	 	
#line 525
##### begin kernel_read_sysctl(xm_t) depth: 1
#line 525
 	
#line 525
	
#line 525
	
#line 525
		require {
#line 525
			
#line 525
		type sysctl_t, proc_t;
#line 525
	
#line 525
		} # end require
#line 525
	
#line 525

#line 525

#line 525
	
#line 525
	allow xm_t proc_t:dir { getattr search open };
#line 525
	allow xm_t sysctl_t:dir { getattr search open read lock ioctl };
#line 525

#line 525
	
#line 525
	allow xm_t sysctl_t:dir { getattr search open };
#line 525
	allow xm_t sysctl_t:file { getattr open read lock ioctl };
#line 525

#line 525

#line 525
	 	
#line 525
##### end kernel_read_sysctl(xm_t) depth: 0
#line 525
 	
 	 	
#line 526
##### begin kernel_read_xen_state(xm_t) depth: 1
#line 526
 	
#line 526
	
#line 526
	
#line 526
		require {
#line 526
			
#line 526
		type proc_t, proc_xen_t;
#line 526
	
#line 526
		} # end require
#line 526
	
#line 526

#line 526

#line 526
	
#line 526
	allow xm_t { proc_t proc_xen_t }:dir { getattr search open };
#line 526
	allow xm_t proc_xen_t:file { getattr open read lock ioctl };
#line 526

#line 526
	
#line 526
	allow xm_t { proc_t proc_xen_t }:dir { getattr search open };
#line 526
	allow xm_t proc_xen_t:lnk_file { getattr read };
#line 526

#line 526

#line 526
	
#line 526
	allow xm_t proc_t:dir { getattr search open };
#line 526
	allow xm_t proc_xen_t:dir { getattr search open read lock ioctl };
#line 526

#line 526

#line 526
	 	
#line 526
##### end kernel_read_xen_state(xm_t) depth: 0
#line 526
 	
 	 	
#line 527
##### begin kernel_write_xen_state(xm_t) depth: 1
#line 527
 	
#line 527
	
#line 527
	
#line 527
		require {
#line 527
			
#line 527
		type proc_t, proc_xen_t;
#line 527
	
#line 527
		} # end require
#line 527
	
#line 527

#line 527

#line 527
	
#line 527
	allow xm_t { proc_t proc_xen_t }:dir { getattr search open };
#line 527
	allow xm_t proc_xen_t:file { getattr open write append lock ioctl };
#line 527

#line 527

#line 527
	 	
#line 527
##### end kernel_write_xen_state(xm_t) depth: 0
#line 527
 	
 	 	
#line 528
##### begin sysnet_domtrans_ifconfig(xm_t) depth: 1
#line 528
 	
#line 528
	
#line 528
	
#line 528
		require {
#line 528
			
#line 528
		type ifconfig_t, ifconfig_exec_t;
#line 528
	
#line 528
		} # end require
#line 528
	
#line 528

#line 528

#line 528
	 	 	
#line 528
##### begin corecmd_search_bin(xm_t) depth: 2
#line 528
 	
#line 528
	
#line 528
	
#line 528
		require {
#line 528
			
#line 528
		type bin_t;
#line 528
	
#line 528
		} # end require
#line 528
	
#line 528

#line 528

#line 528
	
#line 528
	allow xm_t bin_t:dir { getattr search open };
#line 528
	allow xm_t bin_t:dir { getattr search open };
#line 528

#line 528

#line 528
	 	
#line 528
##### end corecmd_search_bin(xm_t) depth: 1
#line 528
 	
#line 528
	
#line 528
	
#line 528
	
#line 528
	allow xm_t ifconfig_exec_t:file { getattr open read execute };
#line 528
	allow xm_t ifconfig_t:process transition;
#line 528
	dontaudit xm_t ifconfig_t:process { noatsecure siginh rlimitinh };
#line 528

#line 528
	type_transition xm_t ifconfig_exec_t:process ifconfig_t;
#line 528

#line 528

#line 528
	allow ifconfig_t xm_t:fd use;
#line 528
	allow ifconfig_t xm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 528
	allow ifconfig_t xm_t:process sigchld;
#line 528

#line 528

#line 528
	 	
#line 528
##### end sysnet_domtrans_ifconfig(xm_t) depth: 0
#line 528
 	

 	 	
#line 530
##### begin corecmd_exec_bin(xm_t) depth: 1
#line 530
 	
#line 530
	
#line 530
	
#line 530
		require {
#line 530
			
#line 530
		type bin_t;
#line 530
	
#line 530
		} # end require
#line 530
	
#line 530

#line 530

#line 530
	
#line 530
	allow xm_t bin_t:dir { getattr search open };
#line 530
	allow xm_t bin_t:lnk_file { getattr read };
#line 530

#line 530
	
#line 530
	allow xm_t bin_t:dir { getattr search open };
#line 530
	allow xm_t bin_t:dir { getattr search open read lock ioctl };
#line 530

#line 530
	allow xm_t bin_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 530

#line 530
	 	
#line 530
##### end corecmd_exec_bin(xm_t) depth: 0
#line 530
 	
 	 	
#line 531
##### begin corecmd_exec_shell(xm_t) depth: 1
#line 531
 	
#line 531
	
#line 531
	
#line 531
		require {
#line 531
			
#line 531
		type bin_t, shell_exec_t;
#line 531
	
#line 531
		} # end require
#line 531
	
#line 531

#line 531

#line 531
	
#line 531
	allow xm_t bin_t:dir { getattr search open };
#line 531
	allow xm_t bin_t:dir { getattr search open read lock ioctl };
#line 531

#line 531
	
#line 531
	allow xm_t bin_t:dir { getattr search open };
#line 531
	allow xm_t bin_t:lnk_file { getattr read };
#line 531

#line 531
	allow xm_t shell_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 531

#line 531
	 	
#line 531
##### end corecmd_exec_shell(xm_t) depth: 0
#line 531
 	

 	 	
#line 533
##### begin corenet_all_recvfrom_unlabeled(xm_t) depth: 1
#line 533
 	
#line 533
	 	 	
#line 533
##### begin kernel_tcp_recvfrom_unlabeled(xm_t) depth: 2
#line 533
 	
#line 533
	
#line 533
	
#line 533
		require {
#line 533
			
#line 533
		type unlabeled_t;
#line 533
	
#line 533
		} # end require
#line 533
	
#line 533

#line 533

#line 533
	allow xm_t unlabeled_t:tcp_socket recvfrom;
#line 533

#line 533
	 	
#line 533
##### end kernel_tcp_recvfrom_unlabeled(xm_t) depth: 1
#line 533
 	
#line 533
	 	 	
#line 533
##### begin kernel_udp_recvfrom_unlabeled(xm_t) depth: 2
#line 533
 	
#line 533
	
#line 533
	
#line 533
		require {
#line 533
			
#line 533
		type unlabeled_t;
#line 533
	
#line 533
		} # end require
#line 533
	
#line 533

#line 533

#line 533
	allow xm_t unlabeled_t:udp_socket recvfrom;
#line 533

#line 533
	 	
#line 533
##### end kernel_udp_recvfrom_unlabeled(xm_t) depth: 1
#line 533
 	
#line 533
	 	 	
#line 533
##### begin kernel_raw_recvfrom_unlabeled(xm_t) depth: 2
#line 533
 	
#line 533
	
#line 533
	
#line 533
		require {
#line 533
			
#line 533
		type unlabeled_t;
#line 533
	
#line 533
		} # end require
#line 533
	
#line 533

#line 533

#line 533
	allow xm_t unlabeled_t:rawip_socket recvfrom;
#line 533

#line 533
	 	
#line 533
##### end kernel_raw_recvfrom_unlabeled(xm_t) depth: 1
#line 533
 	
#line 533
	 	 	
#line 533
##### begin kernel_recvfrom_unlabeled_peer(xm_t) depth: 2
#line 533
 	
#line 533
	
#line 533
	
#line 533
		require {
#line 533
			
#line 533
		type unlabeled_t;
#line 533
	
#line 533
		} # end require
#line 533
	
#line 533

#line 533

#line 533
	allow xm_t unlabeled_t:peer recv;
#line 533

#line 533
	 	
#line 533
##### end kernel_recvfrom_unlabeled_peer(xm_t) depth: 1
#line 533
 	
#line 533

#line 533
	# XXX - at some point the oubound/send access check will be removed
#line 533
	# but for right now we need to keep this in place so as not to break
#line 533
	# older systems
#line 533
	 	 	
#line 533
##### begin kernel_sendrecv_unlabeled_association(xm_t) depth: 2
#line 533
 	
#line 533
	
#line 533
	
#line 533
		require {
#line 533
			
#line 533
		type unlabeled_t;
#line 533
	
#line 533
		} # end require
#line 533
	
#line 533

#line 533

#line 533
	allow xm_t unlabeled_t:association { sendto recvfrom };
#line 533

#line 533
	 	
#line 533
##### end kernel_sendrecv_unlabeled_association(xm_t) depth: 1
#line 533
 	
#line 533

#line 533
	 	
#line 533
##### end corenet_all_recvfrom_unlabeled(xm_t) depth: 0
#line 533
 	
 	 	
#line 534
##### begin corenet_all_recvfrom_netlabel(xm_t) depth: 1
#line 534
 	
#line 534
	
#line 534
	
#line 534
		require {
#line 534
			
#line 534
		type netlabel_peer_t;
#line 534
	
#line 534
		} # end require
#line 534
	
#line 534

#line 534

#line 534
	allow xm_t netlabel_peer_t:peer recv;
#line 534
	allow xm_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 534

#line 534
	 	
#line 534
##### end corenet_all_recvfrom_netlabel(xm_t) depth: 0
#line 534
 	
 	 	
#line 535
##### begin corenet_tcp_sendrecv_generic_if(xm_t) depth: 1
#line 535
 	
#line 535
	
#line 535
	
#line 535
		require {
#line 535
			
#line 535
		type netif_t;
#line 535
	
#line 535
		} # end require
#line 535
	
#line 535

#line 535

#line 535
	allow xm_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 535

#line 535
	 	
#line 535
##### end corenet_tcp_sendrecv_generic_if(xm_t) depth: 0
#line 535
 	
 	 	
#line 536
##### begin corenet_tcp_sendrecv_generic_node(xm_t) depth: 1
#line 536
 	
#line 536
	
#line 536
	
#line 536
		require {
#line 536
			
#line 536
		type node_t;
#line 536
	
#line 536
		} # end require
#line 536
	
#line 536

#line 536

#line 536
	allow xm_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 536

#line 536
	 	
#line 536
##### end corenet_tcp_sendrecv_generic_node(xm_t) depth: 0
#line 536
 	

 	 	
#line 538
##### begin corenet_sendrecv_soundd_client_packets(xm_t) depth: 1
#line 538
 	
#line 538
	 	 	
#line 538
##### begin corenet_send_soundd_client_packets(xm_t) depth: 2
#line 538
 	
#line 538
	
#line 538
	
#line 538
		require {
#line 538
			
#line 538
		type soundd_client_packet_t;
#line 538
	
#line 538
		} # end require
#line 538
	
#line 538

#line 538

#line 538
	allow xm_t soundd_client_packet_t:packet send;
#line 538

#line 538
	 	
#line 538
##### end corenet_send_soundd_client_packets(xm_t) depth: 1
#line 538
 	
#line 538
	 	 	
#line 538
##### begin corenet_receive_soundd_client_packets(xm_t) depth: 2
#line 538
 	
#line 538
	
#line 538
	
#line 538
		require {
#line 538
			
#line 538
		type soundd_client_packet_t;
#line 538
	
#line 538
		} # end require
#line 538
	
#line 538

#line 538

#line 538
	allow xm_t soundd_client_packet_t:packet recv;
#line 538

#line 538
	 	
#line 538
##### end corenet_receive_soundd_client_packets(xm_t) depth: 1
#line 538
 	
#line 538

#line 538
	 	
#line 538
##### end corenet_sendrecv_soundd_client_packets(xm_t) depth: 0
#line 538
 	
 	 	
#line 539
##### begin corenet_tcp_connect_soundd_port(xm_t) depth: 1
#line 539
 	
#line 539
	
#line 539
	
#line 539
		require {
#line 539
			
#line 539
		type soundd_port_t;
#line 539
	
#line 539
		} # end require
#line 539
	
#line 539

#line 539

#line 539
	allow xm_t soundd_port_t:tcp_socket name_connect;
#line 539

#line 539
	 	
#line 539
##### end corenet_tcp_connect_soundd_port(xm_t) depth: 0
#line 539
 	
 	 	
#line 540
##### begin corenet_tcp_sendrecv_soundd_port(xm_t) depth: 1
#line 540
 	
#line 540
	
#line 540
	
#line 540
		require {
#line 540
			
#line 540
		type soundd_port_t;
#line 540
	
#line 540
		} # end require
#line 540
	
#line 540

#line 540

#line 540
	allow xm_t soundd_port_t:tcp_socket { send_msg recv_msg };
#line 540

#line 540
	 	
#line 540
##### end corenet_tcp_sendrecv_soundd_port(xm_t) depth: 0
#line 540
 	

 	 	
#line 542
##### begin dev_read_rand(xm_t) depth: 1
#line 542
 	
#line 542
	
#line 542
	
#line 542
		require {
#line 542
			
#line 542
		type device_t, random_device_t;
#line 542
	
#line 542
		} # end require
#line 542
	
#line 542

#line 542

#line 542
	
#line 542
	allow xm_t device_t:dir { getattr search open };
#line 542
	allow xm_t random_device_t:chr_file { getattr open read lock ioctl };
#line 542

#line 542

#line 542
	 	
#line 542
##### end dev_read_rand(xm_t) depth: 0
#line 542
 	
 	 	
#line 543
##### begin dev_read_urand(xm_t) depth: 1
#line 543
 	
#line 543
	
#line 543
	
#line 543
		require {
#line 543
			
#line 543
		type device_t, urandom_device_t;
#line 543
	
#line 543
		} # end require
#line 543
	
#line 543

#line 543

#line 543
	
#line 543
	allow xm_t device_t:dir { getattr search open };
#line 543
	allow xm_t urandom_device_t:chr_file { getattr open read lock ioctl };
#line 543

#line 543

#line 543
	 	
#line 543
##### end dev_read_urand(xm_t) depth: 0
#line 543
 	
 	 	
#line 544
##### begin dev_read_sysfs(xm_t) depth: 1
#line 544
 	
#line 544
	
#line 544
	
#line 544
		require {
#line 544
			
#line 544
		type sysfs_t;
#line 544
	
#line 544
		} # end require
#line 544
	
#line 544

#line 544

#line 544
	
#line 544
	allow xm_t sysfs_t:dir { getattr search open };
#line 544
	allow xm_t sysfs_t:file { getattr open read lock ioctl };
#line 544

#line 544
	
#line 544
	allow xm_t sysfs_t:dir { getattr search open };
#line 544
	allow xm_t sysfs_t:lnk_file { getattr read };
#line 544

#line 544

#line 544
	
#line 544
	allow xm_t sysfs_t:dir { getattr search open };
#line 544
	allow xm_t sysfs_t:dir { getattr search open read lock ioctl };
#line 544

#line 544

#line 544
	 	
#line 544
##### end dev_read_sysfs(xm_t) depth: 0
#line 544
 	

 	 	
#line 546
##### begin files_read_etc_runtime_files(xm_t) depth: 1
#line 546
 	
#line 546
	
#line 546
	
#line 546
		require {
#line 546
			
#line 546
		type etc_t, etc_runtime_t;
#line 546
	
#line 546
		} # end require
#line 546
	
#line 546

#line 546

#line 546
	allow xm_t etc_t:dir { getattr search open read lock ioctl };
#line 546
	
#line 546
	allow xm_t etc_t:dir { getattr search open };
#line 546
	allow xm_t etc_runtime_t:file { getattr open read lock ioctl };
#line 546

#line 546
	
#line 546
	allow xm_t etc_t:dir { getattr search open };
#line 546
	allow xm_t etc_runtime_t:lnk_file { getattr read };
#line 546

#line 546

#line 546
	 	
#line 546
##### end files_read_etc_runtime_files(xm_t) depth: 0
#line 546
 	
 	 	
#line 547
##### begin files_read_etc_files(xm_t) depth: 1
#line 547
 	
#line 547
	
#line 547
	
#line 547
		require {
#line 547
			
#line 547
		type etc_t;
#line 547
	
#line 547
		} # end require
#line 547
	
#line 547

#line 547

#line 547
	allow xm_t etc_t:dir { getattr search open read lock ioctl };
#line 547
	
#line 547
	allow xm_t etc_t:dir { getattr search open };
#line 547
	allow xm_t etc_t:file { getattr open read lock ioctl };
#line 547

#line 547
	
#line 547
	allow xm_t etc_t:dir { getattr search open };
#line 547
	allow xm_t etc_t:lnk_file { getattr read };
#line 547

#line 547

#line 547
	 	
#line 547
##### end files_read_etc_files(xm_t) depth: 0
#line 547
 	
 	 	
#line 548
##### begin files_read_usr_files(xm_t) depth: 1
#line 548
 	
#line 548
	
#line 548
	
#line 548
		require {
#line 548
			
#line 548
		type usr_t;
#line 548
	
#line 548
		} # end require
#line 548
	
#line 548

#line 548

#line 548
	allow xm_t usr_t:dir { getattr search open read lock ioctl };
#line 548
	
#line 548
	allow xm_t usr_t:dir { getattr search open };
#line 548
	allow xm_t usr_t:file { getattr open read lock ioctl };
#line 548

#line 548
	
#line 548
	allow xm_t usr_t:dir { getattr search open };
#line 548
	allow xm_t usr_t:lnk_file { getattr read };
#line 548

#line 548

#line 548
	 	
#line 548
##### end files_read_usr_files(xm_t) depth: 0
#line 548
 	
 	 	
#line 549
##### begin files_search_pids(xm_t) depth: 1
#line 549
 	
#line 549
	
#line 549
	
#line 549
		require {
#line 549
			
#line 549
		type var_t, var_run_t;
#line 549
	
#line 549
		} # end require
#line 549
	
#line 549

#line 549

#line 549
	allow xm_t var_run_t:lnk_file { getattr read };
#line 549
	
#line 549
	allow xm_t var_t:dir { getattr search open };
#line 549
	allow xm_t var_run_t:dir { getattr search open };
#line 549

#line 549

#line 549
	 	
#line 549
##### end files_search_pids(xm_t) depth: 0
#line 549
 	
 	 	
#line 550
##### begin files_search_var_lib(xm_t) depth: 1
#line 550
 	
#line 550
	
#line 550
	
#line 550
		require {
#line 550
			
#line 550
		type var_t, var_lib_t;
#line 550
	
#line 550
		} # end require
#line 550
	
#line 550

#line 550

#line 550
	
#line 550
	allow xm_t var_t:dir { getattr search open };
#line 550
	allow xm_t var_lib_t:dir { getattr search open };
#line 550

#line 550

#line 550
	 	
#line 550
##### end files_search_var_lib(xm_t) depth: 0
#line 550
 	
 	 	
#line 551
##### begin files_list_mnt(xm_t) depth: 1
#line 551
 	
#line 551
	
#line 551
	
#line 551
		require {
#line 551
			
#line 551
		type mnt_t;
#line 551
	
#line 551
		} # end require
#line 551
	
#line 551

#line 551

#line 551
	allow xm_t mnt_t:dir { getattr search open read lock ioctl };
#line 551

#line 551
	 	
#line 551
##### end files_list_mnt(xm_t) depth: 0
#line 551
 	
 	 	
#line 552
##### begin files_list_tmp(xm_t) depth: 1
#line 552
 	
#line 552
	
#line 552
	
#line 552
		require {
#line 552
			
#line 552
		type tmp_t;
#line 552
	
#line 552
		} # end require
#line 552
	
#line 552

#line 552

#line 552
	allow xm_t tmp_t:dir { getattr search open read lock ioctl };
#line 552

#line 552
	 	
#line 552
##### end files_list_tmp(xm_t) depth: 0
#line 552
 	

 	 	
#line 554
##### begin fs_getattr_all_fs(xm_t) depth: 1
#line 554
 	
#line 554
	
#line 554
	
#line 554
		require {
#line 554
			
#line 554
		attribute filesystem_type;
#line 554
	
#line 554
		} # end require
#line 554
	
#line 554

#line 554

#line 554
	allow xm_t filesystem_type:filesystem getattr;
#line 554
	 	 	
#line 554
##### begin files_getattr_all_file_type_fs(xm_t) depth: 2
#line 554
 	
#line 554
	
#line 554
	
#line 554
		require {
#line 554
			
#line 554
		attribute file_type;
#line 554
	
#line 554
		} # end require
#line 554
	
#line 554

#line 554

#line 554
	allow xm_t file_type:filesystem getattr;
#line 554

#line 554
	 	
#line 554
##### end files_getattr_all_file_type_fs(xm_t) depth: 1
#line 554
 	
#line 554

#line 554
	 	
#line 554
##### end fs_getattr_all_fs(xm_t) depth: 0
#line 554
 	
 	 	
#line 555
##### begin fs_manage_xenfs_dirs(xm_t) depth: 1
#line 555
 	
#line 555
	
#line 555
	
#line 555
		require {
#line 555
			
#line 555
		type xenfs_t;
#line 555
	
#line 555
		} # end require
#line 555
	
#line 555

#line 555

#line 555
	allow xm_t xenfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 555

#line 555
	 	
#line 555
##### end fs_manage_xenfs_dirs(xm_t) depth: 0
#line 555
 	
 	 	
#line 556
##### begin fs_manage_xenfs_files(xm_t) depth: 1
#line 556
 	
#line 556
	
#line 556
	
#line 556
		require {
#line 556
			
#line 556
		type xenfs_t;
#line 556
	
#line 556
		} # end require
#line 556
	
#line 556

#line 556

#line 556
	
#line 556
	allow xm_t xenfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 556
	allow xm_t xenfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 556

#line 556

#line 556
	 	
#line 556
##### end fs_manage_xenfs_files(xm_t) depth: 0
#line 556
 	
 	 	
#line 557
##### begin fs_search_auto_mountpoints(xm_t) depth: 1
#line 557
 	
#line 557
	
#line 557
	
#line 557
		require {
#line 557
			
#line 557
		type autofs_t;
#line 557
	
#line 557
		} # end require
#line 557
	
#line 557

#line 557

#line 557
	allow xm_t autofs_t:dir { getattr search open };
#line 557

#line 557
	 	
#line 557
##### end fs_search_auto_mountpoints(xm_t) depth: 0
#line 557
 	

 	 	
#line 559
##### begin storage_raw_read_fixed_disk(xm_t) depth: 1
#line 559
 	
#line 559
	
#line 559
	
#line 559
		require {
#line 559
			
#line 559
		attribute fixed_disk_raw_read;
#line 559
		type fixed_disk_device_t;
#line 559
	
#line 559
		} # end require
#line 559
	
#line 559

#line 559

#line 559
	 	 	
#line 559
##### begin dev_list_all_dev_nodes(xm_t) depth: 2
#line 559
 	
#line 559
	
#line 559
	
#line 559
		require {
#line 559
			
#line 559
		type device_t;
#line 559
	
#line 559
		} # end require
#line 559
	
#line 559

#line 559

#line 559
	
#line 559
	allow xm_t device_t:dir { getattr search open };
#line 559
	allow xm_t device_t:dir { getattr search open read lock ioctl };
#line 559

#line 559
	
#line 559
	allow xm_t device_t:dir { getattr search open };
#line 559
	allow xm_t device_t:lnk_file { getattr read };
#line 559

#line 559

#line 559
	 	
#line 559
##### end dev_list_all_dev_nodes(xm_t) depth: 1
#line 559
 	
#line 559
	allow xm_t fixed_disk_device_t:blk_file { getattr open read lock ioctl };
#line 559
	allow xm_t fixed_disk_device_t:chr_file { getattr open read lock ioctl };
#line 559
	typeattribute xm_t fixed_disk_raw_read;
#line 559

#line 559
	 	
#line 559
##### end storage_raw_read_fixed_disk(xm_t) depth: 0
#line 559
 	

 	 	
#line 561
##### begin term_use_all_terms(xm_t) depth: 1
#line 561
 	
#line 561
	
#line 561
	
#line 561
		require {
#line 561
			
#line 561
		attribute ttynode, ptynode;
#line 561
		type console_device_t, devpts_t, tty_device_t;
#line 561
	
#line 561
		} # end require
#line 561
	
#line 561

#line 561

#line 561
	 	 	
#line 561
##### begin dev_list_all_dev_nodes(xm_t) depth: 2
#line 561
 	
#line 561
	
#line 561
	
#line 561
		require {
#line 561
			
#line 561
		type device_t;
#line 561
	
#line 561
		} # end require
#line 561
	
#line 561

#line 561

#line 561
	
#line 561
	allow xm_t device_t:dir { getattr search open };
#line 561
	allow xm_t device_t:dir { getattr search open read lock ioctl };
#line 561

#line 561
	
#line 561
	allow xm_t device_t:dir { getattr search open };
#line 561
	allow xm_t device_t:lnk_file { getattr read };
#line 561

#line 561

#line 561
	 	
#line 561
##### end dev_list_all_dev_nodes(xm_t) depth: 1
#line 561
 	
#line 561
	allow xm_t devpts_t:dir { getattr search open read lock ioctl };
#line 561
	allow xm_t { devpts_t console_device_t tty_device_t ttynode ptynode }:chr_file { getattr open read write append ioctl lock };
#line 561

#line 561
	 	
#line 561
##### end term_use_all_terms(xm_t) depth: 0
#line 561
 	

 	 	
#line 563
##### begin init_stream_connect_script(xm_t) depth: 1
#line 563
 	
#line 563
	
#line 563
	
#line 563
		require {
#line 563
			
#line 563
		type initrc_t;
#line 563
	
#line 563
		} # end require
#line 563
	
#line 563

#line 563

#line 563
	allow xm_t initrc_t:unix_stream_socket connectto;
#line 563

#line 563
	 	
#line 563
##### end init_stream_connect_script(xm_t) depth: 0
#line 563
 	
 	 	
#line 564
##### begin init_rw_script_stream_sockets(xm_t) depth: 1
#line 564
 	
#line 564
	
#line 564
	
#line 564
		require {
#line 564
			
#line 564
		type initrc_t;
#line 564
	
#line 564
		} # end require
#line 564
	
#line 564

#line 564

#line 564
	allow xm_t initrc_t:unix_stream_socket { ioctl read getattr write setattr append bind connect getopt setopt shutdown };
#line 564

#line 564
	 	
#line 564
##### end init_rw_script_stream_sockets(xm_t) depth: 0
#line 564
 	
 	 	
#line 565
##### begin init_use_fds(xm_t) depth: 1
#line 565
 	
#line 565
	
#line 565
	
#line 565
		require {
#line 565
			
#line 565
		type init_t;
#line 565
	
#line 565
		} # end require
#line 565
	
#line 565

#line 565

#line 565
	allow xm_t init_t:fd use;
#line 565

#line 565
	 	
#line 565
##### end init_use_fds(xm_t) depth: 0
#line 565
 	

 	 	
#line 567
##### begin logging_send_syslog_msg(xm_t) depth: 1
#line 567
 	
#line 567
	
#line 567
	
#line 567
		require {
#line 567
			
#line 567
		type syslogd_t, syslogd_var_run_t, devlog_t;
#line 567
	
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
	allow xm_t devlog_t:sock_file { getattr write open append };
#line 567

#line 567
	# systemd journal socket is in /run/systemd/journal/dev-log
#line 567
	 	 	
#line 567
##### begin init_search_run(xm_t) depth: 2
#line 567
 	
#line 567
	
#line 567
	
#line 567
		require {
#line 567
			
#line 567
		type init_var_run_t;
#line 567
	
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
	 	 	
#line 567
##### begin files_search_pids(xm_t) depth: 3
#line 567
 	
#line 567
	
#line 567
	
#line 567
		require {
#line 567
			
#line 567
		type var_t, var_run_t;
#line 567
	
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
	allow xm_t var_run_t:lnk_file { getattr read };
#line 567
	
#line 567
	allow xm_t var_t:dir { getattr search open };
#line 567
	allow xm_t var_run_t:dir { getattr search open };
#line 567

#line 567

#line 567
	 	
#line 567
##### end files_search_pids(xm_t) depth: 2
#line 567
 	
#line 567
	allow xm_t init_var_run_t:dir { getattr search open };
#line 567

#line 567
	 	
#line 567
##### end init_search_run(xm_t) depth: 1
#line 567
 	
#line 567
	allow xm_t syslogd_var_run_t:dir { getattr search open };
#line 567

#line 567
	# the type of socket depends on the syslog daemon
#line 567
	allow xm_t syslogd_t:unix_dgram_socket sendto;
#line 567
	allow xm_t syslogd_t:unix_stream_socket connectto;
#line 567
	allow xm_t self:unix_dgram_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 567
	allow xm_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 567

#line 567
	# If syslog is down, the glibc syslog() function
#line 567
	# will write to the console.
#line 567
	 	 	
#line 567
##### begin term_write_console(xm_t) depth: 2
#line 567
 	
#line 567
	
#line 567
	
#line 567
		require {
#line 567
			
#line 567
		type console_device_t;
#line 567
	
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
	 	 	
#line 567
##### begin dev_list_all_dev_nodes(xm_t) depth: 3
#line 567
 	
#line 567
	
#line 567
	
#line 567
		require {
#line 567
			
#line 567
		type device_t;
#line 567
	
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
	
#line 567
	allow xm_t device_t:dir { getattr search open };
#line 567
	allow xm_t device_t:dir { getattr search open read lock ioctl };
#line 567

#line 567
	
#line 567
	allow xm_t device_t:dir { getattr search open };
#line 567
	allow xm_t device_t:lnk_file { getattr read };
#line 567

#line 567

#line 567
	 	
#line 567
##### end dev_list_all_dev_nodes(xm_t) depth: 2
#line 567
 	
#line 567
	allow xm_t console_device_t:chr_file { getattr open write append lock ioctl };
#line 567

#line 567
	 	
#line 567
##### end term_write_console(xm_t) depth: 1
#line 567
 	
#line 567
	 	 	
#line 567
##### begin term_dontaudit_read_console(xm_t) depth: 2
#line 567
 	
#line 567
	
#line 567
	
#line 567
		require {
#line 567
			
#line 567
		type console_device_t;
#line 567
	
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
	dontaudit xm_t console_device_t:chr_file { getattr open read lock ioctl };
#line 567

#line 567
	 	
#line 567
##### end term_dontaudit_read_console(xm_t) depth: 1
#line 567
 	
#line 567

#line 567
	# because systemd is now using /run/systemd/journal/dev-log
#line 567
	 	 	
#line 567
##### begin init_search_pid_dirs(xm_t) depth: 2
#line 567
 	
#line 567
    
#line 567
	
#line 567
		require {
#line 567
			
#line 567
        type init_var_run_t;
#line 567
    
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
    allow xm_t init_var_run_t:dir { getattr search open };
#line 567

#line 567
	 	
#line 567
##### end init_search_pid_dirs(xm_t) depth: 1
#line 567
 	
#line 567

#line 567
	 	
#line 567
##### end logging_send_syslog_msg(xm_t) depth: 0
#line 567
 	

 	 	
#line 569
##### begin miscfiles_read_localization(xm_t) depth: 1
#line 569
 	
#line 569
	
#line 569
	
#line 569
		require {
#line 569
			
#line 569
		type locale_t;
#line 569
	
#line 569
		} # end require
#line 569
	
#line 569

#line 569

#line 569
	 	 	
#line 569
##### begin files_read_etc_symlinks(xm_t) depth: 2
#line 569
 	
#line 569
	
#line 569
	
#line 569
		require {
#line 569
			
#line 569
		type etc_t;
#line 569
	
#line 569
		} # end require
#line 569
	
#line 569

#line 569

#line 569
	
#line 569
	allow xm_t etc_t:dir { getattr search open };
#line 569
	allow xm_t etc_t:lnk_file { getattr read };
#line 569

#line 569

#line 569
	 	
#line 569
##### end files_read_etc_symlinks(xm_t) depth: 1
#line 569
 	
#line 569
	 	 	
#line 569
##### begin files_search_usr(xm_t) depth: 2
#line 569
 	
#line 569
	
#line 569
	
#line 569
		require {
#line 569
			
#line 569
		type usr_t;
#line 569
	
#line 569
		} # end require
#line 569
	
#line 569

#line 569

#line 569
	allow xm_t usr_t:dir { getattr search open };
#line 569

#line 569
	 	
#line 569
##### end files_search_usr(xm_t) depth: 1
#line 569
 	
#line 569
	allow xm_t locale_t:dir { getattr search open read lock ioctl };
#line 569
	
#line 569
	allow xm_t locale_t:dir { getattr search open };
#line 569
	allow xm_t locale_t:file { getattr open read lock ioctl };
#line 569

#line 569
	
#line 569
	allow xm_t locale_t:dir { getattr search open };
#line 569
	allow xm_t locale_t:lnk_file { getattr read };
#line 569

#line 569

#line 569
	 	
#line 569
##### end miscfiles_read_localization(xm_t) depth: 0
#line 569
 	

 	 	
#line 571
##### begin sysnet_dns_name_resolve(xm_t) depth: 1
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type net_conf_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t self:tcp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 571
	allow xm_t self:udp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 571
	allow xm_t self:netlink_route_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } nlmsg_read };
#line 571

#line 571
	 	 	
#line 571
##### begin corenet_all_recvfrom_unlabeled(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin kernel_tcp_recvfrom_unlabeled(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type unlabeled_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t unlabeled_t:tcp_socket recvfrom;
#line 571

#line 571
	 	
#line 571
##### end kernel_tcp_recvfrom_unlabeled(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin kernel_udp_recvfrom_unlabeled(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type unlabeled_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t unlabeled_t:udp_socket recvfrom;
#line 571

#line 571
	 	
#line 571
##### end kernel_udp_recvfrom_unlabeled(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin kernel_raw_recvfrom_unlabeled(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type unlabeled_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t unlabeled_t:rawip_socket recvfrom;
#line 571

#line 571
	 	
#line 571
##### end kernel_raw_recvfrom_unlabeled(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin kernel_recvfrom_unlabeled_peer(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type unlabeled_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t unlabeled_t:peer recv;
#line 571

#line 571
	 	
#line 571
##### end kernel_recvfrom_unlabeled_peer(xm_t) depth: 2
#line 571
 	
#line 571

#line 571
	# XXX - at some point the oubound/send access check will be removed
#line 571
	# but for right now we need to keep this in place so as not to break
#line 571
	# older systems
#line 571
	 	 	
#line 571
##### begin kernel_sendrecv_unlabeled_association(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type unlabeled_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t unlabeled_t:association { sendto recvfrom };
#line 571

#line 571
	 	
#line 571
##### end kernel_sendrecv_unlabeled_association(xm_t) depth: 2
#line 571
 	
#line 571

#line 571
	 	
#line 571
##### end corenet_all_recvfrom_unlabeled(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_all_recvfrom_netlabel(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type netlabel_peer_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t netlabel_peer_t:peer recv;
#line 571
	allow xm_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 571

#line 571
	 	
#line 571
##### end corenet_all_recvfrom_netlabel(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_tcp_sendrecv_generic_if(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type netif_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 571

#line 571
	 	
#line 571
##### end corenet_tcp_sendrecv_generic_if(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_sendrecv_generic_if(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_send_generic_if(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type netif_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t netif_t:netif { udp_send egress };
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_send_generic_if(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_receive_generic_if(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type netif_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t netif_t:netif { udp_recv ingress };
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_receive_generic_if(xm_t) depth: 2
#line 571
 	
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_sendrecv_generic_if(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_tcp_sendrecv_generic_node(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type node_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 571

#line 571
	 	
#line 571
##### end corenet_tcp_sendrecv_generic_node(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_sendrecv_generic_node(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_send_generic_node(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type node_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t node_t:node { udp_send sendto };
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_send_generic_node(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_receive_generic_node(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type node_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t node_t:node { udp_recv recvfrom };
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_receive_generic_node(xm_t) depth: 2
#line 571
 	
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_sendrecv_generic_node(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_tcp_sendrecv_dns_port(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type dns_port_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t dns_port_t:tcp_socket { send_msg recv_msg };
#line 571

#line 571
	 	
#line 571
##### end corenet_tcp_sendrecv_dns_port(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_sendrecv_dns_port(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_send_dns_port(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type dns_port_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t dns_port_t:udp_socket send_msg;
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_send_dns_port(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_udp_receive_dns_port(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type dns_port_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t dns_port_t:udp_socket recv_msg;
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_receive_dns_port(xm_t) depth: 2
#line 571
 	
#line 571

#line 571
	 	
#line 571
##### end corenet_udp_sendrecv_dns_port(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_tcp_connect_dns_port(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type dns_port_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t dns_port_t:tcp_socket name_connect;
#line 571

#line 571
	 	
#line 571
##### end corenet_tcp_connect_dns_port(xm_t) depth: 1
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_sendrecv_dns_client_packets(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_send_dns_client_packets(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type dns_client_packet_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t dns_client_packet_t:packet send;
#line 571

#line 571
	 	
#line 571
##### end corenet_send_dns_client_packets(xm_t) depth: 2
#line 571
 	
#line 571
	 	 	
#line 571
##### begin corenet_receive_dns_client_packets(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type dns_client_packet_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t dns_client_packet_t:packet recv;
#line 571

#line 571
	 	
#line 571
##### end corenet_receive_dns_client_packets(xm_t) depth: 2
#line 571
 	
#line 571

#line 571
	 	
#line 571
##### end corenet_sendrecv_dns_client_packets(xm_t) depth: 1
#line 571
 	
#line 571

#line 571
	 	 	
#line 571
##### begin sysnet_read_config(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type net_conf_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	 	 	
#line 571
##### begin files_search_etc(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type etc_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t etc_t:dir { getattr search open };
#line 571

#line 571
	 	
#line 571
##### end files_search_etc(xm_t) depth: 2
#line 571
 	
#line 571
	allow xm_t net_conf_t:file { getattr open read lock ioctl };
#line 571

#line 571
	
#line 571
		 	 	
#line 571
##### begin files_search_pids(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type var_t, var_run_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t var_run_t:lnk_file { getattr read };
#line 571
	
#line 571
	allow xm_t var_t:dir { getattr search open };
#line 571
	allow xm_t var_run_t:dir { getattr search open };
#line 571

#line 571

#line 571
	 	
#line 571
##### end files_search_pids(xm_t) depth: 2
#line 571
 	
#line 571
		allow xm_t net_conf_t:dir { getattr search open read lock ioctl };
#line 571
		
#line 571
	allow xm_t net_conf_t:dir { getattr search open };
#line 571
	allow xm_t net_conf_t:file { getattr open read lock ioctl };
#line 571

#line 571
	
#line 571

#line 571
	
#line 571

#line 571
	 	
#line 571
##### end sysnet_read_config(xm_t) depth: 1
#line 571
 	
#line 571

#line 571
	
#line 571
	optional {
#line 571
		
#line 571
		 	 	
#line 571
##### begin avahi_stream_connect(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type avahi_t, avahi_var_run_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	 	 	
#line 571
##### begin files_search_pids(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type var_t, var_run_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t var_run_t:lnk_file { getattr read };
#line 571
	
#line 571
	allow xm_t var_t:dir { getattr search open };
#line 571
	allow xm_t var_run_t:dir { getattr search open };
#line 571

#line 571

#line 571
	 	
#line 571
##### end files_search_pids(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	allow xm_t avahi_var_run_t:dir { getattr search open };
#line 571
	allow xm_t avahi_var_run_t:sock_file { getattr write open append };
#line 571
	allow xm_t avahi_t:unix_stream_socket connectto;
#line 571

#line 571

#line 571
	 	
#line 571
##### end avahi_stream_connect(xm_t) depth: 1
#line 571
 	
#line 571
	
#line 571
	} # end optional
#line 571

#line 571

#line 571
	
#line 571
	optional {
#line 571
		
#line 571
		 	 	
#line 571
##### begin nscd_use(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		
#line 571
bool nscd_use_shm;
#line 571

#line 571
  
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571
	if (nscd_use_shm) {
#line 571
		
#line 571
		 	 	
#line 571
##### begin nscd_shm_use(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type nscd_t, nscd_var_run_t;
#line 571
		class nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 571

#line 571
	allow xm_t nscd_t:nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 571
	allow xm_t nscd_t:fd use;
#line 571

#line 571
	 	 	
#line 571
##### begin files_search_pids(xm_t) depth: 4
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type var_t, var_run_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t var_run_t:lnk_file { getattr read };
#line 571
	
#line 571
	allow xm_t var_t:dir { getattr search open };
#line 571
	allow xm_t var_run_t:dir { getattr search open };
#line 571

#line 571

#line 571
	 	
#line 571
##### end files_search_pids(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	allow xm_t nscd_var_run_t:dir { getattr search open };
#line 571
	allow xm_t nscd_var_run_t:sock_file { getattr write open append };
#line 571
	allow xm_t nscd_t:unix_stream_socket connectto;
#line 571

#line 571
	dontaudit xm_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 571

#line 571
	allow xm_t nscd_var_run_t:dir { getattr search open read lock ioctl };
#line 571
	allow xm_t nscd_var_run_t:sock_file { getattr open read };
#line 571

#line 571
	 	
#line 571
##### end nscd_shm_use(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	} else {
#line 571
		
#line 571
		 	 	
#line 571
##### begin nscd_socket_use(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type nscd_t, nscd_var_run_t;
#line 571
		class nscd { getserv getpwd getgrp gethost shmempwd shmemgrp shmemhost shmemserv };
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 571

#line 571
	allow xm_t nscd_t:nscd { getpwd getgrp gethost };
#line 571

#line 571
	dontaudit xm_t nscd_t:fd use;
#line 571
	dontaudit xm_t nscd_t:nscd { getserv shmempwd shmemgrp shmemhost shmemserv };
#line 571

#line 571
	 	 	
#line 571
##### begin files_search_pids(xm_t) depth: 4
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type var_t, var_run_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xm_t var_run_t:lnk_file { getattr read };
#line 571
	
#line 571
	allow xm_t var_t:dir { getattr search open };
#line 571
	allow xm_t var_run_t:dir { getattr search open };
#line 571

#line 571

#line 571
	 	
#line 571
##### end files_search_pids(xm_t) depth: 3
#line 571
 	
#line 571
	
#line 571
	allow xm_t nscd_var_run_t:dir { getattr search open };
#line 571
	allow xm_t nscd_var_run_t:sock_file { getattr write open append };
#line 571
	allow xm_t nscd_t:unix_stream_socket connectto;
#line 571

#line 571
	dontaudit xm_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 571

#line 571
	
#line 571
	allow nscd_t xm_t:dir { getattr search open read lock ioctl };
#line 571
	allow nscd_t xm_t:file { getattr open read lock ioctl };
#line 571
	allow nscd_t xm_t:lnk_file { getattr read };
#line 571
	allow nscd_t xm_t:process getattr;
#line 571

#line 571

#line 571
	 	
#line 571
##### end nscd_socket_use(xm_t) depth: 2
#line 571
 	
#line 571
	
#line 571
	}
#line 571

#line 571

#line 571
	 	
#line 571
##### end nscd_use(xm_t) depth: 1
#line 571
 	
#line 571
	
#line 571
	} # end optional
#line 571

#line 571

#line 571
	 	
#line 571
##### end sysnet_dns_name_resolve(xm_t) depth: 0
#line 571
 	


#line 573
	
#line 573
	
#line 573
		require {
#line 573
			
#line 573
		
#line 573
bool xen_use_fusefs;
#line 573

#line 573
  
#line 573
	
#line 573
		} # end require
#line 573
	
#line 573

#line 573
	if (xen_use_fusefs) {
#line 573
		
#line 573
	 	 	
#line 573
##### begin fs_manage_fusefs_dirs(xm_t) depth: 1
#line 573
 	
#line 573
	
#line 573
	
#line 573
		require {
#line 573
			
#line 573
		type fusefs_t;
#line 573
	
#line 573
		} # end require
#line 573
	
#line 573

#line 573

#line 573
	allow xm_t fusefs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 573

#line 573
	 	
#line 573
##### end fs_manage_fusefs_dirs(xm_t) depth: 0
#line 573
 	
#line 573
	 	 	
#line 573
##### begin fs_manage_fusefs_files(xm_t) depth: 1
#line 573
 	
#line 573
	
#line 573
	
#line 573
		require {
#line 573
			
#line 573
		type fusefs_t;
#line 573
	
#line 573
		} # end require
#line 573
	
#line 573

#line 573

#line 573
	
#line 573
	allow xm_t fusefs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 573
	allow xm_t fusefs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 573

#line 573

#line 573
	 	
#line 573
##### end fs_manage_fusefs_files(xm_t) depth: 0
#line 573
 	
#line 573
	 	 	
#line 573
##### begin fs_read_fusefs_symlinks(xm_t) depth: 1
#line 573
 	
#line 573
	
#line 573
	
#line 573
		require {
#line 573
			
#line 573
		type fusefs_t;
#line 573
	
#line 573
		} # end require
#line 573
	
#line 573

#line 573

#line 573
	allow xm_t fusefs_t:dir { getattr search open read lock ioctl };
#line 573
	
#line 573
	allow xm_t fusefs_t:dir { getattr search open };
#line 573
	allow xm_t fusefs_t:lnk_file { getattr read };
#line 573

#line 573

#line 573
	 	
#line 573
##### end fs_read_fusefs_symlinks(xm_t) depth: 0
#line 573
 	
#line 573

#line 573
	}
#line 577



#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		
#line 579
bool xen_use_nfs;
#line 579

#line 579
  
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579
	if (xen_use_nfs) {
#line 579
		
#line 579
	 	 	
#line 579
##### begin fs_manage_nfs_dirs(xm_t) depth: 1
#line 579
 	
#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		type nfs_t;
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579

#line 579
	allow xm_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 579

#line 579
	 	
#line 579
##### end fs_manage_nfs_dirs(xm_t) depth: 0
#line 579
 	
#line 579
	 	 	
#line 579
##### begin fs_manage_nfs_files(xm_t) depth: 1
#line 579
 	
#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		type nfs_t;
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579

#line 579
	
#line 579
	allow xm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 579
	allow xm_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 579

#line 579

#line 579
	 	
#line 579
##### end fs_manage_nfs_files(xm_t) depth: 0
#line 579
 	
#line 579
	 	 	
#line 579
##### begin fs_read_nfs_symlinks(xm_t) depth: 1
#line 579
 	
#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		type nfs_t;
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579

#line 579
	allow xm_t nfs_t:dir { getattr search open read lock ioctl };
#line 579
	
#line 579
	allow xm_t nfs_t:dir { getattr search open };
#line 579
	allow xm_t nfs_t:lnk_file { getattr read };
#line 579

#line 579

#line 579
	 	
#line 579
##### end fs_read_nfs_symlinks(xm_t) depth: 0
#line 579
 	
#line 579

#line 579
	}
#line 583



#line 585
	
#line 585
	
#line 585
		require {
#line 585
			
#line 585
		
#line 585
bool xen_use_samba;
#line 585

#line 585
  
#line 585
	
#line 585
		} # end require
#line 585
	
#line 585

#line 585
	if (xen_use_samba) {
#line 585
		
#line 585
	 	 	
#line 585
##### begin fs_manage_cifs_dirs(xm_t) depth: 1
#line 585
 	
#line 585
	
#line 585
	
#line 585
		require {
#line 585
			
#line 585
		type cifs_t;
#line 585
	
#line 585
		} # end require
#line 585
	
#line 585

#line 585

#line 585
	allow xm_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 585

#line 585
	 	
#line 585
##### end fs_manage_cifs_dirs(xm_t) depth: 0
#line 585
 	
#line 585
	 	 	
#line 585
##### begin fs_manage_cifs_files(xm_t) depth: 1
#line 585
 	
#line 585
	
#line 585
	
#line 585
		require {
#line 585
			
#line 585
		type cifs_t;
#line 585
	
#line 585
		} # end require
#line 585
	
#line 585

#line 585

#line 585
	
#line 585
	allow xm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 585
	allow xm_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 585

#line 585

#line 585
	 	
#line 585
##### end fs_manage_cifs_files(xm_t) depth: 0
#line 585
 	
#line 585
	 	 	
#line 585
##### begin fs_read_cifs_symlinks(xm_t) depth: 1
#line 585
 	
#line 585
	
#line 585
	
#line 585
		require {
#line 585
			
#line 585
		type cifs_t;
#line 585
	
#line 585
		} # end require
#line 585
	
#line 585

#line 585

#line 585
	allow xm_t cifs_t:dir { getattr search open read lock ioctl };
#line 585
	
#line 585
	allow xm_t cifs_t:dir { getattr search open };
#line 585
	allow xm_t cifs_t:lnk_file { getattr read };
#line 585

#line 585

#line 585
	 	
#line 585
##### end fs_read_cifs_symlinks(xm_t) depth: 0
#line 585
 	
#line 585

#line 585
	}
#line 589



#line 591
	optional {
#line 591
		
#line 591
	 	 	
#line 591
##### begin unconfined_run_to(xm_t,xm_exec_t) depth: 1
#line 591
 	
#line 591
	
#line 591
	
#line 591
		require {
#line 591
			
#line 591
		type unconfined_t;
#line 591
		role unconfined_r;
#line 591
	
#line 591
		} # end require
#line 591
	
#line 591

#line 591

#line 591
	
#line 591
	
#line 591
	
#line 591
	allow unconfined_t xm_exec_t:file { getattr open read execute };
#line 591
	allow unconfined_t xm_t:process transition;
#line 591
	dontaudit unconfined_t xm_t:process { noatsecure siginh rlimitinh };
#line 591

#line 591
	type_transition unconfined_t xm_exec_t:process xm_t;
#line 591

#line 591

#line 591
	allow xm_t unconfined_t:fd use;
#line 591
	allow xm_t unconfined_t:fifo_file { open { getattr read write append ioctl lock } };
#line 591
	allow xm_t unconfined_t:process sigchld;
#line 591

#line 591
	role unconfined_r types xm_t;
#line 591
	 	 	
#line 591
##### begin userdom_use_user_terminals(xm_t) depth: 2
#line 591
 	
#line 591
	
#line 591
	
#line 591
		require {
#line 591
			
#line 591
		type user_tty_device_t, user_devpts_t;
#line 591
	
#line 591
		} # end require
#line 591
	
#line 591

#line 591

#line 591
	allow xm_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 591
	allow xm_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 591
	 	 	
#line 591
##### begin term_list_ptys(xm_t) depth: 3
#line 591
 	
#line 591
	
#line 591
	
#line 591
		require {
#line 591
			
#line 591
		type devpts_t;
#line 591
	
#line 591
		} # end require
#line 591
	
#line 591

#line 591

#line 591
	 	 	
#line 591
##### begin dev_list_all_dev_nodes(xm_t) depth: 4
#line 591
 	
#line 591
	
#line 591
	
#line 591
		require {
#line 591
			
#line 591
		type device_t;
#line 591
	
#line 591
		} # end require
#line 591
	
#line 591

#line 591

#line 591
	
#line 591
	allow xm_t device_t:dir { getattr search open };
#line 591
	allow xm_t device_t:dir { getattr search open read lock ioctl };
#line 591

#line 591
	
#line 591
	allow xm_t device_t:dir { getattr search open };
#line 591
	allow xm_t device_t:lnk_file { getattr read };
#line 591

#line 591

#line 591
	 	
#line 591
##### end dev_list_all_dev_nodes(xm_t) depth: 3
#line 591
 	
#line 591
	allow xm_t devpts_t:dir { getattr search open read lock ioctl };
#line 591

#line 591
	 	
#line 591
##### end term_list_ptys(xm_t) depth: 2
#line 591
 	
#line 591

#line 591
	 	
#line 591
##### end userdom_use_user_terminals(xm_t) depth: 1
#line 591
 	
#line 591

#line 591
	 	
#line 591
##### end unconfined_run_to(xm_t,xm_exec_t) depth: 0
#line 591
 	
#line 591

#line 591
	} # end optional
#line 593



#line 595
	optional {
#line 595
		
#line 595
	 	 	
#line 595
##### begin qemu_domtrans(xm_t) depth: 1
#line 595
 	
#line 595
	
#line 595
	
#line 595
		require {
#line 595
			
#line 595
		type qemu_t, qemu_exec_t;
#line 595
	
#line 595
		} # end require
#line 595
	
#line 595

#line 595

#line 595
	 	 	
#line 595
##### begin corecmd_search_bin(xm_t) depth: 2
#line 595
 	
#line 595
	
#line 595
	
#line 595
		require {
#line 595
			
#line 595
		type bin_t;
#line 595
	
#line 595
		} # end require
#line 595
	
#line 595

#line 595

#line 595
	
#line 595
	allow xm_t bin_t:dir { getattr search open };
#line 595
	allow xm_t bin_t:dir { getattr search open };
#line 595

#line 595

#line 595
	 	
#line 595
##### end corecmd_search_bin(xm_t) depth: 1
#line 595
 	
#line 595
	
#line 595
	
#line 595
	
#line 595
	allow xm_t qemu_exec_t:file { getattr open read execute };
#line 595
	allow xm_t qemu_t:process transition;
#line 595
	dontaudit xm_t qemu_t:process { noatsecure siginh rlimitinh };
#line 595

#line 595
	type_transition xm_t qemu_exec_t:process qemu_t;
#line 595

#line 595

#line 595
	allow qemu_t xm_t:fd use;
#line 595
	allow qemu_t xm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 595
	allow qemu_t xm_t:process sigchld;
#line 595

#line 595

#line 595
	 	
#line 595
##### end qemu_domtrans(xm_t) depth: 0
#line 595
 	
#line 595
	 	 	
#line 595
##### begin qemu_signal(xm_t) depth: 1
#line 595
 	
#line 595
	
#line 595
	
#line 595
		require {
#line 595
			
#line 595
		type qemu_t;
#line 595
	
#line 595
		} # end require
#line 595
	
#line 595

#line 595

#line 595
	allow xm_t qemu_t:process signal;
#line 595

#line 595
	 	
#line 595
##### end qemu_signal(xm_t) depth: 0
#line 595
 	
#line 595
	 	 	
#line 595
##### begin qemu_stream_connect(xm_t) depth: 1
#line 595
 	
#line 595
	
#line 595
	
#line 595
		require {
#line 595
			
#line 595
		type qemu_t, qemu_var_run_t;
#line 595
	
#line 595
		} # end require
#line 595
	
#line 595

#line 595

#line 595
	 	 	
#line 595
##### begin files_search_pids(xm_t) depth: 2
#line 595
 	
#line 595
	
#line 595
	
#line 595
		require {
#line 595
			
#line 595
		type var_t, var_run_t;
#line 595
	
#line 595
		} # end require
#line 595
	
#line 595

#line 595

#line 595
	allow xm_t var_run_t:lnk_file { getattr read };
#line 595
	
#line 595
	allow xm_t var_t:dir { getattr search open };
#line 595
	allow xm_t var_run_t:dir { getattr search open };
#line 595

#line 595

#line 595
	 	
#line 595
##### end files_search_pids(xm_t) depth: 1
#line 595
 	
#line 595
	
#line 595
	allow xm_t qemu_var_run_t:dir { getattr search open };
#line 595
	allow xm_t qemu_var_run_t:sock_file { getattr write open append };
#line 595
	allow xm_t qemu_t:unix_stream_socket connectto;
#line 595

#line 595

#line 595
	 	
#line 595
##### end qemu_stream_connect(xm_t) depth: 0
#line 595
 	
#line 595
	 	 	
#line 595
##### begin qemu_unlink_socket(xm_t) depth: 1
#line 595
 	
#line 595
	
#line 595
	
#line 595
		require {
#line 595
			
#line 595
		type qemu_t, qemu_var_run_t;
#line 595
	
#line 595
		} # end require
#line 595
	
#line 595

#line 595

#line 595
	allow xm_t qemu_var_run_t:sock_file unlink;
#line 595

#line 595
	 	
#line 595
##### end qemu_unlink_socket(xm_t) depth: 0
#line 595
 	
#line 595

#line 595
	} # end optional
#line 600



#line 602
	optional {
#line 602
		
#line 602
	 	 	
#line 602
##### begin iptables_domtrans(xm_t) depth: 1
#line 602
 	
#line 602
	
#line 602
	
#line 602
		require {
#line 602
			
#line 602
		type iptables_t, iptables_exec_t;
#line 602
	
#line 602
		} # end require
#line 602
	
#line 602

#line 602

#line 602
	 	 	
#line 602
##### begin corecmd_search_bin(xm_t) depth: 2
#line 602
 	
#line 602
	
#line 602
	
#line 602
		require {
#line 602
			
#line 602
		type bin_t;
#line 602
	
#line 602
		} # end require
#line 602
	
#line 602

#line 602

#line 602
	
#line 602
	allow xm_t bin_t:dir { getattr search open };
#line 602
	allow xm_t bin_t:dir { getattr search open };
#line 602

#line 602

#line 602
	 	
#line 602
##### end corecmd_search_bin(xm_t) depth: 1
#line 602
 	
#line 602
	
#line 602
	
#line 602
	
#line 602
	allow xm_t iptables_exec_t:file { getattr open read execute };
#line 602
	allow xm_t iptables_t:process transition;
#line 602
	dontaudit xm_t iptables_t:process { noatsecure siginh rlimitinh };
#line 602

#line 602
	type_transition xm_t iptables_exec_t:process iptables_t;
#line 602

#line 602

#line 602
	allow iptables_t xm_t:fd use;
#line 602
	allow iptables_t xm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 602
	allow iptables_t xm_t:process sigchld;
#line 602

#line 602

#line 602
	
#line 602
		dontaudit iptables_t xm_t:{ tcp_socket udp_socket rawip_socket netlink_socket packet_socket unix_stream_socket unix_dgram_socket appletalk_socket netlink_route_socket netlink_firewall_socket netlink_tcpdiag_socket netlink_nflog_socket netlink_xfrm_socket netlink_selinux_socket netlink_audit_socket netlink_ip6fw_socket netlink_dnrt_socket netlink_kobject_uevent_socket tun_socket netlink_iscsi_socket netlink_fib_lookup_socket netlink_connector_socket netlink_netfilter_socket netlink_generic_socket netlink_scsitransport_socket netlink_rdma_socket netlink_crypto_socket } { read write };
#line 602
	
#line 602

#line 602
	 	
#line 602
##### end iptables_domtrans(xm_t) depth: 0
#line 602
 	
#line 602

#line 602
	} # end optional
#line 604



#line 606
	optional {
#line 606
		
#line 606
	 	 	
#line 606
##### begin cron_system_entry(xm_t,xm_exec_t) depth: 1
#line 606
 	
#line 606
	
#line 606
	
#line 606
		require {
#line 606
			
#line 606
		type crond_t, system_cronjob_t;
#line 606
		type user_cron_spool_log_t;
#line 606
	
#line 606
		} # end require
#line 606
	
#line 606

#line 606

#line 606
	
#line 606
	allow xm_t user_cron_spool_log_t:dir { getattr search open };
#line 606
	allow xm_t user_cron_spool_log_t:file { getattr open read write append ioctl lock };
#line 606

#line 606

#line 606
	
#line 606
	
#line 606
	
#line 606
	allow system_cronjob_t xm_exec_t:file { getattr open read execute };
#line 606
	allow system_cronjob_t xm_t:process transition;
#line 606
	dontaudit system_cronjob_t xm_t:process { noatsecure siginh rlimitinh };
#line 606

#line 606
	type_transition system_cronjob_t xm_exec_t:process xm_t;
#line 606

#line 606

#line 606
	allow xm_t system_cronjob_t:fd use;
#line 606
	allow xm_t system_cronjob_t:fifo_file { open { getattr read write append ioctl lock } };
#line 606
	allow xm_t system_cronjob_t:process sigchld;
#line 606

#line 606
	
#line 606
	
#line 606
	
#line 606
	allow crond_t xm_exec_t:file { getattr open read execute };
#line 606
	allow crond_t xm_t:process transition;
#line 606
	dontaudit crond_t xm_t:process { noatsecure siginh rlimitinh };
#line 606

#line 606
	type_transition crond_t xm_exec_t:process xm_t;
#line 606

#line 606

#line 606
	allow xm_t crond_t:fd use;
#line 606
	allow xm_t crond_t:fifo_file { open { getattr read write append ioctl lock } };
#line 606
	allow xm_t crond_t:process sigchld;
#line 606

#line 606

#line 606
	role system_r types xm_t;
#line 606

#line 606
	 	
#line 606
##### end cron_system_entry(xm_t,xm_exec_t) depth: 0
#line 606
 	
#line 606

#line 606
	} # end optional
#line 608



#line 610
	optional {
#line 610
		
#line 610
	 	 	
#line 610
##### begin dbus_system_bus_client(xm_t) depth: 1
#line 610
 	
#line 610
	
#line 610
	
#line 610
		require {
#line 610
			
#line 610
		attribute dbusd_system_bus_client;
#line 610
		type system_dbusd_t, system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 610
		class dbus send_msg;
#line 610
	
#line 610
		} # end require
#line 610
	
#line 610

#line 610

#line 610
	typeattribute xm_t dbusd_system_bus_client;
#line 610

#line 610
	allow xm_t { system_dbusd_t self }:dbus send_msg;
#line 610
	allow system_dbusd_t xm_t:dbus send_msg;
#line 610

#line 610
	 	 	
#line 610
##### begin files_search_var_lib(xm_t) depth: 2
#line 610
 	
#line 610
	
#line 610
	
#line 610
		require {
#line 610
			
#line 610
		type var_t, var_lib_t;
#line 610
	
#line 610
		} # end require
#line 610
	
#line 610

#line 610

#line 610
	
#line 610
	allow xm_t var_t:dir { getattr search open };
#line 610
	allow xm_t var_lib_t:dir { getattr search open };
#line 610

#line 610

#line 610
	 	
#line 610
##### end files_search_var_lib(xm_t) depth: 1
#line 610
 	
#line 610
	
#line 610
	allow xm_t system_dbusd_var_lib_t:dir { getattr search open };
#line 610
	allow xm_t system_dbusd_var_lib_t:file { getattr open read lock ioctl };
#line 610

#line 610

#line 610
	 	 	
#line 610
##### begin files_search_pids(xm_t) depth: 2
#line 610
 	
#line 610
	
#line 610
	
#line 610
		require {
#line 610
			
#line 610
		type var_t, var_run_t;
#line 610
	
#line 610
		} # end require
#line 610
	
#line 610

#line 610

#line 610
	allow xm_t var_run_t:lnk_file { getattr read };
#line 610
	
#line 610
	allow xm_t var_t:dir { getattr search open };
#line 610
	allow xm_t var_run_t:dir { getattr search open };
#line 610

#line 610

#line 610
	 	
#line 610
##### end files_search_pids(xm_t) depth: 1
#line 610
 	
#line 610
	
#line 610
	allow xm_t system_dbusd_var_run_t:dir { getattr search open };
#line 610
	allow xm_t system_dbusd_var_run_t:sock_file { getattr write open append };
#line 610
	allow xm_t system_dbusd_t:unix_stream_socket connectto;
#line 610

#line 610

#line 610
	 	 	
#line 610
##### begin dbus_read_config(xm_t) depth: 2
#line 610
 	
#line 610
	
#line 610
	
#line 610
		require {
#line 610
			
#line 610
		type dbusd_etc_t;
#line 610
	
#line 610
		} # end require
#line 610
	
#line 610

#line 610

#line 610
	allow xm_t dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 610
	allow xm_t dbusd_etc_t:file { getattr open read lock ioctl };
#line 610

#line 610
	 	
#line 610
##### end dbus_read_config(xm_t) depth: 1
#line 610
 	
#line 610

#line 610
	 	
#line 610
##### end dbus_system_bus_client(xm_t) depth: 0
#line 610
 	
#line 610

#line 610
	
#line 610
	optional {
#line 610
		
#line 610
		 	 	
#line 610
##### begin hal_dbus_chat(xm_t) depth: 1
#line 610
 	
#line 610
	
#line 610
	
#line 610
		require {
#line 610
			
#line 610
		type hald_t;
#line 610
		class dbus send_msg;
#line 610
	
#line 610
		} # end require
#line 610
	
#line 610

#line 610

#line 610
	allow xm_t hald_t:dbus send_msg;
#line 610
	allow hald_t xm_t:dbus send_msg;
#line 610

#line 610
	 	
#line 610
##### end hal_dbus_chat(xm_t) depth: 0
#line 610
 	
#line 610
	
#line 610
	}
#line 610

#line 610

#line 610
	} # end optional
#line 616



#line 618
	optional {
#line 618
		
#line 618
	 	 	
#line 618
##### begin rpm_exec(xm_t) depth: 1
#line 618
 	
#line 618
	
#line 618
	
#line 618
		require {
#line 618
			
#line 618
		type rpm_exec_t;
#line 618
	
#line 618
		} # end require
#line 618
	
#line 618

#line 618

#line 618
	 	 	
#line 618
##### begin corecmd_search_bin(xm_t) depth: 2
#line 618
 	
#line 618
	
#line 618
	
#line 618
		require {
#line 618
			
#line 618
		type bin_t;
#line 618
	
#line 618
		} # end require
#line 618
	
#line 618

#line 618

#line 618
	
#line 618
	allow xm_t bin_t:dir { getattr search open };
#line 618
	allow xm_t bin_t:dir { getattr search open };
#line 618

#line 618

#line 618
	 	
#line 618
##### end corecmd_search_bin(xm_t) depth: 1
#line 618
 	
#line 618
	allow xm_t rpm_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 618

#line 618
	 	
#line 618
##### end rpm_exec(xm_t) depth: 0
#line 618
 	
#line 618

#line 618
	} # end optional
#line 620



#line 622
	optional {
#line 622
		
#line 622
	 	 	
#line 622
##### begin vhostmd_rw_tmpfs_files(xm_t) depth: 1
#line 622
 	
#line 622
	
#line 622
	
#line 622
		require {
#line 622
			
#line 622
		type vhostmd_tmpfs_t;
#line 622
	
#line 622
		} # end require
#line 622
	
#line 622

#line 622

#line 622
	 	 	
#line 622
##### begin fs_search_tmpfs(xm_t) depth: 2
#line 622
 	
#line 622
	
#line 622
	
#line 622
		require {
#line 622
			
#line 622
		type tmpfs_t;
#line 622
	
#line 622
		} # end require
#line 622
	
#line 622

#line 622

#line 622
	allow xm_t tmpfs_t:dir { getattr search open };
#line 622

#line 622
	 	
#line 622
##### end fs_search_tmpfs(xm_t) depth: 1
#line 622
 	
#line 622
	
#line 622
	allow xm_t vhostmd_tmpfs_t:dir { getattr search open };
#line 622
	allow xm_t vhostmd_tmpfs_t:file { getattr open read write append ioctl lock };
#line 622

#line 622

#line 622
	 	
#line 622
##### end vhostmd_rw_tmpfs_files(xm_t) depth: 0
#line 622
 	
#line 622
	 	 	
#line 622
##### begin vhostmd_stream_connect(xm_t) depth: 1
#line 622
 	
#line 622
	
#line 622
	
#line 622
		require {
#line 622
			
#line 622
		type vhostmd_t, vhostmd_var_run_t;
#line 622
	
#line 622
		} # end require
#line 622
	
#line 622

#line 622

#line 622
	 	 	
#line 622
##### begin files_search_pids(xm_t) depth: 2
#line 622
 	
#line 622
	
#line 622
	
#line 622
		require {
#line 622
			
#line 622
		type var_t, var_run_t;
#line 622
	
#line 622
		} # end require
#line 622
	
#line 622

#line 622

#line 622
	allow xm_t var_run_t:lnk_file { getattr read };
#line 622
	
#line 622
	allow xm_t var_t:dir { getattr search open };
#line 622
	allow xm_t var_run_t:dir { getattr search open };
#line 622

#line 622

#line 622
	 	
#line 622
##### end files_search_pids(xm_t) depth: 1
#line 622
 	
#line 622
	
#line 622
	allow xm_t vhostmd_var_run_t:dir { getattr search open };
#line 622
	allow xm_t vhostmd_var_run_t:sock_file { getattr write open append };
#line 622
	allow xm_t vhostmd_t:unix_stream_socket connectto;
#line 622

#line 622

#line 622
	 	
#line 622
##### end vhostmd_stream_connect(xm_t) depth: 0
#line 622
 	
#line 622
	 	 	
#line 622
##### begin vhostmd_dontaudit_rw_stream_connect(xm_t) depth: 1
#line 622
 	
#line 622
	
#line 622
	
#line 622
		require {
#line 622
			
#line 622
		type vhostmd_t;
#line 622
	
#line 622
		} # end require
#line 622
	
#line 622

#line 622

#line 622
	dontaudit xm_t vhostmd_t:unix_stream_socket { read write };
#line 622

#line 622
	 	
#line 622
##### end vhostmd_dontaudit_rw_stream_connect(xm_t) depth: 0
#line 622
 	
#line 622

#line 622
	} # end optional
#line 626



#line 628
	optional {
#line 628
		
#line 628
	 	 	
#line 628
##### begin virt_domtrans(xm_t) depth: 1
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type virtd_t, virtd_exec_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	 	 	
#line 628
##### begin corecmd_search_bin(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type bin_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	
#line 628
	allow xm_t bin_t:dir { getattr search open };
#line 628
	allow xm_t bin_t:dir { getattr search open };
#line 628

#line 628

#line 628
	 	
#line 628
##### end corecmd_search_bin(xm_t) depth: 1
#line 628
 	
#line 628
	
#line 628
	
#line 628
	
#line 628
	allow xm_t virtd_exec_t:file { getattr open read execute };
#line 628
	allow xm_t virtd_t:process transition;
#line 628
	dontaudit xm_t virtd_t:process { noatsecure siginh rlimitinh };
#line 628

#line 628
	type_transition xm_t virtd_exec_t:process virtd_t;
#line 628

#line 628

#line 628
	allow virtd_t xm_t:fd use;
#line 628
	allow virtd_t xm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 628
	allow virtd_t xm_t:process sigchld;
#line 628

#line 628

#line 628
	 	
#line 628
##### end virt_domtrans(xm_t) depth: 0
#line 628
 	
#line 628
	 	 	
#line 628
##### begin virt_manage_images(xm_t) depth: 1
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type virt_var_lib_t;
#line 628
		attribute virt_image_type;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	 	 	
#line 628
##### begin virt_search_lib(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type virt_var_lib_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	 	 	
#line 628
##### begin files_search_var_lib(xm_t) depth: 3
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type var_t, var_lib_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	
#line 628
	allow xm_t var_t:dir { getattr search open };
#line 628
	allow xm_t var_lib_t:dir { getattr search open };
#line 628

#line 628

#line 628
	 	
#line 628
##### end files_search_var_lib(xm_t) depth: 2
#line 628
 	
#line 628
	allow xm_t virt_var_lib_t:dir { getattr search open };
#line 628

#line 628
	 	
#line 628
##### end virt_search_lib(xm_t) depth: 1
#line 628
 	
#line 628
	allow xm_t virt_image_type:dir { getattr search open read lock ioctl };
#line 628
	
#line 628
	allow xm_t virt_image_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 628
	allow xm_t virt_image_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 628

#line 628
	
#line 628
	allow xm_t virt_image_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 628
	allow xm_t virt_image_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 628

#line 628
	
#line 628
	allow xm_t virt_image_type:dir { getattr search open };
#line 628
	allow xm_t virt_image_type:lnk_file { getattr read };
#line 628

#line 628
	
#line 628
	allow xm_t virt_image_type:dir { getattr search open };
#line 628
	allow xm_t virt_image_type:blk_file { getattr open read write append ioctl lock };
#line 628

#line 628

#line 628
	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		
#line 628
bool virt_use_nfs;
#line 628

#line 628
  
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628
	if (virt_use_nfs) {
#line 628
		
#line 628
		 	 	
#line 628
##### begin fs_manage_nfs_dirs(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type nfs_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	allow xm_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 628

#line 628
	 	
#line 628
##### end fs_manage_nfs_dirs(xm_t) depth: 1
#line 628
 	
#line 628
		 	 	
#line 628
##### begin fs_manage_nfs_files(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type nfs_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	
#line 628
	allow xm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 628
	allow xm_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 628

#line 628

#line 628
	 	
#line 628
##### end fs_manage_nfs_files(xm_t) depth: 1
#line 628
 	
#line 628
		 	 	
#line 628
##### begin fs_read_nfs_symlinks(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type nfs_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	allow xm_t nfs_t:dir { getattr search open read lock ioctl };
#line 628
	
#line 628
	allow xm_t nfs_t:dir { getattr search open };
#line 628
	allow xm_t nfs_t:lnk_file { getattr read };
#line 628

#line 628

#line 628
	 	
#line 628
##### end fs_read_nfs_symlinks(xm_t) depth: 1
#line 628
 	
#line 628
	
#line 628
	}
#line 628

#line 628

#line 628
	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		
#line 628
bool virt_use_samba;
#line 628

#line 628
  
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628
	if (virt_use_samba) {
#line 628
		
#line 628
		 	 	
#line 628
##### begin fs_manage_cifs_files(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type cifs_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	
#line 628
	allow xm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 628
	allow xm_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 628

#line 628

#line 628
	 	
#line 628
##### end fs_manage_cifs_files(xm_t) depth: 1
#line 628
 	
#line 628
		 	 	
#line 628
##### begin fs_manage_cifs_files(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type cifs_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	
#line 628
	allow xm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 628
	allow xm_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 628

#line 628

#line 628
	 	
#line 628
##### end fs_manage_cifs_files(xm_t) depth: 1
#line 628
 	
#line 628
		 	 	
#line 628
##### begin fs_read_cifs_symlinks(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type cifs_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	allow xm_t cifs_t:dir { getattr search open read lock ioctl };
#line 628
	
#line 628
	allow xm_t cifs_t:dir { getattr search open };
#line 628
	allow xm_t cifs_t:lnk_file { getattr read };
#line 628

#line 628

#line 628
	 	
#line 628
##### end fs_read_cifs_symlinks(xm_t) depth: 1
#line 628
 	
#line 628
	
#line 628
	}
#line 628

#line 628

#line 628
	 	
#line 628
##### end virt_manage_images(xm_t) depth: 0
#line 628
 	
#line 628
	 	 	
#line 628
##### begin virt_manage_config(xm_t) depth: 1
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type virt_etc_t, virt_etc_rw_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	 	 	
#line 628
##### begin files_search_etc(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type etc_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	allow xm_t etc_t:dir { getattr search open };
#line 628

#line 628
	 	
#line 628
##### end files_search_etc(xm_t) depth: 1
#line 628
 	
#line 628
	allow xm_t { virt_etc_t virt_etc_rw_t }:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 628
	
#line 628
	allow xm_t virt_etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 628
	allow xm_t virt_etc_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 628

#line 628
	
#line 628
	allow xm_t virt_etc_rw_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 628
	allow xm_t virt_etc_rw_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 628

#line 628
	
#line 628
	allow xm_t virt_etc_rw_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 628
	allow xm_t virt_etc_rw_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 628

#line 628

#line 628
	 	
#line 628
##### end virt_manage_config(xm_t) depth: 0
#line 628
 	
#line 628
	 	 	
#line 628
##### begin virt_stream_connect(xm_t) depth: 1
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type virtd_t, virt_var_run_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	 	 	
#line 628
##### begin files_search_pids(xm_t) depth: 2
#line 628
 	
#line 628
	
#line 628
	
#line 628
		require {
#line 628
			
#line 628
		type var_t, var_run_t;
#line 628
	
#line 628
		} # end require
#line 628
	
#line 628

#line 628

#line 628
	allow xm_t var_run_t:lnk_file { getattr read };
#line 628
	
#line 628
	allow xm_t var_t:dir { getattr search open };
#line 628
	allow xm_t var_run_t:dir { getattr search open };
#line 628

#line 628

#line 628
	 	
#line 628
##### end files_search_pids(xm_t) depth: 1
#line 628
 	
#line 628
	
#line 628
	allow xm_t virt_var_run_t:dir { getattr search open };
#line 628
	allow xm_t virt_var_run_t:sock_file { getattr write open append };
#line 628
	allow xm_t virtd_t:unix_stream_socket connectto;
#line 628

#line 628

#line 628
	 	
#line 628
##### end virt_stream_connect(xm_t) depth: 0
#line 628
 	
#line 628

#line 628
	} # end optional
#line 633



#line 635
	optional {
#line 635
		
#line 635
	 	 	
#line 635
##### begin ssh_basic_client_template(xm,xm_t,system_r) depth: 1
#line 635
 	
#line 635

#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute ssh_server;
#line 635
		type ssh_exec_t, sshd_key_t, sshd_tmp_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	##############################
#line 635
	#
#line 635
	# Declarations
#line 635
	#
#line 635

#line 635
	type xm_ssh_t;
#line 635
	 	 	
#line 635
##### begin application_domain(xm_ssh_t,ssh_exec_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin application_type(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute application_domain_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute xm_ssh_t application_domain_type;
#line 635

#line 635
	# start with basic domain
#line 635
	 	 	
#line 635
##### begin domain_type(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	# start with basic domain
#line 635
	 	 	
#line 635
##### begin domain_base_type(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute domain;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute xm_ssh_t domain;
#line 635

#line 635
	 	
#line 635
##### end domain_base_type(xm_ssh_t) depth: 4
#line 635
 	
#line 635

#line 635
	
#line 635

#line 635
	# send init a sigchld and signull
#line 635
	
#line 635
	optional {
#line 635
		
#line 635
		 	 	
#line 635
##### begin init_sigchld(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type init_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t init_t:process sigchld;
#line 635

#line 635
	 	
#line 635
##### end init_sigchld(xm_ssh_t) depth: 4
#line 635
 	
#line 635
		 	 	
#line 635
##### begin init_signull(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type init_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t init_t:process signull;
#line 635

#line 635
	 	
#line 635
##### end init_signull(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	}
#line 635

#line 635

#line 635
	# these seem questionable:
#line 635

#line 635
	
#line 635
	optional {
#line 635
		
#line 635
		 	 	
#line 635
##### begin rpm_use_fds(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type rpm_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t rpm_t:fd use;
#line 635

#line 635
	 	
#line 635
##### end rpm_use_fds(xm_ssh_t) depth: 4
#line 635
 	
#line 635
		 	 	
#line 635
##### begin rpm_read_pipes(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type rpm_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 635

#line 635
	 	
#line 635
##### end rpm_read_pipes(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	}
#line 635

#line 635

#line 635
	
#line 635
	optional {
#line 635
		
#line 635
		 	 	
#line 635
##### begin selinux_dontaudit_getattr_fs(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type security_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	dontaudit xm_ssh_t security_t:filesystem getattr;
#line 635

#line 635
	 	 	
#line 635
##### begin dev_dontaudit_getattr_sysfs(xm_ssh_t) depth: 6
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type sysfs_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	dontaudit xm_ssh_t sysfs_t:filesystem getattr;
#line 635

#line 635
	 	
#line 635
##### end dev_dontaudit_getattr_sysfs(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	 	 	
#line 635
##### begin dev_dontaudit_search_sysfs(xm_ssh_t) depth: 6
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type sysfs_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	dontaudit xm_ssh_t sysfs_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end dev_dontaudit_search_sysfs(xm_ssh_t) depth: 5
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end selinux_dontaudit_getattr_fs(xm_ssh_t) depth: 4
#line 635
 	
#line 635
		 	 	
#line 635
##### begin selinux_dontaudit_read_fs(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type security_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	dontaudit xm_ssh_t security_t:dir { getattr search open };
#line 635
	dontaudit xm_ssh_t security_t:file { getattr open read lock ioctl };
#line 635

#line 635
	 	
#line 635
##### end selinux_dontaudit_read_fs(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	}
#line 635

#line 635

#line 635
	
#line 635
	optional {
#line 635
		
#line 635
		 	 	
#line 635
##### begin seutil_dontaudit_read_config(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type selinux_config_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	dontaudit xm_ssh_t selinux_config_t:dir { getattr search open };
#line 635
	dontaudit xm_ssh_t selinux_config_t:file { getattr open read lock ioctl };
#line 635

#line 635
	 	
#line 635
##### end seutil_dontaudit_read_config(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	}
#line 635

#line 635

#line 635
	 	
#line 635
##### end domain_type(xm_ssh_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end application_type(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin application_executable_file(ssh_exec_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute application_exec_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute ssh_exec_t application_exec_type;
#line 635

#line 635
	 	 	
#line 635
##### begin corecmd_executable_file(ssh_exec_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute exec_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute ssh_exec_t exec_type;
#line 635

#line 635
	 	 	
#line 635
##### begin files_type(ssh_exec_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute ssh_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 635

#line 635
	 	
#line 635
##### end files_type(ssh_exec_t) depth: 4
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corecmd_executable_file(ssh_exec_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end application_executable_file(ssh_exec_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin domain_entry_file(xm_ssh_t,ssh_exec_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute entry_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t ssh_exec_t:file entrypoint;
#line 635
	allow xm_ssh_t ssh_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 635

#line 635
	typeattribute ssh_exec_t entry_type;
#line 635

#line 635
	 	 	
#line 635
##### begin corecmd_executable_file(ssh_exec_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute exec_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute ssh_exec_t exec_type;
#line 635

#line 635
	 	 	
#line 635
##### begin files_type(ssh_exec_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute ssh_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 635

#line 635
	 	
#line 635
##### end files_type(ssh_exec_t) depth: 4
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corecmd_executable_file(ssh_exec_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end domain_entry_file(xm_ssh_t,ssh_exec_t) depth: 2
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end application_domain(xm_ssh_t,ssh_exec_t) depth: 1
#line 635
 	
#line 635
	role system_r types xm_ssh_t;
#line 635

#line 635
	type xm_ssh_home_t;
#line 635
	 	 	
#line 635
##### begin files_type(xm_ssh_home_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute xm_ssh_home_t file_type, non_security_file_type, non_auth_file_type;
#line 635

#line 635
	 	
#line 635
##### end files_type(xm_ssh_home_t) depth: 1
#line 635
 	
#line 635
	typealias xm_ssh_home_t alias xm_home_ssh_t;
#line 635

#line 635
	##############################
#line 635
	#
#line 635
	# Client local policy
#line 635
	#
#line 635

#line 635
	allow xm_ssh_t self:capability { setuid setgid dac_override dac_read_search };
#line 635
	allow xm_ssh_t self:process ~{ ptrace setcurrent setexec setfscreate setrlimit execmem execstack execheap };
#line 635
	allow xm_ssh_t self:fd use;
#line 635
	allow xm_ssh_t self:fifo_file { open { getattr read write append ioctl lock } };
#line 635
	allow xm_ssh_t self:unix_dgram_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } sendto };
#line 635
	allow xm_ssh_t self:unix_stream_socket { { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept } connectto };
#line 635
	allow xm_ssh_t self:shm { associate getattr setattr create destroy read write lock unix_read unix_write };
#line 635
	allow xm_ssh_t self:sem { associate getattr setattr create destroy read write unix_read unix_write };
#line 635
	allow xm_ssh_t self:msgq { associate getattr setattr create destroy read write enqueue unix_read unix_write };
#line 635
	allow xm_ssh_t self:msg { send receive };
#line 635
	allow xm_ssh_t self:tcp_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 635

#line 635
	# for rsync
#line 635
	allow xm_ssh_t xm_t:unix_stream_socket { ioctl read getattr write setattr append bind connect getopt setopt shutdown };
#line 635
	allow xm_ssh_t xm_t:unix_stream_socket connectto;
#line 635

#line 635
	# Read the ssh key file.
#line 635
	allow xm_ssh_t sshd_key_t:file { getattr open read lock ioctl };
#line 635

#line 635
	# Access the ssh temporary files.
#line 635
	allow xm_ssh_t sshd_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 635
	allow xm_ssh_t sshd_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 635
	 	 	
#line 635
##### begin files_tmp_filetrans(xm_ssh_t,sshd_tmp_t,{ file dir }) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type tmp_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 635
	type_transition xm_ssh_t tmp_t:{ file dir } sshd_tmp_t ;
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_tmp_filetrans(xm_ssh_t,sshd_tmp_t,{ file dir }) depth: 1
#line 635
 	
#line 635

#line 635
	# Transition from the domain to the derived domain.
#line 635
	
#line 635
	
#line 635
	
#line 635
	allow xm_t ssh_exec_t:file { getattr open read execute };
#line 635
	allow xm_t xm_ssh_t:process transition;
#line 635
	dontaudit xm_t xm_ssh_t:process { noatsecure siginh rlimitinh };
#line 635

#line 635
	type_transition xm_t ssh_exec_t:process xm_ssh_t;
#line 635

#line 635

#line 635
	allow xm_ssh_t xm_t:fd use;
#line 635
	allow xm_ssh_t xm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 635
	allow xm_ssh_t xm_t:process sigchld;
#line 635

#line 635

#line 635
	# inheriting stream sockets is needed for "ssh host command" as no pty
#line 635
	# is allocated
#line 635
	# cjp: should probably fix target to be an attribute for ssh servers
#line 635
	# or "regular" (not special like sshd_extern_t) servers
#line 635
	allow xm_t ssh_server:unix_stream_socket { { ioctl read getattr write setattr append bind connect getopt setopt shutdown } listen accept };
#line 635

#line 635
	# allow ps to show ssh
#line 635
	
#line 635
	allow xm_t xm_ssh_t:dir { getattr search open read lock ioctl };
#line 635
	allow xm_t xm_ssh_t:file { getattr open read lock ioctl };
#line 635
	allow xm_t xm_ssh_t:lnk_file { getattr read };
#line 635
	allow xm_t xm_ssh_t:process getattr;
#line 635

#line 635

#line 635
	# user can manage the keys and config
#line 635
	
#line 635
	allow xm_t xm_ssh_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 635
	allow xm_t xm_ssh_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 635

#line 635
	
#line 635
	allow xm_t xm_ssh_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 635
	allow xm_t xm_ssh_home_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 635

#line 635
	
#line 635
	allow xm_t xm_ssh_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 635
	allow xm_t xm_ssh_home_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 635

#line 635

#line 635
	# ssh client can manage the keys and config
#line 635
	
#line 635
	allow xm_ssh_t xm_ssh_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 635
	allow xm_ssh_t xm_ssh_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t xm_ssh_home_t:dir { getattr search open };
#line 635
	allow xm_ssh_t xm_ssh_home_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	# ssh servers can read the user keys and config
#line 635
	allow ssh_server xm_ssh_home_t:dir { getattr search open read lock ioctl };
#line 635
	
#line 635
	allow ssh_server xm_ssh_home_t:dir { getattr search open };
#line 635
	allow ssh_server xm_ssh_home_t:file { getattr open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow ssh_server xm_ssh_home_t:dir { getattr search open };
#line 635
	allow ssh_server xm_ssh_home_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin kernel_read_kernel_sysctls(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type proc_t, sysctl_t, sysctl_kernel_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 635
	allow xm_ssh_t sysctl_kernel_t:file { getattr open read lock ioctl };
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t { proc_t sysctl_t }:dir { getattr search open };
#line 635
	allow xm_ssh_t sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 635

#line 635

#line 635
	 	
#line 635
##### end kernel_read_kernel_sysctls(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_read_system_state(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type proc_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t proc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t proc_t:file { getattr open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t proc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t proc_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t proc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t proc_t:dir { getattr search open read lock ioctl };
#line 635

#line 635

#line 635
	 	
#line 635
##### end kernel_read_system_state(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin corenet_all_recvfrom_unlabeled(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_tcp_recvfrom_unlabeled(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:tcp_socket recvfrom;
#line 635

#line 635
	 	
#line 635
##### end kernel_tcp_recvfrom_unlabeled(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_udp_recvfrom_unlabeled(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:udp_socket recvfrom;
#line 635

#line 635
	 	
#line 635
##### end kernel_udp_recvfrom_unlabeled(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_raw_recvfrom_unlabeled(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:rawip_socket recvfrom;
#line 635

#line 635
	 	
#line 635
##### end kernel_raw_recvfrom_unlabeled(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_recvfrom_unlabeled_peer(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:peer recv;
#line 635

#line 635
	 	
#line 635
##### end kernel_recvfrom_unlabeled_peer(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
	# XXX - at some point the oubound/send access check will be removed
#line 635
	# but for right now we need to keep this in place so as not to break
#line 635
	# older systems
#line 635
	 	 	
#line 635
##### begin kernel_sendrecv_unlabeled_association(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:association { sendto recvfrom };
#line 635

#line 635
	 	
#line 635
##### end kernel_sendrecv_unlabeled_association(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corenet_all_recvfrom_unlabeled(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_all_recvfrom_netlabel(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type netlabel_peer_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t netlabel_peer_t:peer recv;
#line 635
	allow xm_ssh_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 635

#line 635
	 	
#line 635
##### end corenet_all_recvfrom_netlabel(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_tcp_sendrecv_generic_if(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type netif_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_sendrecv_generic_if(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_tcp_sendrecv_generic_node(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type node_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_sendrecv_generic_node(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_tcp_sendrecv_all_ports(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute port_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t port_type:tcp_socket { send_msg recv_msg };
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_sendrecv_all_ports(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_tcp_connect_ssh_port(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type ssh_port_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t ssh_port_t:tcp_socket name_connect;
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_connect_ssh_port(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_sendrecv_ssh_client_packets(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_send_ssh_client_packets(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type ssh_client_packet_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t ssh_client_packet_t:packet send;
#line 635

#line 635
	 	
#line 635
##### end corenet_send_ssh_client_packets(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_receive_ssh_client_packets(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type ssh_client_packet_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t ssh_client_packet_t:packet recv;
#line 635

#line 635
	 	
#line 635
##### end corenet_receive_ssh_client_packets(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corenet_sendrecv_ssh_client_packets(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin dev_read_urand(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type device_t, urandom_device_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t device_t:dir { getattr search open };
#line 635
	allow xm_ssh_t urandom_device_t:chr_file { getattr open read lock ioctl };
#line 635

#line 635

#line 635
	 	
#line 635
##### end dev_read_urand(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin fs_getattr_all_fs(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute filesystem_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t filesystem_type:filesystem getattr;
#line 635
	 	 	
#line 635
##### begin files_getattr_all_file_type_fs(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute file_type;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t file_type:filesystem getattr;
#line 635

#line 635
	 	
#line 635
##### end files_getattr_all_file_type_fs(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end fs_getattr_all_fs(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin fs_search_auto_mountpoints(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type autofs_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t autofs_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end fs_search_auto_mountpoints(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	# run helper programs - needed eg for x11-ssh-askpass
#line 635
	 	 	
#line 635
##### begin corecmd_exec_shell(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type bin_t, shell_exec_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t bin_t:dir { getattr search open };
#line 635
	allow xm_ssh_t bin_t:dir { getattr search open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t bin_t:dir { getattr search open };
#line 635
	allow xm_ssh_t bin_t:lnk_file { getattr read };
#line 635

#line 635
	allow xm_ssh_t shell_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 635

#line 635
	 	
#line 635
##### end corecmd_exec_shell(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corecmd_exec_bin(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type bin_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t bin_t:dir { getattr search open };
#line 635
	allow xm_ssh_t bin_t:lnk_file { getattr read };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t bin_t:dir { getattr search open };
#line 635
	allow xm_ssh_t bin_t:dir { getattr search open read lock ioctl };
#line 635

#line 635
	allow xm_ssh_t bin_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 635

#line 635
	 	
#line 635
##### end corecmd_exec_bin(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin domain_use_interactive_fds(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		attribute privfd;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t privfd:fd use;
#line 635

#line 635
	 	
#line 635
##### end domain_use_interactive_fds(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin files_list_home(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type home_root_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t home_root_t:dir { getattr search open read lock ioctl };
#line 635
	allow xm_ssh_t home_root_t:lnk_file { getattr read };
#line 635

#line 635
	 	
#line 635
##### end files_list_home(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin files_read_usr_files(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type usr_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t usr_t:dir { getattr search open read lock ioctl };
#line 635
	
#line 635
	allow xm_ssh_t usr_t:dir { getattr search open };
#line 635
	allow xm_ssh_t usr_t:file { getattr open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t usr_t:dir { getattr search open };
#line 635
	allow xm_ssh_t usr_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_read_usr_files(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin files_read_etc_runtime_files(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type etc_t, etc_runtime_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t etc_t:dir { getattr search open read lock ioctl };
#line 635
	
#line 635
	allow xm_ssh_t etc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t etc_runtime_t:file { getattr open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t etc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t etc_runtime_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_read_etc_runtime_files(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin files_read_etc_files(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type etc_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t etc_t:dir { getattr search open read lock ioctl };
#line 635
	
#line 635
	allow xm_ssh_t etc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t etc_t:file { getattr open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t etc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t etc_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_read_etc_files(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin files_read_var_files(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type var_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t var_t:dir { getattr search open };
#line 635
	allow xm_ssh_t var_t:file { getattr open read lock ioctl };
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_read_var_files(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin auth_use_nsswitch(xm_ssh_t) depth: 2
#line 635
 	
#line 635
    
#line 635
	
#line 635
		require {
#line 635
			
#line 635
        attribute nsswitch_domain;
#line 635
    
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	typeattribute xm_ssh_t nsswitch_domain;
#line 635

#line 635
	 	
#line 635
##### end auth_use_nsswitch(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin logging_send_syslog_msg(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type syslogd_t, syslogd_var_run_t, devlog_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t devlog_t:sock_file { getattr write open append };
#line 635

#line 635
	# systemd journal socket is in /run/systemd/journal/dev-log
#line 635
	 	 	
#line 635
##### begin init_search_run(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type init_var_run_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin files_search_pids(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type var_t, var_run_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t var_run_t:lnk_file { getattr read };
#line 635
	
#line 635
	allow xm_ssh_t var_t:dir { getattr search open };
#line 635
	allow xm_ssh_t var_run_t:dir { getattr search open };
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_search_pids(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	allow xm_ssh_t init_var_run_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end init_search_run(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	allow xm_ssh_t syslogd_var_run_t:dir { getattr search open };
#line 635

#line 635
	# the type of socket depends on the syslog daemon
#line 635
	allow xm_ssh_t syslogd_t:unix_dgram_socket sendto;
#line 635
	allow xm_ssh_t syslogd_t:unix_stream_socket connectto;
#line 635
	allow xm_ssh_t self:unix_dgram_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 635
	allow xm_ssh_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 635

#line 635
	# If syslog is down, the glibc syslog() function
#line 635
	# will write to the console.
#line 635
	 	 	
#line 635
##### begin term_write_console(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type console_device_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin dev_list_all_dev_nodes(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type device_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t device_t:dir { getattr search open };
#line 635
	allow xm_ssh_t device_t:dir { getattr search open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t device_t:dir { getattr search open };
#line 635
	allow xm_ssh_t device_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	 	
#line 635
##### end dev_list_all_dev_nodes(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	allow xm_ssh_t console_device_t:chr_file { getattr open write append lock ioctl };
#line 635

#line 635
	 	
#line 635
##### end term_write_console(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin term_dontaudit_read_console(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type console_device_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	dontaudit xm_ssh_t console_device_t:chr_file { getattr open read lock ioctl };
#line 635

#line 635
	 	
#line 635
##### end term_dontaudit_read_console(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
	# because systemd is now using /run/systemd/journal/dev-log
#line 635
	 	 	
#line 635
##### begin init_search_pid_dirs(xm_ssh_t) depth: 3
#line 635
 	
#line 635
    
#line 635
	
#line 635
		require {
#line 635
			
#line 635
        type init_var_run_t;
#line 635
    
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
    allow xm_ssh_t init_var_run_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end init_search_pid_dirs(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end logging_send_syslog_msg(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	 	 	
#line 635
##### begin logging_read_generic_logs(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type var_log_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin files_search_var(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type var_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t var_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end files_search_var(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	allow xm_ssh_t var_log_t:dir { getattr search open read lock ioctl };
#line 635
	
#line 635
	allow xm_ssh_t var_log_t:dir { getattr search open };
#line 635
	allow xm_ssh_t var_log_t:file { getattr open read lock ioctl };
#line 635

#line 635

#line 635
	 	
#line 635
##### end logging_read_generic_logs(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin miscfiles_read_localization(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type locale_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin files_read_etc_symlinks(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type etc_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t etc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t etc_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_read_etc_symlinks(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin files_search_usr(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type usr_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t usr_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end files_search_usr(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	allow xm_ssh_t locale_t:dir { getattr search open read lock ioctl };
#line 635
	
#line 635
	allow xm_ssh_t locale_t:dir { getattr search open };
#line 635
	allow xm_ssh_t locale_t:file { getattr open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t locale_t:dir { getattr search open };
#line 635
	allow xm_ssh_t locale_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	 	
#line 635
##### end miscfiles_read_localization(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin seutil_read_config(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type selinux_config_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin files_search_etc(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type etc_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t etc_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end files_search_etc(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	allow xm_ssh_t selinux_config_t:dir { getattr search open read lock ioctl };
#line 635
	
#line 635
	allow xm_ssh_t selinux_config_t:dir { getattr search open };
#line 635
	allow xm_ssh_t selinux_config_t:file { getattr open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t selinux_config_t:dir { getattr search open };
#line 635
	allow xm_ssh_t selinux_config_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	 	
#line 635
##### end seutil_read_config(xm_ssh_t) depth: 1
#line 635
 	
#line 635

#line 635
	
#line 635
	optional {
#line 635
		
#line 635
		 	 	
#line 635
##### begin kerberos_use(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type krb5kdc_conf_t, krb5_host_rcache_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin kerberos_read_config(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type krb5_conf_t, krb5_home_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin files_search_etc(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type etc_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t etc_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end files_search_etc(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	allow xm_ssh_t krb5_conf_t:file { getattr open read lock ioctl };
#line 635

#line 635
	 	 	
#line 635
##### begin userdom_search_user_home_dirs(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type user_home_dir_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t user_home_dir_t:dir { getattr search open };
#line 635
	 	 	
#line 635
##### begin files_search_home(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type home_root_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t home_root_t:dir { getattr search open };
#line 635
	allow xm_ssh_t home_root_t:lnk_file { getattr read };
#line 635

#line 635
	 	
#line 635
##### end files_search_home(xm_ssh_t) depth: 4
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end userdom_search_user_home_dirs(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	allow xm_ssh_t krb5_home_t:file { getattr open read lock ioctl };
#line 635

#line 635
	 	
#line 635
##### end kerberos_read_config(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
	dontaudit xm_ssh_t krb5_conf_t:file { getattr open write append lock ioctl };
#line 635
	dontaudit xm_ssh_t krb5kdc_conf_t:dir { getattr search open read lock ioctl };
#line 635
	dontaudit xm_ssh_t krb5kdc_conf_t:file { getattr open read write append ioctl lock };
#line 635

#line 635
	dontaudit xm_ssh_t self:process setfscreate;
#line 635

#line 635
	 	 	
#line 635
##### begin selinux_dontaudit_validate_context(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type security_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	dontaudit xm_ssh_t security_t:dir { getattr search open read lock ioctl };
#line 635
	dontaudit xm_ssh_t security_t:file { getattr open read write append ioctl lock };
#line 635
	dontaudit xm_ssh_t security_t:security check_context;
#line 635

#line 635
	 	
#line 635
##### end selinux_dontaudit_validate_context(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	 	 	
#line 635
##### begin seutil_dontaudit_read_file_contexts(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type selinux_config_t, default_context_t, file_context_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	dontaudit xm_ssh_t { selinux_config_t default_context_t file_context_t }:dir { getattr search open };
#line 635
	dontaudit xm_ssh_t file_context_t:file { getattr open read lock ioctl };
#line 635

#line 635
	 	
#line 635
##### end seutil_dontaudit_read_file_contexts(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		
#line 635
bool allow_kerberos;
#line 635

#line 635
  
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635
	if (allow_kerberos) {
#line 635
		
#line 635
		allow xm_ssh_t self:tcp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 635
		allow xm_ssh_t self:udp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 635

#line 635
		 	 	
#line 635
##### begin corenet_all_recvfrom_unlabeled(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_tcp_recvfrom_unlabeled(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:tcp_socket recvfrom;
#line 635

#line 635
	 	
#line 635
##### end kernel_tcp_recvfrom_unlabeled(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_udp_recvfrom_unlabeled(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:udp_socket recvfrom;
#line 635

#line 635
	 	
#line 635
##### end kernel_udp_recvfrom_unlabeled(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_raw_recvfrom_unlabeled(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:rawip_socket recvfrom;
#line 635

#line 635
	 	
#line 635
##### end kernel_raw_recvfrom_unlabeled(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_recvfrom_unlabeled_peer(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:peer recv;
#line 635

#line 635
	 	
#line 635
##### end kernel_recvfrom_unlabeled_peer(xm_ssh_t) depth: 3
#line 635
 	
#line 635

#line 635
	# XXX - at some point the oubound/send access check will be removed
#line 635
	# but for right now we need to keep this in place so as not to break
#line 635
	# older systems
#line 635
	 	 	
#line 635
##### begin kernel_sendrecv_unlabeled_association(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type unlabeled_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t unlabeled_t:association { sendto recvfrom };
#line 635

#line 635
	 	
#line 635
##### end kernel_sendrecv_unlabeled_association(xm_ssh_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corenet_all_recvfrom_unlabeled(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_all_recvfrom_netlabel(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type netlabel_peer_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t netlabel_peer_t:peer recv;
#line 635
	allow xm_ssh_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 635

#line 635
	 	
#line 635
##### end corenet_all_recvfrom_netlabel(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_tcp_sendrecv_generic_if(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type netif_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_sendrecv_generic_if(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_udp_sendrecv_generic_if(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_udp_send_generic_if(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type netif_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t netif_t:netif { udp_send egress };
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_send_generic_if(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_udp_receive_generic_if(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type netif_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t netif_t:netif { udp_recv ingress };
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_receive_generic_if(xm_ssh_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_sendrecv_generic_if(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_tcp_sendrecv_generic_node(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type node_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_sendrecv_generic_node(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_udp_sendrecv_generic_node(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_udp_send_generic_node(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type node_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t node_t:node { udp_send sendto };
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_send_generic_node(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_udp_receive_generic_node(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type node_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t node_t:node { udp_recv recvfrom };
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_receive_generic_node(xm_ssh_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_sendrecv_generic_node(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
		 	 	
#line 635
##### begin corenet_sendrecv_kerberos_client_packets(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_send_kerberos_client_packets(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type kerberos_client_packet_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t kerberos_client_packet_t:packet send;
#line 635

#line 635
	 	
#line 635
##### end corenet_send_kerberos_client_packets(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_receive_kerberos_client_packets(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type kerberos_client_packet_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t kerberos_client_packet_t:packet recv;
#line 635

#line 635
	 	
#line 635
##### end corenet_receive_kerberos_client_packets(xm_ssh_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corenet_sendrecv_kerberos_client_packets(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_tcp_connect_kerberos_port(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type kerberos_port_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t kerberos_port_t:tcp_socket name_connect;
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_connect_kerberos_port(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_tcp_sendrecv_kerberos_port(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type kerberos_port_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t kerberos_port_t:tcp_socket { send_msg recv_msg };
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_sendrecv_kerberos_port(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_udp_sendrecv_kerberos_port(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_udp_send_kerberos_port(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type kerberos_port_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t kerberos_port_t:udp_socket send_msg;
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_send_kerberos_port(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_udp_receive_kerberos_port(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type kerberos_port_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t kerberos_port_t:udp_socket recv_msg;
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_receive_kerberos_port(xm_ssh_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corenet_udp_sendrecv_kerberos_port(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
		 	 	
#line 635
##### begin corenet_sendrecv_ocsp_client_packets(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_send_ocsp_client_packets(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type ocsp_client_packet_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t ocsp_client_packet_t:packet send;
#line 635

#line 635
	 	
#line 635
##### end corenet_send_ocsp_client_packets(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	 	 	
#line 635
##### begin corenet_receive_ocsp_client_packets(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type ocsp_client_packet_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t ocsp_client_packet_t:packet recv;
#line 635

#line 635
	 	
#line 635
##### end corenet_receive_ocsp_client_packets(xm_ssh_t) depth: 3
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end corenet_sendrecv_ocsp_client_packets(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_tcp_connect_ocsp_port(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type ocsp_port_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t ocsp_port_t:tcp_socket name_connect;
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_connect_ocsp_port(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		 	 	
#line 635
##### begin corenet_tcp_sendrecv_ocsp_port(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type ocsp_port_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t ocsp_port_t:tcp_socket { send_msg recv_msg };
#line 635

#line 635
	 	
#line 635
##### end corenet_tcp_sendrecv_ocsp_port(xm_ssh_t) depth: 2
#line 635
 	
#line 635

#line 635
		allow xm_ssh_t krb5_host_rcache_t:file { getattr };
#line 635
	
#line 635
	}
#line 635

#line 635

#line 635
	
#line 635
	optional {
#line 635
		
#line 635
		
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		
#line 635
bool allow_kerberos;
#line 635

#line 635
  
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635
	if (allow_kerberos) {
#line 635
		
#line 635
			 	 	
#line 635
##### begin pcscd_stream_connect(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type pcscd_t, pcscd_var_run_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin files_search_pids(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type var_t, var_run_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t var_run_t:lnk_file { getattr read };
#line 635
	
#line 635
	allow xm_ssh_t var_t:dir { getattr search open };
#line 635
	allow xm_ssh_t var_run_t:dir { getattr search open };
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_search_pids(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	allow xm_ssh_t pcscd_var_run_t:dir { getattr search open };
#line 635
	allow xm_ssh_t pcscd_var_run_t:sock_file { getattr write open append };
#line 635
	allow xm_ssh_t pcscd_t:unix_stream_socket connectto;
#line 635

#line 635

#line 635
	 	
#line 635
##### end pcscd_stream_connect(xm_ssh_t) depth: 2
#line 635
 	
#line 635
		
#line 635
	}
#line 635

#line 635
	
#line 635
	}
#line 635

#line 635

#line 635
	
#line 635
	optional {
#line 635
		
#line 635
		 	 	
#line 635
##### begin sssd_read_public_files(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type sssd_public_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	 	 	
#line 635
##### begin sssd_search_lib(xm_ssh_t) depth: 4
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type sssd_var_lib_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t sssd_var_lib_t:dir { getattr search open };
#line 635
	 	 	
#line 635
##### begin files_search_var_lib(xm_ssh_t) depth: 5
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type var_t, var_lib_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t var_t:dir { getattr search open };
#line 635
	allow xm_ssh_t var_lib_t:dir { getattr search open };
#line 635

#line 635

#line 635
	 	
#line 635
##### end files_search_var_lib(xm_ssh_t) depth: 4
#line 635
 	
#line 635

#line 635
	 	
#line 635
##### end sssd_search_lib(xm_ssh_t) depth: 3
#line 635
 	
#line 635
	allow xm_ssh_t sssd_public_t:dir { getattr search open read lock ioctl };
#line 635
	
#line 635
	allow xm_ssh_t sssd_public_t:dir { getattr search open };
#line 635
	allow xm_ssh_t sssd_public_t:file { getattr open read lock ioctl };
#line 635

#line 635

#line 635
	 	
#line 635
##### end sssd_read_public_files(xm_ssh_t) depth: 2
#line 635
 	
#line 635
	
#line 635
	}
#line 635

#line 635

#line 635
	 	
#line 635
##### end kerberos_use(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	
#line 635
	}
#line 635

#line 635
 	 	
#line 635
##### end ssh_basic_client_template(xm,xm_t,system_r) depth: 0
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin kernel_read_xen_state(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type proc_t, proc_xen_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t { proc_t proc_xen_t }:dir { getattr search open };
#line 635
	allow xm_ssh_t proc_xen_t:file { getattr open read lock ioctl };
#line 635

#line 635
	
#line 635
	allow xm_ssh_t { proc_t proc_xen_t }:dir { getattr search open };
#line 635
	allow xm_ssh_t proc_xen_t:lnk_file { getattr read };
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t proc_t:dir { getattr search open };
#line 635
	allow xm_ssh_t proc_xen_t:dir { getattr search open read lock ioctl };
#line 635

#line 635

#line 635
	 	
#line 635
##### end kernel_read_xen_state(xm_ssh_t) depth: 0
#line 635
 	
#line 635
	 	 	
#line 635
##### begin kernel_write_xen_state(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type proc_t, proc_xen_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t { proc_t proc_xen_t }:dir { getattr search open };
#line 635
	allow xm_ssh_t proc_xen_t:file { getattr open write append lock ioctl };
#line 635

#line 635

#line 635
	 	
#line 635
##### end kernel_write_xen_state(xm_ssh_t) depth: 0
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin files_search_tmp(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type tmp_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t tmp_t:dir { getattr search open };
#line 635

#line 635
	 	
#line 635
##### end files_search_tmp(xm_ssh_t) depth: 0
#line 635
 	
#line 635

#line 635
	 	 	
#line 635
##### begin fs_manage_xenfs_dirs(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type xenfs_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	allow xm_ssh_t xenfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 635

#line 635
	 	
#line 635
##### end fs_manage_xenfs_dirs(xm_ssh_t) depth: 0
#line 635
 	
#line 635
	 	 	
#line 635
##### begin fs_manage_xenfs_files(xm_ssh_t) depth: 1
#line 635
 	
#line 635
	
#line 635
	
#line 635
		require {
#line 635
			
#line 635
		type xenfs_t;
#line 635
	
#line 635
		} # end require
#line 635
	
#line 635

#line 635

#line 635
	
#line 635
	allow xm_ssh_t xenfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 635
	allow xm_ssh_t xenfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 635

#line 635

#line 635
	 	
#line 635
##### end fs_manage_xenfs_files(xm_ssh_t) depth: 0
#line 635
 	
#line 635

#line 635
	} # end optional
#line 645

