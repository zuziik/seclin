#line 1 "tmp/generated_definitions.conf"
































































































#line 158


#line 196

































































































































































































































#line 275061 "tmp/all_interfaces.conf"

#line 1 "policy/modules/services/xserver.te"

#line 1
	
#line 1
		module xserver 3.12.0;
#line 1

#line 1
		require {
#line 1
			role system_r;
#line 1
			
#line 1
	class security { compute_av compute_create compute_member check_context load_policy compute_relabel compute_user setenforce setbool setsecparam setcheckreqprot read_policy validate_trans };
#line 1
	class process { fork transition sigchld sigkill sigstop signull signal ptrace getsched setsched getsession getpgid setpgid getcap setcap share getattr setexec setfscreate noatsecure siginh setrlimit rlimitinh dyntransition setcurrent execmem execstack execheap setkeycreate setsockcreate };
#line 1
	class system { ipc_info syslog_read syslog_mod syslog_console module_request module_load halt reboot status start stop enable disable reload };
#line 1
	class capability { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
#line 1
	class filesystem { mount remount unmount getattr relabelfrom relabelto transition associate quotamod quotaget };
#line 1
	class file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
#line 1
	class dir { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton add_name remove_name reparent search rmdir open audit_access execmod };
#line 1
	class fd { use };
#line 1
	class lnk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class chr_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
#line 1
	class blk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class sock_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class fifo_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class tcp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom node_bind name_connect };
#line 1
	class udp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 1
	class rawip_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 1
	class node { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send enforce_dest dccp_recv dccp_send recvfrom sendto };
#line 1
	class netif { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send dccp_recv dccp_send ingress egress };
#line 1
	class netlink_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class packet_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class key_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class unix_stream_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom };
#line 1
	class unix_dgram_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class sem { create destroy getattr setattr read write associate unix_read unix_write };
#line 1
	class msg { send receive };
#line 1
	class msgq { create destroy getattr setattr read write associate unix_read unix_write enqueue };
#line 1
	class shm { create destroy getattr setattr read write associate unix_read unix_write lock };
#line 1
	class ipc { create destroy getattr setattr read write associate unix_read unix_write };
#line 1
	class netlink_route_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_firewall_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_tcpdiag_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_nflog_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_xfrm_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_selinux_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_audit_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write nlmsg_relay nlmsg_readpriv nlmsg_tty_audit };
#line 1
	class netlink_ip6fw_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_dnrt_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class association { sendto recvfrom setcontext polmatch };
#line 1
	class netlink_kobject_uevent_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class appletalk_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class packet { send recv relabelto flow_in flow_out forward_in forward_out };
#line 1
	class key { view read write search link setattr create };
#line 1
	class dccp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind name_connect };
#line 1
	class memprotect { mmap_zero };
#line 1
	class peer { recv };
#line 1
	class capability2 { mac_override mac_admin syslog wake_alarm block_suspend audit_read };
#line 1
	class kernel_service { use_as_override create_files_as };
#line 1
	class tun_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind attach_queue };
#line 1
	class binder { impersonate call set_context_mgr transfer };
#line 1
	class netlink_iscsi_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_fib_lookup_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_connector_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_netfilter_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_generic_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_scsitransport_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_rdma_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_crypto_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class cap_userns { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
#line 1
	class cap2_userns { mac_override mac_admin syslog wake_alarm block_suspend audit_read };
#line 1

#line 1

#line 1
			
#line 1
				sensitivity s0;
#line 1

#line 1
				category c0;
#line 1
category c1;
#line 1
category c2;
#line 1
category c3;
#line 1
category c4;
#line 1
category c5;
#line 1
category c6;
#line 1
category c7;
#line 1
category c8;
#line 1
category c9;
#line 1
category c10;
#line 1
category c11;
#line 1
category c12;
#line 1
category c13;
#line 1
category c14;
#line 1
category c15;
#line 1
category c16;
#line 1
category c17;
#line 1
category c18;
#line 1
category c19;
#line 1
category c20;
#line 1
category c21;
#line 1
category c22;
#line 1
category c23;
#line 1
category c24;
#line 1
category c25;
#line 1
category c26;
#line 1
category c27;
#line 1
category c28;
#line 1
category c29;
#line 1
category c30;
#line 1
category c31;
#line 1
category c32;
#line 1
category c33;
#line 1
category c34;
#line 1
category c35;
#line 1
category c36;
#line 1
category c37;
#line 1
category c38;
#line 1
category c39;
#line 1
category c40;
#line 1
category c41;
#line 1
category c42;
#line 1
category c43;
#line 1
category c44;
#line 1
category c45;
#line 1
category c46;
#line 1
category c47;
#line 1
category c48;
#line 1
category c49;
#line 1
category c50;
#line 1
category c51;
#line 1
category c52;
#line 1
category c53;
#line 1
category c54;
#line 1
category c55;
#line 1
category c56;
#line 1
category c57;
#line 1
category c58;
#line 1
category c59;
#line 1
category c60;
#line 1
category c61;
#line 1
category c62;
#line 1
category c63;
#line 1
category c64;
#line 1
category c65;
#line 1
category c66;
#line 1
category c67;
#line 1
category c68;
#line 1
category c69;
#line 1
category c70;
#line 1
category c71;
#line 1
category c72;
#line 1
category c73;
#line 1
category c74;
#line 1
category c75;
#line 1
category c76;
#line 1
category c77;
#line 1
category c78;
#line 1
category c79;
#line 1
category c80;
#line 1
category c81;
#line 1
category c82;
#line 1
category c83;
#line 1
category c84;
#line 1
category c85;
#line 1
category c86;
#line 1
category c87;
#line 1
category c88;
#line 1
category c89;
#line 1
category c90;
#line 1
category c91;
#line 1
category c92;
#line 1
category c93;
#line 1
category c94;
#line 1
category c95;
#line 1
category c96;
#line 1
category c97;
#line 1
category c98;
#line 1
category c99;
#line 1
category c100;
#line 1
category c101;
#line 1
category c102;
#line 1
category c103;
#line 1
category c104;
#line 1
category c105;
#line 1
category c106;
#line 1
category c107;
#line 1
category c108;
#line 1
category c109;
#line 1
category c110;
#line 1
category c111;
#line 1
category c112;
#line 1
category c113;
#line 1
category c114;
#line 1
category c115;
#line 1
category c116;
#line 1
category c117;
#line 1
category c118;
#line 1
category c119;
#line 1
category c120;
#line 1
category c121;
#line 1
category c122;
#line 1
category c123;
#line 1
category c124;
#line 1
category c125;
#line 1
category c126;
#line 1
category c127;
#line 1
category c128;
#line 1
category c129;
#line 1
category c130;
#line 1
category c131;
#line 1
category c132;
#line 1
category c133;
#line 1
category c134;
#line 1
category c135;
#line 1
category c136;
#line 1
category c137;
#line 1
category c138;
#line 1
category c139;
#line 1
category c140;
#line 1
category c141;
#line 1
category c142;
#line 1
category c143;
#line 1
category c144;
#line 1
category c145;
#line 1
category c146;
#line 1
category c147;
#line 1
category c148;
#line 1
category c149;
#line 1
category c150;
#line 1
category c151;
#line 1
category c152;
#line 1
category c153;
#line 1
category c154;
#line 1
category c155;
#line 1
category c156;
#line 1
category c157;
#line 1
category c158;
#line 1
category c159;
#line 1
category c160;
#line 1
category c161;
#line 1
category c162;
#line 1
category c163;
#line 1
category c164;
#line 1
category c165;
#line 1
category c166;
#line 1
category c167;
#line 1
category c168;
#line 1
category c169;
#line 1
category c170;
#line 1
category c171;
#line 1
category c172;
#line 1
category c173;
#line 1
category c174;
#line 1
category c175;
#line 1
category c176;
#line 1
category c177;
#line 1
category c178;
#line 1
category c179;
#line 1
category c180;
#line 1
category c181;
#line 1
category c182;
#line 1
category c183;
#line 1
category c184;
#line 1
category c185;
#line 1
category c186;
#line 1
category c187;
#line 1
category c188;
#line 1
category c189;
#line 1
category c190;
#line 1
category c191;
#line 1
category c192;
#line 1
category c193;
#line 1
category c194;
#line 1
category c195;
#line 1
category c196;
#line 1
category c197;
#line 1
category c198;
#line 1
category c199;
#line 1
category c200;
#line 1
category c201;
#line 1
category c202;
#line 1
category c203;
#line 1
category c204;
#line 1
category c205;
#line 1
category c206;
#line 1
category c207;
#line 1
category c208;
#line 1
category c209;
#line 1
category c210;
#line 1
category c211;
#line 1
category c212;
#line 1
category c213;
#line 1
category c214;
#line 1
category c215;
#line 1
category c216;
#line 1
category c217;
#line 1
category c218;
#line 1
category c219;
#line 1
category c220;
#line 1
category c221;
#line 1
category c222;
#line 1
category c223;
#line 1
category c224;
#line 1
category c225;
#line 1
category c226;
#line 1
category c227;
#line 1
category c228;
#line 1
category c229;
#line 1
category c230;
#line 1
category c231;
#line 1
category c232;
#line 1
category c233;
#line 1
category c234;
#line 1
category c235;
#line 1
category c236;
#line 1
category c237;
#line 1
category c238;
#line 1
category c239;
#line 1
category c240;
#line 1
category c241;
#line 1
category c242;
#line 1
category c243;
#line 1
category c244;
#line 1
category c245;
#line 1
category c246;
#line 1
category c247;
#line 1
category c248;
#line 1
category c249;
#line 1
category c250;
#line 1
category c251;
#line 1
category c252;
#line 1
category c253;
#line 1
category c254;
#line 1
category c255;
#line 1
category c256;
#line 1
category c257;
#line 1
category c258;
#line 1
category c259;
#line 1
category c260;
#line 1
category c261;
#line 1
category c262;
#line 1
category c263;
#line 1
category c264;
#line 1
category c265;
#line 1
category c266;
#line 1
category c267;
#line 1
category c268;
#line 1
category c269;
#line 1
category c270;
#line 1
category c271;
#line 1
category c272;
#line 1
category c273;
#line 1
category c274;
#line 1
category c275;
#line 1
category c276;
#line 1
category c277;
#line 1
category c278;
#line 1
category c279;
#line 1
category c280;
#line 1
category c281;
#line 1
category c282;
#line 1
category c283;
#line 1
category c284;
#line 1
category c285;
#line 1
category c286;
#line 1
category c287;
#line 1
category c288;
#line 1
category c289;
#line 1
category c290;
#line 1
category c291;
#line 1
category c292;
#line 1
category c293;
#line 1
category c294;
#line 1
category c295;
#line 1
category c296;
#line 1
category c297;
#line 1
category c298;
#line 1
category c299;
#line 1
category c300;
#line 1
category c301;
#line 1
category c302;
#line 1
category c303;
#line 1
category c304;
#line 1
category c305;
#line 1
category c306;
#line 1
category c307;
#line 1
category c308;
#line 1
category c309;
#line 1
category c310;
#line 1
category c311;
#line 1
category c312;
#line 1
category c313;
#line 1
category c314;
#line 1
category c315;
#line 1
category c316;
#line 1
category c317;
#line 1
category c318;
#line 1
category c319;
#line 1
category c320;
#line 1
category c321;
#line 1
category c322;
#line 1
category c323;
#line 1
category c324;
#line 1
category c325;
#line 1
category c326;
#line 1
category c327;
#line 1
category c328;
#line 1
category c329;
#line 1
category c330;
#line 1
category c331;
#line 1
category c332;
#line 1
category c333;
#line 1
category c334;
#line 1
category c335;
#line 1
category c336;
#line 1
category c337;
#line 1
category c338;
#line 1
category c339;
#line 1
category c340;
#line 1
category c341;
#line 1
category c342;
#line 1
category c343;
#line 1
category c344;
#line 1
category c345;
#line 1
category c346;
#line 1
category c347;
#line 1
category c348;
#line 1
category c349;
#line 1
category c350;
#line 1
category c351;
#line 1
category c352;
#line 1
category c353;
#line 1
category c354;
#line 1
category c355;
#line 1
category c356;
#line 1
category c357;
#line 1
category c358;
#line 1
category c359;
#line 1
category c360;
#line 1
category c361;
#line 1
category c362;
#line 1
category c363;
#line 1
category c364;
#line 1
category c365;
#line 1
category c366;
#line 1
category c367;
#line 1
category c368;
#line 1
category c369;
#line 1
category c370;
#line 1
category c371;
#line 1
category c372;
#line 1
category c373;
#line 1
category c374;
#line 1
category c375;
#line 1
category c376;
#line 1
category c377;
#line 1
category c378;
#line 1
category c379;
#line 1
category c380;
#line 1
category c381;
#line 1
category c382;
#line 1
category c383;
#line 1
category c384;
#line 1
category c385;
#line 1
category c386;
#line 1
category c387;
#line 1
category c388;
#line 1
category c389;
#line 1
category c390;
#line 1
category c391;
#line 1
category c392;
#line 1
category c393;
#line 1
category c394;
#line 1
category c395;
#line 1
category c396;
#line 1
category c397;
#line 1
category c398;
#line 1
category c399;
#line 1
category c400;
#line 1
category c401;
#line 1
category c402;
#line 1
category c403;
#line 1
category c404;
#line 1
category c405;
#line 1
category c406;
#line 1
category c407;
#line 1
category c408;
#line 1
category c409;
#line 1
category c410;
#line 1
category c411;
#line 1
category c412;
#line 1
category c413;
#line 1
category c414;
#line 1
category c415;
#line 1
category c416;
#line 1
category c417;
#line 1
category c418;
#line 1
category c419;
#line 1
category c420;
#line 1
category c421;
#line 1
category c422;
#line 1
category c423;
#line 1
category c424;
#line 1
category c425;
#line 1
category c426;
#line 1
category c427;
#line 1
category c428;
#line 1
category c429;
#line 1
category c430;
#line 1
category c431;
#line 1
category c432;
#line 1
category c433;
#line 1
category c434;
#line 1
category c435;
#line 1
category c436;
#line 1
category c437;
#line 1
category c438;
#line 1
category c439;
#line 1
category c440;
#line 1
category c441;
#line 1
category c442;
#line 1
category c443;
#line 1
category c444;
#line 1
category c445;
#line 1
category c446;
#line 1
category c447;
#line 1
category c448;
#line 1
category c449;
#line 1
category c450;
#line 1
category c451;
#line 1
category c452;
#line 1
category c453;
#line 1
category c454;
#line 1
category c455;
#line 1
category c456;
#line 1
category c457;
#line 1
category c458;
#line 1
category c459;
#line 1
category c460;
#line 1
category c461;
#line 1
category c462;
#line 1
category c463;
#line 1
category c464;
#line 1
category c465;
#line 1
category c466;
#line 1
category c467;
#line 1
category c468;
#line 1
category c469;
#line 1
category c470;
#line 1
category c471;
#line 1
category c472;
#line 1
category c473;
#line 1
category c474;
#line 1
category c475;
#line 1
category c476;
#line 1
category c477;
#line 1
category c478;
#line 1
category c479;
#line 1
category c480;
#line 1
category c481;
#line 1
category c482;
#line 1
category c483;
#line 1
category c484;
#line 1
category c485;
#line 1
category c486;
#line 1
category c487;
#line 1
category c488;
#line 1
category c489;
#line 1
category c490;
#line 1
category c491;
#line 1
category c492;
#line 1
category c493;
#line 1
category c494;
#line 1
category c495;
#line 1
category c496;
#line 1
category c497;
#line 1
category c498;
#line 1
category c499;
#line 1
category c500;
#line 1
category c501;
#line 1
category c502;
#line 1
category c503;
#line 1
category c504;
#line 1
category c505;
#line 1
category c506;
#line 1
category c507;
#line 1
category c508;
#line 1
category c509;
#line 1
category c510;
#line 1
category c511;
#line 1
category c512;
#line 1
category c513;
#line 1
category c514;
#line 1
category c515;
#line 1
category c516;
#line 1
category c517;
#line 1
category c518;
#line 1
category c519;
#line 1
category c520;
#line 1
category c521;
#line 1
category c522;
#line 1
category c523;
#line 1
category c524;
#line 1
category c525;
#line 1
category c526;
#line 1
category c527;
#line 1
category c528;
#line 1
category c529;
#line 1
category c530;
#line 1
category c531;
#line 1
category c532;
#line 1
category c533;
#line 1
category c534;
#line 1
category c535;
#line 1
category c536;
#line 1
category c537;
#line 1
category c538;
#line 1
category c539;
#line 1
category c540;
#line 1
category c541;
#line 1
category c542;
#line 1
category c543;
#line 1
category c544;
#line 1
category c545;
#line 1
category c546;
#line 1
category c547;
#line 1
category c548;
#line 1
category c549;
#line 1
category c550;
#line 1
category c551;
#line 1
category c552;
#line 1
category c553;
#line 1
category c554;
#line 1
category c555;
#line 1
category c556;
#line 1
category c557;
#line 1
category c558;
#line 1
category c559;
#line 1
category c560;
#line 1
category c561;
#line 1
category c562;
#line 1
category c563;
#line 1
category c564;
#line 1
category c565;
#line 1
category c566;
#line 1
category c567;
#line 1
category c568;
#line 1
category c569;
#line 1
category c570;
#line 1
category c571;
#line 1
category c572;
#line 1
category c573;
#line 1
category c574;
#line 1
category c575;
#line 1
category c576;
#line 1
category c577;
#line 1
category c578;
#line 1
category c579;
#line 1
category c580;
#line 1
category c581;
#line 1
category c582;
#line 1
category c583;
#line 1
category c584;
#line 1
category c585;
#line 1
category c586;
#line 1
category c587;
#line 1
category c588;
#line 1
category c589;
#line 1
category c590;
#line 1
category c591;
#line 1
category c592;
#line 1
category c593;
#line 1
category c594;
#line 1
category c595;
#line 1
category c596;
#line 1
category c597;
#line 1
category c598;
#line 1
category c599;
#line 1
category c600;
#line 1
category c601;
#line 1
category c602;
#line 1
category c603;
#line 1
category c604;
#line 1
category c605;
#line 1
category c606;
#line 1
category c607;
#line 1
category c608;
#line 1
category c609;
#line 1
category c610;
#line 1
category c611;
#line 1
category c612;
#line 1
category c613;
#line 1
category c614;
#line 1
category c615;
#line 1
category c616;
#line 1
category c617;
#line 1
category c618;
#line 1
category c619;
#line 1
category c620;
#line 1
category c621;
#line 1
category c622;
#line 1
category c623;
#line 1
category c624;
#line 1
category c625;
#line 1
category c626;
#line 1
category c627;
#line 1
category c628;
#line 1
category c629;
#line 1
category c630;
#line 1
category c631;
#line 1
category c632;
#line 1
category c633;
#line 1
category c634;
#line 1
category c635;
#line 1
category c636;
#line 1
category c637;
#line 1
category c638;
#line 1
category c639;
#line 1
category c640;
#line 1
category c641;
#line 1
category c642;
#line 1
category c643;
#line 1
category c644;
#line 1
category c645;
#line 1
category c646;
#line 1
category c647;
#line 1
category c648;
#line 1
category c649;
#line 1
category c650;
#line 1
category c651;
#line 1
category c652;
#line 1
category c653;
#line 1
category c654;
#line 1
category c655;
#line 1
category c656;
#line 1
category c657;
#line 1
category c658;
#line 1
category c659;
#line 1
category c660;
#line 1
category c661;
#line 1
category c662;
#line 1
category c663;
#line 1
category c664;
#line 1
category c665;
#line 1
category c666;
#line 1
category c667;
#line 1
category c668;
#line 1
category c669;
#line 1
category c670;
#line 1
category c671;
#line 1
category c672;
#line 1
category c673;
#line 1
category c674;
#line 1
category c675;
#line 1
category c676;
#line 1
category c677;
#line 1
category c678;
#line 1
category c679;
#line 1
category c680;
#line 1
category c681;
#line 1
category c682;
#line 1
category c683;
#line 1
category c684;
#line 1
category c685;
#line 1
category c686;
#line 1
category c687;
#line 1
category c688;
#line 1
category c689;
#line 1
category c690;
#line 1
category c691;
#line 1
category c692;
#line 1
category c693;
#line 1
category c694;
#line 1
category c695;
#line 1
category c696;
#line 1
category c697;
#line 1
category c698;
#line 1
category c699;
#line 1
category c700;
#line 1
category c701;
#line 1
category c702;
#line 1
category c703;
#line 1
category c704;
#line 1
category c705;
#line 1
category c706;
#line 1
category c707;
#line 1
category c708;
#line 1
category c709;
#line 1
category c710;
#line 1
category c711;
#line 1
category c712;
#line 1
category c713;
#line 1
category c714;
#line 1
category c715;
#line 1
category c716;
#line 1
category c717;
#line 1
category c718;
#line 1
category c719;
#line 1
category c720;
#line 1
category c721;
#line 1
category c722;
#line 1
category c723;
#line 1
category c724;
#line 1
category c725;
#line 1
category c726;
#line 1
category c727;
#line 1
category c728;
#line 1
category c729;
#line 1
category c730;
#line 1
category c731;
#line 1
category c732;
#line 1
category c733;
#line 1
category c734;
#line 1
category c735;
#line 1
category c736;
#line 1
category c737;
#line 1
category c738;
#line 1
category c739;
#line 1
category c740;
#line 1
category c741;
#line 1
category c742;
#line 1
category c743;
#line 1
category c744;
#line 1
category c745;
#line 1
category c746;
#line 1
category c747;
#line 1
category c748;
#line 1
category c749;
#line 1
category c750;
#line 1
category c751;
#line 1
category c752;
#line 1
category c753;
#line 1
category c754;
#line 1
category c755;
#line 1
category c756;
#line 1
category c757;
#line 1
category c758;
#line 1
category c759;
#line 1
category c760;
#line 1
category c761;
#line 1
category c762;
#line 1
category c763;
#line 1
category c764;
#line 1
category c765;
#line 1
category c766;
#line 1
category c767;
#line 1
category c768;
#line 1
category c769;
#line 1
category c770;
#line 1
category c771;
#line 1
category c772;
#line 1
category c773;
#line 1
category c774;
#line 1
category c775;
#line 1
category c776;
#line 1
category c777;
#line 1
category c778;
#line 1
category c779;
#line 1
category c780;
#line 1
category c781;
#line 1
category c782;
#line 1
category c783;
#line 1
category c784;
#line 1
category c785;
#line 1
category c786;
#line 1
category c787;
#line 1
category c788;
#line 1
category c789;
#line 1
category c790;
#line 1
category c791;
#line 1
category c792;
#line 1
category c793;
#line 1
category c794;
#line 1
category c795;
#line 1
category c796;
#line 1
category c797;
#line 1
category c798;
#line 1
category c799;
#line 1
category c800;
#line 1
category c801;
#line 1
category c802;
#line 1
category c803;
#line 1
category c804;
#line 1
category c805;
#line 1
category c806;
#line 1
category c807;
#line 1
category c808;
#line 1
category c809;
#line 1
category c810;
#line 1
category c811;
#line 1
category c812;
#line 1
category c813;
#line 1
category c814;
#line 1
category c815;
#line 1
category c816;
#line 1
category c817;
#line 1
category c818;
#line 1
category c819;
#line 1
category c820;
#line 1
category c821;
#line 1
category c822;
#line 1
category c823;
#line 1
category c824;
#line 1
category c825;
#line 1
category c826;
#line 1
category c827;
#line 1
category c828;
#line 1
category c829;
#line 1
category c830;
#line 1
category c831;
#line 1
category c832;
#line 1
category c833;
#line 1
category c834;
#line 1
category c835;
#line 1
category c836;
#line 1
category c837;
#line 1
category c838;
#line 1
category c839;
#line 1
category c840;
#line 1
category c841;
#line 1
category c842;
#line 1
category c843;
#line 1
category c844;
#line 1
category c845;
#line 1
category c846;
#line 1
category c847;
#line 1
category c848;
#line 1
category c849;
#line 1
category c850;
#line 1
category c851;
#line 1
category c852;
#line 1
category c853;
#line 1
category c854;
#line 1
category c855;
#line 1
category c856;
#line 1
category c857;
#line 1
category c858;
#line 1
category c859;
#line 1
category c860;
#line 1
category c861;
#line 1
category c862;
#line 1
category c863;
#line 1
category c864;
#line 1
category c865;
#line 1
category c866;
#line 1
category c867;
#line 1
category c868;
#line 1
category c869;
#line 1
category c870;
#line 1
category c871;
#line 1
category c872;
#line 1
category c873;
#line 1
category c874;
#line 1
category c875;
#line 1
category c876;
#line 1
category c877;
#line 1
category c878;
#line 1
category c879;
#line 1
category c880;
#line 1
category c881;
#line 1
category c882;
#line 1
category c883;
#line 1
category c884;
#line 1
category c885;
#line 1
category c886;
#line 1
category c887;
#line 1
category c888;
#line 1
category c889;
#line 1
category c890;
#line 1
category c891;
#line 1
category c892;
#line 1
category c893;
#line 1
category c894;
#line 1
category c895;
#line 1
category c896;
#line 1
category c897;
#line 1
category c898;
#line 1
category c899;
#line 1
category c900;
#line 1
category c901;
#line 1
category c902;
#line 1
category c903;
#line 1
category c904;
#line 1
category c905;
#line 1
category c906;
#line 1
category c907;
#line 1
category c908;
#line 1
category c909;
#line 1
category c910;
#line 1
category c911;
#line 1
category c912;
#line 1
category c913;
#line 1
category c914;
#line 1
category c915;
#line 1
category c916;
#line 1
category c917;
#line 1
category c918;
#line 1
category c919;
#line 1
category c920;
#line 1
category c921;
#line 1
category c922;
#line 1
category c923;
#line 1
category c924;
#line 1
category c925;
#line 1
category c926;
#line 1
category c927;
#line 1
category c928;
#line 1
category c929;
#line 1
category c930;
#line 1
category c931;
#line 1
category c932;
#line 1
category c933;
#line 1
category c934;
#line 1
category c935;
#line 1
category c936;
#line 1
category c937;
#line 1
category c938;
#line 1
category c939;
#line 1
category c940;
#line 1
category c941;
#line 1
category c942;
#line 1
category c943;
#line 1
category c944;
#line 1
category c945;
#line 1
category c946;
#line 1
category c947;
#line 1
category c948;
#line 1
category c949;
#line 1
category c950;
#line 1
category c951;
#line 1
category c952;
#line 1
category c953;
#line 1
category c954;
#line 1
category c955;
#line 1
category c956;
#line 1
category c957;
#line 1
category c958;
#line 1
category c959;
#line 1
category c960;
#line 1
category c961;
#line 1
category c962;
#line 1
category c963;
#line 1
category c964;
#line 1
category c965;
#line 1
category c966;
#line 1
category c967;
#line 1
category c968;
#line 1
category c969;
#line 1
category c970;
#line 1
category c971;
#line 1
category c972;
#line 1
category c973;
#line 1
category c974;
#line 1
category c975;
#line 1
category c976;
#line 1
category c977;
#line 1
category c978;
#line 1
category c979;
#line 1
category c980;
#line 1
category c981;
#line 1
category c982;
#line 1
category c983;
#line 1
category c984;
#line 1
category c985;
#line 1
category c986;
#line 1
category c987;
#line 1
category c988;
#line 1
category c989;
#line 1
category c990;
#line 1
category c991;
#line 1
category c992;
#line 1
category c993;
#line 1
category c994;
#line 1
category c995;
#line 1
category c996;
#line 1
category c997;
#line 1
category c998;
#line 1
category c999;
#line 1
category c1000;
#line 1
category c1001;
#line 1
category c1002;
#line 1
category c1003;
#line 1
category c1004;
#line 1
category c1005;
#line 1
category c1006;
#line 1
category c1007;
#line 1
category c1008;
#line 1
category c1009;
#line 1
category c1010;
#line 1
category c1011;
#line 1
category c1012;
#line 1
category c1013;
#line 1
category c1014;
#line 1
category c1015;
#line 1
category c1016;
#line 1
category c1017;
#line 1
category c1018;
#line 1
category c1019;
#line 1
category c1020;
#line 1
category c1021;
#line 1
category c1022;
#line 1
category c1023;
#line 1

#line 1
			
#line 1

#line 1
			
#line 1
		}
#line 1
	
#line 1



#line 3
	
#line 3
		require {
#line 3
			
#line 3
	class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 3
	class x_screen { getattr setattr hide_cursor show_cursor saver_getattr saver_setattr saver_hide saver_show };
#line 3
	class x_gc { create destroy getattr setattr use };
#line 3
	class x_font { create destroy getattr add_glyph remove_glyph use };
#line 3
	class x_colormap { create destroy read write getattr add_color remove_color install uninstall use };
#line 3
	class x_property { create destroy read write append getattr setattr };
#line 3
	class x_selection { read write getattr setattr };
#line 3
	class x_cursor { create destroy read write getattr setattr use };
#line 3
	class x_client { destroy getattr setattr manage };
#line 3
	class x_device { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 3
	class x_pointer { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 3
	class x_keyboard { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 3
	class x_server { getattr setattr record debug grab manage };
#line 3
	class x_extension { query use };
#line 3
	class x_resource { read write };
#line 3
	class x_event { send receive };
#line 3
	class x_synthetic_event { send receive };
#line 3

#line 3
		} # end require
#line 3
	
#line 21


########################################
#
# Declarations
#

## <desc>
## <p>
## Allows clients to write to the X server shared
## memory segments.
## </p>
## </desc>

#line 34
	bool allow_write_xshm false;
#line 34


## <desc>
## <p>
## Allow xdm logins as sysadm
## </p>
## </desc>

#line 41
	bool xdm_sysadm_login false;
#line 41


## <desc>
## <p>
## Support X userspace object manager
## </p>
## </desc>

#line 48
	bool xserver_object_manager false;
#line 48


attribute x_domain;

# X Events
attribute xevent_type;
attribute input_xevent_type;
type xevent_t, xevent_type;
typealias xevent_t alias { user_property_xevent_t staff_property_xevent_t sysadm_property_xevent_t };
typealias xevent_t alias { auditadm_property_xevent_t secadm_property_xevent_t };
typealias xevent_t alias { user_focus_xevent_t staff_focus_xevent_t sysadm_focus_xevent_t };
typealias xevent_t alias { auditadm_focus_xevent_t secadm_focus_xevent_t };
typealias xevent_t alias { user_manage_xevent_t staff_manage_xevent_t sysadm_manage_xevent_t };
typealias xevent_t alias { auditadm_manage_xevent_t secadm_manage_xevent_t };
typealias xevent_t alias { user_default_xevent_t staff_default_xevent_t sysadm_default_xevent_t };
typealias xevent_t alias { auditadm_default_xevent_t secadm_default_xevent_t };

type client_xevent_t, xevent_type;
typealias client_xevent_t alias { user_client_xevent_t staff_client_xevent_t sysadm_client_xevent_t };
typealias client_xevent_t alias { auditadm_client_xevent_t secadm_client_xevent_t };

type input_xevent_t, xevent_type, input_xevent_type;

# X Extensions
attribute xextension_type;
type xextension_t, xextension_type;
type security_xextension_t, xextension_type;

# X Properties
attribute xproperty_type;
type xproperty_t, xproperty_type;
type seclabel_xproperty_t, xproperty_type;
type clipboard_xproperty_t, xproperty_type;

# X Selections
attribute xselection_type;
type xselection_t, xselection_type;
type clipboard_xselection_t, xselection_type;
#type settings_xselection_t, xselection_type;
#type dbus_xselection_t, xselection_type;

# X Drawables
attribute xdrawable_type;
attribute xcolormap_type;
type root_xdrawable_t, xdrawable_type;
type root_xcolormap_t, xcolormap_type;

attribute xserver_unconfined_type;

 	 	
#line 97
##### begin xserver_object_types_template(root) depth: 1
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		attribute xproperty_type, input_xevent_type, xevent_type;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	##############################
#line 97
	#
#line 97
	# Declarations
#line 97
	#
#line 97

#line 97
	# Types for properties
#line 97
	type root_xproperty_t, xproperty_type;
#line 97
	 	 	
#line 97
##### begin ubac_constrained(root_xproperty_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		attribute ubac_constrained_type;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	typeattribute root_xproperty_t ubac_constrained_type;
#line 97

#line 97
	 	
#line 97
##### end ubac_constrained(root_xproperty_t) depth: 1
#line 97
 	
#line 97

#line 97
	# Types for events
#line 97
	type root_input_xevent_t, input_xevent_type, xevent_type;
#line 97
	 	 	
#line 97
##### begin ubac_constrained(root_input_xevent_t) depth: 2
#line 97
 	
#line 97
	
#line 97
	
#line 97
		require {
#line 97
			
#line 97
		attribute ubac_constrained_type;
#line 97
	
#line 97
		} # end require
#line 97
	
#line 97

#line 97

#line 97
	typeattribute root_input_xevent_t ubac_constrained_type;
#line 97

#line 97
	 	
#line 97
##### end ubac_constrained(root_input_xevent_t) depth: 1
#line 97
 	
#line 97
 	 	
#line 97
##### end xserver_object_types_template(root) depth: 0
#line 97
 	
 	 	
#line 98
##### begin xserver_object_types_template(user) depth: 1
#line 98
 	
#line 98
	
#line 98
	
#line 98
		require {
#line 98
			
#line 98
		attribute xproperty_type, input_xevent_type, xevent_type;
#line 98
	
#line 98
		} # end require
#line 98
	
#line 98

#line 98

#line 98
	##############################
#line 98
	#
#line 98
	# Declarations
#line 98
	#
#line 98

#line 98
	# Types for properties
#line 98
	type user_xproperty_t, xproperty_type;
#line 98
	 	 	
#line 98
##### begin ubac_constrained(user_xproperty_t) depth: 2
#line 98
 	
#line 98
	
#line 98
	
#line 98
		require {
#line 98
			
#line 98
		attribute ubac_constrained_type;
#line 98
	
#line 98
		} # end require
#line 98
	
#line 98

#line 98

#line 98
	typeattribute user_xproperty_t ubac_constrained_type;
#line 98

#line 98
	 	
#line 98
##### end ubac_constrained(user_xproperty_t) depth: 1
#line 98
 	
#line 98

#line 98
	# Types for events
#line 98
	type user_input_xevent_t, input_xevent_type, xevent_type;
#line 98
	 	 	
#line 98
##### begin ubac_constrained(user_input_xevent_t) depth: 2
#line 98
 	
#line 98
	
#line 98
	
#line 98
		require {
#line 98
			
#line 98
		attribute ubac_constrained_type;
#line 98
	
#line 98
		} # end require
#line 98
	
#line 98

#line 98

#line 98
	typeattribute user_input_xevent_t ubac_constrained_type;
#line 98

#line 98
	 	
#line 98
##### end ubac_constrained(user_input_xevent_t) depth: 1
#line 98
 	
#line 98
 	 	
#line 98
##### end xserver_object_types_template(user) depth: 0
#line 98
 	

typealias user_xproperty_t alias { staff_xproperty_t sysadm_xproperty_t };
typealias user_xproperty_t alias { auditadm_xproperty_t secadm_xproperty_t };
typealias user_input_xevent_t alias { staff_input_xevent_t sysadm_input_xevent_t };
typealias user_input_xevent_t alias { auditadm_input_xevent_t secadm_input_xevent_t };

type remote_t;
 	 	
#line 106
##### begin xserver_object_types_template(remote) depth: 1
#line 106
 	
#line 106
	
#line 106
	
#line 106
		require {
#line 106
			
#line 106
		attribute xproperty_type, input_xevent_type, xevent_type;
#line 106
	
#line 106
		} # end require
#line 106
	
#line 106

#line 106

#line 106
	##############################
#line 106
	#
#line 106
	# Declarations
#line 106
	#
#line 106

#line 106
	# Types for properties
#line 106
	type remote_xproperty_t, xproperty_type;
#line 106
	 	 	
#line 106
##### begin ubac_constrained(remote_xproperty_t) depth: 2
#line 106
 	
#line 106
	
#line 106
	
#line 106
		require {
#line 106
			
#line 106
		attribute ubac_constrained_type;
#line 106
	
#line 106
		} # end require
#line 106
	
#line 106

#line 106

#line 106
	typeattribute remote_xproperty_t ubac_constrained_type;
#line 106

#line 106
	 	
#line 106
##### end ubac_constrained(remote_xproperty_t) depth: 1
#line 106
 	
#line 106

#line 106
	# Types for events
#line 106
	type remote_input_xevent_t, input_xevent_type, xevent_type;
#line 106
	 	 	
#line 106
##### begin ubac_constrained(remote_input_xevent_t) depth: 2
#line 106
 	
#line 106
	
#line 106
	
#line 106
		require {
#line 106
			
#line 106
		attribute ubac_constrained_type;
#line 106
	
#line 106
		} # end require
#line 106
	
#line 106

#line 106

#line 106
	typeattribute remote_input_xevent_t ubac_constrained_type;
#line 106

#line 106
	 	
#line 106
##### end ubac_constrained(remote_input_xevent_t) depth: 1
#line 106
 	
#line 106
 	 	
#line 106
##### end xserver_object_types_template(remote) depth: 0
#line 106
 	
 	 	
#line 107
##### begin xserver_common_x_domain_template(remote,remote_t) depth: 1
#line 107
 	
#line 107
	
#line 107
	
#line 107
		require {
#line 107
			
#line 107
		type root_xdrawable_t;
#line 107
		type xproperty_t, remote_xproperty_t;
#line 107
		type xevent_t, client_xevent_t;
#line 107
		type input_xevent_t, remote_input_xevent_t;
#line 107

#line 107
		attribute x_domain;
#line 107
		attribute xdrawable_type, xcolormap_type;
#line 107
		attribute input_xevent_type;
#line 107

#line 107
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 107
		class x_property { create destroy read write append getattr setattr };
#line 107
		class x_event { send receive };
#line 107
		class x_synthetic_event { send receive };
#line 107
	
#line 107
		} # end require
#line 107
	
#line 107

#line 107

#line 107
	##############################
#line 107
	#
#line 107
	# Local Policy
#line 107
	#
#line 107

#line 107
	# Type attributes
#line 107
	typeattribute remote_t x_domain;
#line 107
	typeattribute remote_t xdrawable_type, xcolormap_type;
#line 107

#line 107
	# X Properties
#line 107
	# disable property transitions for the time being.
#line 107
#	type_transition remote_t xproperty_t:x_property remote_xproperty_t;
#line 107

#line 107
	# X Windows
#line 107
	# new windows have the domain type
#line 107
	type_transition remote_t root_xdrawable_t:x_drawable remote_t;
#line 107

#line 107
	# X Input
#line 107
	# distinguish input events
#line 107
	type_transition remote_t input_xevent_t:x_event remote_input_xevent_t;
#line 107
	# can send own events
#line 107
	allow remote_t remote_input_xevent_t:{ x_event x_synthetic_event } send;
#line 107
	# can receive own events
#line 107
	allow remote_t remote_input_xevent_t:{ x_event x_synthetic_event } receive;
#line 107
	# can receive default events
#line 107
	allow remote_t client_xevent_t:{ x_event x_synthetic_event } receive;
#line 107
	allow remote_t xevent_t:{ x_event x_synthetic_event } receive;
#line 107
	# dont audit send failures
#line 107
	dontaudit remote_t input_xevent_type:x_event send;
#line 107
 	 	
#line 107
##### end xserver_common_x_domain_template(remote,remote_t) depth: 0
#line 107
 	

type user_fonts_t;
typealias user_fonts_t alias { staff_fonts_t sysadm_fonts_t };
typealias user_fonts_t alias { auditadm_fonts_t secadm_fonts_t };
 	 	
#line 112
##### begin userdom_user_home_content(user_fonts_t) depth: 1
#line 112
 	
#line 112
	
#line 112
	
#line 112
		require {
#line 112
			
#line 112
		attribute user_home_content_type;
#line 112
		type user_home_t;
#line 112
	
#line 112
		} # end require
#line 112
	
#line 112

#line 112

#line 112
	typeattribute user_fonts_t user_home_content_type;
#line 112

#line 112
	allow user_fonts_t user_home_t:filesystem associate;
#line 112
	 	 	
#line 112
##### begin files_type(user_fonts_t) depth: 2
#line 112
 	
#line 112
	
#line 112
	
#line 112
		require {
#line 112
			
#line 112
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 112
	
#line 112
		} # end require
#line 112
	
#line 112

#line 112

#line 112
	typeattribute user_fonts_t file_type, non_security_file_type, non_auth_file_type;
#line 112

#line 112
	 	
#line 112
##### end files_type(user_fonts_t) depth: 1
#line 112
 	
#line 112
	 	 	
#line 112
##### begin files_poly_member(user_fonts_t) depth: 2
#line 112
 	
#line 112
	
#line 112
	
#line 112
		require {
#line 112
			
#line 112
		attribute polymember;
#line 112
	
#line 112
		} # end require
#line 112
	
#line 112

#line 112

#line 112
	 	 	
#line 112
##### begin files_type(user_fonts_t) depth: 3
#line 112
 	
#line 112
	
#line 112
	
#line 112
		require {
#line 112
			
#line 112
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 112
	
#line 112
		} # end require
#line 112
	
#line 112

#line 112

#line 112
	typeattribute user_fonts_t file_type, non_security_file_type, non_auth_file_type;
#line 112

#line 112
	 	
#line 112
##### end files_type(user_fonts_t) depth: 2
#line 112
 	
#line 112
	typeattribute user_fonts_t polymember;
#line 112

#line 112
	 	
#line 112
##### end files_poly_member(user_fonts_t) depth: 1
#line 112
 	
#line 112
	 	 	
#line 112
##### begin ubac_constrained(user_fonts_t) depth: 2
#line 112
 	
#line 112
	
#line 112
	
#line 112
		require {
#line 112
			
#line 112
		attribute ubac_constrained_type;
#line 112
	
#line 112
		} # end require
#line 112
	
#line 112

#line 112

#line 112
	typeattribute user_fonts_t ubac_constrained_type;
#line 112

#line 112
	 	
#line 112
##### end ubac_constrained(user_fonts_t) depth: 1
#line 112
 	
#line 112

#line 112
	 	
#line 112
##### end userdom_user_home_content(user_fonts_t) depth: 0
#line 112
 	

type user_fonts_cache_t;
typealias user_fonts_cache_t alias { staff_fonts_cache_t sysadm_fonts_cache_t };
typealias user_fonts_cache_t alias { auditadm_fonts_cache_t secadm_fonts_cache_t };
 	 	
#line 117
##### begin userdom_user_home_content(user_fonts_cache_t) depth: 1
#line 117
 	
#line 117
	
#line 117
	
#line 117
		require {
#line 117
			
#line 117
		attribute user_home_content_type;
#line 117
		type user_home_t;
#line 117
	
#line 117
		} # end require
#line 117
	
#line 117

#line 117

#line 117
	typeattribute user_fonts_cache_t user_home_content_type;
#line 117

#line 117
	allow user_fonts_cache_t user_home_t:filesystem associate;
#line 117
	 	 	
#line 117
##### begin files_type(user_fonts_cache_t) depth: 2
#line 117
 	
#line 117
	
#line 117
	
#line 117
		require {
#line 117
			
#line 117
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 117
	
#line 117
		} # end require
#line 117
	
#line 117

#line 117

#line 117
	typeattribute user_fonts_cache_t file_type, non_security_file_type, non_auth_file_type;
#line 117

#line 117
	 	
#line 117
##### end files_type(user_fonts_cache_t) depth: 1
#line 117
 	
#line 117
	 	 	
#line 117
##### begin files_poly_member(user_fonts_cache_t) depth: 2
#line 117
 	
#line 117
	
#line 117
	
#line 117
		require {
#line 117
			
#line 117
		attribute polymember;
#line 117
	
#line 117
		} # end require
#line 117
	
#line 117

#line 117

#line 117
	 	 	
#line 117
##### begin files_type(user_fonts_cache_t) depth: 3
#line 117
 	
#line 117
	
#line 117
	
#line 117
		require {
#line 117
			
#line 117
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 117
	
#line 117
		} # end require
#line 117
	
#line 117

#line 117

#line 117
	typeattribute user_fonts_cache_t file_type, non_security_file_type, non_auth_file_type;
#line 117

#line 117
	 	
#line 117
##### end files_type(user_fonts_cache_t) depth: 2
#line 117
 	
#line 117
	typeattribute user_fonts_cache_t polymember;
#line 117

#line 117
	 	
#line 117
##### end files_poly_member(user_fonts_cache_t) depth: 1
#line 117
 	
#line 117
	 	 	
#line 117
##### begin ubac_constrained(user_fonts_cache_t) depth: 2
#line 117
 	
#line 117
	
#line 117
	
#line 117
		require {
#line 117
			
#line 117
		attribute ubac_constrained_type;
#line 117
	
#line 117
		} # end require
#line 117
	
#line 117

#line 117

#line 117
	typeattribute user_fonts_cache_t ubac_constrained_type;
#line 117

#line 117
	 	
#line 117
##### end ubac_constrained(user_fonts_cache_t) depth: 1
#line 117
 	
#line 117

#line 117
	 	
#line 117
##### end userdom_user_home_content(user_fonts_cache_t) depth: 0
#line 117
 	

type user_fonts_config_t;
typealias user_fonts_config_t alias { staff_fonts_config_t sysadm_fonts_config_t };
typealias user_fonts_config_t alias { auditadm_fonts_config_t secadm_fonts_config_t };
 	 	
#line 122
##### begin userdom_user_home_content(user_fonts_config_t) depth: 1
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute user_home_content_type;
#line 122
		type user_home_t;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute user_fonts_config_t user_home_content_type;
#line 122

#line 122
	allow user_fonts_config_t user_home_t:filesystem associate;
#line 122
	 	 	
#line 122
##### begin files_type(user_fonts_config_t) depth: 2
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute user_fonts_config_t file_type, non_security_file_type, non_auth_file_type;
#line 122

#line 122
	 	
#line 122
##### end files_type(user_fonts_config_t) depth: 1
#line 122
 	
#line 122
	 	 	
#line 122
##### begin files_poly_member(user_fonts_config_t) depth: 2
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute polymember;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	 	 	
#line 122
##### begin files_type(user_fonts_config_t) depth: 3
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute user_fonts_config_t file_type, non_security_file_type, non_auth_file_type;
#line 122

#line 122
	 	
#line 122
##### end files_type(user_fonts_config_t) depth: 2
#line 122
 	
#line 122
	typeattribute user_fonts_config_t polymember;
#line 122

#line 122
	 	
#line 122
##### end files_poly_member(user_fonts_config_t) depth: 1
#line 122
 	
#line 122
	 	 	
#line 122
##### begin ubac_constrained(user_fonts_config_t) depth: 2
#line 122
 	
#line 122
	
#line 122
	
#line 122
		require {
#line 122
			
#line 122
		attribute ubac_constrained_type;
#line 122
	
#line 122
		} # end require
#line 122
	
#line 122

#line 122

#line 122
	typeattribute user_fonts_config_t ubac_constrained_type;
#line 122

#line 122
	 	
#line 122
##### end ubac_constrained(user_fonts_config_t) depth: 1
#line 122
 	
#line 122

#line 122
	 	
#line 122
##### end userdom_user_home_content(user_fonts_config_t) depth: 0
#line 122
 	

type iceauth_t;
type iceauth_exec_t;
typealias iceauth_t alias { user_iceauth_t staff_iceauth_t sysadm_iceauth_t };
typealias iceauth_t alias { auditadm_iceauth_t secadm_iceauth_t };
 	 	
#line 128
##### begin userdom_user_application_domain(iceauth_t,iceauth_exec_t) depth: 1
#line 128
 	
#line 128
	 	 	
#line 128
##### begin application_domain(iceauth_t,iceauth_exec_t) depth: 2
#line 128
 	
#line 128
	 	 	
#line 128
##### begin application_type(iceauth_t) depth: 3
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute application_domain_type;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	typeattribute iceauth_t application_domain_type;
#line 128

#line 128
	# start with basic domain
#line 128
	 	 	
#line 128
##### begin domain_type(iceauth_t) depth: 4
#line 128
 	
#line 128
	# start with basic domain
#line 128
	 	 	
#line 128
##### begin domain_base_type(iceauth_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute domain;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	typeattribute iceauth_t domain;
#line 128

#line 128
	 	
#line 128
##### end domain_base_type(iceauth_t) depth: 4
#line 128
 	
#line 128

#line 128
	
#line 128

#line 128
	# send init a sigchld and signull
#line 128
	
#line 128
	optional {
#line 128
		
#line 128
		 	 	
#line 128
##### begin init_sigchld(iceauth_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type init_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	allow iceauth_t init_t:process sigchld;
#line 128

#line 128
	 	
#line 128
##### end init_sigchld(iceauth_t) depth: 4
#line 128
 	
#line 128
		 	 	
#line 128
##### begin init_signull(iceauth_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type init_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	allow iceauth_t init_t:process signull;
#line 128

#line 128
	 	
#line 128
##### end init_signull(iceauth_t) depth: 4
#line 128
 	
#line 128
	
#line 128
	} # end optional
#line 128

#line 128

#line 128
	# these seem questionable:
#line 128

#line 128
	
#line 128
	optional {
#line 128
		
#line 128
		 	 	
#line 128
##### begin rpm_use_fds(iceauth_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type rpm_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	allow iceauth_t rpm_t:fd use;
#line 128

#line 128
	 	
#line 128
##### end rpm_use_fds(iceauth_t) depth: 4
#line 128
 	
#line 128
		 	 	
#line 128
##### begin rpm_read_pipes(iceauth_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type rpm_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	allow iceauth_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 128

#line 128
	 	
#line 128
##### end rpm_read_pipes(iceauth_t) depth: 4
#line 128
 	
#line 128
	
#line 128
	} # end optional
#line 128

#line 128

#line 128
	
#line 128
	optional {
#line 128
		
#line 128
		 	 	
#line 128
##### begin selinux_dontaudit_getattr_fs(iceauth_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type security_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	dontaudit iceauth_t security_t:filesystem getattr;
#line 128

#line 128
	 	 	
#line 128
##### begin dev_dontaudit_getattr_sysfs(iceauth_t) depth: 6
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type sysfs_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	dontaudit iceauth_t sysfs_t:filesystem getattr;
#line 128

#line 128
	 	
#line 128
##### end dev_dontaudit_getattr_sysfs(iceauth_t) depth: 5
#line 128
 	
#line 128
	 	 	
#line 128
##### begin dev_dontaudit_search_sysfs(iceauth_t) depth: 6
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type sysfs_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	dontaudit iceauth_t sysfs_t:dir { getattr search open };
#line 128

#line 128
	 	
#line 128
##### end dev_dontaudit_search_sysfs(iceauth_t) depth: 5
#line 128
 	
#line 128

#line 128
	 	
#line 128
##### end selinux_dontaudit_getattr_fs(iceauth_t) depth: 4
#line 128
 	
#line 128
		 	 	
#line 128
##### begin selinux_dontaudit_read_fs(iceauth_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type security_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	dontaudit iceauth_t security_t:dir { getattr search open };
#line 128
	dontaudit iceauth_t security_t:file { getattr open read lock ioctl };
#line 128

#line 128
	 	
#line 128
##### end selinux_dontaudit_read_fs(iceauth_t) depth: 4
#line 128
 	
#line 128
	
#line 128
	} # end optional
#line 128

#line 128

#line 128
	
#line 128
	optional {
#line 128
		
#line 128
		 	 	
#line 128
##### begin seutil_dontaudit_read_config(iceauth_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		type selinux_config_t;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	dontaudit iceauth_t selinux_config_t:dir { getattr search open };
#line 128
	dontaudit iceauth_t selinux_config_t:file { getattr open read lock ioctl };
#line 128

#line 128
	 	
#line 128
##### end seutil_dontaudit_read_config(iceauth_t) depth: 4
#line 128
 	
#line 128
	
#line 128
	} # end optional
#line 128

#line 128

#line 128
	 	
#line 128
##### end domain_type(iceauth_t) depth: 3
#line 128
 	
#line 128

#line 128
	 	
#line 128
##### end application_type(iceauth_t) depth: 2
#line 128
 	
#line 128
	 	 	
#line 128
##### begin application_executable_file(iceauth_exec_t) depth: 3
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute application_exec_type;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	typeattribute iceauth_exec_t application_exec_type;
#line 128

#line 128
	 	 	
#line 128
##### begin corecmd_executable_file(iceauth_exec_t) depth: 4
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute exec_type;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	typeattribute iceauth_exec_t exec_type;
#line 128

#line 128
	 	 	
#line 128
##### begin files_type(iceauth_exec_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	typeattribute iceauth_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 128

#line 128
	 	
#line 128
##### end files_type(iceauth_exec_t) depth: 4
#line 128
 	
#line 128

#line 128
	 	
#line 128
##### end corecmd_executable_file(iceauth_exec_t) depth: 3
#line 128
 	
#line 128

#line 128
	 	
#line 128
##### end application_executable_file(iceauth_exec_t) depth: 2
#line 128
 	
#line 128
	 	 	
#line 128
##### begin domain_entry_file(iceauth_t,iceauth_exec_t) depth: 3
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute entry_type;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	allow iceauth_t iceauth_exec_t:file entrypoint;
#line 128
	allow iceauth_t iceauth_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 128

#line 128
	typeattribute iceauth_exec_t entry_type;
#line 128

#line 128
	 	 	
#line 128
##### begin corecmd_executable_file(iceauth_exec_t) depth: 4
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute exec_type;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	typeattribute iceauth_exec_t exec_type;
#line 128

#line 128
	 	 	
#line 128
##### begin files_type(iceauth_exec_t) depth: 5
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	typeattribute iceauth_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 128

#line 128
	 	
#line 128
##### end files_type(iceauth_exec_t) depth: 4
#line 128
 	
#line 128

#line 128
	 	
#line 128
##### end corecmd_executable_file(iceauth_exec_t) depth: 3
#line 128
 	
#line 128

#line 128
	 	
#line 128
##### end domain_entry_file(iceauth_t,iceauth_exec_t) depth: 2
#line 128
 	
#line 128

#line 128
	 	
#line 128
##### end application_domain(iceauth_t,iceauth_exec_t) depth: 1
#line 128
 	
#line 128
	 	 	
#line 128
##### begin ubac_constrained(iceauth_t) depth: 2
#line 128
 	
#line 128
	
#line 128
	
#line 128
		require {
#line 128
			
#line 128
		attribute ubac_constrained_type;
#line 128
	
#line 128
		} # end require
#line 128
	
#line 128

#line 128

#line 128
	typeattribute iceauth_t ubac_constrained_type;
#line 128

#line 128
	 	
#line 128
##### end ubac_constrained(iceauth_t) depth: 1
#line 128
 	
#line 128

#line 128
	 	
#line 128
##### end userdom_user_application_domain(iceauth_t,iceauth_exec_t) depth: 0
#line 128
 	

type iceauth_home_t;
typealias iceauth_home_t alias { user_iceauth_home_t staff_iceauth_home_t sysadm_iceauth_home_t };
typealias iceauth_home_t alias { auditadm_iceauth_home_t secadm_iceauth_home_t };
 	 	
#line 133
##### begin userdom_user_home_content(iceauth_home_t) depth: 1
#line 133
 	
#line 133
	
#line 133
	
#line 133
		require {
#line 133
			
#line 133
		attribute user_home_content_type;
#line 133
		type user_home_t;
#line 133
	
#line 133
		} # end require
#line 133
	
#line 133

#line 133

#line 133
	typeattribute iceauth_home_t user_home_content_type;
#line 133

#line 133
	allow iceauth_home_t user_home_t:filesystem associate;
#line 133
	 	 	
#line 133
##### begin files_type(iceauth_home_t) depth: 2
#line 133
 	
#line 133
	
#line 133
	
#line 133
		require {
#line 133
			
#line 133
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 133
	
#line 133
		} # end require
#line 133
	
#line 133

#line 133

#line 133
	typeattribute iceauth_home_t file_type, non_security_file_type, non_auth_file_type;
#line 133

#line 133
	 	
#line 133
##### end files_type(iceauth_home_t) depth: 1
#line 133
 	
#line 133
	 	 	
#line 133
##### begin files_poly_member(iceauth_home_t) depth: 2
#line 133
 	
#line 133
	
#line 133
	
#line 133
		require {
#line 133
			
#line 133
		attribute polymember;
#line 133
	
#line 133
		} # end require
#line 133
	
#line 133

#line 133

#line 133
	 	 	
#line 133
##### begin files_type(iceauth_home_t) depth: 3
#line 133
 	
#line 133
	
#line 133
	
#line 133
		require {
#line 133
			
#line 133
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 133
	
#line 133
		} # end require
#line 133
	
#line 133

#line 133

#line 133
	typeattribute iceauth_home_t file_type, non_security_file_type, non_auth_file_type;
#line 133

#line 133
	 	
#line 133
##### end files_type(iceauth_home_t) depth: 2
#line 133
 	
#line 133
	typeattribute iceauth_home_t polymember;
#line 133

#line 133
	 	
#line 133
##### end files_poly_member(iceauth_home_t) depth: 1
#line 133
 	
#line 133
	 	 	
#line 133
##### begin ubac_constrained(iceauth_home_t) depth: 2
#line 133
 	
#line 133
	
#line 133
	
#line 133
		require {
#line 133
			
#line 133
		attribute ubac_constrained_type;
#line 133
	
#line 133
		} # end require
#line 133
	
#line 133

#line 133

#line 133
	typeattribute iceauth_home_t ubac_constrained_type;
#line 133

#line 133
	 	
#line 133
##### end ubac_constrained(iceauth_home_t) depth: 1
#line 133
 	
#line 133

#line 133
	 	
#line 133
##### end userdom_user_home_content(iceauth_home_t) depth: 0
#line 133
 	

type xauth_t;
type xauth_exec_t;
typealias xauth_t alias { user_xauth_t staff_xauth_t sysadm_xauth_t };
typealias xauth_t alias { auditadm_xauth_t secadm_xauth_t };
 	 	
#line 139
##### begin userdom_user_application_domain(xauth_t,xauth_exec_t) depth: 1
#line 139
 	
#line 139
	 	 	
#line 139
##### begin application_domain(xauth_t,xauth_exec_t) depth: 2
#line 139
 	
#line 139
	 	 	
#line 139
##### begin application_type(xauth_t) depth: 3
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute application_domain_type;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	typeattribute xauth_t application_domain_type;
#line 139

#line 139
	# start with basic domain
#line 139
	 	 	
#line 139
##### begin domain_type(xauth_t) depth: 4
#line 139
 	
#line 139
	# start with basic domain
#line 139
	 	 	
#line 139
##### begin domain_base_type(xauth_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute domain;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	typeattribute xauth_t domain;
#line 139

#line 139
	 	
#line 139
##### end domain_base_type(xauth_t) depth: 4
#line 139
 	
#line 139

#line 139
	
#line 139

#line 139
	# send init a sigchld and signull
#line 139
	
#line 139
	optional {
#line 139
		
#line 139
		 	 	
#line 139
##### begin init_sigchld(xauth_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type init_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	allow xauth_t init_t:process sigchld;
#line 139

#line 139
	 	
#line 139
##### end init_sigchld(xauth_t) depth: 4
#line 139
 	
#line 139
		 	 	
#line 139
##### begin init_signull(xauth_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type init_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	allow xauth_t init_t:process signull;
#line 139

#line 139
	 	
#line 139
##### end init_signull(xauth_t) depth: 4
#line 139
 	
#line 139
	
#line 139
	} # end optional
#line 139

#line 139

#line 139
	# these seem questionable:
#line 139

#line 139
	
#line 139
	optional {
#line 139
		
#line 139
		 	 	
#line 139
##### begin rpm_use_fds(xauth_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type rpm_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	allow xauth_t rpm_t:fd use;
#line 139

#line 139
	 	
#line 139
##### end rpm_use_fds(xauth_t) depth: 4
#line 139
 	
#line 139
		 	 	
#line 139
##### begin rpm_read_pipes(xauth_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type rpm_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	allow xauth_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 139

#line 139
	 	
#line 139
##### end rpm_read_pipes(xauth_t) depth: 4
#line 139
 	
#line 139
	
#line 139
	} # end optional
#line 139

#line 139

#line 139
	
#line 139
	optional {
#line 139
		
#line 139
		 	 	
#line 139
##### begin selinux_dontaudit_getattr_fs(xauth_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type security_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	dontaudit xauth_t security_t:filesystem getattr;
#line 139

#line 139
	 	 	
#line 139
##### begin dev_dontaudit_getattr_sysfs(xauth_t) depth: 6
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type sysfs_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	dontaudit xauth_t sysfs_t:filesystem getattr;
#line 139

#line 139
	 	
#line 139
##### end dev_dontaudit_getattr_sysfs(xauth_t) depth: 5
#line 139
 	
#line 139
	 	 	
#line 139
##### begin dev_dontaudit_search_sysfs(xauth_t) depth: 6
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type sysfs_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	dontaudit xauth_t sysfs_t:dir { getattr search open };
#line 139

#line 139
	 	
#line 139
##### end dev_dontaudit_search_sysfs(xauth_t) depth: 5
#line 139
 	
#line 139

#line 139
	 	
#line 139
##### end selinux_dontaudit_getattr_fs(xauth_t) depth: 4
#line 139
 	
#line 139
		 	 	
#line 139
##### begin selinux_dontaudit_read_fs(xauth_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type security_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	dontaudit xauth_t security_t:dir { getattr search open };
#line 139
	dontaudit xauth_t security_t:file { getattr open read lock ioctl };
#line 139

#line 139
	 	
#line 139
##### end selinux_dontaudit_read_fs(xauth_t) depth: 4
#line 139
 	
#line 139
	
#line 139
	} # end optional
#line 139

#line 139

#line 139
	
#line 139
	optional {
#line 139
		
#line 139
		 	 	
#line 139
##### begin seutil_dontaudit_read_config(xauth_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type selinux_config_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	dontaudit xauth_t selinux_config_t:dir { getattr search open };
#line 139
	dontaudit xauth_t selinux_config_t:file { getattr open read lock ioctl };
#line 139

#line 139
	 	
#line 139
##### end seutil_dontaudit_read_config(xauth_t) depth: 4
#line 139
 	
#line 139
	
#line 139
	} # end optional
#line 139

#line 139

#line 139
	 	
#line 139
##### end domain_type(xauth_t) depth: 3
#line 139
 	
#line 139

#line 139
	 	
#line 139
##### end application_type(xauth_t) depth: 2
#line 139
 	
#line 139
	 	 	
#line 139
##### begin application_executable_file(xauth_exec_t) depth: 3
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute application_exec_type;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	typeattribute xauth_exec_t application_exec_type;
#line 139

#line 139
	 	 	
#line 139
##### begin corecmd_executable_file(xauth_exec_t) depth: 4
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute exec_type;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	typeattribute xauth_exec_t exec_type;
#line 139

#line 139
	 	 	
#line 139
##### begin files_type(xauth_exec_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	typeattribute xauth_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 139

#line 139
	 	
#line 139
##### end files_type(xauth_exec_t) depth: 4
#line 139
 	
#line 139

#line 139
	 	
#line 139
##### end corecmd_executable_file(xauth_exec_t) depth: 3
#line 139
 	
#line 139

#line 139
	 	
#line 139
##### end application_executable_file(xauth_exec_t) depth: 2
#line 139
 	
#line 139
	 	 	
#line 139
##### begin domain_entry_file(xauth_t,xauth_exec_t) depth: 3
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute entry_type;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	allow xauth_t xauth_exec_t:file entrypoint;
#line 139
	allow xauth_t xauth_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 139

#line 139
	typeattribute xauth_exec_t entry_type;
#line 139

#line 139
	 	 	
#line 139
##### begin corecmd_executable_file(xauth_exec_t) depth: 4
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute exec_type;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	typeattribute xauth_exec_t exec_type;
#line 139

#line 139
	 	 	
#line 139
##### begin files_type(xauth_exec_t) depth: 5
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	typeattribute xauth_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 139

#line 139
	 	
#line 139
##### end files_type(xauth_exec_t) depth: 4
#line 139
 	
#line 139

#line 139
	 	
#line 139
##### end corecmd_executable_file(xauth_exec_t) depth: 3
#line 139
 	
#line 139

#line 139
	 	
#line 139
##### end domain_entry_file(xauth_t,xauth_exec_t) depth: 2
#line 139
 	
#line 139

#line 139
	 	
#line 139
##### end application_domain(xauth_t,xauth_exec_t) depth: 1
#line 139
 	
#line 139
	 	 	
#line 139
##### begin ubac_constrained(xauth_t) depth: 2
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		attribute ubac_constrained_type;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	typeattribute xauth_t ubac_constrained_type;
#line 139

#line 139
	 	
#line 139
##### end ubac_constrained(xauth_t) depth: 1
#line 139
 	
#line 139

#line 139
	 	
#line 139
##### end userdom_user_application_domain(xauth_t,xauth_exec_t) depth: 0
#line 139
 	

type xauth_home_t;
typealias xauth_home_t alias { user_xauth_home_t staff_xauth_home_t sysadm_xauth_home_t };
typealias xauth_home_t alias { auditadm_xauth_home_t secadm_xauth_home_t };
 	 	
#line 144
##### begin userdom_user_home_content(xauth_home_t) depth: 1
#line 144
 	
#line 144
	
#line 144
	
#line 144
		require {
#line 144
			
#line 144
		attribute user_home_content_type;
#line 144
		type user_home_t;
#line 144
	
#line 144
		} # end require
#line 144
	
#line 144

#line 144

#line 144
	typeattribute xauth_home_t user_home_content_type;
#line 144

#line 144
	allow xauth_home_t user_home_t:filesystem associate;
#line 144
	 	 	
#line 144
##### begin files_type(xauth_home_t) depth: 2
#line 144
 	
#line 144
	
#line 144
	
#line 144
		require {
#line 144
			
#line 144
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 144
	
#line 144
		} # end require
#line 144
	
#line 144

#line 144

#line 144
	typeattribute xauth_home_t file_type, non_security_file_type, non_auth_file_type;
#line 144

#line 144
	 	
#line 144
##### end files_type(xauth_home_t) depth: 1
#line 144
 	
#line 144
	 	 	
#line 144
##### begin files_poly_member(xauth_home_t) depth: 2
#line 144
 	
#line 144
	
#line 144
	
#line 144
		require {
#line 144
			
#line 144
		attribute polymember;
#line 144
	
#line 144
		} # end require
#line 144
	
#line 144

#line 144

#line 144
	 	 	
#line 144
##### begin files_type(xauth_home_t) depth: 3
#line 144
 	
#line 144
	
#line 144
	
#line 144
		require {
#line 144
			
#line 144
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 144
	
#line 144
		} # end require
#line 144
	
#line 144

#line 144

#line 144
	typeattribute xauth_home_t file_type, non_security_file_type, non_auth_file_type;
#line 144

#line 144
	 	
#line 144
##### end files_type(xauth_home_t) depth: 2
#line 144
 	
#line 144
	typeattribute xauth_home_t polymember;
#line 144

#line 144
	 	
#line 144
##### end files_poly_member(xauth_home_t) depth: 1
#line 144
 	
#line 144
	 	 	
#line 144
##### begin ubac_constrained(xauth_home_t) depth: 2
#line 144
 	
#line 144
	
#line 144
	
#line 144
		require {
#line 144
			
#line 144
		attribute ubac_constrained_type;
#line 144
	
#line 144
		} # end require
#line 144
	
#line 144

#line 144

#line 144
	typeattribute xauth_home_t ubac_constrained_type;
#line 144

#line 144
	 	
#line 144
##### end ubac_constrained(xauth_home_t) depth: 1
#line 144
 	
#line 144

#line 144
	 	
#line 144
##### end userdom_user_home_content(xauth_home_t) depth: 0
#line 144
 	

type xauth_tmp_t;
typealias xauth_tmp_t alias { user_xauth_tmp_t staff_xauth_tmp_t sysadm_xauth_tmp_t };
typealias xauth_tmp_t alias { auditadm_xauth_tmp_t secadm_xauth_tmp_t };
 	 	
#line 149
##### begin userdom_user_tmp_file(xauth_tmp_t) depth: 1
#line 149
 	
#line 149
	 	 	
#line 149
##### begin files_tmp_file(xauth_tmp_t) depth: 2
#line 149
 	
#line 149
	
#line 149
	
#line 149
		require {
#line 149
			
#line 149
		attribute tmpfile;
#line 149
		type tmp_t;
#line 149
	
#line 149
		} # end require
#line 149
	
#line 149

#line 149

#line 149
	 	 	
#line 149
##### begin files_type(xauth_tmp_t) depth: 3
#line 149
 	
#line 149
	
#line 149
	
#line 149
		require {
#line 149
			
#line 149
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 149
	
#line 149
		} # end require
#line 149
	
#line 149

#line 149

#line 149
	typeattribute xauth_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 149

#line 149
	 	
#line 149
##### end files_type(xauth_tmp_t) depth: 2
#line 149
 	
#line 149
	 	 	
#line 149
##### begin files_poly_member(xauth_tmp_t) depth: 3
#line 149
 	
#line 149
	
#line 149
	
#line 149
		require {
#line 149
			
#line 149
		attribute polymember;
#line 149
	
#line 149
		} # end require
#line 149
	
#line 149

#line 149

#line 149
	 	 	
#line 149
##### begin files_type(xauth_tmp_t) depth: 4
#line 149
 	
#line 149
	
#line 149
	
#line 149
		require {
#line 149
			
#line 149
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 149
	
#line 149
		} # end require
#line 149
	
#line 149

#line 149

#line 149
	typeattribute xauth_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 149

#line 149
	 	
#line 149
##### end files_type(xauth_tmp_t) depth: 3
#line 149
 	
#line 149
	typeattribute xauth_tmp_t polymember;
#line 149

#line 149
	 	
#line 149
##### end files_poly_member(xauth_tmp_t) depth: 2
#line 149
 	
#line 149
	typeattribute xauth_tmp_t tmpfile;
#line 149

#line 149
	 	
#line 149
##### end files_tmp_file(xauth_tmp_t) depth: 1
#line 149
 	
#line 149
	 	 	
#line 149
##### begin ubac_constrained(xauth_tmp_t) depth: 2
#line 149
 	
#line 149
	
#line 149
	
#line 149
		require {
#line 149
			
#line 149
		attribute ubac_constrained_type;
#line 149
	
#line 149
		} # end require
#line 149
	
#line 149

#line 149

#line 149
	typeattribute xauth_tmp_t ubac_constrained_type;
#line 149

#line 149
	 	
#line 149
##### end ubac_constrained(xauth_tmp_t) depth: 1
#line 149
 	
#line 149

#line 149
	 	
#line 149
##### end userdom_user_tmp_file(xauth_tmp_t) depth: 0
#line 149
 	

# this is not actually a device, its a pipe
type xconsole_device_t;
 	 	
#line 153
##### begin files_type(xconsole_device_t) depth: 1
#line 153
 	
#line 153
	
#line 153
	
#line 153
		require {
#line 153
			
#line 153
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 153
	
#line 153
		} # end require
#line 153
	
#line 153

#line 153

#line 153
	typeattribute xconsole_device_t file_type, non_security_file_type, non_auth_file_type;
#line 153

#line 153
	 	
#line 153
##### end files_type(xconsole_device_t) depth: 0
#line 153
 	
 	 	
#line 154
##### begin dev_associate(xconsole_device_t) depth: 1
#line 154
 	
#line 154
	
#line 154
	
#line 154
		require {
#line 154
			
#line 154
		type device_t;
#line 154
	
#line 154
		} # end require
#line 154
	
#line 154

#line 154

#line 154
	allow xconsole_device_t device_t:filesystem associate;
#line 154
	 	 	
#line 154
##### begin fs_associate_tmpfs(xconsole_device_t) depth: 2
#line 154
 	
#line 154
	
#line 154
	
#line 154
		require {
#line 154
			
#line 154
		type tmpfs_t;
#line 154
	
#line 154
		} # end require
#line 154
	
#line 154

#line 154

#line 154
	allow xconsole_device_t tmpfs_t:filesystem associate;
#line 154

#line 154
	 	
#line 154
##### end fs_associate_tmpfs(xconsole_device_t) depth: 1
#line 154
 		#For backwards compatibility
#line 154

#line 154
	 	
#line 154
##### end dev_associate(xconsole_device_t) depth: 0
#line 154
 	
 	 	
#line 155
##### begin fs_associate_tmpfs(xconsole_device_t) depth: 1
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type tmpfs_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow xconsole_device_t tmpfs_t:filesystem associate;
#line 155

#line 155
	 	
#line 155
##### end fs_associate_tmpfs(xconsole_device_t) depth: 0
#line 155
 	
 	 	
#line 156
##### begin files_associate_tmp(xconsole_device_t) depth: 1
#line 156
 	
#line 156
	
#line 156
	
#line 156
		require {
#line 156
			
#line 156
		type tmp_t;
#line 156
	
#line 156
		} # end require
#line 156
	
#line 156

#line 156

#line 156
	allow xconsole_device_t tmp_t:filesystem associate;
#line 156

#line 156
	 	
#line 156
##### end files_associate_tmp(xconsole_device_t) depth: 0
#line 156
 	

type xdm_t;
type xdm_exec_t;
 	 	
#line 160
##### begin auth_login_pgm_domain(xdm_t) depth: 1
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_auth_t, auth_cache_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin domain_type(xdm_t) depth: 2
#line 160
 	
#line 160
	# start with basic domain
#line 160
	 	 	
#line 160
##### begin domain_base_type(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute domain;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t domain;
#line 160

#line 160
	 	
#line 160
##### end domain_base_type(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	
#line 160

#line 160
	# send init a sigchld and signull
#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin init_sigchld(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type init_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t init_t:process sigchld;
#line 160

#line 160
	 	
#line 160
##### end init_sigchld(xdm_t) depth: 2
#line 160
 	
#line 160
		 	 	
#line 160
##### begin init_signull(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type init_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t init_t:process signull;
#line 160

#line 160
	 	
#line 160
##### end init_signull(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	# these seem questionable:
#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin rpm_use_fds(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type rpm_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t rpm_t:fd use;
#line 160

#line 160
	 	
#line 160
##### end rpm_use_fds(xdm_t) depth: 2
#line 160
 	
#line 160
		 	 	
#line 160
##### begin rpm_read_pipes(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type rpm_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end rpm_read_pipes(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin selinux_dontaudit_getattr_fs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t security_t:filesystem getattr;
#line 160

#line 160
	 	 	
#line 160
##### begin dev_dontaudit_getattr_sysfs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t sysfs_t:filesystem getattr;
#line 160

#line 160
	 	
#line 160
##### end dev_dontaudit_getattr_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	 	 	
#line 160
##### begin dev_dontaudit_search_sysfs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end dev_dontaudit_search_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end selinux_dontaudit_getattr_fs(xdm_t) depth: 2
#line 160
 	
#line 160
		 	 	
#line 160
##### begin selinux_dontaudit_read_fs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t security_t:dir { getattr search open };
#line 160
	dontaudit xdm_t security_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end selinux_dontaudit_read_fs(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin seutil_dontaudit_read_config(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type selinux_config_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t selinux_config_t:dir { getattr search open };
#line 160
	dontaudit xdm_t selinux_config_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end seutil_dontaudit_read_config(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	 	
#line 160
##### end domain_type(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin domain_subj_id_change_exemption(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute can_change_process_identity;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t can_change_process_identity;
#line 160

#line 160
	 	
#line 160
##### end domain_subj_id_change_exemption(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin domain_role_change_exemption(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute can_change_process_role;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t can_change_process_role;
#line 160

#line 160
	 	
#line 160
##### end domain_role_change_exemption(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin domain_obj_id_change_exemption(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute can_change_object_identity;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t can_change_object_identity;
#line 160

#line 160
	 	
#line 160
##### end domain_obj_id_change_exemption(xdm_t) depth: 1
#line 160
 	
#line 160
	role system_r types xdm_t;
#line 160

#line 160
	# Needed for pam_selinux_permit to cleanup properly
#line 160
	 	 	
#line 160
##### begin domain_read_all_domains_state(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute domain;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin kernel_search_proc(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type proc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t proc_t:dir { getattr search open };
#line 160
	allow xdm_t proc_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end kernel_search_proc(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t domain:dir { getattr search open read lock ioctl };
#line 160
	
#line 160
	allow xdm_t domain:dir { getattr search open };
#line 160
	allow xdm_t domain:file { getattr open read lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t domain:dir { getattr search open };
#line 160
	allow xdm_t domain:lnk_file { getattr read };
#line 160

#line 160

#line 160
	 	
#line 160
##### end domain_read_all_domains_state(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin domain_kill_all_domains(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute domain;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t domain:process sigkill;
#line 160
	allow xdm_t self:capability kill;
#line 160

#line 160
	 	
#line 160
##### end domain_kill_all_domains(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	# pam_keyring
#line 160
	allow xdm_t self:capability ipc_lock;
#line 160
	allow xdm_t self:process setkeycreate;
#line 160
	allow xdm_t self:key { create link read search setattr view write } ;
#line 160

#line 160
	 	 	
#line 160
##### begin files_list_var_lib(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_lib_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_lib_t:dir { getattr search open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_list_var_lib(xdm_t) depth: 1
#line 160
 	
#line 160
	
#line 160
	allow xdm_t var_auth_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 160
	allow xdm_t var_auth_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t auth_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 160
	allow xdm_t auth_cache_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t auth_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 160
	allow xdm_t auth_cache_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 160

#line 160
	
#line 160
	allow xdm_t auth_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 160
	allow xdm_t auth_cache_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 160

#line 160
	 	 	
#line 160
##### begin files_var_filetrans(xdm_t,auth_cache_t,dir) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t var_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 160
	type_transition xdm_t var_t:dir auth_cache_t ;
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_var_filetrans(xdm_t,auth_cache_t,dir) depth: 1
#line 160
 	
#line 160

#line 160
	# needed for afs - https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=253321
#line 160
	 	 	
#line 160
##### begin kernel_rw_afs_state(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type proc_t, proc_afs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t proc_t:dir { getattr search open };
#line 160
	allow xdm_t proc_t:dir { getattr search open read lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t proc_afs_t:dir { getattr search open };
#line 160
	allow xdm_t proc_afs_t:file { getattr open read write append ioctl lock };
#line 160

#line 160

#line 160
	 	
#line 160
##### end kernel_rw_afs_state(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	# for fingerprint readers
#line 160
	 	 	
#line 160
##### begin dev_rw_input_dev(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type device_t, event_device_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t device_t:dir { getattr search open };
#line 160
	allow xdm_t event_device_t:chr_file { getattr open read write append ioctl lock };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_rw_input_dev(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin dev_rw_generic_usb_dev(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type device_t, usb_device_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t device_t:dir { getattr search open };
#line 160
	allow xdm_t usb_device_t:chr_file { getattr open read write append ioctl lock };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_rw_generic_usb_dev(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin files_read_etc_files(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type etc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t etc_t:dir { getattr search open read lock ioctl };
#line 160
	
#line 160
	allow xdm_t etc_t:dir { getattr search open };
#line 160
	allow xdm_t etc_t:file { getattr open read lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t etc_t:dir { getattr search open };
#line 160
	allow xdm_t etc_t:lnk_file { getattr read };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_read_etc_files(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin fs_list_auto_mountpoints(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type autofs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t autofs_t:dir { getattr search open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end fs_list_auto_mountpoints(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin selinux_get_fs_mount(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 160
	# attempt to short circuit by checking if SELINUXMNT
#line 160
	# (/selinux) is already a selinuxfs
#line 160
	allow xdm_t security_t:filesystem getattr;
#line 160

#line 160
	# Same for /sys/fs/selinux
#line 160
	 	 	
#line 160
##### begin dev_getattr_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t sysfs_t:filesystem getattr;
#line 160

#line 160
	 	
#line 160
##### end dev_getattr_sysfs(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin dev_search_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_search_sysfs(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	# read /proc/filesystems to see if selinuxfs is supported
#line 160
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 160
	 	 	
#line 160
##### begin kernel_read_system_state(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type proc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t proc_t:dir { getattr search open };
#line 160
	allow xdm_t proc_t:file { getattr open read lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t proc_t:dir { getattr search open };
#line 160
	allow xdm_t proc_t:lnk_file { getattr read };
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t proc_t:dir { getattr search open };
#line 160
	allow xdm_t proc_t:dir { getattr search open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end kernel_read_system_state(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end selinux_get_fs_mount(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin selinux_validate_context(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dev_search_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_search_sysfs(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t security_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t security_t:file { getattr open read write append ioctl lock };
#line 160
	allow xdm_t security_t:security check_context;
#line 160

#line 160
	 	
#line 160
##### end selinux_validate_context(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin selinux_compute_access_vector(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dev_search_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_search_sysfs(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t security_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t security_t:file { getattr open read write append ioctl lock };
#line 160
	allow xdm_t security_t:security compute_av;
#line 160

#line 160
	 	
#line 160
##### end selinux_compute_access_vector(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin selinux_compute_create_context(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dev_search_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_search_sysfs(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t security_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t security_t:file { getattr open read write append ioctl lock };
#line 160
	allow xdm_t security_t:security compute_create;
#line 160

#line 160
	 	
#line 160
##### end selinux_compute_create_context(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin selinux_compute_relabel_context(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dev_search_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_search_sysfs(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t security_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t security_t:file { getattr open read write append ioctl lock };
#line 160
	allow xdm_t security_t:security compute_relabel;
#line 160

#line 160
	 	
#line 160
##### end selinux_compute_relabel_context(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin selinux_compute_user_contexts(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dev_search_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_search_sysfs(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t security_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t security_t:file { getattr open read write append ioctl lock };
#line 160
	allow xdm_t security_t:security compute_user;
#line 160

#line 160
	 	
#line 160
##### end selinux_compute_user_contexts(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin mls_file_read_all_levels(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute mlsfileread;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t mlsfileread;
#line 160

#line 160
	 	
#line 160
##### end mls_file_read_all_levels(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin mls_file_write_all_levels(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute mlsfilewrite;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t mlsfilewrite;
#line 160

#line 160
	 	
#line 160
##### end mls_file_write_all_levels(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin mls_file_upgrade(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute mlsfileupgrade;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t mlsfileupgrade;
#line 160

#line 160
	 	
#line 160
##### end mls_file_upgrade(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin mls_file_downgrade(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute mlsfiledowngrade;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t mlsfiledowngrade;
#line 160

#line 160
	 	
#line 160
##### end mls_file_downgrade(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin mls_process_set_level(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute mlsprocsetsl;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t mlsprocsetsl;
#line 160

#line 160
	 	
#line 160
##### end mls_process_set_level(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin mls_fd_share_all_levels(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute mlsfdshare;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t mlsfdshare;
#line 160

#line 160
	 	
#line 160
##### end mls_fd_share_all_levels(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin auth_use_pam(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	# for SSP/ProPolice
#line 160
	 	 	
#line 160
##### begin dev_read_urand(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type device_t, urandom_device_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t device_t:dir { getattr search open };
#line 160
	allow xdm_t urandom_device_t:chr_file { getattr open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_read_urand(xdm_t) depth: 2
#line 160
 	
#line 160
	# for encrypted homedir
#line 160
	 	 	
#line 160
##### begin dev_read_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:file { getattr open read lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:lnk_file { getattr read };
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_read_sysfs(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin auth_domtrans_chk_passwd(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type chkpwd_t, chkpwd_exec_t, shadow_t;
#line 160
		type auth_cache_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t auth_cache_t:dir { getattr search open };
#line 160

#line 160
	 	 	
#line 160
##### begin corecmd_search_bin(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type bin_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t bin_t:dir { getattr search open };
#line 160
	allow xdm_t bin_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end corecmd_search_bin(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
	
#line 160
	allow xdm_t chkpwd_exec_t:file { getattr open read execute };
#line 160
	allow xdm_t chkpwd_t:process transition;
#line 160
	dontaudit xdm_t chkpwd_t:process { noatsecure siginh rlimitinh };
#line 160

#line 160
	type_transition xdm_t chkpwd_exec_t:process chkpwd_t;
#line 160

#line 160

#line 160
	allow chkpwd_t xdm_t:fd use;
#line 160
	allow chkpwd_t xdm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 160
	allow chkpwd_t xdm_t:process sigchld;
#line 160

#line 160

#line 160
	dontaudit xdm_t shadow_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	 	
#line 160
##### begin dev_read_rand(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type device_t, random_device_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t device_t:dir { getattr search open };
#line 160
	allow xdm_t random_device_t:chr_file { getattr open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_read_rand(xdm_t) depth: 3
#line 160
 	
#line 160
	 	 	
#line 160
##### begin dev_read_urand(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type device_t, urandom_device_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t device_t:dir { getattr search open };
#line 160
	allow xdm_t urandom_device_t:chr_file { getattr open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_read_urand(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin auth_use_nsswitch(xdm_t) depth: 4
#line 160
 	
#line 160
    
#line 160
	
#line 160
		require {
#line 160
			
#line 160
        attribute nsswitch_domain;
#line 160
    
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t nsswitch_domain;
#line 160

#line 160
	 	
#line 160
##### end auth_use_nsswitch(xdm_t) depth: 3
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_rw_faillog(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type faillog_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin logging_search_logs(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_log_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_var(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_var(xdm_t) depth: 5
#line 160
 	
#line 160
	allow xdm_t var_log_t:dir { getattr search open };
#line 160
	allow xdm_t var_log_t:lnk_file { getattr read };
#line 160

#line 160
	 	
#line 160
##### end logging_search_logs(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t faillog_t:file { getattr open read write append ioctl lock };
#line 160

#line 160
	 	
#line 160
##### end auth_rw_faillog(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin logging_send_audit_msgs(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t self:capability audit_write;
#line 160
	allow xdm_t self:netlink_audit_socket { { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_relay };
#line 160

#line 160
	 	
#line 160
##### end logging_send_audit_msgs(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin miscfiles_read_generic_certs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type cert_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t cert_t:dir { getattr search open read lock ioctl };
#line 160
	
#line 160
	allow xdm_t cert_t:dir { getattr search open };
#line 160
	allow xdm_t cert_t:file { getattr open read lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t cert_t:dir { getattr search open };
#line 160
	allow xdm_t cert_t:lnk_file { getattr read };
#line 160

#line 160

#line 160
	 	
#line 160
##### end miscfiles_read_generic_certs(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin kerberos_read_keytab(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type krb5_keytab_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_etc(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type etc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t etc_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_etc(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t krb5_keytab_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end kerberos_read_keytab(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin pcscd_read_pid_files(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type pcscd_var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_pids(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_run_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_search_pids(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	allow xdm_t pcscd_var_run_t:dir { getattr search open };
#line 160
	allow xdm_t pcscd_var_run_t:file { getattr open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end pcscd_read_pid_files(xdm_t) depth: 3
#line 160
 	
#line 160
		 	 	
#line 160
##### begin pcscd_stream_connect(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type pcscd_t, pcscd_var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_pids(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_run_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_search_pids(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	allow xdm_t pcscd_var_run_t:dir { getattr search open };
#line 160
	allow xdm_t pcscd_var_run_t:sock_file { getattr write open append };
#line 160
	allow xdm_t pcscd_t:unix_stream_socket connectto;
#line 160

#line 160

#line 160
	 	
#line 160
##### end pcscd_stream_connect(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin samba_stream_connect_winbind(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type samba_var_t, winbind_t, winbind_var_run_t, smbd_var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_pids(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_run_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_search_pids(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	allow xdm_t { smbd_var_run_t samba_var_t winbind_var_run_t }:dir { getattr search open };
#line 160
	allow xdm_t winbind_var_run_t:sock_file { getattr write open append };
#line 160
	allow xdm_t winbind_t:unix_stream_socket connectto;
#line 160

#line 160

#line 160
	 	
#line 160
##### end samba_stream_connect_winbind(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	 	
#line 160
##### end auth_domtrans_chk_passwd(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_domtrans_upd_passwd(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type updpwd_t, updpwd_exec_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	
#line 160
	
#line 160
	allow xdm_t updpwd_exec_t:file { getattr open read execute };
#line 160
	allow xdm_t updpwd_t:process transition;
#line 160
	dontaudit xdm_t updpwd_t:process { noatsecure siginh rlimitinh };
#line 160

#line 160
	type_transition xdm_t updpwd_exec_t:process updpwd_t;
#line 160

#line 160

#line 160
	allow updpwd_t xdm_t:fd use;
#line 160
	allow updpwd_t xdm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 160
	allow updpwd_t xdm_t:process sigchld;
#line 160

#line 160
	 	 	
#line 160
##### begin auth_dontaudit_read_shadow(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type shadow_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t shadow_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end auth_dontaudit_read_shadow(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160

#line 160
	 	
#line 160
##### end auth_domtrans_upd_passwd(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_dontaudit_read_shadow(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type shadow_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t shadow_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end auth_dontaudit_read_shadow(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_read_login_records(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type wtmp_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin logging_search_logs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_log_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_var(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_var(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t var_log_t:dir { getattr search open };
#line 160
	allow xdm_t var_log_t:lnk_file { getattr read };
#line 160

#line 160
	 	
#line 160
##### end logging_search_logs(xdm_t) depth: 3
#line 160
 	
#line 160
	allow xdm_t wtmp_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end auth_read_login_records(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_append_login_records(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type wtmp_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t wtmp_t:file { getattr open append lock ioctl };
#line 160
	 	 	
#line 160
##### begin logging_search_logs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_log_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_var(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_var(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t var_log_t:dir { getattr search open };
#line 160
	allow xdm_t var_log_t:lnk_file { getattr read };
#line 160

#line 160
	 	
#line 160
##### end logging_search_logs(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end auth_append_login_records(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_rw_lastlog(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type lastlog_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin logging_search_logs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_log_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_var(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_var(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t var_log_t:dir { getattr search open };
#line 160
	allow xdm_t var_log_t:lnk_file { getattr read };
#line 160

#line 160
	 	
#line 160
##### end logging_search_logs(xdm_t) depth: 3
#line 160
 	
#line 160
	allow xdm_t lastlog_t:file { { getattr open read write append ioctl lock } lock setattr };
#line 160

#line 160
	 	
#line 160
##### end auth_rw_lastlog(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_rw_faillog(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type faillog_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin logging_search_logs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_log_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_var(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_var(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t var_log_t:dir { getattr search open };
#line 160
	allow xdm_t var_log_t:lnk_file { getattr read };
#line 160

#line 160
	 	
#line 160
##### end logging_search_logs(xdm_t) depth: 3
#line 160
 	
#line 160
	allow xdm_t faillog_t:file { getattr open read write append ioctl lock };
#line 160

#line 160
	 	
#line 160
##### end auth_rw_faillog(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_exec_pam(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type pam_exec_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t pam_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 160

#line 160
	 	
#line 160
##### end auth_exec_pam(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin auth_use_nsswitch(xdm_t) depth: 3
#line 160
 	
#line 160
    
#line 160
	
#line 160
		require {
#line 160
			
#line 160
        attribute nsswitch_domain;
#line 160
    
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t nsswitch_domain;
#line 160

#line 160
	 	
#line 160
##### end auth_use_nsswitch(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin logging_send_audit_msgs(xdm_t) depth: 3
#line 160
 	
#line 160
	allow xdm_t self:capability audit_write;
#line 160
	allow xdm_t self:netlink_audit_socket { { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_relay };
#line 160

#line 160
	 	
#line 160
##### end logging_send_audit_msgs(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin logging_send_syslog_msg(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type syslogd_t, syslogd_var_run_t, devlog_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t devlog_t:sock_file { getattr write open append };
#line 160

#line 160
	# systemd journal socket is in /run/systemd/journal/dev-log
#line 160
	 	 	
#line 160
##### begin init_search_run(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type init_var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_pids(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_run_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_search_pids(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t init_var_run_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end init_search_run(xdm_t) depth: 3
#line 160
 	
#line 160
	allow xdm_t syslogd_var_run_t:dir { getattr search open };
#line 160

#line 160
	# the type of socket depends on the syslog daemon
#line 160
	allow xdm_t syslogd_t:unix_dgram_socket sendto;
#line 160
	allow xdm_t syslogd_t:unix_stream_socket connectto;
#line 160
	allow xdm_t self:unix_dgram_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 160
	allow xdm_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 160

#line 160
	# If syslog is down, the glibc syslog() function
#line 160
	# will write to the console.
#line 160
	 	 	
#line 160
##### begin term_write_console(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type console_device_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dev_list_all_dev_nodes(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type device_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t device_t:dir { getattr search open };
#line 160
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t device_t:dir { getattr search open };
#line 160
	allow xdm_t device_t:lnk_file { getattr read };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_list_all_dev_nodes(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t console_device_t:chr_file { getattr open write append lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end term_write_console(xdm_t) depth: 3
#line 160
 	
#line 160
	 	 	
#line 160
##### begin term_dontaudit_read_console(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type console_device_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t console_device_t:chr_file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end term_dontaudit_read_console(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	# because systemd is now using /run/systemd/journal/dev-log
#line 160
	 	 	
#line 160
##### begin init_search_pid_dirs(xdm_t) depth: 4
#line 160
 	
#line 160
    
#line 160
	
#line 160
		require {
#line 160
			
#line 160
        type init_var_run_t;
#line 160
    
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
    allow xdm_t init_var_run_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end init_search_pid_dirs(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end logging_send_syslog_msg(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin dbus_system_bus_client(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute dbusd_system_bus_client;
#line 160
		type system_dbusd_t, system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 160
		class dbus send_msg;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t dbusd_system_bus_client;
#line 160

#line 160
	allow xdm_t { system_dbusd_t self }:dbus send_msg;
#line 160
	allow system_dbusd_t xdm_t:dbus send_msg;
#line 160

#line 160
	 	 	
#line 160
##### begin files_search_var_lib(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_lib_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_lib_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_search_var_lib(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	allow xdm_t system_dbusd_var_lib_t:dir { getattr search open };
#line 160
	allow xdm_t system_dbusd_var_lib_t:file { getattr open read lock ioctl };
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_pids(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_run_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_search_pids(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	allow xdm_t system_dbusd_var_run_t:dir { getattr search open };
#line 160
	allow xdm_t system_dbusd_var_run_t:sock_file { getattr write open append };
#line 160
	allow xdm_t system_dbusd_t:unix_stream_socket connectto;
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dbus_read_config(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type dbusd_etc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t dbusd_etc_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end dbus_read_config(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end dbus_system_bus_client(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
		
#line 160
	optional {
#line 160
		
#line 160
			 	 	
#line 160
##### begin consolekit_dbus_chat(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type consolekit_t;
#line 160
		class dbus send_msg;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t consolekit_t:dbus send_msg;
#line 160
	allow consolekit_t xdm_t:dbus send_msg;
#line 160

#line 160
	 	
#line 160
##### end consolekit_dbus_chat(xdm_t) depth: 2
#line 160
 	
#line 160
		
#line 160
	}
#line 160

#line 160

#line 160
		
#line 160
	optional {
#line 160
		
#line 160
			 	 	
#line 160
##### begin fprintd_dbus_chat(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type fprintd_t;
#line 160
		class dbus send_msg;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t fprintd_t:dbus send_msg;
#line 160
	allow fprintd_t xdm_t:dbus send_msg;
#line 160

#line 160
	 	
#line 160
##### end fprintd_dbus_chat(xdm_t) depth: 2
#line 160
 	
#line 160
		
#line 160
	}
#line 160

#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin kerberos_manage_host_rcache(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type krb5_host_rcache_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin domain_obj_id_change_exemption(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute can_change_object_identity;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	typeattribute xdm_t can_change_object_identity;
#line 160

#line 160
	 	
#line 160
##### end domain_obj_id_change_exemption(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		
#line 160
bool allow_kerberos;
#line 160

#line 160
  
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160
	if (allow_kerberos) {
#line 160
		
#line 160
		allow xdm_t self:process setfscreate;
#line 160

#line 160
		 	 	
#line 160
##### begin selinux_validate_context(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dev_search_sysfs(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_search_sysfs(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t security_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t security_t:file { getattr open read write append ioctl lock };
#line 160
	allow xdm_t security_t:security check_context;
#line 160

#line 160
	 	
#line 160
##### end selinux_validate_context(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
		 	 	
#line 160
##### begin seutil_read_file_contexts(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type selinux_config_t, default_context_t, file_context_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_etc(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type etc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t etc_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_etc(xdm_t) depth: 4
#line 160
 	
#line 160
	allow xdm_t { selinux_config_t default_context_t }:dir { getattr search open };
#line 160
	
#line 160
	allow xdm_t file_context_t:dir { getattr search open };
#line 160
	allow xdm_t file_context_t:file { getattr open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end seutil_read_file_contexts(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
		 	 	
#line 160
##### begin files_search_tmp(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type tmp_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t tmp_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_tmp(xdm_t) depth: 3
#line 160
 	
#line 160
		allow xdm_t krb5_host_rcache_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 160
	
#line 160
	}
#line 160

#line 160

#line 160
	 	
#line 160
##### end kerberos_manage_host_rcache(xdm_t) depth: 2
#line 160
 	
#line 160
		 	 	
#line 160
##### begin kerberos_read_config(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type krb5_conf_t, krb5_home_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_etc(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type etc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t etc_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_etc(xdm_t) depth: 3
#line 160
 	
#line 160
	allow xdm_t krb5_conf_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	 	
#line 160
##### begin userdom_search_user_home_dirs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type user_home_dir_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t user_home_dir_t:dir { getattr search open };
#line 160
	 	 	
#line 160
##### begin files_search_home(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type home_root_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t home_root_t:dir { getattr search open };
#line 160
	allow xdm_t home_root_t:lnk_file { getattr read };
#line 160

#line 160
	 	
#line 160
##### end files_search_home(xdm_t) depth: 4
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end userdom_search_user_home_dirs(xdm_t) depth: 3
#line 160
 	
#line 160
	allow xdm_t krb5_home_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end kerberos_read_config(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin nis_authenticate(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		
#line 160
bool allow_ypbind;
#line 160

#line 160
  
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160
	if (allow_ypbind) {
#line 160
		
#line 160
		 	 	
#line 160
##### begin nis_use_ypbind_uncond(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_yp_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t self:capability net_bind_service;
#line 160

#line 160
	allow xdm_t self:tcp_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 160
	allow xdm_t self:udp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 160

#line 160
	allow xdm_t var_yp_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t var_yp_t:file { getattr open read lock ioctl };
#line 160
	allow xdm_t var_yp_t:lnk_file { getattr read };
#line 160

#line 160
	 	 	
#line 160
##### begin corenet_all_recvfrom_unlabeled(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin kernel_tcp_recvfrom_unlabeled(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type unlabeled_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t unlabeled_t:tcp_socket recvfrom;
#line 160

#line 160
	 	
#line 160
##### end kernel_tcp_recvfrom_unlabeled(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin kernel_udp_recvfrom_unlabeled(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type unlabeled_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t unlabeled_t:udp_socket recvfrom;
#line 160

#line 160
	 	
#line 160
##### end kernel_udp_recvfrom_unlabeled(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin kernel_raw_recvfrom_unlabeled(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type unlabeled_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t unlabeled_t:rawip_socket recvfrom;
#line 160

#line 160
	 	
#line 160
##### end kernel_raw_recvfrom_unlabeled(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin kernel_recvfrom_unlabeled_peer(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type unlabeled_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t unlabeled_t:peer recv;
#line 160

#line 160
	 	
#line 160
##### end kernel_recvfrom_unlabeled_peer(xdm_t) depth: 5
#line 160
 	
#line 160

#line 160
	# XXX - at some point the oubound/send access check will be removed
#line 160
	# but for right now we need to keep this in place so as not to break
#line 160
	# older systems
#line 160
	 	 	
#line 160
##### begin kernel_sendrecv_unlabeled_association(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type unlabeled_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t unlabeled_t:association { sendto recvfrom };
#line 160

#line 160
	 	
#line 160
##### end kernel_sendrecv_unlabeled_association(xdm_t) depth: 5
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end corenet_all_recvfrom_unlabeled(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_all_recvfrom_netlabel(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type netlabel_peer_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t netlabel_peer_t:peer recv;
#line 160
	allow xdm_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 160

#line 160
	 	
#line 160
##### end corenet_all_recvfrom_netlabel(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_tcp_sendrecv_generic_if(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type netif_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_sendrecv_generic_if(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_sendrecv_generic_if(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_send_generic_if(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type netif_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t netif_t:netif { udp_send egress };
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_send_generic_if(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_receive_generic_if(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type netif_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t netif_t:netif { udp_recv ingress };
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_receive_generic_if(xdm_t) depth: 5
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_sendrecv_generic_if(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_tcp_sendrecv_generic_node(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type node_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_sendrecv_generic_node(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_sendrecv_generic_node(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_send_generic_node(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type node_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t node_t:node { udp_send sendto };
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_send_generic_node(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_receive_generic_node(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type node_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t node_t:node { udp_recv recvfrom };
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_receive_generic_node(xdm_t) depth: 5
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_sendrecv_generic_node(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_tcp_sendrecv_all_ports(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t port_type:tcp_socket { send_msg recv_msg };
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_sendrecv_all_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_sendrecv_all_ports(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_send_all_ports(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t port_type:udp_socket send_msg;
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_send_all_ports(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_receive_all_ports(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t port_type:udp_socket recv_msg;
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_receive_all_ports(xdm_t) depth: 5
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_sendrecv_all_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_tcp_bind_generic_node(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type node_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t node_t:tcp_socket node_bind;
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_bind_generic_node(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_bind_generic_node(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type node_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t node_t:udp_socket node_bind;
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_bind_generic_node(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_tcp_bind_generic_port(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type port_t;
#line 160
		attribute defined_port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t port_t:tcp_socket name_bind;
#line 160
	dontaudit xdm_t defined_port_type:tcp_socket name_bind;
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_bind_generic_port(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_udp_bind_generic_port(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type port_t;
#line 160
		attribute defined_port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t port_t:udp_socket name_bind;
#line 160
	dontaudit xdm_t defined_port_type:udp_socket name_bind;
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_bind_generic_port(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_dontaudit_tcp_bind_all_reserved_ports(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute reserved_port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t reserved_port_type:tcp_socket name_bind;
#line 160

#line 160
	 	
#line 160
##### end corenet_dontaudit_tcp_bind_all_reserved_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_dontaudit_udp_bind_all_reserved_ports(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute reserved_port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t reserved_port_type:udp_socket name_bind;
#line 160

#line 160
	 	
#line 160
##### end corenet_dontaudit_udp_bind_all_reserved_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_dontaudit_tcp_bind_all_ports(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t port_type:tcp_socket name_bind;
#line 160

#line 160
	 	
#line 160
##### end corenet_dontaudit_tcp_bind_all_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_dontaudit_udp_bind_all_ports(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t port_type:udp_socket name_bind;
#line 160

#line 160
	 	
#line 160
##### end corenet_dontaudit_udp_bind_all_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_tcp_connect_portmap_port(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type portmap_port_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t portmap_port_t:tcp_socket name_connect;
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_connect_portmap_port(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_tcp_connect_reserved_port(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type reserved_port_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t reserved_port_t:tcp_socket name_connect;
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_connect_reserved_port(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_tcp_connect_generic_port(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type port_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t port_t:tcp_socket name_connect;
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_connect_generic_port(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_dontaudit_tcp_connect_all_ports(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	dontaudit xdm_t port_type:tcp_socket name_connect;
#line 160

#line 160
	 	
#line 160
##### end corenet_dontaudit_tcp_connect_all_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_sendrecv_portmap_client_packets(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_send_portmap_client_packets(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type portmap_client_packet_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t portmap_client_packet_t:packet send;
#line 160

#line 160
	 	
#line 160
##### end corenet_send_portmap_client_packets(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_receive_portmap_client_packets(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type portmap_client_packet_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t portmap_client_packet_t:packet recv;
#line 160

#line 160
	 	
#line 160
##### end corenet_receive_portmap_client_packets(xdm_t) depth: 5
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end corenet_sendrecv_portmap_client_packets(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_sendrecv_generic_client_packets(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_send_generic_client_packets(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type client_packet_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t client_packet_t:packet send;
#line 160

#line 160
	 	
#line 160
##### end corenet_send_generic_client_packets(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_receive_generic_client_packets(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type client_packet_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t client_packet_t:packet recv;
#line 160

#line 160
	 	
#line 160
##### end corenet_receive_generic_client_packets(xdm_t) depth: 5
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end corenet_sendrecv_generic_client_packets(xdm_t) depth: 4
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_sendrecv_generic_server_packets(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_send_generic_server_packets(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type server_packet_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t server_packet_t:packet send;
#line 160

#line 160
	 	
#line 160
##### end corenet_send_generic_server_packets(xdm_t) depth: 5
#line 160
 	
#line 160
	 	 	
#line 160
##### begin corenet_receive_generic_server_packets(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type server_packet_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t server_packet_t:packet recv;
#line 160

#line 160
	 	
#line 160
##### end corenet_receive_generic_server_packets(xdm_t) depth: 5
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end corenet_sendrecv_generic_server_packets(xdm_t) depth: 4
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin sysnet_read_config(xdm_t) depth: 5
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type net_conf_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_etc(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type etc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t etc_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_etc(xdm_t) depth: 5
#line 160
 	
#line 160
	allow xdm_t net_conf_t:file { getattr open read lock ioctl };
#line 160

#line 160
	
#line 160
		 	 	
#line 160
##### begin files_search_pids(xdm_t) depth: 6
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_run_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_search_pids(xdm_t) depth: 5
#line 160
 	
#line 160
		allow xdm_t net_conf_t:dir { getattr search open read lock ioctl };
#line 160
		
#line 160
	allow xdm_t net_conf_t:dir { getattr search open };
#line 160
	allow xdm_t net_conf_t:file { getattr open read lock ioctl };
#line 160

#line 160
	
#line 160

#line 160
	
#line 160

#line 160
	 	
#line 160
##### end sysnet_read_config(xdm_t) depth: 4
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end nis_use_ypbind_uncond(xdm_t) depth: 3
#line 160
 	
#line 160
		 	 	
#line 160
##### begin corenet_tcp_bind_all_rpc_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute rpc_port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t rpc_port_type:tcp_socket name_bind;
#line 160
	allow xdm_t self:capability net_bind_service;
#line 160

#line 160
	 	
#line 160
##### end corenet_tcp_bind_all_rpc_ports(xdm_t) depth: 3
#line 160
 	
#line 160
		 	 	
#line 160
##### begin corenet_udp_bind_all_rpc_ports(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute rpc_port_type;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t rpc_port_type:udp_socket name_bind;
#line 160
	allow xdm_t self:capability net_bind_service;
#line 160

#line 160
	 	
#line 160
##### end corenet_udp_bind_all_rpc_ports(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	}
#line 160

#line 160

#line 160
	 	
#line 160
##### end nis_authenticate(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	 	
#line 160
##### end auth_use_pam(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin init_rw_utmp(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type initrc_var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_list_pids(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_run_t:dir { getattr search open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_list_pids(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t initrc_var_run_t:file { getattr open read write append ioctl lock };
#line 160

#line 160
	 	
#line 160
##### end init_rw_utmp(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin logging_set_loginuid(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t self:capability audit_control;
#line 160
	allow xdm_t self:netlink_audit_socket { { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_relay };
#line 160

#line 160
	 	
#line 160
##### end logging_set_loginuid(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin logging_set_tty_audit(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t self:netlink_audit_socket { { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_tty_audit };
#line 160

#line 160
	 	
#line 160
##### end logging_set_tty_audit(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin seutil_read_config(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type selinux_config_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_etc(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type etc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t etc_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_etc(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t selinux_config_t:dir { getattr search open read lock ioctl };
#line 160
	
#line 160
	allow xdm_t selinux_config_t:dir { getattr search open };
#line 160
	allow xdm_t selinux_config_t:file { getattr open read lock ioctl };
#line 160

#line 160
	
#line 160
	allow xdm_t selinux_config_t:dir { getattr search open };
#line 160
	allow xdm_t selinux_config_t:lnk_file { getattr read };
#line 160

#line 160

#line 160
	 	
#line 160
##### end seutil_read_config(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin seutil_read_default_contexts(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type selinux_config_t, default_context_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin files_search_etc(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type etc_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t etc_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end files_search_etc(xdm_t) depth: 2
#line 160
 	
#line 160
	allow xdm_t selinux_config_t:dir { getattr search open };
#line 160
	allow xdm_t default_context_t:dir { getattr search open read lock ioctl };
#line 160
	
#line 160
	allow xdm_t default_context_t:dir { getattr search open };
#line 160
	allow xdm_t default_context_t:file { getattr open read lock ioctl };
#line 160

#line 160

#line 160
	 	
#line 160
##### end seutil_read_default_contexts(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin userdom_search_user_runtime(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type user_runtime_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t user_runtime_t:dir { getattr search open };
#line 160
	 	 	
#line 160
##### begin userdom_search_user_runtime_root(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type user_runtime_root_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t user_runtime_root_t:dir { getattr search open };
#line 160
	 	 	
#line 160
##### begin files_search_pids(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type var_t, var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 160
	
#line 160
	allow xdm_t var_t:dir { getattr search open };
#line 160
	allow xdm_t var_run_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end files_search_pids(xdm_t) depth: 3
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end userdom_search_user_runtime_root(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end userdom_search_user_runtime(xdm_t) depth: 1
#line 160
 	
#line 160
	 	 	
#line 160
##### begin userdom_read_user_tmpfs_files(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type user_tmpfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t user_tmpfs_t:dir { getattr search open };
#line 160
	allow xdm_t user_tmpfs_t:file { getattr open read lock ioctl };
#line 160

#line 160
	allow xdm_t user_tmpfs_t:dir { getattr search open read lock ioctl };
#line 160
	 	 	
#line 160
##### begin fs_search_tmpfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type tmpfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t tmpfs_t:dir { getattr search open };
#line 160

#line 160
	 	
#line 160
##### end fs_search_tmpfs(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	 	
#line 160
##### end userdom_read_user_tmpfs_files(xdm_t) depth: 1
#line 160
 	
#line 160

#line 160
	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		
#line 160
bool allow_polyinstantiation;
#line 160

#line 160
  
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160
	if (allow_polyinstantiation) {
#line 160
		
#line 160
		 	 	
#line 160
##### begin files_polyinstantiate_all(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		attribute polydir, polymember, polyparent;
#line 160
		type poly_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	# Need to give access to /selinux/member
#line 160
	 	 	
#line 160
##### begin selinux_compute_member(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type security_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	 	 	
#line 160
##### begin dev_search_sysfs(xdm_t) depth: 4
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type sysfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160
	allow xdm_t sysfs_t:dir { getattr search open };
#line 160

#line 160

#line 160
	 	
#line 160
##### end dev_search_sysfs(xdm_t) depth: 3
#line 160
 	
#line 160
	allow xdm_t security_t:dir { getattr search open read lock ioctl };
#line 160
	allow xdm_t security_t:file { getattr open read write append ioctl lock };
#line 160
	allow xdm_t security_t:security compute_member;
#line 160

#line 160
	 	
#line 160
##### end selinux_compute_member(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	# Need sys_admin capability for mounting
#line 160
	allow xdm_t self:capability { chown fsetid sys_admin fowner };
#line 160

#line 160
	# Need to give access to the directories to be polyinstantiated
#line 160
	allow xdm_t polydir:dir { create open getattr search write add_name setattr mounton rmdir };
#line 160

#line 160
	# Need to give access to the polyinstantiated subdirectories
#line 160
	allow xdm_t polymember:dir { getattr search open };
#line 160

#line 160
	# Need to give access to parent directories where original
#line 160
	# is remounted for polyinstantiation aware programs (like gdm)
#line 160
	allow xdm_t polyparent:dir { getattr mounton };
#line 160

#line 160
	# Need to give permission to create directories where applicable
#line 160
	allow xdm_t self:process setfscreate;
#line 160
	allow xdm_t polymember: dir { create setattr relabelto };
#line 160
	allow xdm_t polydir: dir { write add_name open };
#line 160
	allow xdm_t polyparent:dir { open read write remove_name add_name relabelfrom relabelto };
#line 160

#line 160
	# Default type for mountpoints
#line 160
	allow xdm_t poly_t:dir { create mounton };
#line 160
	 	 	
#line 160
##### begin fs_unmount_xattr_fs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type fs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t fs_t:filesystem unmount;
#line 160

#line 160
	 	
#line 160
##### end fs_unmount_xattr_fs(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	 	 	
#line 160
##### begin fs_mount_tmpfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type tmpfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t tmpfs_t:filesystem mount;
#line 160

#line 160
	 	
#line 160
##### end fs_mount_tmpfs(xdm_t) depth: 2
#line 160
 	
#line 160
	 	 	
#line 160
##### begin fs_unmount_tmpfs(xdm_t) depth: 3
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type tmpfs_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t tmpfs_t:filesystem unmount;
#line 160

#line 160
	 	
#line 160
##### end fs_unmount_tmpfs(xdm_t) depth: 2
#line 160
 	
#line 160

#line 160
	
#line 160

#line 160
	 	
#line 160
##### end files_polyinstantiate_all(xdm_t) depth: 1
#line 160
 	
#line 160
	
#line 160
	}
#line 160

#line 160

#line 160
	
#line 160
	optional {
#line 160
		
#line 160
		 	 	
#line 160
##### begin systemd_logind_read_process_state(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type systemd_logind_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow systemd_logind_t xdm_t:dir { getattr search open read lock ioctl };
#line 160
	allow systemd_logind_t xdm_t:file { getattr open read lock ioctl };
#line 160

#line 160
	 	
#line 160
##### end systemd_logind_read_process_state(xdm_t) depth: 1
#line 160
 	
#line 160
		 	 	
#line 160
##### begin systemd_write_inherited_logind_sessions_pipes(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
		type systemd_logind_t, systemd_sessions_var_run_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow xdm_t systemd_logind_t:fd use;
#line 160
	allow xdm_t systemd_sessions_var_run_t:fifo_file write;
#line 160
	allow systemd_logind_t xdm_t:process signal;
#line 160

#line 160
	 	
#line 160
##### end systemd_write_inherited_logind_sessions_pipes(xdm_t) depth: 1
#line 160
 	
#line 160
		 	 	
#line 160
##### begin systemd_passwd_agent_inherits_fd(xdm_t) depth: 2
#line 160
 	
#line 160
	
#line 160
	
#line 160
		require {
#line 160
			
#line 160
              type systemd_passwd_agent_t;
#line 160
	
#line 160
		} # end require
#line 160
	
#line 160

#line 160

#line 160
	allow systemd_passwd_agent_t xdm_t:fd use;
#line 160

#line 160
	 	
#line 160
##### end systemd_passwd_agent_inherits_fd(xdm_t) depth: 1
#line 160
 	
#line 160
	
#line 160
	} # end optional
#line 160

#line 160

#line 160
	 	
#line 160
##### end auth_login_pgm_domain(xdm_t) depth: 0
#line 160
 	
 	 	
#line 161
##### begin init_domain(xdm_t,xdm_exec_t) depth: 1
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type init_t;
#line 161
		role system_r;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	 	 	
#line 161
##### begin domain_type(xdm_t) depth: 2
#line 161
 	
#line 161
	# start with basic domain
#line 161
	 	 	
#line 161
##### begin domain_base_type(xdm_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		attribute domain;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	typeattribute xdm_t domain;
#line 161

#line 161
	 	
#line 161
##### end domain_base_type(xdm_t) depth: 2
#line 161
 	
#line 161

#line 161
	
#line 161

#line 161
	# send init a sigchld and signull
#line 161
	
#line 161
	optional {
#line 161
		
#line 161
		 	 	
#line 161
##### begin init_sigchld(xdm_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type init_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	allow xdm_t init_t:process sigchld;
#line 161

#line 161
	 	
#line 161
##### end init_sigchld(xdm_t) depth: 2
#line 161
 	
#line 161
		 	 	
#line 161
##### begin init_signull(xdm_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type init_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	allow xdm_t init_t:process signull;
#line 161

#line 161
	 	
#line 161
##### end init_signull(xdm_t) depth: 2
#line 161
 	
#line 161
	
#line 161
	} # end optional
#line 161

#line 161

#line 161
	# these seem questionable:
#line 161

#line 161
	
#line 161
	optional {
#line 161
		
#line 161
		 	 	
#line 161
##### begin rpm_use_fds(xdm_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type rpm_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	allow xdm_t rpm_t:fd use;
#line 161

#line 161
	 	
#line 161
##### end rpm_use_fds(xdm_t) depth: 2
#line 161
 	
#line 161
		 	 	
#line 161
##### begin rpm_read_pipes(xdm_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type rpm_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	allow xdm_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 161

#line 161
	 	
#line 161
##### end rpm_read_pipes(xdm_t) depth: 2
#line 161
 	
#line 161
	
#line 161
	} # end optional
#line 161

#line 161

#line 161
	
#line 161
	optional {
#line 161
		
#line 161
		 	 	
#line 161
##### begin selinux_dontaudit_getattr_fs(xdm_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type security_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	dontaudit xdm_t security_t:filesystem getattr;
#line 161

#line 161
	 	 	
#line 161
##### begin dev_dontaudit_getattr_sysfs(xdm_t) depth: 4
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type sysfs_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	dontaudit xdm_t sysfs_t:filesystem getattr;
#line 161

#line 161
	 	
#line 161
##### end dev_dontaudit_getattr_sysfs(xdm_t) depth: 3
#line 161
 	
#line 161
	 	 	
#line 161
##### begin dev_dontaudit_search_sysfs(xdm_t) depth: 4
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type sysfs_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	dontaudit xdm_t sysfs_t:dir { getattr search open };
#line 161

#line 161
	 	
#line 161
##### end dev_dontaudit_search_sysfs(xdm_t) depth: 3
#line 161
 	
#line 161

#line 161
	 	
#line 161
##### end selinux_dontaudit_getattr_fs(xdm_t) depth: 2
#line 161
 	
#line 161
		 	 	
#line 161
##### begin selinux_dontaudit_read_fs(xdm_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type security_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	dontaudit xdm_t security_t:dir { getattr search open };
#line 161
	dontaudit xdm_t security_t:file { getattr open read lock ioctl };
#line 161

#line 161
	 	
#line 161
##### end selinux_dontaudit_read_fs(xdm_t) depth: 2
#line 161
 	
#line 161
	
#line 161
	} # end optional
#line 161

#line 161

#line 161
	
#line 161
	optional {
#line 161
		
#line 161
		 	 	
#line 161
##### begin seutil_dontaudit_read_config(xdm_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type selinux_config_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	dontaudit xdm_t selinux_config_t:dir { getattr search open };
#line 161
	dontaudit xdm_t selinux_config_t:file { getattr open read lock ioctl };
#line 161

#line 161
	 	
#line 161
##### end seutil_dontaudit_read_config(xdm_t) depth: 2
#line 161
 	
#line 161
	
#line 161
	} # end optional
#line 161

#line 161

#line 161
	 	
#line 161
##### end domain_type(xdm_t) depth: 1
#line 161
 	
#line 161
	 	 	
#line 161
##### begin domain_entry_file(xdm_t,xdm_exec_t) depth: 2
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		attribute entry_type;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	allow xdm_t xdm_exec_t:file entrypoint;
#line 161
	allow xdm_t xdm_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 161

#line 161
	typeattribute xdm_exec_t entry_type;
#line 161

#line 161
	 	 	
#line 161
##### begin corecmd_executable_file(xdm_exec_t) depth: 3
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		attribute exec_type;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	typeattribute xdm_exec_t exec_type;
#line 161

#line 161
	 	 	
#line 161
##### begin files_type(xdm_exec_t) depth: 4
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	typeattribute xdm_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 161

#line 161
	 	
#line 161
##### end files_type(xdm_exec_t) depth: 3
#line 161
 	
#line 161

#line 161
	 	
#line 161
##### end corecmd_executable_file(xdm_exec_t) depth: 2
#line 161
 	
#line 161

#line 161
	 	
#line 161
##### end domain_entry_file(xdm_t,xdm_exec_t) depth: 1
#line 161
 	
#line 161

#line 161
	role system_r types xdm_t;
#line 161

#line 161
	
#line 161

#line 161
	
#line 161

#line 161
	 	
#line 161
##### end init_domain(xdm_t,xdm_exec_t) depth: 0
#line 161
 	
 	 	
#line 162
##### begin init_daemon_domain(xdm_t,xdm_exec_t) depth: 1
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type initrc_t;
#line 162
		type init_t;
#line 162
		role system_r;
#line 162
		attribute daemon;
#line 162
		attribute initrc_transition_domain;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	typeattribute xdm_t daemon;
#line 162

#line 162
	 	 	
#line 162
##### begin domain_type(xdm_t) depth: 2
#line 162
 	
#line 162
	# start with basic domain
#line 162
	 	 	
#line 162
##### begin domain_base_type(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		attribute domain;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	typeattribute xdm_t domain;
#line 162

#line 162
	 	
#line 162
##### end domain_base_type(xdm_t) depth: 2
#line 162
 	
#line 162

#line 162
	
#line 162

#line 162
	# send init a sigchld and signull
#line 162
	
#line 162
	optional {
#line 162
		
#line 162
		 	 	
#line 162
##### begin init_sigchld(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type init_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t init_t:process sigchld;
#line 162

#line 162
	 	
#line 162
##### end init_sigchld(xdm_t) depth: 2
#line 162
 	
#line 162
		 	 	
#line 162
##### begin init_signull(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type init_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t init_t:process signull;
#line 162

#line 162
	 	
#line 162
##### end init_signull(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	} # end optional
#line 162

#line 162

#line 162
	# these seem questionable:
#line 162

#line 162
	
#line 162
	optional {
#line 162
		
#line 162
		 	 	
#line 162
##### begin rpm_use_fds(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type rpm_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t rpm_t:fd use;
#line 162

#line 162
	 	
#line 162
##### end rpm_use_fds(xdm_t) depth: 2
#line 162
 	
#line 162
		 	 	
#line 162
##### begin rpm_read_pipes(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type rpm_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 162

#line 162
	 	
#line 162
##### end rpm_read_pipes(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	} # end optional
#line 162

#line 162

#line 162
	
#line 162
	optional {
#line 162
		
#line 162
		 	 	
#line 162
##### begin selinux_dontaudit_getattr_fs(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type security_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	dontaudit xdm_t security_t:filesystem getattr;
#line 162

#line 162
	 	 	
#line 162
##### begin dev_dontaudit_getattr_sysfs(xdm_t) depth: 4
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type sysfs_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	dontaudit xdm_t sysfs_t:filesystem getattr;
#line 162

#line 162
	 	
#line 162
##### end dev_dontaudit_getattr_sysfs(xdm_t) depth: 3
#line 162
 	
#line 162
	 	 	
#line 162
##### begin dev_dontaudit_search_sysfs(xdm_t) depth: 4
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type sysfs_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	dontaudit xdm_t sysfs_t:dir { getattr search open };
#line 162

#line 162
	 	
#line 162
##### end dev_dontaudit_search_sysfs(xdm_t) depth: 3
#line 162
 	
#line 162

#line 162
	 	
#line 162
##### end selinux_dontaudit_getattr_fs(xdm_t) depth: 2
#line 162
 	
#line 162
		 	 	
#line 162
##### begin selinux_dontaudit_read_fs(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type security_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	dontaudit xdm_t security_t:dir { getattr search open };
#line 162
	dontaudit xdm_t security_t:file { getattr open read lock ioctl };
#line 162

#line 162
	 	
#line 162
##### end selinux_dontaudit_read_fs(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	} # end optional
#line 162

#line 162

#line 162
	
#line 162
	optional {
#line 162
		
#line 162
		 	 	
#line 162
##### begin seutil_dontaudit_read_config(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type selinux_config_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	dontaudit xdm_t selinux_config_t:dir { getattr search open };
#line 162
	dontaudit xdm_t selinux_config_t:file { getattr open read lock ioctl };
#line 162

#line 162
	 	
#line 162
##### end seutil_dontaudit_read_config(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	} # end optional
#line 162

#line 162

#line 162
	 	
#line 162
##### end domain_type(xdm_t) depth: 1
#line 162
 	
#line 162
	 	 	
#line 162
##### begin domain_entry_file(xdm_t,xdm_exec_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		attribute entry_type;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t xdm_exec_t:file entrypoint;
#line 162
	allow xdm_t xdm_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 162

#line 162
	typeattribute xdm_exec_t entry_type;
#line 162

#line 162
	 	 	
#line 162
##### begin corecmd_executable_file(xdm_exec_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		attribute exec_type;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	typeattribute xdm_exec_t exec_type;
#line 162

#line 162
	 	 	
#line 162
##### begin files_type(xdm_exec_t) depth: 4
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	typeattribute xdm_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 162

#line 162
	 	
#line 162
##### end files_type(xdm_exec_t) depth: 3
#line 162
 	
#line 162

#line 162
	 	
#line 162
##### end corecmd_executable_file(xdm_exec_t) depth: 2
#line 162
 	
#line 162

#line 162
	 	
#line 162
##### end domain_entry_file(xdm_t,xdm_exec_t) depth: 1
#line 162
 	
#line 162

#line 162
	role system_r types xdm_t;
#line 162

#line 162
	
#line 162
	
#line 162
	
#line 162
	allow initrc_t xdm_exec_t:file { getattr open read execute };
#line 162
	allow initrc_t xdm_t:process transition;
#line 162
	dontaudit initrc_t xdm_t:process { noatsecure siginh rlimitinh };
#line 162

#line 162
	type_transition initrc_t xdm_exec_t:process xdm_t;
#line 162

#line 162

#line 162
	allow xdm_t initrc_t:fd use;
#line 162
	allow xdm_t initrc_t:fifo_file { open { getattr read write append ioctl lock } };
#line 162
	allow xdm_t initrc_t:process sigchld;
#line 162

#line 162

#line 162
	
#line 162

#line 162
	# daemons started from init will
#line 162
	# inherit fds from init for the console
#line 162
	 	 	
#line 162
##### begin init_dontaudit_use_fds(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type init_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	dontaudit xdm_t init_t:fd use;
#line 162

#line 162
	 	
#line 162
##### end init_dontaudit_use_fds(xdm_t) depth: 1
#line 162
 	
#line 162
	 	 	
#line 162
##### begin term_dontaudit_use_console(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type console_device_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	dontaudit xdm_t console_device_t:chr_file { getattr open read write append ioctl lock };
#line 162

#line 162
	 	
#line 162
##### end term_dontaudit_use_console(xdm_t) depth: 1
#line 162
 	
#line 162

#line 162
	# init script ptys are the stdin/out/err
#line 162
	# when using run_init
#line 162
	 	 	
#line 162
##### begin init_use_script_ptys(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type initrc_devpts_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	 	 	
#line 162
##### begin term_list_ptys(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type devpts_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	 	 	
#line 162
##### begin dev_list_all_dev_nodes(xdm_t) depth: 4
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type device_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	
#line 162
	allow xdm_t device_t:dir { getattr search open };
#line 162
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 162

#line 162
	
#line 162
	allow xdm_t device_t:dir { getattr search open };
#line 162
	allow xdm_t device_t:lnk_file { getattr read };
#line 162

#line 162

#line 162
	 	
#line 162
##### end dev_list_all_dev_nodes(xdm_t) depth: 3
#line 162
 	
#line 162
	allow xdm_t devpts_t:dir { getattr search open read lock ioctl };
#line 162

#line 162
	 	
#line 162
##### end term_list_ptys(xdm_t) depth: 2
#line 162
 	
#line 162
	allow xdm_t initrc_devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 162

#line 162
	 	
#line 162
##### end init_use_script_ptys(xdm_t) depth: 1
#line 162
 	
#line 162

#line 162
	
#line 162
		 	 	
#line 162
##### begin userdom_dontaudit_use_user_terminals(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type user_tty_device_t, user_devpts_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	dontaudit xdm_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 162
	dontaudit xdm_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 162

#line 162
	 	
#line 162
##### end userdom_dontaudit_use_user_terminals(xdm_t) depth: 1
#line 162
 	
#line 162
	
#line 162

#line 162
	
#line 162

#line 162
	
#line 162
	optional {
#line 162
		
#line 162
		 	 	
#line 162
##### begin nscd_use(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		
#line 162
bool nscd_use_shm;
#line 162

#line 162
  
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162
	if (nscd_use_shm) {
#line 162
		
#line 162
		 	 	
#line 162
##### begin nscd_shm_use(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type nscd_t, nscd_var_run_t;
#line 162
		class nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 162

#line 162
	allow xdm_t nscd_t:nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 162
	allow xdm_t nscd_t:fd use;
#line 162

#line 162
	 	 	
#line 162
##### begin files_search_pids(xdm_t) depth: 4
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type var_t, var_run_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 162
	
#line 162
	allow xdm_t var_t:dir { getattr search open };
#line 162
	allow xdm_t var_run_t:dir { getattr search open };
#line 162

#line 162

#line 162
	 	
#line 162
##### end files_search_pids(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	allow xdm_t nscd_var_run_t:dir { getattr search open };
#line 162
	allow xdm_t nscd_var_run_t:sock_file { getattr write open append };
#line 162
	allow xdm_t nscd_t:unix_stream_socket connectto;
#line 162

#line 162
	dontaudit xdm_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 162

#line 162
	allow xdm_t nscd_var_run_t:dir { getattr search open read lock ioctl };
#line 162
	allow xdm_t nscd_var_run_t:sock_file { getattr open read };
#line 162

#line 162
	 	
#line 162
##### end nscd_shm_use(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	} else {
#line 162
		
#line 162
		 	 	
#line 162
##### begin nscd_socket_use(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type nscd_t, nscd_var_run_t;
#line 162
		class nscd { getserv getpwd getgrp gethost shmempwd shmemgrp shmemhost shmemserv };
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 162

#line 162
	allow xdm_t nscd_t:nscd { getpwd getgrp gethost };
#line 162

#line 162
	dontaudit xdm_t nscd_t:fd use;
#line 162
	dontaudit xdm_t nscd_t:nscd { getserv shmempwd shmemgrp shmemhost shmemserv };
#line 162

#line 162
	 	 	
#line 162
##### begin files_search_pids(xdm_t) depth: 4
#line 162
 	
#line 162
	
#line 162
	
#line 162
		require {
#line 162
			
#line 162
		type var_t, var_run_t;
#line 162
	
#line 162
		} # end require
#line 162
	
#line 162

#line 162

#line 162
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 162
	
#line 162
	allow xdm_t var_t:dir { getattr search open };
#line 162
	allow xdm_t var_run_t:dir { getattr search open };
#line 162

#line 162

#line 162
	 	
#line 162
##### end files_search_pids(xdm_t) depth: 3
#line 162
 	
#line 162
	
#line 162
	allow xdm_t nscd_var_run_t:dir { getattr search open };
#line 162
	allow xdm_t nscd_var_run_t:sock_file { getattr write open append };
#line 162
	allow xdm_t nscd_t:unix_stream_socket connectto;
#line 162

#line 162
	dontaudit xdm_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 162

#line 162
	
#line 162
	allow nscd_t xdm_t:dir { getattr search open read lock ioctl };
#line 162
	allow nscd_t xdm_t:file { getattr open read lock ioctl };
#line 162
	allow nscd_t xdm_t:lnk_file { getattr read };
#line 162
	allow nscd_t xdm_t:process getattr;
#line 162

#line 162

#line 162
	 	
#line 162
##### end nscd_socket_use(xdm_t) depth: 2
#line 162
 	
#line 162
	
#line 162
	}
#line 162

#line 162

#line 162
	 	
#line 162
##### end nscd_use(xdm_t) depth: 1
#line 162
 	
#line 162
	
#line 162
	} # end optional
#line 162

#line 162

#line 162
	 	
#line 162
##### end init_daemon_domain(xdm_t,xdm_exec_t) depth: 0
#line 162
 	
 	 	
#line 163
##### begin xserver_object_types_template(xdm) depth: 1
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		attribute xproperty_type, input_xevent_type, xevent_type;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	##############################
#line 163
	#
#line 163
	# Declarations
#line 163
	#
#line 163

#line 163
	# Types for properties
#line 163
	type xdm_xproperty_t, xproperty_type;
#line 163
	 	 	
#line 163
##### begin ubac_constrained(xdm_xproperty_t) depth: 2
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		attribute ubac_constrained_type;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	typeattribute xdm_xproperty_t ubac_constrained_type;
#line 163

#line 163
	 	
#line 163
##### end ubac_constrained(xdm_xproperty_t) depth: 1
#line 163
 	
#line 163

#line 163
	# Types for events
#line 163
	type xdm_input_xevent_t, input_xevent_type, xevent_type;
#line 163
	 	 	
#line 163
##### begin ubac_constrained(xdm_input_xevent_t) depth: 2
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		attribute ubac_constrained_type;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	typeattribute xdm_input_xevent_t ubac_constrained_type;
#line 163

#line 163
	 	
#line 163
##### end ubac_constrained(xdm_input_xevent_t) depth: 1
#line 163
 	
#line 163
 	 	
#line 163
##### end xserver_object_types_template(xdm) depth: 0
#line 163
 	
 	 	
#line 164
##### begin xserver_common_x_domain_template(xdm,xdm_t) depth: 1
#line 164
 	
#line 164
	
#line 164
	
#line 164
		require {
#line 164
			
#line 164
		type root_xdrawable_t;
#line 164
		type xproperty_t, xdm_xproperty_t;
#line 164
		type xevent_t, client_xevent_t;
#line 164
		type input_xevent_t, xdm_input_xevent_t;
#line 164

#line 164
		attribute x_domain;
#line 164
		attribute xdrawable_type, xcolormap_type;
#line 164
		attribute input_xevent_type;
#line 164

#line 164
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 164
		class x_property { create destroy read write append getattr setattr };
#line 164
		class x_event { send receive };
#line 164
		class x_synthetic_event { send receive };
#line 164
	
#line 164
		} # end require
#line 164
	
#line 164

#line 164

#line 164
	##############################
#line 164
	#
#line 164
	# Local Policy
#line 164
	#
#line 164

#line 164
	# Type attributes
#line 164
	typeattribute xdm_t x_domain;
#line 164
	typeattribute xdm_t xdrawable_type, xcolormap_type;
#line 164

#line 164
	# X Properties
#line 164
	# disable property transitions for the time being.
#line 164
#	type_transition xdm_t xproperty_t:x_property xdm_xproperty_t;
#line 164

#line 164
	# X Windows
#line 164
	# new windows have the domain type
#line 164
	type_transition xdm_t root_xdrawable_t:x_drawable xdm_t;
#line 164

#line 164
	# X Input
#line 164
	# distinguish input events
#line 164
	type_transition xdm_t input_xevent_t:x_event xdm_input_xevent_t;
#line 164
	# can send own events
#line 164
	allow xdm_t xdm_input_xevent_t:{ x_event x_synthetic_event } send;
#line 164
	# can receive own events
#line 164
	allow xdm_t xdm_input_xevent_t:{ x_event x_synthetic_event } receive;
#line 164
	# can receive default events
#line 164
	allow xdm_t client_xevent_t:{ x_event x_synthetic_event } receive;
#line 164
	allow xdm_t xevent_t:{ x_event x_synthetic_event } receive;
#line 164
	# dont audit send failures
#line 164
	dontaudit xdm_t input_xevent_type:x_event send;
#line 164
 	 	
#line 164
##### end xserver_common_x_domain_template(xdm,xdm_t) depth: 0
#line 164
 	

type xdm_lock_t;
 	 	
#line 167
##### begin files_lock_file(xdm_lock_t) depth: 1
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		attribute lockfile;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	 	 	
#line 167
##### begin files_type(xdm_lock_t) depth: 2
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	typeattribute xdm_lock_t file_type, non_security_file_type, non_auth_file_type;
#line 167

#line 167
	 	
#line 167
##### end files_type(xdm_lock_t) depth: 1
#line 167
 	
#line 167
	typeattribute xdm_lock_t lockfile;
#line 167

#line 167
	 	
#line 167
##### end files_lock_file(xdm_lock_t) depth: 0
#line 167
 	

type xdm_rw_etc_t;
 	 	
#line 170
##### begin files_type(xdm_rw_etc_t) depth: 1
#line 170
 	
#line 170
	
#line 170
	
#line 170
		require {
#line 170
			
#line 170
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 170
	
#line 170
		} # end require
#line 170
	
#line 170

#line 170

#line 170
	typeattribute xdm_rw_etc_t file_type, non_security_file_type, non_auth_file_type;
#line 170

#line 170
	 	
#line 170
##### end files_type(xdm_rw_etc_t) depth: 0
#line 170
 	

type xdm_var_lib_t;
 	 	
#line 173
##### begin files_type(xdm_var_lib_t) depth: 1
#line 173
 	
#line 173
	
#line 173
	
#line 173
		require {
#line 173
			
#line 173
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 173
	
#line 173
		} # end require
#line 173
	
#line 173

#line 173

#line 173
	typeattribute xdm_var_lib_t file_type, non_security_file_type, non_auth_file_type;
#line 173

#line 173
	 	
#line 173
##### end files_type(xdm_var_lib_t) depth: 0
#line 173
 	

type xdm_var_run_t;
 	 	
#line 176
##### begin files_pid_file(xdm_var_run_t) depth: 1
#line 176
 	
#line 176
	
#line 176
	
#line 176
		require {
#line 176
			
#line 176
		attribute pidfile;
#line 176
	
#line 176
		} # end require
#line 176
	
#line 176

#line 176

#line 176
	 	 	
#line 176
##### begin files_type(xdm_var_run_t) depth: 2
#line 176
 	
#line 176
	
#line 176
	
#line 176
		require {
#line 176
			
#line 176
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 176
	
#line 176
		} # end require
#line 176
	
#line 176

#line 176

#line 176
	typeattribute xdm_var_run_t file_type, non_security_file_type, non_auth_file_type;
#line 176

#line 176
	 	
#line 176
##### end files_type(xdm_var_run_t) depth: 1
#line 176
 	
#line 176
	typeattribute xdm_var_run_t pidfile;
#line 176

#line 176
	 	
#line 176
##### end files_pid_file(xdm_var_run_t) depth: 0
#line 176
 	

type xdm_tmp_t;
 	 	
#line 179
##### begin files_tmp_file(xdm_tmp_t) depth: 1
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		attribute tmpfile;
#line 179
		type tmp_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin files_type(xdm_tmp_t) depth: 2
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	typeattribute xdm_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 179

#line 179
	 	
#line 179
##### end files_type(xdm_tmp_t) depth: 1
#line 179
 	
#line 179
	 	 	
#line 179
##### begin files_poly_member(xdm_tmp_t) depth: 2
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		attribute polymember;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin files_type(xdm_tmp_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	typeattribute xdm_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 179

#line 179
	 	
#line 179
##### end files_type(xdm_tmp_t) depth: 2
#line 179
 	
#line 179
	typeattribute xdm_tmp_t polymember;
#line 179

#line 179
	 	
#line 179
##### end files_poly_member(xdm_tmp_t) depth: 1
#line 179
 	
#line 179
	typeattribute xdm_tmp_t tmpfile;
#line 179

#line 179
	 	
#line 179
##### end files_tmp_file(xdm_tmp_t) depth: 0
#line 179
 	
typealias xdm_tmp_t alias ice_tmp_t;

type xdm_tmpfs_t;
 	 	
#line 183
##### begin files_tmpfs_file(xdm_tmpfs_t) depth: 1
#line 183
 	
#line 183
	
#line 183
	
#line 183
		require {
#line 183
			
#line 183
		attribute tmpfsfile;
#line 183
	
#line 183
		} # end require
#line 183
	
#line 183

#line 183

#line 183
	 	 	
#line 183
##### begin files_type(xdm_tmpfs_t) depth: 2
#line 183
 	
#line 183
	
#line 183
	
#line 183
		require {
#line 183
			
#line 183
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 183
	
#line 183
		} # end require
#line 183
	
#line 183

#line 183

#line 183
	typeattribute xdm_tmpfs_t file_type, non_security_file_type, non_auth_file_type;
#line 183

#line 183
	 	
#line 183
##### end files_type(xdm_tmpfs_t) depth: 1
#line 183
 	
#line 183
	typeattribute xdm_tmpfs_t tmpfsfile;
#line 183

#line 183
	 	
#line 183
##### end files_tmpfs_file(xdm_tmpfs_t) depth: 0
#line 183
 	

# type for /var/lib/xkb
type xkb_var_lib_t;
 	 	
#line 187
##### begin files_type(xkb_var_lib_t) depth: 1
#line 187
 	
#line 187
	
#line 187
	
#line 187
		require {
#line 187
			
#line 187
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 187
	
#line 187
		} # end require
#line 187
	
#line 187

#line 187

#line 187
	typeattribute xkb_var_lib_t file_type, non_security_file_type, non_auth_file_type;
#line 187

#line 187
	 	
#line 187
##### end files_type(xkb_var_lib_t) depth: 0
#line 187
 	

# Type for the executable used to start the X server, e.g. Xwrapper.
type xserver_t;
type xserver_exec_t;
typealias xserver_t alias { user_xserver_t staff_xserver_t sysadm_xserver_t };
typealias xserver_t alias { auditadm_xserver_t secadm_xserver_t xdm_xserver_t };
 	 	
#line 194
##### begin init_system_domain(xserver_t,xserver_exec_t) depth: 1
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type initrc_t;
#line 194
		role system_r;
#line 194
		attribute systemprocess;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	typeattribute xserver_t systemprocess;
#line 194
	 	 	
#line 194
##### begin application_domain(xserver_t,xserver_exec_t) depth: 2
#line 194
 	
#line 194
	 	 	
#line 194
##### begin application_type(xserver_t) depth: 3
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		attribute application_domain_type;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	typeattribute xserver_t application_domain_type;
#line 194

#line 194
	# start with basic domain
#line 194
	 	 	
#line 194
##### begin domain_type(xserver_t) depth: 4
#line 194
 	
#line 194
	# start with basic domain
#line 194
	 	 	
#line 194
##### begin domain_base_type(xserver_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		attribute domain;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	typeattribute xserver_t domain;
#line 194

#line 194
	 	
#line 194
##### end domain_base_type(xserver_t) depth: 4
#line 194
 	
#line 194

#line 194
	
#line 194

#line 194
	# send init a sigchld and signull
#line 194
	
#line 194
	optional {
#line 194
		
#line 194
		 	 	
#line 194
##### begin init_sigchld(xserver_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type init_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	allow xserver_t init_t:process sigchld;
#line 194

#line 194
	 	
#line 194
##### end init_sigchld(xserver_t) depth: 4
#line 194
 	
#line 194
		 	 	
#line 194
##### begin init_signull(xserver_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type init_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	allow xserver_t init_t:process signull;
#line 194

#line 194
	 	
#line 194
##### end init_signull(xserver_t) depth: 4
#line 194
 	
#line 194
	
#line 194
	} # end optional
#line 194

#line 194

#line 194
	# these seem questionable:
#line 194

#line 194
	
#line 194
	optional {
#line 194
		
#line 194
		 	 	
#line 194
##### begin rpm_use_fds(xserver_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type rpm_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	allow xserver_t rpm_t:fd use;
#line 194

#line 194
	 	
#line 194
##### end rpm_use_fds(xserver_t) depth: 4
#line 194
 	
#line 194
		 	 	
#line 194
##### begin rpm_read_pipes(xserver_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type rpm_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	allow xserver_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 194

#line 194
	 	
#line 194
##### end rpm_read_pipes(xserver_t) depth: 4
#line 194
 	
#line 194
	
#line 194
	} # end optional
#line 194

#line 194

#line 194
	
#line 194
	optional {
#line 194
		
#line 194
		 	 	
#line 194
##### begin selinux_dontaudit_getattr_fs(xserver_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type security_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	dontaudit xserver_t security_t:filesystem getattr;
#line 194

#line 194
	 	 	
#line 194
##### begin dev_dontaudit_getattr_sysfs(xserver_t) depth: 6
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type sysfs_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	dontaudit xserver_t sysfs_t:filesystem getattr;
#line 194

#line 194
	 	
#line 194
##### end dev_dontaudit_getattr_sysfs(xserver_t) depth: 5
#line 194
 	
#line 194
	 	 	
#line 194
##### begin dev_dontaudit_search_sysfs(xserver_t) depth: 6
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type sysfs_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	dontaudit xserver_t sysfs_t:dir { getattr search open };
#line 194

#line 194
	 	
#line 194
##### end dev_dontaudit_search_sysfs(xserver_t) depth: 5
#line 194
 	
#line 194

#line 194
	 	
#line 194
##### end selinux_dontaudit_getattr_fs(xserver_t) depth: 4
#line 194
 	
#line 194
		 	 	
#line 194
##### begin selinux_dontaudit_read_fs(xserver_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type security_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	dontaudit xserver_t security_t:dir { getattr search open };
#line 194
	dontaudit xserver_t security_t:file { getattr open read lock ioctl };
#line 194

#line 194
	 	
#line 194
##### end selinux_dontaudit_read_fs(xserver_t) depth: 4
#line 194
 	
#line 194
	
#line 194
	} # end optional
#line 194

#line 194

#line 194
	
#line 194
	optional {
#line 194
		
#line 194
		 	 	
#line 194
##### begin seutil_dontaudit_read_config(xserver_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		type selinux_config_t;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	dontaudit xserver_t selinux_config_t:dir { getattr search open };
#line 194
	dontaudit xserver_t selinux_config_t:file { getattr open read lock ioctl };
#line 194

#line 194
	 	
#line 194
##### end seutil_dontaudit_read_config(xserver_t) depth: 4
#line 194
 	
#line 194
	
#line 194
	} # end optional
#line 194

#line 194

#line 194
	 	
#line 194
##### end domain_type(xserver_t) depth: 3
#line 194
 	
#line 194

#line 194
	 	
#line 194
##### end application_type(xserver_t) depth: 2
#line 194
 	
#line 194
	 	 	
#line 194
##### begin application_executable_file(xserver_exec_t) depth: 3
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		attribute application_exec_type;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	typeattribute xserver_exec_t application_exec_type;
#line 194

#line 194
	 	 	
#line 194
##### begin corecmd_executable_file(xserver_exec_t) depth: 4
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		attribute exec_type;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	typeattribute xserver_exec_t exec_type;
#line 194

#line 194
	 	 	
#line 194
##### begin files_type(xserver_exec_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	typeattribute xserver_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 194

#line 194
	 	
#line 194
##### end files_type(xserver_exec_t) depth: 4
#line 194
 	
#line 194

#line 194
	 	
#line 194
##### end corecmd_executable_file(xserver_exec_t) depth: 3
#line 194
 	
#line 194

#line 194
	 	
#line 194
##### end application_executable_file(xserver_exec_t) depth: 2
#line 194
 	
#line 194
	 	 	
#line 194
##### begin domain_entry_file(xserver_t,xserver_exec_t) depth: 3
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		attribute entry_type;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	allow xserver_t xserver_exec_t:file entrypoint;
#line 194
	allow xserver_t xserver_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 194

#line 194
	typeattribute xserver_exec_t entry_type;
#line 194

#line 194
	 	 	
#line 194
##### begin corecmd_executable_file(xserver_exec_t) depth: 4
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		attribute exec_type;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	typeattribute xserver_exec_t exec_type;
#line 194

#line 194
	 	 	
#line 194
##### begin files_type(xserver_exec_t) depth: 5
#line 194
 	
#line 194
	
#line 194
	
#line 194
		require {
#line 194
			
#line 194
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 194
	
#line 194
		} # end require
#line 194
	
#line 194

#line 194

#line 194
	typeattribute xserver_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 194

#line 194
	 	
#line 194
##### end files_type(xserver_exec_t) depth: 4
#line 194
 	
#line 194

#line 194
	 	
#line 194
##### end corecmd_executable_file(xserver_exec_t) depth: 3
#line 194
 	
#line 194

#line 194
	 	
#line 194
##### end domain_entry_file(xserver_t,xserver_exec_t) depth: 2
#line 194
 	
#line 194

#line 194
	 	
#line 194
##### end application_domain(xserver_t,xserver_exec_t) depth: 1
#line 194
 	
#line 194

#line 194
	role system_r types xserver_t;
#line 194

#line 194
	
#line 194
	
#line 194
	
#line 194
	allow initrc_t xserver_exec_t:file { getattr open read execute };
#line 194
	allow initrc_t xserver_t:process transition;
#line 194
	dontaudit initrc_t xserver_t:process { noatsecure siginh rlimitinh };
#line 194

#line 194
	type_transition initrc_t xserver_exec_t:process xserver_t;
#line 194

#line 194

#line 194
	allow xserver_t initrc_t:fd use;
#line 194
	allow xserver_t initrc_t:fifo_file { open { getattr read write append ioctl lock } };
#line 194
	allow xserver_t initrc_t:process sigchld;
#line 194

#line 194

#line 194
	
#line 194

#line 194
	 	
#line 194
##### end init_system_domain(xserver_t,xserver_exec_t) depth: 0
#line 194
 	
 	 	
#line 195
##### begin ubac_constrained(xserver_t) depth: 1
#line 195
 	
#line 195
	
#line 195
	
#line 195
		require {
#line 195
			
#line 195
		attribute ubac_constrained_type;
#line 195
	
#line 195
		} # end require
#line 195
	
#line 195

#line 195

#line 195
	typeattribute xserver_t ubac_constrained_type;
#line 195

#line 195
	 	
#line 195
##### end ubac_constrained(xserver_t) depth: 0
#line 195
 	

type xserver_tmp_t;
typealias xserver_tmp_t alias { user_xserver_tmp_t staff_xserver_tmp_t sysadm_xserver_tmp_t };
typealias xserver_tmp_t alias { auditadm_xserver_tmp_t secadm_xserver_tmp_t xdm_xserver_tmp_t };
 	 	
#line 200
##### begin userdom_user_tmp_file(xserver_tmp_t) depth: 1
#line 200
 	
#line 200
	 	 	
#line 200
##### begin files_tmp_file(xserver_tmp_t) depth: 2
#line 200
 	
#line 200
	
#line 200
	
#line 200
		require {
#line 200
			
#line 200
		attribute tmpfile;
#line 200
		type tmp_t;
#line 200
	
#line 200
		} # end require
#line 200
	
#line 200

#line 200

#line 200
	 	 	
#line 200
##### begin files_type(xserver_tmp_t) depth: 3
#line 200
 	
#line 200
	
#line 200
	
#line 200
		require {
#line 200
			
#line 200
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 200
	
#line 200
		} # end require
#line 200
	
#line 200

#line 200

#line 200
	typeattribute xserver_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 200

#line 200
	 	
#line 200
##### end files_type(xserver_tmp_t) depth: 2
#line 200
 	
#line 200
	 	 	
#line 200
##### begin files_poly_member(xserver_tmp_t) depth: 3
#line 200
 	
#line 200
	
#line 200
	
#line 200
		require {
#line 200
			
#line 200
		attribute polymember;
#line 200
	
#line 200
		} # end require
#line 200
	
#line 200

#line 200

#line 200
	 	 	
#line 200
##### begin files_type(xserver_tmp_t) depth: 4
#line 200
 	
#line 200
	
#line 200
	
#line 200
		require {
#line 200
			
#line 200
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 200
	
#line 200
		} # end require
#line 200
	
#line 200

#line 200

#line 200
	typeattribute xserver_tmp_t file_type, non_security_file_type, non_auth_file_type;
#line 200

#line 200
	 	
#line 200
##### end files_type(xserver_tmp_t) depth: 3
#line 200
 	
#line 200
	typeattribute xserver_tmp_t polymember;
#line 200

#line 200
	 	
#line 200
##### end files_poly_member(xserver_tmp_t) depth: 2
#line 200
 	
#line 200
	typeattribute xserver_tmp_t tmpfile;
#line 200

#line 200
	 	
#line 200
##### end files_tmp_file(xserver_tmp_t) depth: 1
#line 200
 	
#line 200
	 	 	
#line 200
##### begin ubac_constrained(xserver_tmp_t) depth: 2
#line 200
 	
#line 200
	
#line 200
	
#line 200
		require {
#line 200
			
#line 200
		attribute ubac_constrained_type;
#line 200
	
#line 200
		} # end require
#line 200
	
#line 200

#line 200

#line 200
	typeattribute xserver_tmp_t ubac_constrained_type;
#line 200

#line 200
	 	
#line 200
##### end ubac_constrained(xserver_tmp_t) depth: 1
#line 200
 	
#line 200

#line 200
	 	
#line 200
##### end userdom_user_tmp_file(xserver_tmp_t) depth: 0
#line 200
 	

type xserver_tmpfs_t;
typealias xserver_tmpfs_t alias { user_xserver_tmpfs_t staff_xserver_tmpfs_t sysadm_xserver_tmpfs_t };
typealias xserver_tmpfs_t alias { auditadm_xserver_tmpfs_t secadm_xserver_tmpfs_t xdm_xserver_tmpfs_t };
 	 	
#line 205
##### begin userdom_user_tmpfs_file(xserver_tmpfs_t) depth: 1
#line 205
 	
#line 205
	 	 	
#line 205
##### begin files_tmpfs_file(xserver_tmpfs_t) depth: 2
#line 205
 	
#line 205
	
#line 205
	
#line 205
		require {
#line 205
			
#line 205
		attribute tmpfsfile;
#line 205
	
#line 205
		} # end require
#line 205
	
#line 205

#line 205

#line 205
	 	 	
#line 205
##### begin files_type(xserver_tmpfs_t) depth: 3
#line 205
 	
#line 205
	
#line 205
	
#line 205
		require {
#line 205
			
#line 205
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 205
	
#line 205
		} # end require
#line 205
	
#line 205

#line 205

#line 205
	typeattribute xserver_tmpfs_t file_type, non_security_file_type, non_auth_file_type;
#line 205

#line 205
	 	
#line 205
##### end files_type(xserver_tmpfs_t) depth: 2
#line 205
 	
#line 205
	typeattribute xserver_tmpfs_t tmpfsfile;
#line 205

#line 205
	 	
#line 205
##### end files_tmpfs_file(xserver_tmpfs_t) depth: 1
#line 205
 	
#line 205
	 	 	
#line 205
##### begin ubac_constrained(xserver_tmpfs_t) depth: 2
#line 205
 	
#line 205
	
#line 205
	
#line 205
		require {
#line 205
			
#line 205
		attribute ubac_constrained_type;
#line 205
	
#line 205
		} # end require
#line 205
	
#line 205

#line 205

#line 205
	typeattribute xserver_tmpfs_t ubac_constrained_type;
#line 205

#line 205
	 	
#line 205
##### end ubac_constrained(xserver_tmpfs_t) depth: 1
#line 205
 	
#line 205

#line 205
	 	
#line 205
##### end userdom_user_tmpfs_file(xserver_tmpfs_t) depth: 0
#line 205
 	

type xsession_exec_t;
 	 	
#line 208
##### begin corecmd_executable_file(xsession_exec_t) depth: 1
#line 208
 	
#line 208
	
#line 208
	
#line 208
		require {
#line 208
			
#line 208
		attribute exec_type;
#line 208
	
#line 208
		} # end require
#line 208
	
#line 208

#line 208

#line 208
	typeattribute xsession_exec_t exec_type;
#line 208

#line 208
	 	 	
#line 208
##### begin files_type(xsession_exec_t) depth: 2
#line 208
 	
#line 208
	
#line 208
	
#line 208
		require {
#line 208
			
#line 208
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 208
	
#line 208
		} # end require
#line 208
	
#line 208

#line 208

#line 208
	typeattribute xsession_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 208

#line 208
	 	
#line 208
##### end files_type(xsession_exec_t) depth: 1
#line 208
 	
#line 208

#line 208
	 	
#line 208
##### end corecmd_executable_file(xsession_exec_t) depth: 0
#line 208
 	

# Type for the X server log file.
type xserver_log_t;
 	 	
#line 212
##### begin logging_log_file(xserver_log_t) depth: 1
#line 212
 	
#line 212
	
#line 212
	
#line 212
		require {
#line 212
			
#line 212
		attribute logfile;
#line 212
	
#line 212
		} # end require
#line 212
	
#line 212

#line 212

#line 212
	 	 	
#line 212
##### begin files_type(xserver_log_t) depth: 2
#line 212
 	
#line 212
	
#line 212
	
#line 212
		require {
#line 212
			
#line 212
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 212
	
#line 212
		} # end require
#line 212
	
#line 212

#line 212

#line 212
	typeattribute xserver_log_t file_type, non_security_file_type, non_auth_file_type;
#line 212

#line 212
	 	
#line 212
##### end files_type(xserver_log_t) depth: 1
#line 212
 	
#line 212
	 	 	
#line 212
##### begin files_associate_tmp(xserver_log_t) depth: 2
#line 212
 	
#line 212
	
#line 212
	
#line 212
		require {
#line 212
			
#line 212
		type tmp_t;
#line 212
	
#line 212
		} # end require
#line 212
	
#line 212

#line 212

#line 212
	allow xserver_log_t tmp_t:filesystem associate;
#line 212

#line 212
	 	
#line 212
##### end files_associate_tmp(xserver_log_t) depth: 1
#line 212
 	
#line 212
	 	 	
#line 212
##### begin fs_associate_tmpfs(xserver_log_t) depth: 2
#line 212
 	
#line 212
	
#line 212
	
#line 212
		require {
#line 212
			
#line 212
		type tmpfs_t;
#line 212
	
#line 212
		} # end require
#line 212
	
#line 212

#line 212

#line 212
	allow xserver_log_t tmpfs_t:filesystem associate;
#line 212

#line 212
	 	
#line 212
##### end fs_associate_tmpfs(xserver_log_t) depth: 1
#line 212
 	
#line 212
	typeattribute xserver_log_t logfile;
#line 212

#line 212
	 	
#line 212
##### end logging_log_file(xserver_log_t) depth: 0
#line 212
 	


#line 214
	 	 	
#line 214
##### begin init_ranged_domain(xdm_t,xdm_exec_t,s0 - s0:c0.c1023) depth: 1
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type init_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	 	 	
#line 214
##### begin init_domain(xdm_t,xdm_exec_t) depth: 2
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type init_t;
#line 214
		role system_r;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	 	 	
#line 214
##### begin domain_type(xdm_t) depth: 3
#line 214
 	
#line 214
	# start with basic domain
#line 214
	 	 	
#line 214
##### begin domain_base_type(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		attribute domain;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	typeattribute xdm_t domain;
#line 214

#line 214
	 	
#line 214
##### end domain_base_type(xdm_t) depth: 3
#line 214
 	
#line 214

#line 214
	
#line 214

#line 214
	# send init a sigchld and signull
#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin init_sigchld(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type init_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t init_t:process sigchld;
#line 214

#line 214
	 	
#line 214
##### end init_sigchld(xdm_t) depth: 3
#line 214
 	
#line 214
		 	 	
#line 214
##### begin init_signull(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type init_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t init_t:process signull;
#line 214

#line 214
	 	
#line 214
##### end init_signull(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	# these seem questionable:
#line 214

#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin rpm_use_fds(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type rpm_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t rpm_t:fd use;
#line 214

#line 214
	 	
#line 214
##### end rpm_use_fds(xdm_t) depth: 3
#line 214
 	
#line 214
		 	 	
#line 214
##### begin rpm_read_pipes(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type rpm_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 214

#line 214
	 	
#line 214
##### end rpm_read_pipes(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin selinux_dontaudit_getattr_fs(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type security_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t security_t:filesystem getattr;
#line 214

#line 214
	 	 	
#line 214
##### begin dev_dontaudit_getattr_sysfs(xdm_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type sysfs_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t sysfs_t:filesystem getattr;
#line 214

#line 214
	 	
#line 214
##### end dev_dontaudit_getattr_sysfs(xdm_t) depth: 4
#line 214
 	
#line 214
	 	 	
#line 214
##### begin dev_dontaudit_search_sysfs(xdm_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type sysfs_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t sysfs_t:dir { getattr search open };
#line 214

#line 214
	 	
#line 214
##### end dev_dontaudit_search_sysfs(xdm_t) depth: 4
#line 214
 	
#line 214

#line 214
	 	
#line 214
##### end selinux_dontaudit_getattr_fs(xdm_t) depth: 3
#line 214
 	
#line 214
		 	 	
#line 214
##### begin selinux_dontaudit_read_fs(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type security_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t security_t:dir { getattr search open };
#line 214
	dontaudit xdm_t security_t:file { getattr open read lock ioctl };
#line 214

#line 214
	 	
#line 214
##### end selinux_dontaudit_read_fs(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin seutil_dontaudit_read_config(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type selinux_config_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t selinux_config_t:dir { getattr search open };
#line 214
	dontaudit xdm_t selinux_config_t:file { getattr open read lock ioctl };
#line 214

#line 214
	 	
#line 214
##### end seutil_dontaudit_read_config(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	 	
#line 214
##### end domain_type(xdm_t) depth: 2
#line 214
 	
#line 214
	 	 	
#line 214
##### begin domain_entry_file(xdm_t,xdm_exec_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		attribute entry_type;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t xdm_exec_t:file entrypoint;
#line 214
	allow xdm_t xdm_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 214

#line 214
	typeattribute xdm_exec_t entry_type;
#line 214

#line 214
	 	 	
#line 214
##### begin corecmd_executable_file(xdm_exec_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		attribute exec_type;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	typeattribute xdm_exec_t exec_type;
#line 214

#line 214
	 	 	
#line 214
##### begin files_type(xdm_exec_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	typeattribute xdm_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 214

#line 214
	 	
#line 214
##### end files_type(xdm_exec_t) depth: 4
#line 214
 	
#line 214

#line 214
	 	
#line 214
##### end corecmd_executable_file(xdm_exec_t) depth: 3
#line 214
 	
#line 214

#line 214
	 	
#line 214
##### end domain_entry_file(xdm_t,xdm_exec_t) depth: 2
#line 214
 	
#line 214

#line 214
	role system_r types xdm_t;
#line 214

#line 214
	
#line 214

#line 214
	
#line 214

#line 214
	 	
#line 214
##### end init_domain(xdm_t,xdm_exec_t) depth: 1
#line 214
 	
#line 214

#line 214
	
#line 214
		range_transition init_t xdm_exec_t:process s0 - s0:c0.c1023;
#line 214
		range_transition initrc_t xdm_exec_t:process s0 - s0:c0.c1023;
#line 214
	
#line 214

#line 214
	
#line 214

#line 214
	 	
#line 214
##### end init_ranged_domain(xdm_t,xdm_exec_t,s0 - s0:c0.c1023) depth: 0
#line 214
 	
#line 214
	 	 	
#line 214
##### begin init_ranged_daemon_domain(xdm_t,xdm_exec_t,s0 - s0:c0.c1023) depth: 1
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type initrc_t;
#line 214
		type init_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	
#line 214
		 	 	
#line 214
##### begin init_daemon_domain(xdm_t,xdm_exec_t) depth: 2
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type initrc_t;
#line 214
		type init_t;
#line 214
		role system_r;
#line 214
		attribute daemon;
#line 214
		attribute initrc_transition_domain;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	typeattribute xdm_t daemon;
#line 214

#line 214
	 	 	
#line 214
##### begin domain_type(xdm_t) depth: 3
#line 214
 	
#line 214
	# start with basic domain
#line 214
	 	 	
#line 214
##### begin domain_base_type(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		attribute domain;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	typeattribute xdm_t domain;
#line 214

#line 214
	 	
#line 214
##### end domain_base_type(xdm_t) depth: 3
#line 214
 	
#line 214

#line 214
	
#line 214

#line 214
	# send init a sigchld and signull
#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin init_sigchld(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type init_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t init_t:process sigchld;
#line 214

#line 214
	 	
#line 214
##### end init_sigchld(xdm_t) depth: 3
#line 214
 	
#line 214
		 	 	
#line 214
##### begin init_signull(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type init_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t init_t:process signull;
#line 214

#line 214
	 	
#line 214
##### end init_signull(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	# these seem questionable:
#line 214

#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin rpm_use_fds(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type rpm_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t rpm_t:fd use;
#line 214

#line 214
	 	
#line 214
##### end rpm_use_fds(xdm_t) depth: 3
#line 214
 	
#line 214
		 	 	
#line 214
##### begin rpm_read_pipes(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type rpm_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t rpm_t:fifo_file { getattr open read lock ioctl };
#line 214

#line 214
	 	
#line 214
##### end rpm_read_pipes(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin selinux_dontaudit_getattr_fs(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type security_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t security_t:filesystem getattr;
#line 214

#line 214
	 	 	
#line 214
##### begin dev_dontaudit_getattr_sysfs(xdm_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type sysfs_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t sysfs_t:filesystem getattr;
#line 214

#line 214
	 	
#line 214
##### end dev_dontaudit_getattr_sysfs(xdm_t) depth: 4
#line 214
 	
#line 214
	 	 	
#line 214
##### begin dev_dontaudit_search_sysfs(xdm_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type sysfs_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t sysfs_t:dir { getattr search open };
#line 214

#line 214
	 	
#line 214
##### end dev_dontaudit_search_sysfs(xdm_t) depth: 4
#line 214
 	
#line 214

#line 214
	 	
#line 214
##### end selinux_dontaudit_getattr_fs(xdm_t) depth: 3
#line 214
 	
#line 214
		 	 	
#line 214
##### begin selinux_dontaudit_read_fs(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type security_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t security_t:dir { getattr search open };
#line 214
	dontaudit xdm_t security_t:file { getattr open read lock ioctl };
#line 214

#line 214
	 	
#line 214
##### end selinux_dontaudit_read_fs(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin seutil_dontaudit_read_config(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type selinux_config_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t selinux_config_t:dir { getattr search open };
#line 214
	dontaudit xdm_t selinux_config_t:file { getattr open read lock ioctl };
#line 214

#line 214
	 	
#line 214
##### end seutil_dontaudit_read_config(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	 	
#line 214
##### end domain_type(xdm_t) depth: 2
#line 214
 	
#line 214
	 	 	
#line 214
##### begin domain_entry_file(xdm_t,xdm_exec_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		attribute entry_type;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t xdm_exec_t:file entrypoint;
#line 214
	allow xdm_t xdm_exec_t:file { { getattr open read execute ioctl } ioctl lock };
#line 214

#line 214
	typeattribute xdm_exec_t entry_type;
#line 214

#line 214
	 	 	
#line 214
##### begin corecmd_executable_file(xdm_exec_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		attribute exec_type;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	typeattribute xdm_exec_t exec_type;
#line 214

#line 214
	 	 	
#line 214
##### begin files_type(xdm_exec_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	typeattribute xdm_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 214

#line 214
	 	
#line 214
##### end files_type(xdm_exec_t) depth: 4
#line 214
 	
#line 214

#line 214
	 	
#line 214
##### end corecmd_executable_file(xdm_exec_t) depth: 3
#line 214
 	
#line 214

#line 214
	 	
#line 214
##### end domain_entry_file(xdm_t,xdm_exec_t) depth: 2
#line 214
 	
#line 214

#line 214
	role system_r types xdm_t;
#line 214

#line 214
	
#line 214
	
#line 214
	
#line 214
	allow initrc_t xdm_exec_t:file { getattr open read execute };
#line 214
	allow initrc_t xdm_t:process transition;
#line 214
	dontaudit initrc_t xdm_t:process { noatsecure siginh rlimitinh };
#line 214

#line 214
	type_transition initrc_t xdm_exec_t:process xdm_t;
#line 214

#line 214

#line 214
	allow xdm_t initrc_t:fd use;
#line 214
	allow xdm_t initrc_t:fifo_file { open { getattr read write append ioctl lock } };
#line 214
	allow xdm_t initrc_t:process sigchld;
#line 214

#line 214

#line 214
	
#line 214

#line 214
	# daemons started from init will
#line 214
	# inherit fds from init for the console
#line 214
	 	 	
#line 214
##### begin init_dontaudit_use_fds(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type init_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t init_t:fd use;
#line 214

#line 214
	 	
#line 214
##### end init_dontaudit_use_fds(xdm_t) depth: 2
#line 214
 	
#line 214
	 	 	
#line 214
##### begin term_dontaudit_use_console(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type console_device_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t console_device_t:chr_file { getattr open read write append ioctl lock };
#line 214

#line 214
	 	
#line 214
##### end term_dontaudit_use_console(xdm_t) depth: 2
#line 214
 	
#line 214

#line 214
	# init script ptys are the stdin/out/err
#line 214
	# when using run_init
#line 214
	 	 	
#line 214
##### begin init_use_script_ptys(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type initrc_devpts_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	 	 	
#line 214
##### begin term_list_ptys(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type devpts_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	 	 	
#line 214
##### begin dev_list_all_dev_nodes(xdm_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type device_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	
#line 214
	allow xdm_t device_t:dir { getattr search open };
#line 214
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 214

#line 214
	
#line 214
	allow xdm_t device_t:dir { getattr search open };
#line 214
	allow xdm_t device_t:lnk_file { getattr read };
#line 214

#line 214

#line 214
	 	
#line 214
##### end dev_list_all_dev_nodes(xdm_t) depth: 4
#line 214
 	
#line 214
	allow xdm_t devpts_t:dir { getattr search open read lock ioctl };
#line 214

#line 214
	 	
#line 214
##### end term_list_ptys(xdm_t) depth: 3
#line 214
 	
#line 214
	allow xdm_t initrc_devpts_t:chr_file { { { getattr read write append ioctl } open } lock append };
#line 214

#line 214
	 	
#line 214
##### end init_use_script_ptys(xdm_t) depth: 2
#line 214
 	
#line 214

#line 214
	
#line 214
		 	 	
#line 214
##### begin userdom_dontaudit_use_user_terminals(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type user_tty_device_t, user_devpts_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	dontaudit xdm_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 214
	dontaudit xdm_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 214

#line 214
	 	
#line 214
##### end userdom_dontaudit_use_user_terminals(xdm_t) depth: 2
#line 214
 	
#line 214
	
#line 214

#line 214
	
#line 214

#line 214
	
#line 214
	optional {
#line 214
		
#line 214
		 	 	
#line 214
##### begin nscd_use(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		
#line 214
bool nscd_use_shm;
#line 214

#line 214
  
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214
	if (nscd_use_shm) {
#line 214
		
#line 214
		 	 	
#line 214
##### begin nscd_shm_use(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type nscd_t, nscd_var_run_t;
#line 214
		class nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 214

#line 214
	allow xdm_t nscd_t:nscd { getpwd getgrp gethost shmempwd shmemgrp shmemhost };
#line 214
	allow xdm_t nscd_t:fd use;
#line 214

#line 214
	 	 	
#line 214
##### begin files_search_pids(xdm_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type var_t, var_run_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 214
	
#line 214
	allow xdm_t var_t:dir { getattr search open };
#line 214
	allow xdm_t var_run_t:dir { getattr search open };
#line 214

#line 214

#line 214
	 	
#line 214
##### end files_search_pids(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	allow xdm_t nscd_var_run_t:dir { getattr search open };
#line 214
	allow xdm_t nscd_var_run_t:sock_file { getattr write open append };
#line 214
	allow xdm_t nscd_t:unix_stream_socket connectto;
#line 214

#line 214
	dontaudit xdm_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 214

#line 214
	allow xdm_t nscd_var_run_t:dir { getattr search open read lock ioctl };
#line 214
	allow xdm_t nscd_var_run_t:sock_file { getattr open read };
#line 214

#line 214
	 	
#line 214
##### end nscd_shm_use(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	} else {
#line 214
		
#line 214
		 	 	
#line 214
##### begin nscd_socket_use(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type nscd_t, nscd_var_run_t;
#line 214
		class nscd { getserv getpwd getgrp gethost shmempwd shmemgrp shmemhost shmemserv };
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 214

#line 214
	allow xdm_t nscd_t:nscd { getpwd getgrp gethost };
#line 214

#line 214
	dontaudit xdm_t nscd_t:fd use;
#line 214
	dontaudit xdm_t nscd_t:nscd { getserv shmempwd shmemgrp shmemhost shmemserv };
#line 214

#line 214
	 	 	
#line 214
##### begin files_search_pids(xdm_t) depth: 5
#line 214
 	
#line 214
	
#line 214
	
#line 214
		require {
#line 214
			
#line 214
		type var_t, var_run_t;
#line 214
	
#line 214
		} # end require
#line 214
	
#line 214

#line 214

#line 214
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 214
	
#line 214
	allow xdm_t var_t:dir { getattr search open };
#line 214
	allow xdm_t var_run_t:dir { getattr search open };
#line 214

#line 214

#line 214
	 	
#line 214
##### end files_search_pids(xdm_t) depth: 4
#line 214
 	
#line 214
	
#line 214
	allow xdm_t nscd_var_run_t:dir { getattr search open };
#line 214
	allow xdm_t nscd_var_run_t:sock_file { getattr write open append };
#line 214
	allow xdm_t nscd_t:unix_stream_socket connectto;
#line 214

#line 214
	dontaudit xdm_t nscd_var_run_t:file { getattr open read lock ioctl };
#line 214

#line 214
	
#line 214
	allow nscd_t xdm_t:dir { getattr search open read lock ioctl };
#line 214
	allow nscd_t xdm_t:file { getattr open read lock ioctl };
#line 214
	allow nscd_t xdm_t:lnk_file { getattr read };
#line 214
	allow nscd_t xdm_t:process getattr;
#line 214

#line 214

#line 214
	 	
#line 214
##### end nscd_socket_use(xdm_t) depth: 3
#line 214
 	
#line 214
	
#line 214
	}
#line 214

#line 214

#line 214
	 	
#line 214
##### end nscd_use(xdm_t) depth: 2
#line 214
 	
#line 214
	
#line 214
	} # end optional
#line 214

#line 214

#line 214
	 	
#line 214
##### end init_daemon_domain(xdm_t,xdm_exec_t) depth: 1
#line 214
 	
#line 214

#line 214
		
#line 214
			range_transition initrc_t xdm_exec_t:process s0 - s0:c0.c1023;
#line 214
			range_transition init_t xdm_exec_t:process s0 - s0:c0.c1023;
#line 214
		
#line 214

#line 214
		
#line 214
	
#line 214

#line 214
	 	
#line 214
##### end init_ranged_daemon_domain(xdm_t,xdm_exec_t,s0 - s0:c0.c1023) depth: 0
#line 214
 	
#line 217



#line 219
	optional {
#line 219
		
#line 219
	 	 	
#line 219
##### begin prelink_object_file(xkb_var_lib_t) depth: 1
#line 219
 	
#line 219
	
#line 219
	
#line 219
		require {
#line 219
			
#line 219
		attribute prelink_object;
#line 219
	
#line 219
		} # end require
#line 219
	
#line 219

#line 219

#line 219
	typeattribute xkb_var_lib_t prelink_object;
#line 219

#line 219
	 	
#line 219
##### end prelink_object_file(xkb_var_lib_t) depth: 0
#line 219
 	
#line 219

#line 219
	} # end optional
#line 221


########################################
#
# Iceauth local policy
#

allow iceauth_t iceauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
 	 	
#line 229
##### begin userdom_user_home_dir_filetrans(iceauth_t,iceauth_home_t,file) depth: 1
#line 229
 	
#line 229
	
#line 229
	
#line 229
		require {
#line 229
			
#line 229
		type user_home_dir_t;
#line 229
	
#line 229
		} # end require
#line 229
	
#line 229

#line 229

#line 229
	
#line 229
	allow iceauth_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 229
	type_transition iceauth_t user_home_dir_t:file iceauth_home_t ;
#line 229

#line 229
	 	 	
#line 229
##### begin files_search_home(iceauth_t) depth: 2
#line 229
 	
#line 229
	
#line 229
	
#line 229
		require {
#line 229
			
#line 229
		type home_root_t;
#line 229
	
#line 229
		} # end require
#line 229
	
#line 229

#line 229

#line 229
	allow iceauth_t home_root_t:dir { getattr search open };
#line 229
	allow iceauth_t home_root_t:lnk_file { getattr read };
#line 229

#line 229
	 	
#line 229
##### end files_search_home(iceauth_t) depth: 1
#line 229
 	
#line 229

#line 229
	 	
#line 229
##### end userdom_user_home_dir_filetrans(iceauth_t,iceauth_home_t,file) depth: 0
#line 229
 	

allow xdm_t iceauth_home_t:file { getattr open read lock ioctl };

 	 	
#line 233
##### begin fs_search_auto_mountpoints(iceauth_t) depth: 1
#line 233
 	
#line 233
	
#line 233
	
#line 233
		require {
#line 233
			
#line 233
		type autofs_t;
#line 233
	
#line 233
		} # end require
#line 233
	
#line 233

#line 233

#line 233
	allow iceauth_t autofs_t:dir { getattr search open };
#line 233

#line 233
	 	
#line 233
##### end fs_search_auto_mountpoints(iceauth_t) depth: 0
#line 233
 	

 	 	
#line 235
##### begin userdom_use_user_terminals(iceauth_t) depth: 1
#line 235
 	
#line 235
	
#line 235
	
#line 235
		require {
#line 235
			
#line 235
		type user_tty_device_t, user_devpts_t;
#line 235
	
#line 235
		} # end require
#line 235
	
#line 235

#line 235

#line 235
	allow iceauth_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 235
	allow iceauth_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 235
	 	 	
#line 235
##### begin term_list_ptys(iceauth_t) depth: 2
#line 235
 	
#line 235
	
#line 235
	
#line 235
		require {
#line 235
			
#line 235
		type devpts_t;
#line 235
	
#line 235
		} # end require
#line 235
	
#line 235

#line 235

#line 235
	 	 	
#line 235
##### begin dev_list_all_dev_nodes(iceauth_t) depth: 3
#line 235
 	
#line 235
	
#line 235
	
#line 235
		require {
#line 235
			
#line 235
		type device_t;
#line 235
	
#line 235
		} # end require
#line 235
	
#line 235

#line 235

#line 235
	
#line 235
	allow iceauth_t device_t:dir { getattr search open };
#line 235
	allow iceauth_t device_t:dir { getattr search open read lock ioctl };
#line 235

#line 235
	
#line 235
	allow iceauth_t device_t:dir { getattr search open };
#line 235
	allow iceauth_t device_t:lnk_file { getattr read };
#line 235

#line 235

#line 235
	 	
#line 235
##### end dev_list_all_dev_nodes(iceauth_t) depth: 2
#line 235
 	
#line 235
	allow iceauth_t devpts_t:dir { getattr search open read lock ioctl };
#line 235

#line 235
	 	
#line 235
##### end term_list_ptys(iceauth_t) depth: 1
#line 235
 	
#line 235

#line 235
	 	
#line 235
##### end userdom_use_user_terminals(iceauth_t) depth: 0
#line 235
 	
 	 	
#line 236
##### begin userdom_read_user_tmp_files(iceauth_t) depth: 1
#line 236
 	
#line 236
	
#line 236
	
#line 236
		require {
#line 236
			
#line 236
		type user_tmp_t;
#line 236
	
#line 236
		} # end require
#line 236
	
#line 236

#line 236

#line 236
	
#line 236
	allow iceauth_t user_tmp_t:dir { getattr search open };
#line 236
	allow iceauth_t user_tmp_t:file { getattr open read lock ioctl };
#line 236

#line 236
	allow iceauth_t user_tmp_t:dir { getattr search open read lock ioctl };
#line 236
	 	 	
#line 236
##### begin files_search_tmp(iceauth_t) depth: 2
#line 236
 	
#line 236
	
#line 236
	
#line 236
		require {
#line 236
			
#line 236
		type tmp_t;
#line 236
	
#line 236
		} # end require
#line 236
	
#line 236

#line 236

#line 236
	allow iceauth_t tmp_t:dir { getattr search open };
#line 236

#line 236
	 	
#line 236
##### end files_search_tmp(iceauth_t) depth: 1
#line 236
 	
#line 236
	 	 	
#line 236
##### begin userdom_search_user_runtime(iceauth_t) depth: 2
#line 236
 	
#line 236
	
#line 236
	
#line 236
		require {
#line 236
			
#line 236
		type user_runtime_t;
#line 236
	
#line 236
		} # end require
#line 236
	
#line 236

#line 236

#line 236
	allow iceauth_t user_runtime_t:dir { getattr search open };
#line 236
	 	 	
#line 236
##### begin userdom_search_user_runtime_root(iceauth_t) depth: 3
#line 236
 	
#line 236
	
#line 236
	
#line 236
		require {
#line 236
			
#line 236
		type user_runtime_root_t;
#line 236
	
#line 236
		} # end require
#line 236
	
#line 236

#line 236

#line 236
	allow iceauth_t user_runtime_root_t:dir { getattr search open };
#line 236
	 	 	
#line 236
##### begin files_search_pids(iceauth_t) depth: 4
#line 236
 	
#line 236
	
#line 236
	
#line 236
		require {
#line 236
			
#line 236
		type var_t, var_run_t;
#line 236
	
#line 236
		} # end require
#line 236
	
#line 236

#line 236

#line 236
	allow iceauth_t var_run_t:lnk_file { getattr read };
#line 236
	
#line 236
	allow iceauth_t var_t:dir { getattr search open };
#line 236
	allow iceauth_t var_run_t:dir { getattr search open };
#line 236

#line 236

#line 236
	 	
#line 236
##### end files_search_pids(iceauth_t) depth: 3
#line 236
 	
#line 236

#line 236
	 	
#line 236
##### end userdom_search_user_runtime_root(iceauth_t) depth: 2
#line 236
 	
#line 236

#line 236
	 	
#line 236
##### end userdom_search_user_runtime(iceauth_t) depth: 1
#line 236
 	
#line 236

#line 236
	 	
#line 236
##### end userdom_read_user_tmp_files(iceauth_t) depth: 0
#line 236
 	


#line 238
	
#line 238
	
#line 238
		require {
#line 238
			
#line 238
		
#line 238
bool use_nfs_home_dirs;
#line 238

#line 238
  
#line 238
	
#line 238
		} # end require
#line 238
	
#line 238

#line 238
	if (use_nfs_home_dirs) {
#line 238
		
#line 238
	 	 	
#line 238
##### begin fs_manage_nfs_files(iceauth_t) depth: 1
#line 238
 	
#line 238
	
#line 238
	
#line 238
		require {
#line 238
			
#line 238
		type nfs_t;
#line 238
	
#line 238
		} # end require
#line 238
	
#line 238

#line 238

#line 238
	
#line 238
	allow iceauth_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 238
	allow iceauth_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 238

#line 238

#line 238
	 	
#line 238
##### end fs_manage_nfs_files(iceauth_t) depth: 0
#line 238
 	
#line 238

#line 238
	}
#line 240



#line 242
	
#line 242
	
#line 242
		require {
#line 242
			
#line 242
		
#line 242
bool use_samba_home_dirs;
#line 242

#line 242
  
#line 242
	
#line 242
		} # end require
#line 242
	
#line 242

#line 242
	if (use_samba_home_dirs) {
#line 242
		
#line 242
	 	 	
#line 242
##### begin fs_manage_cifs_files(iceauth_t) depth: 1
#line 242
 	
#line 242
	
#line 242
	
#line 242
		require {
#line 242
			
#line 242
		type cifs_t;
#line 242
	
#line 242
		} # end require
#line 242
	
#line 242

#line 242

#line 242
	
#line 242
	allow iceauth_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 242
	allow iceauth_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 242

#line 242

#line 242
	 	
#line 242
##### end fs_manage_cifs_files(iceauth_t) depth: 0
#line 242
 	
#line 242

#line 242
	}
#line 244


########################################
#
# Xauth local policy
#

allow xauth_t self:process signal;
allow xauth_t self:unix_stream_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };

allow xauth_t xauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
 	 	
#line 255
##### begin userdom_user_home_dir_filetrans(xauth_t,xauth_home_t,file) depth: 1
#line 255
 	
#line 255
	
#line 255
	
#line 255
		require {
#line 255
			
#line 255
		type user_home_dir_t;
#line 255
	
#line 255
		} # end require
#line 255
	
#line 255

#line 255

#line 255
	
#line 255
	allow xauth_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 255
	type_transition xauth_t user_home_dir_t:file xauth_home_t ;
#line 255

#line 255
	 	 	
#line 255
##### begin files_search_home(xauth_t) depth: 2
#line 255
 	
#line 255
	
#line 255
	
#line 255
		require {
#line 255
			
#line 255
		type home_root_t;
#line 255
	
#line 255
		} # end require
#line 255
	
#line 255

#line 255

#line 255
	allow xauth_t home_root_t:dir { getattr search open };
#line 255
	allow xauth_t home_root_t:lnk_file { getattr read };
#line 255

#line 255
	 	
#line 255
##### end files_search_home(xauth_t) depth: 1
#line 255
 	
#line 255

#line 255
	 	
#line 255
##### end userdom_user_home_dir_filetrans(xauth_t,xauth_home_t,file) depth: 0
#line 255
 	


#line 257
	allow xauth_t xauth_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 257
	allow xauth_t xauth_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 257


#line 258
	allow xauth_t xauth_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 258
	allow xauth_t xauth_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 258

 	 	
#line 259
##### begin files_tmp_filetrans(xauth_t,xauth_tmp_t,{ file dir }) depth: 1
#line 259
 	
#line 259
	
#line 259
	
#line 259
		require {
#line 259
			
#line 259
		type tmp_t;
#line 259
	
#line 259
		} # end require
#line 259
	
#line 259

#line 259

#line 259
	
#line 259
	allow xauth_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 259
	type_transition xauth_t tmp_t:{ file dir } xauth_tmp_t ;
#line 259

#line 259

#line 259
	 	
#line 259
##### end files_tmp_filetrans(xauth_t,xauth_tmp_t,{ file dir }) depth: 0
#line 259
 	

allow xdm_t xauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
 	 	
#line 262
##### begin userdom_user_home_dir_filetrans(xdm_t,xauth_home_t,file,".Xauthority") depth: 1
#line 262
 	
#line 262
	
#line 262
	
#line 262
		require {
#line 262
			
#line 262
		type user_home_dir_t;
#line 262
	
#line 262
		} # end require
#line 262
	
#line 262

#line 262

#line 262
	
#line 262
	allow xdm_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 262
	type_transition xdm_t user_home_dir_t:file xauth_home_t ".Xauthority";
#line 262

#line 262
	 	 	
#line 262
##### begin files_search_home(xdm_t) depth: 2
#line 262
 	
#line 262
	
#line 262
	
#line 262
		require {
#line 262
			
#line 262
		type home_root_t;
#line 262
	
#line 262
		} # end require
#line 262
	
#line 262

#line 262

#line 262
	allow xdm_t home_root_t:dir { getattr search open };
#line 262
	allow xdm_t home_root_t:lnk_file { getattr read };
#line 262

#line 262
	 	
#line 262
##### end files_search_home(xdm_t) depth: 1
#line 262
 	
#line 262

#line 262
	 	
#line 262
##### end userdom_user_home_dir_filetrans(xdm_t,xauth_home_t,file,".Xauthority") depth: 0
#line 262
 	
 	 	
#line 263
##### begin userdom_user_home_dir_filetrans(xdm_t,user_home_t,file,".xsession-errors") depth: 1
#line 263
 	
#line 263
	
#line 263
	
#line 263
		require {
#line 263
			
#line 263
		type user_home_dir_t;
#line 263
	
#line 263
		} # end require
#line 263
	
#line 263

#line 263

#line 263
	
#line 263
	allow xdm_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 263
	type_transition xdm_t user_home_dir_t:file user_home_t ".xsession-errors";
#line 263

#line 263
	 	 	
#line 263
##### begin files_search_home(xdm_t) depth: 2
#line 263
 	
#line 263
	
#line 263
	
#line 263
		require {
#line 263
			
#line 263
		type home_root_t;
#line 263
	
#line 263
		} # end require
#line 263
	
#line 263

#line 263

#line 263
	allow xdm_t home_root_t:dir { getattr search open };
#line 263
	allow xdm_t home_root_t:lnk_file { getattr read };
#line 263

#line 263
	 	
#line 263
##### end files_search_home(xdm_t) depth: 1
#line 263
 	
#line 263

#line 263
	 	
#line 263
##### end userdom_user_home_dir_filetrans(xdm_t,user_home_t,file,".xsession-errors") depth: 0
#line 263
 	
allow xauth_t xdm_t:process sigchld;

 	 	
#line 266
##### begin kernel_request_load_module(xauth_t) depth: 1
#line 266
 	
#line 266
	
#line 266
	
#line 266
		require {
#line 266
			
#line 266
		type kernel_t;
#line 266
	
#line 266
		} # end require
#line 266
	
#line 266

#line 266

#line 266
	allow xauth_t kernel_t:system module_request;
#line 266

#line 266
	 	
#line 266
##### end kernel_request_load_module(xauth_t) depth: 0
#line 266
 	

 	 	
#line 268
##### begin domain_use_interactive_fds(xauth_t) depth: 1
#line 268
 	
#line 268
	
#line 268
	
#line 268
		require {
#line 268
			
#line 268
		attribute privfd;
#line 268
	
#line 268
		} # end require
#line 268
	
#line 268

#line 268

#line 268
	allow xauth_t privfd:fd use;
#line 268

#line 268
	 	
#line 268
##### end domain_use_interactive_fds(xauth_t) depth: 0
#line 268
 	

 	 	
#line 270
##### begin files_read_etc_files(xauth_t) depth: 1
#line 270
 	
#line 270
	
#line 270
	
#line 270
		require {
#line 270
			
#line 270
		type etc_t;
#line 270
	
#line 270
		} # end require
#line 270
	
#line 270

#line 270

#line 270
	allow xauth_t etc_t:dir { getattr search open read lock ioctl };
#line 270
	
#line 270
	allow xauth_t etc_t:dir { getattr search open };
#line 270
	allow xauth_t etc_t:file { getattr open read lock ioctl };
#line 270

#line 270
	
#line 270
	allow xauth_t etc_t:dir { getattr search open };
#line 270
	allow xauth_t etc_t:lnk_file { getattr read };
#line 270

#line 270

#line 270
	 	
#line 270
##### end files_read_etc_files(xauth_t) depth: 0
#line 270
 	
 	 	
#line 271
##### begin files_search_pids(xauth_t) depth: 1
#line 271
 	
#line 271
	
#line 271
	
#line 271
		require {
#line 271
			
#line 271
		type var_t, var_run_t;
#line 271
	
#line 271
		} # end require
#line 271
	
#line 271

#line 271

#line 271
	allow xauth_t var_run_t:lnk_file { getattr read };
#line 271
	
#line 271
	allow xauth_t var_t:dir { getattr search open };
#line 271
	allow xauth_t var_run_t:dir { getattr search open };
#line 271

#line 271

#line 271
	 	
#line 271
##### end files_search_pids(xauth_t) depth: 0
#line 271
 	

 	 	
#line 273
##### begin fs_getattr_xattr_fs(xauth_t) depth: 1
#line 273
 	
#line 273
	
#line 273
	
#line 273
		require {
#line 273
			
#line 273
		type fs_t;
#line 273
	
#line 273
		} # end require
#line 273
	
#line 273

#line 273

#line 273
	allow xauth_t fs_t:filesystem getattr;
#line 273

#line 273
	 	
#line 273
##### end fs_getattr_xattr_fs(xauth_t) depth: 0
#line 273
 	
 	 	
#line 274
##### begin fs_search_auto_mountpoints(xauth_t) depth: 1
#line 274
 	
#line 274
	
#line 274
	
#line 274
		require {
#line 274
			
#line 274
		type autofs_t;
#line 274
	
#line 274
		} # end require
#line 274
	
#line 274

#line 274

#line 274
	allow xauth_t autofs_t:dir { getattr search open };
#line 274

#line 274
	 	
#line 274
##### end fs_search_auto_mountpoints(xauth_t) depth: 0
#line 274
 	

allow xauth_t xdm_t:fd use;
allow xauth_t xdm_t:fifo_file { getattr read };
allow xauth_t xdm_t:unix_stream_socket { read write };

# cjp: why?
 	 	
#line 281
##### begin term_use_ptmx(xauth_t) depth: 1
#line 281
 	
#line 281
	
#line 281
	
#line 281
		require {
#line 281
			
#line 281
		type ptmx_t;
#line 281
	
#line 281
		} # end require
#line 281
	
#line 281

#line 281

#line 281
	 	 	
#line 281
##### begin dev_list_all_dev_nodes(xauth_t) depth: 2
#line 281
 	
#line 281
	
#line 281
	
#line 281
		require {
#line 281
			
#line 281
		type device_t;
#line 281
	
#line 281
		} # end require
#line 281
	
#line 281

#line 281

#line 281
	
#line 281
	allow xauth_t device_t:dir { getattr search open };
#line 281
	allow xauth_t device_t:dir { getattr search open read lock ioctl };
#line 281

#line 281
	
#line 281
	allow xauth_t device_t:dir { getattr search open };
#line 281
	allow xauth_t device_t:lnk_file { getattr read };
#line 281

#line 281

#line 281
	 	
#line 281
##### end dev_list_all_dev_nodes(xauth_t) depth: 1
#line 281
 	
#line 281
	allow xauth_t ptmx_t:chr_file { getattr open read write append ioctl lock };
#line 281

#line 281
	 	
#line 281
##### end term_use_ptmx(xauth_t) depth: 0
#line 281
 	

 	 	
#line 283
##### begin auth_use_nsswitch(xauth_t) depth: 1
#line 283
 	
#line 283
    
#line 283
	
#line 283
		require {
#line 283
			
#line 283
        attribute nsswitch_domain;
#line 283
    
#line 283
		} # end require
#line 283
	
#line 283

#line 283

#line 283
	typeattribute xauth_t nsswitch_domain;
#line 283

#line 283
	 	
#line 283
##### end auth_use_nsswitch(xauth_t) depth: 0
#line 283
 	

 	 	
#line 285
##### begin userdom_use_user_terminals(xauth_t) depth: 1
#line 285
 	
#line 285
	
#line 285
	
#line 285
		require {
#line 285
			
#line 285
		type user_tty_device_t, user_devpts_t;
#line 285
	
#line 285
		} # end require
#line 285
	
#line 285

#line 285

#line 285
	allow xauth_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 285
	allow xauth_t user_devpts_t:chr_file { { getattr read write append ioctl } open };
#line 285
	 	 	
#line 285
##### begin term_list_ptys(xauth_t) depth: 2
#line 285
 	
#line 285
	
#line 285
	
#line 285
		require {
#line 285
			
#line 285
		type devpts_t;
#line 285
	
#line 285
		} # end require
#line 285
	
#line 285

#line 285

#line 285
	 	 	
#line 285
##### begin dev_list_all_dev_nodes(xauth_t) depth: 3
#line 285
 	
#line 285
	
#line 285
	
#line 285
		require {
#line 285
			
#line 285
		type device_t;
#line 285
	
#line 285
		} # end require
#line 285
	
#line 285

#line 285

#line 285
	
#line 285
	allow xauth_t device_t:dir { getattr search open };
#line 285
	allow xauth_t device_t:dir { getattr search open read lock ioctl };
#line 285

#line 285
	
#line 285
	allow xauth_t device_t:dir { getattr search open };
#line 285
	allow xauth_t device_t:lnk_file { getattr read };
#line 285

#line 285

#line 285
	 	
#line 285
##### end dev_list_all_dev_nodes(xauth_t) depth: 2
#line 285
 	
#line 285
	allow xauth_t devpts_t:dir { getattr search open read lock ioctl };
#line 285

#line 285
	 	
#line 285
##### end term_list_ptys(xauth_t) depth: 1
#line 285
 	
#line 285

#line 285
	 	
#line 285
##### end userdom_use_user_terminals(xauth_t) depth: 0
#line 285
 	
 	 	
#line 286
##### begin userdom_read_user_tmp_files(xauth_t) depth: 1
#line 286
 	
#line 286
	
#line 286
	
#line 286
		require {
#line 286
			
#line 286
		type user_tmp_t;
#line 286
	
#line 286
		} # end require
#line 286
	
#line 286

#line 286

#line 286
	
#line 286
	allow xauth_t user_tmp_t:dir { getattr search open };
#line 286
	allow xauth_t user_tmp_t:file { getattr open read lock ioctl };
#line 286

#line 286
	allow xauth_t user_tmp_t:dir { getattr search open read lock ioctl };
#line 286
	 	 	
#line 286
##### begin files_search_tmp(xauth_t) depth: 2
#line 286
 	
#line 286
	
#line 286
	
#line 286
		require {
#line 286
			
#line 286
		type tmp_t;
#line 286
	
#line 286
		} # end require
#line 286
	
#line 286

#line 286

#line 286
	allow xauth_t tmp_t:dir { getattr search open };
#line 286

#line 286
	 	
#line 286
##### end files_search_tmp(xauth_t) depth: 1
#line 286
 	
#line 286
	 	 	
#line 286
##### begin userdom_search_user_runtime(xauth_t) depth: 2
#line 286
 	
#line 286
	
#line 286
	
#line 286
		require {
#line 286
			
#line 286
		type user_runtime_t;
#line 286
	
#line 286
		} # end require
#line 286
	
#line 286

#line 286

#line 286
	allow xauth_t user_runtime_t:dir { getattr search open };
#line 286
	 	 	
#line 286
##### begin userdom_search_user_runtime_root(xauth_t) depth: 3
#line 286
 	
#line 286
	
#line 286
	
#line 286
		require {
#line 286
			
#line 286
		type user_runtime_root_t;
#line 286
	
#line 286
		} # end require
#line 286
	
#line 286

#line 286

#line 286
	allow xauth_t user_runtime_root_t:dir { getattr search open };
#line 286
	 	 	
#line 286
##### begin files_search_pids(xauth_t) depth: 4
#line 286
 	
#line 286
	
#line 286
	
#line 286
		require {
#line 286
			
#line 286
		type var_t, var_run_t;
#line 286
	
#line 286
		} # end require
#line 286
	
#line 286

#line 286

#line 286
	allow xauth_t var_run_t:lnk_file { getattr read };
#line 286
	
#line 286
	allow xauth_t var_t:dir { getattr search open };
#line 286
	allow xauth_t var_run_t:dir { getattr search open };
#line 286

#line 286

#line 286
	 	
#line 286
##### end files_search_pids(xauth_t) depth: 3
#line 286
 	
#line 286

#line 286
	 	
#line 286
##### end userdom_search_user_runtime_root(xauth_t) depth: 2
#line 286
 	
#line 286

#line 286
	 	
#line 286
##### end userdom_search_user_runtime(xauth_t) depth: 1
#line 286
 	
#line 286

#line 286
	 	
#line 286
##### end userdom_read_user_tmp_files(xauth_t) depth: 0
#line 286
 	

 	 	
#line 288
##### begin xserver_rw_xdm_tmp_files(xauth_t) depth: 1
#line 288
 	
#line 288
	
#line 288
	
#line 288
		require {
#line 288
			
#line 288
		type xdm_tmp_t;
#line 288
	
#line 288
		} # end require
#line 288
	
#line 288

#line 288

#line 288
	allow xauth_t xdm_tmp_t:dir { getattr search open };
#line 288
	allow xauth_t xdm_tmp_t:file { getattr open read write append ioctl lock };
#line 288

#line 288
	 	
#line 288
##### end xserver_rw_xdm_tmp_files(xauth_t) depth: 0
#line 288
 	


#line 290
	
#line 290
	
#line 290
		require {
#line 290
			
#line 290
		
#line 290
bool use_nfs_home_dirs;
#line 290

#line 290
  
#line 290
	
#line 290
		} # end require
#line 290
	
#line 290

#line 290
	if (use_nfs_home_dirs) {
#line 290
		
#line 290
	 	 	
#line 290
##### begin fs_manage_nfs_files(xauth_t) depth: 1
#line 290
 	
#line 290
	
#line 290
	
#line 290
		require {
#line 290
			
#line 290
		type nfs_t;
#line 290
	
#line 290
		} # end require
#line 290
	
#line 290

#line 290

#line 290
	
#line 290
	allow xauth_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 290
	allow xauth_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 290

#line 290

#line 290
	 	
#line 290
##### end fs_manage_nfs_files(xauth_t) depth: 0
#line 290
 	
#line 290

#line 290
	}
#line 292



#line 294
	
#line 294
	
#line 294
		require {
#line 294
			
#line 294
		
#line 294
bool use_samba_home_dirs;
#line 294

#line 294
  
#line 294
	
#line 294
		} # end require
#line 294
	
#line 294

#line 294
	if (use_samba_home_dirs) {
#line 294
		
#line 294
	 	 	
#line 294
##### begin fs_manage_cifs_files(xauth_t) depth: 1
#line 294
 	
#line 294
	
#line 294
	
#line 294
		require {
#line 294
			
#line 294
		type cifs_t;
#line 294
	
#line 294
		} # end require
#line 294
	
#line 294

#line 294

#line 294
	
#line 294
	allow xauth_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 294
	allow xauth_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 294

#line 294

#line 294
	 	
#line 294
##### end fs_manage_cifs_files(xauth_t) depth: 0
#line 294
 	
#line 294

#line 294
	}
#line 296



#line 298
	optional {
#line 298
		
#line 298
	 	 	
#line 298
##### begin ssh_sigchld(xauth_t) depth: 1
#line 298
 	
#line 298
	
#line 298
	
#line 298
		require {
#line 298
			
#line 298
		type sshd_t;
#line 298
	
#line 298
		} # end require
#line 298
	
#line 298

#line 298

#line 298
	allow xauth_t sshd_t:process sigchld;
#line 298

#line 298
	 	
#line 298
##### end ssh_sigchld(xauth_t) depth: 0
#line 298
 	
#line 298
	 	 	
#line 298
##### begin ssh_read_pipes(xauth_t) depth: 1
#line 298
 	
#line 298
	
#line 298
	
#line 298
		require {
#line 298
			
#line 298
		type sshd_t;
#line 298
	
#line 298
		} # end require
#line 298
	
#line 298

#line 298

#line 298
	allow xauth_t sshd_t:fifo_file { getattr read };
#line 298

#line 298
	 	
#line 298
##### end ssh_read_pipes(xauth_t) depth: 0
#line 298
 	
#line 298
	 	 	
#line 298
##### begin ssh_dontaudit_rw_tcp_sockets(xauth_t) depth: 1
#line 298
 	
#line 298
	
#line 298
	
#line 298
		require {
#line 298
			
#line 298
		type sshd_t;
#line 298
	
#line 298
		} # end require
#line 298
	
#line 298

#line 298

#line 298
	dontaudit xauth_t sshd_t:tcp_socket { read write };
#line 298

#line 298
	 	
#line 298
##### end ssh_dontaudit_rw_tcp_sockets(xauth_t) depth: 0
#line 298
 	
#line 298

#line 298
	} # end optional
#line 302


########################################
#
# XDM Local policy
#

allow xdm_t self:capability { setgid setuid sys_resource kill sys_tty_config mknod chown dac_override dac_read_search fowner fsetid ipc_owner sys_nice sys_rawio net_bind_service };
allow xdm_t self:process { setexec setpgid getsched setsched setrlimit { sigchld sigkill sigstop signull signal } };
allow xdm_t self:fifo_file { open { getattr read write append ioctl lock } };
allow xdm_t self:shm { associate getattr setattr create destroy read write lock unix_read unix_write };
allow xdm_t self:sem { associate getattr setattr create destroy read write unix_read unix_write };
allow xdm_t self:unix_stream_socket { connectto { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept } };
allow xdm_t self:unix_dgram_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
allow xdm_t self:tcp_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
allow xdm_t self:udp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
allow xdm_t self:socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
allow xdm_t self:appletalk_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
allow xdm_t self:key { search link write };

allow xdm_t xconsole_device_t:fifo_file { getattr setattr };

# Allow gdm to run gdm-binary
allow xdm_t xdm_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };

allow xdm_t xdm_lock_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
 	 	
#line 328
##### begin files_lock_filetrans(xdm_t,xdm_lock_t,file) depth: 1
#line 328
 	
#line 328
	
#line 328
	
#line 328
		require {
#line 328
			
#line 328
		type var_t, var_lock_t;
#line 328
	
#line 328
		} # end require
#line 328
	
#line 328

#line 328

#line 328
	allow xdm_t var_t:dir { getattr search open };
#line 328
	allow xdm_t var_lock_t:lnk_file { getattr read };
#line 328
	
#line 328
	allow xdm_t var_lock_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 328
	type_transition xdm_t var_lock_t:file xdm_lock_t ;
#line 328

#line 328

#line 328
	 	
#line 328
##### end files_lock_filetrans(xdm_t,xdm_lock_t,file) depth: 0
#line 328
 	

# wdm has its own config dir /etc/X11/wdm
# this is ugly, daemons should not create files under /etc!

#line 332
	allow xdm_t xdm_rw_etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 332
	allow xdm_t xdm_rw_etc_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 332



#line 334
	allow xdm_t xdm_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 334
	allow xdm_t xdm_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 334


#line 335
	allow xdm_t xdm_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 335
	allow xdm_t xdm_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 335


#line 336
	allow xdm_t xdm_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 336
	allow xdm_t xdm_tmp_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 336

 	 	
#line 337
##### begin files_tmp_filetrans(xdm_t,xdm_tmp_t,{ file dir sock_file }) depth: 1
#line 337
 	
#line 337
	
#line 337
	
#line 337
		require {
#line 337
			
#line 337
		type tmp_t;
#line 337
	
#line 337
		} # end require
#line 337
	
#line 337

#line 337

#line 337
	
#line 337
	allow xdm_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 337
	type_transition xdm_t tmp_t:{ file dir sock_file } xdm_tmp_t ;
#line 337

#line 337

#line 337
	 	
#line 337
##### end files_tmp_filetrans(xdm_t,xdm_tmp_t,{ file dir sock_file }) depth: 0
#line 337
 	


#line 339
	allow xdm_t xdm_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 339
	allow xdm_t xdm_tmpfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 339


#line 340
	allow xdm_t xdm_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 340
	allow xdm_t xdm_tmpfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 340


#line 341
	allow xdm_t xdm_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 341
	allow xdm_t xdm_tmpfs_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 341


#line 342
	allow xdm_t xdm_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 342
	allow xdm_t xdm_tmpfs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 342


#line 343
	allow xdm_t xdm_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 343
	allow xdm_t xdm_tmpfs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 343

 	 	
#line 344
##### begin fs_tmpfs_filetrans(xdm_t,xdm_tmpfs_t,{ dir file lnk_file sock_file fifo_file }) depth: 1
#line 344
 	
#line 344
	
#line 344
	
#line 344
		require {
#line 344
			
#line 344
		type tmpfs_t;
#line 344
	
#line 344
		} # end require
#line 344
	
#line 344

#line 344

#line 344
	allow xdm_tmpfs_t tmpfs_t:filesystem associate;
#line 344
	
#line 344
	allow xdm_t tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 344
	type_transition xdm_t tmpfs_t:{ dir file lnk_file sock_file fifo_file } xdm_tmpfs_t ;
#line 344

#line 344

#line 344
	 	
#line 344
##### end fs_tmpfs_filetrans(xdm_t,xdm_tmpfs_t,{ dir file lnk_file sock_file fifo_file }) depth: 0
#line 344
 	


#line 346
	allow xdm_t xdm_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 346
	allow xdm_t xdm_var_lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 346


#line 347
	allow xdm_t xdm_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 347
	allow xdm_t xdm_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 347

 	 	
#line 348
##### begin files_var_lib_filetrans(xdm_t,xdm_var_lib_t,file) depth: 1
#line 348
 	
#line 348
	
#line 348
	
#line 348
		require {
#line 348
			
#line 348
		type var_t, var_lib_t;
#line 348
	
#line 348
		} # end require
#line 348
	
#line 348

#line 348

#line 348
	allow xdm_t var_t:dir { getattr search open };
#line 348
	
#line 348
	allow xdm_t var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 348
	type_transition xdm_t var_lib_t:file xdm_var_lib_t ;
#line 348

#line 348

#line 348
	 	
#line 348
##### end files_var_lib_filetrans(xdm_t,xdm_var_lib_t,file) depth: 0
#line 348
 	


#line 350
	allow xdm_t xdm_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 350
	allow xdm_t xdm_var_run_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 350


#line 351
	allow xdm_t xdm_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 351
	allow xdm_t xdm_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 351


#line 352
	allow xdm_t xdm_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 352
	allow xdm_t xdm_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 352

 	 	
#line 353
##### begin files_pid_filetrans(xdm_t,xdm_var_run_t,{ dir file fifo_file }) depth: 1
#line 353
 	
#line 353
	
#line 353
	
#line 353
		require {
#line 353
			
#line 353
		type var_t, var_run_t;
#line 353
	
#line 353
		} # end require
#line 353
	
#line 353

#line 353

#line 353
	allow xdm_t var_t:dir { getattr search open };
#line 353
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 353
	
#line 353
	allow xdm_t var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 353
	type_transition xdm_t var_run_t:{ dir file fifo_file } xdm_var_run_t ;
#line 353

#line 353

#line 353
	 	
#line 353
##### end files_pid_filetrans(xdm_t,xdm_var_run_t,{ dir file fifo_file }) depth: 0
#line 353
 	

allow xdm_t xserver_t:process signal;
allow xdm_t xserver_t:unix_stream_socket connectto;

allow xdm_t xserver_tmp_t:sock_file { getattr open read write append };
allow xdm_t xserver_tmp_t:dir { setattr { getattr search open read lock ioctl } };

# transition to the xdm xserver

#line 362
	
#line 362
	
#line 362
	allow xdm_t xserver_exec_t:file { getattr open read execute };
#line 362
	allow xdm_t xserver_t:process transition;
#line 362
	dontaudit xdm_t xserver_t:process { noatsecure siginh rlimitinh };
#line 362

#line 362
	type_transition xdm_t xserver_exec_t:process xserver_t;
#line 362

#line 362

#line 362
	allow xserver_t xdm_t:fd use;
#line 362
	allow xserver_t xdm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 362
	allow xserver_t xdm_t:process sigchld;
#line 362

allow xserver_t xdm_t:process signal;
allow xdm_t xserver_t:process { noatsecure siginh rlimitinh signal sigkill };

allow xdm_t xserver_t:shm { associate getattr read write lock unix_read unix_write };

# connect to xdm xserver over stream socket

#line 369
	allow xdm_t xserver_tmp_t:dir { getattr search open };
#line 369
	allow xdm_t xserver_tmp_t:sock_file { getattr write open append };
#line 369
	allow xdm_t xserver_t:unix_stream_socket connectto;
#line 369


# Remove /tmp/.X11-unix/X0.

#line 372
	allow xdm_t xserver_tmp_t:dir { getattr search open lock ioctl write remove_name };
#line 372
	allow xdm_t xserver_tmp_t:file { getattr unlink };
#line 372


#line 373
	allow xdm_t xserver_tmp_t:dir { getattr search open lock ioctl write remove_name };
#line 373
	allow xdm_t xserver_tmp_t:sock_file { getattr unlink };
#line 373



#line 375
	allow xdm_t xserver_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 375
	allow xdm_t xserver_log_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 375


#line 376
	allow xdm_t xserver_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 376
	allow xdm_t xserver_log_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 376


#line 377
	allow xdm_t xserver_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 377
	allow xdm_t xserver_log_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 377

 	 	
#line 378
##### begin logging_log_filetrans(xdm_t,xserver_log_t,file) depth: 1
#line 378
 	
#line 378
	
#line 378
	
#line 378
		require {
#line 378
			
#line 378
		type var_log_t;
#line 378
	
#line 378
		} # end require
#line 378
	
#line 378

#line 378

#line 378
	 	 	
#line 378
##### begin files_search_var(xdm_t) depth: 2
#line 378
 	
#line 378
	
#line 378
	
#line 378
		require {
#line 378
			
#line 378
		type var_t;
#line 378
	
#line 378
		} # end require
#line 378
	
#line 378

#line 378

#line 378
	allow xdm_t var_t:dir { getattr search open };
#line 378

#line 378
	 	
#line 378
##### end files_search_var(xdm_t) depth: 1
#line 378
 	
#line 378
	
#line 378
	allow xdm_t var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 378
	type_transition xdm_t var_log_t:file xserver_log_t ;
#line 378

#line 378
	allow xdm_t var_log_t:lnk_file { getattr read };
#line 378

#line 378
	 	
#line 378
##### end logging_log_filetrans(xdm_t,xserver_log_t,file) depth: 0
#line 378
 	

 	 	
#line 380
##### begin kernel_read_system_state(xdm_t) depth: 1
#line 380
 	
#line 380
	
#line 380
	
#line 380
		require {
#line 380
			
#line 380
		type proc_t;
#line 380
	
#line 380
		} # end require
#line 380
	
#line 380

#line 380

#line 380
	
#line 380
	allow xdm_t proc_t:dir { getattr search open };
#line 380
	allow xdm_t proc_t:file { getattr open read lock ioctl };
#line 380

#line 380
	
#line 380
	allow xdm_t proc_t:dir { getattr search open };
#line 380
	allow xdm_t proc_t:lnk_file { getattr read };
#line 380

#line 380

#line 380
	
#line 380
	allow xdm_t proc_t:dir { getattr search open };
#line 380
	allow xdm_t proc_t:dir { getattr search open read lock ioctl };
#line 380

#line 380

#line 380
	 	
#line 380
##### end kernel_read_system_state(xdm_t) depth: 0
#line 380
 	
 	 	
#line 381
##### begin kernel_read_kernel_sysctls(xdm_t) depth: 1
#line 381
 	
#line 381
	
#line 381
	
#line 381
		require {
#line 381
			
#line 381
		type proc_t, sysctl_t, sysctl_kernel_t;
#line 381
	
#line 381
		} # end require
#line 381
	
#line 381

#line 381

#line 381
	
#line 381
	allow xdm_t { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 381
	allow xdm_t sysctl_kernel_t:file { getattr open read lock ioctl };
#line 381

#line 381

#line 381
	
#line 381
	allow xdm_t { proc_t sysctl_t }:dir { getattr search open };
#line 381
	allow xdm_t sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 381

#line 381

#line 381
	 	
#line 381
##### end kernel_read_kernel_sysctls(xdm_t) depth: 0
#line 381
 	
 	 	
#line 382
##### begin kernel_read_net_sysctls(xdm_t) depth: 1
#line 382
 	
#line 382
	
#line 382
	
#line 382
		require {
#line 382
			
#line 382
		type proc_t, sysctl_t, sysctl_net_t;
#line 382
	
#line 382
		} # end require
#line 382
	
#line 382

#line 382

#line 382
	
#line 382
	allow xdm_t { proc_t sysctl_t sysctl_net_t }:dir { getattr search open };
#line 382
	allow xdm_t sysctl_net_t:file { getattr open read lock ioctl };
#line 382

#line 382

#line 382
	
#line 382
	allow xdm_t { proc_t sysctl_t }:dir { getattr search open };
#line 382
	allow xdm_t sysctl_net_t:dir { getattr search open read lock ioctl };
#line 382

#line 382

#line 382
	 	
#line 382
##### end kernel_read_net_sysctls(xdm_t) depth: 0
#line 382
 	
 	 	
#line 383
##### begin kernel_read_network_state(xdm_t) depth: 1
#line 383
 	
#line 383
	
#line 383
	
#line 383
		require {
#line 383
			
#line 383
		type proc_t, proc_net_t;
#line 383
	
#line 383
		} # end require
#line 383
	
#line 383

#line 383

#line 383
	
#line 383
	allow xdm_t { proc_t proc_net_t }:dir { getattr search open };
#line 383
	allow xdm_t proc_net_t:file { getattr open read lock ioctl };
#line 383

#line 383
	
#line 383
	allow xdm_t { proc_t proc_net_t }:dir { getattr search open };
#line 383
	allow xdm_t proc_net_t:lnk_file { getattr read };
#line 383

#line 383

#line 383
	
#line 383
	allow xdm_t proc_t:dir { getattr search open };
#line 383
	allow xdm_t proc_net_t:dir { getattr search open read lock ioctl };
#line 383

#line 383

#line 383
	 	
#line 383
##### end kernel_read_network_state(xdm_t) depth: 0
#line 383
 	

 	 	
#line 385
##### begin corecmd_exec_shell(xdm_t) depth: 1
#line 385
 	
#line 385
	
#line 385
	
#line 385
		require {
#line 385
			
#line 385
		type bin_t, shell_exec_t;
#line 385
	
#line 385
		} # end require
#line 385
	
#line 385

#line 385

#line 385
	
#line 385
	allow xdm_t bin_t:dir { getattr search open };
#line 385
	allow xdm_t bin_t:dir { getattr search open read lock ioctl };
#line 385

#line 385
	
#line 385
	allow xdm_t bin_t:dir { getattr search open };
#line 385
	allow xdm_t bin_t:lnk_file { getattr read };
#line 385

#line 385
	allow xdm_t shell_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 385

#line 385
	 	
#line 385
##### end corecmd_exec_shell(xdm_t) depth: 0
#line 385
 	
 	 	
#line 386
##### begin corecmd_exec_bin(xdm_t) depth: 1
#line 386
 	
#line 386
	
#line 386
	
#line 386
		require {
#line 386
			
#line 386
		type bin_t;
#line 386
	
#line 386
		} # end require
#line 386
	
#line 386

#line 386

#line 386
	
#line 386
	allow xdm_t bin_t:dir { getattr search open };
#line 386
	allow xdm_t bin_t:lnk_file { getattr read };
#line 386

#line 386
	
#line 386
	allow xdm_t bin_t:dir { getattr search open };
#line 386
	allow xdm_t bin_t:dir { getattr search open read lock ioctl };
#line 386

#line 386
	allow xdm_t bin_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 386

#line 386
	 	
#line 386
##### end corecmd_exec_bin(xdm_t) depth: 0
#line 386
 	

 	 	
#line 388
##### begin corenet_all_recvfrom_unlabeled(xdm_t) depth: 1
#line 388
 	
#line 388
	 	 	
#line 388
##### begin kernel_tcp_recvfrom_unlabeled(xdm_t) depth: 2
#line 388
 	
#line 388
	
#line 388
	
#line 388
		require {
#line 388
			
#line 388
		type unlabeled_t;
#line 388
	
#line 388
		} # end require
#line 388
	
#line 388

#line 388

#line 388
	allow xdm_t unlabeled_t:tcp_socket recvfrom;
#line 388

#line 388
	 	
#line 388
##### end kernel_tcp_recvfrom_unlabeled(xdm_t) depth: 1
#line 388
 	
#line 388
	 	 	
#line 388
##### begin kernel_udp_recvfrom_unlabeled(xdm_t) depth: 2
#line 388
 	
#line 388
	
#line 388
	
#line 388
		require {
#line 388
			
#line 388
		type unlabeled_t;
#line 388
	
#line 388
		} # end require
#line 388
	
#line 388

#line 388

#line 388
	allow xdm_t unlabeled_t:udp_socket recvfrom;
#line 388

#line 388
	 	
#line 388
##### end kernel_udp_recvfrom_unlabeled(xdm_t) depth: 1
#line 388
 	
#line 388
	 	 	
#line 388
##### begin kernel_raw_recvfrom_unlabeled(xdm_t) depth: 2
#line 388
 	
#line 388
	
#line 388
	
#line 388
		require {
#line 388
			
#line 388
		type unlabeled_t;
#line 388
	
#line 388
		} # end require
#line 388
	
#line 388

#line 388

#line 388
	allow xdm_t unlabeled_t:rawip_socket recvfrom;
#line 388

#line 388
	 	
#line 388
##### end kernel_raw_recvfrom_unlabeled(xdm_t) depth: 1
#line 388
 	
#line 388
	 	 	
#line 388
##### begin kernel_recvfrom_unlabeled_peer(xdm_t) depth: 2
#line 388
 	
#line 388
	
#line 388
	
#line 388
		require {
#line 388
			
#line 388
		type unlabeled_t;
#line 388
	
#line 388
		} # end require
#line 388
	
#line 388

#line 388

#line 388
	allow xdm_t unlabeled_t:peer recv;
#line 388

#line 388
	 	
#line 388
##### end kernel_recvfrom_unlabeled_peer(xdm_t) depth: 1
#line 388
 	
#line 388

#line 388
	# XXX - at some point the oubound/send access check will be removed
#line 388
	# but for right now we need to keep this in place so as not to break
#line 388
	# older systems
#line 388
	 	 	
#line 388
##### begin kernel_sendrecv_unlabeled_association(xdm_t) depth: 2
#line 388
 	
#line 388
	
#line 388
	
#line 388
		require {
#line 388
			
#line 388
		type unlabeled_t;
#line 388
	
#line 388
		} # end require
#line 388
	
#line 388

#line 388

#line 388
	allow xdm_t unlabeled_t:association { sendto recvfrom };
#line 388

#line 388
	 	
#line 388
##### end kernel_sendrecv_unlabeled_association(xdm_t) depth: 1
#line 388
 	
#line 388

#line 388
	 	
#line 388
##### end corenet_all_recvfrom_unlabeled(xdm_t) depth: 0
#line 388
 	
 	 	
#line 389
##### begin corenet_all_recvfrom_netlabel(xdm_t) depth: 1
#line 389
 	
#line 389
	
#line 389
	
#line 389
		require {
#line 389
			
#line 389
		type netlabel_peer_t;
#line 389
	
#line 389
		} # end require
#line 389
	
#line 389

#line 389

#line 389
	allow xdm_t netlabel_peer_t:peer recv;
#line 389
	allow xdm_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 389

#line 389
	 	
#line 389
##### end corenet_all_recvfrom_netlabel(xdm_t) depth: 0
#line 389
 	
 	 	
#line 390
##### begin corenet_tcp_sendrecv_generic_if(xdm_t) depth: 1
#line 390
 	
#line 390
	
#line 390
	
#line 390
		require {
#line 390
			
#line 390
		type netif_t;
#line 390
	
#line 390
		} # end require
#line 390
	
#line 390

#line 390

#line 390
	allow xdm_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 390

#line 390
	 	
#line 390
##### end corenet_tcp_sendrecv_generic_if(xdm_t) depth: 0
#line 390
 	
 	 	
#line 391
##### begin corenet_udp_sendrecv_generic_if(xdm_t) depth: 1
#line 391
 	
#line 391
	 	 	
#line 391
##### begin corenet_udp_send_generic_if(xdm_t) depth: 2
#line 391
 	
#line 391
	
#line 391
	
#line 391
		require {
#line 391
			
#line 391
		type netif_t;
#line 391
	
#line 391
		} # end require
#line 391
	
#line 391

#line 391

#line 391
	allow xdm_t netif_t:netif { udp_send egress };
#line 391

#line 391
	 	
#line 391
##### end corenet_udp_send_generic_if(xdm_t) depth: 1
#line 391
 	
#line 391
	 	 	
#line 391
##### begin corenet_udp_receive_generic_if(xdm_t) depth: 2
#line 391
 	
#line 391
	
#line 391
	
#line 391
		require {
#line 391
			
#line 391
		type netif_t;
#line 391
	
#line 391
		} # end require
#line 391
	
#line 391

#line 391

#line 391
	allow xdm_t netif_t:netif { udp_recv ingress };
#line 391

#line 391
	 	
#line 391
##### end corenet_udp_receive_generic_if(xdm_t) depth: 1
#line 391
 	
#line 391

#line 391
	 	
#line 391
##### end corenet_udp_sendrecv_generic_if(xdm_t) depth: 0
#line 391
 	
 	 	
#line 392
##### begin corenet_tcp_sendrecv_generic_node(xdm_t) depth: 1
#line 392
 	
#line 392
	
#line 392
	
#line 392
		require {
#line 392
			
#line 392
		type node_t;
#line 392
	
#line 392
		} # end require
#line 392
	
#line 392

#line 392

#line 392
	allow xdm_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 392

#line 392
	 	
#line 392
##### end corenet_tcp_sendrecv_generic_node(xdm_t) depth: 0
#line 392
 	
 	 	
#line 393
##### begin corenet_udp_sendrecv_generic_node(xdm_t) depth: 1
#line 393
 	
#line 393
	 	 	
#line 393
##### begin corenet_udp_send_generic_node(xdm_t) depth: 2
#line 393
 	
#line 393
	
#line 393
	
#line 393
		require {
#line 393
			
#line 393
		type node_t;
#line 393
	
#line 393
		} # end require
#line 393
	
#line 393

#line 393

#line 393
	allow xdm_t node_t:node { udp_send sendto };
#line 393

#line 393
	 	
#line 393
##### end corenet_udp_send_generic_node(xdm_t) depth: 1
#line 393
 	
#line 393
	 	 	
#line 393
##### begin corenet_udp_receive_generic_node(xdm_t) depth: 2
#line 393
 	
#line 393
	
#line 393
	
#line 393
		require {
#line 393
			
#line 393
		type node_t;
#line 393
	
#line 393
		} # end require
#line 393
	
#line 393

#line 393

#line 393
	allow xdm_t node_t:node { udp_recv recvfrom };
#line 393

#line 393
	 	
#line 393
##### end corenet_udp_receive_generic_node(xdm_t) depth: 1
#line 393
 	
#line 393

#line 393
	 	
#line 393
##### end corenet_udp_sendrecv_generic_node(xdm_t) depth: 0
#line 393
 	
 	 	
#line 394
##### begin corenet_tcp_sendrecv_all_ports(xdm_t) depth: 1
#line 394
 	
#line 394
	
#line 394
	
#line 394
		require {
#line 394
			
#line 394
		attribute port_type;
#line 394
	
#line 394
		} # end require
#line 394
	
#line 394

#line 394

#line 394
	allow xdm_t port_type:tcp_socket { send_msg recv_msg };
#line 394

#line 394
	 	
#line 394
##### end corenet_tcp_sendrecv_all_ports(xdm_t) depth: 0
#line 394
 	
 	 	
#line 395
##### begin corenet_udp_sendrecv_all_ports(xdm_t) depth: 1
#line 395
 	
#line 395
	 	 	
#line 395
##### begin corenet_udp_send_all_ports(xdm_t) depth: 2
#line 395
 	
#line 395
	
#line 395
	
#line 395
		require {
#line 395
			
#line 395
		attribute port_type;
#line 395
	
#line 395
		} # end require
#line 395
	
#line 395

#line 395

#line 395
	allow xdm_t port_type:udp_socket send_msg;
#line 395

#line 395
	 	
#line 395
##### end corenet_udp_send_all_ports(xdm_t) depth: 1
#line 395
 	
#line 395
	 	 	
#line 395
##### begin corenet_udp_receive_all_ports(xdm_t) depth: 2
#line 395
 	
#line 395
	
#line 395
	
#line 395
		require {
#line 395
			
#line 395
		attribute port_type;
#line 395
	
#line 395
		} # end require
#line 395
	
#line 395

#line 395

#line 395
	allow xdm_t port_type:udp_socket recv_msg;
#line 395

#line 395
	 	
#line 395
##### end corenet_udp_receive_all_ports(xdm_t) depth: 1
#line 395
 	
#line 395

#line 395
	 	
#line 395
##### end corenet_udp_sendrecv_all_ports(xdm_t) depth: 0
#line 395
 	
 	 	
#line 396
##### begin corenet_tcp_bind_generic_node(xdm_t) depth: 1
#line 396
 	
#line 396
	
#line 396
	
#line 396
		require {
#line 396
			
#line 396
		type node_t;
#line 396
	
#line 396
		} # end require
#line 396
	
#line 396

#line 396

#line 396
	allow xdm_t node_t:tcp_socket node_bind;
#line 396

#line 396
	 	
#line 396
##### end corenet_tcp_bind_generic_node(xdm_t) depth: 0
#line 396
 	
 	 	
#line 397
##### begin corenet_udp_bind_generic_node(xdm_t) depth: 1
#line 397
 	
#line 397
	
#line 397
	
#line 397
		require {
#line 397
			
#line 397
		type node_t;
#line 397
	
#line 397
		} # end require
#line 397
	
#line 397

#line 397

#line 397
	allow xdm_t node_t:udp_socket node_bind;
#line 397

#line 397
	 	
#line 397
##### end corenet_udp_bind_generic_node(xdm_t) depth: 0
#line 397
 	
 	 	
#line 398
##### begin corenet_tcp_connect_all_ports(xdm_t) depth: 1
#line 398
 	
#line 398
	
#line 398
	
#line 398
		require {
#line 398
			
#line 398
		attribute port_type;
#line 398
	
#line 398
		} # end require
#line 398
	
#line 398

#line 398

#line 398
	allow xdm_t port_type:tcp_socket name_connect;
#line 398

#line 398
	 	
#line 398
##### end corenet_tcp_connect_all_ports(xdm_t) depth: 0
#line 398
 	
 	 	
#line 399
##### begin corenet_sendrecv_all_client_packets(xdm_t) depth: 1
#line 399
 	
#line 399
	 	 	
#line 399
##### begin corenet_send_all_client_packets(xdm_t) depth: 2
#line 399
 	
#line 399
	
#line 399
	
#line 399
		require {
#line 399
			
#line 399
		attribute client_packet_type;
#line 399
	
#line 399
		} # end require
#line 399
	
#line 399

#line 399

#line 399
	allow xdm_t client_packet_type:packet send;
#line 399

#line 399
	 	
#line 399
##### end corenet_send_all_client_packets(xdm_t) depth: 1
#line 399
 	
#line 399
	 	 	
#line 399
##### begin corenet_receive_all_client_packets(xdm_t) depth: 2
#line 399
 	
#line 399
	
#line 399
	
#line 399
		require {
#line 399
			
#line 399
		attribute client_packet_type;
#line 399
	
#line 399
		} # end require
#line 399
	
#line 399

#line 399

#line 399
	allow xdm_t client_packet_type:packet recv;
#line 399

#line 399
	 	
#line 399
##### end corenet_receive_all_client_packets(xdm_t) depth: 1
#line 399
 	
#line 399

#line 399
	 	
#line 399
##### end corenet_sendrecv_all_client_packets(xdm_t) depth: 0
#line 399
 	
# xdm tries to bind to biff_port_t
 	 	
#line 401
##### begin corenet_dontaudit_tcp_bind_all_ports(xdm_t) depth: 1
#line 401
 	
#line 401
	
#line 401
	
#line 401
		require {
#line 401
			
#line 401
		attribute port_type;
#line 401
	
#line 401
		} # end require
#line 401
	
#line 401

#line 401

#line 401
	dontaudit xdm_t port_type:tcp_socket name_bind;
#line 401

#line 401
	 	
#line 401
##### end corenet_dontaudit_tcp_bind_all_ports(xdm_t) depth: 0
#line 401
 	

 	 	
#line 403
##### begin dev_read_rand(xdm_t) depth: 1
#line 403
 	
#line 403
	
#line 403
	
#line 403
		require {
#line 403
			
#line 403
		type device_t, random_device_t;
#line 403
	
#line 403
		} # end require
#line 403
	
#line 403

#line 403

#line 403
	
#line 403
	allow xdm_t device_t:dir { getattr search open };
#line 403
	allow xdm_t random_device_t:chr_file { getattr open read lock ioctl };
#line 403

#line 403

#line 403
	 	
#line 403
##### end dev_read_rand(xdm_t) depth: 0
#line 403
 	
 	 	
#line 404
##### begin dev_read_sysfs(xdm_t) depth: 1
#line 404
 	
#line 404
	
#line 404
	
#line 404
		require {
#line 404
			
#line 404
		type sysfs_t;
#line 404
	
#line 404
		} # end require
#line 404
	
#line 404

#line 404

#line 404
	
#line 404
	allow xdm_t sysfs_t:dir { getattr search open };
#line 404
	allow xdm_t sysfs_t:file { getattr open read lock ioctl };
#line 404

#line 404
	
#line 404
	allow xdm_t sysfs_t:dir { getattr search open };
#line 404
	allow xdm_t sysfs_t:lnk_file { getattr read };
#line 404

#line 404

#line 404
	
#line 404
	allow xdm_t sysfs_t:dir { getattr search open };
#line 404
	allow xdm_t sysfs_t:dir { getattr search open read lock ioctl };
#line 404

#line 404

#line 404
	 	
#line 404
##### end dev_read_sysfs(xdm_t) depth: 0
#line 404
 	
 	 	
#line 405
##### begin dev_getattr_framebuffer_dev(xdm_t) depth: 1
#line 405
 	
#line 405
	
#line 405
	
#line 405
		require {
#line 405
			
#line 405
		type device_t, framebuf_device_t;
#line 405
	
#line 405
		} # end require
#line 405
	
#line 405

#line 405

#line 405
	
#line 405
	allow xdm_t device_t:dir { getattr search open };
#line 405
	allow xdm_t framebuf_device_t:chr_file { getattr };
#line 405

#line 405

#line 405
	 	
#line 405
##### end dev_getattr_framebuffer_dev(xdm_t) depth: 0
#line 405
 	
 	 	
#line 406
##### begin dev_setattr_framebuffer_dev(xdm_t) depth: 1
#line 406
 	
#line 406
	
#line 406
	
#line 406
		require {
#line 406
			
#line 406
		type device_t, framebuf_device_t;
#line 406
	
#line 406
		} # end require
#line 406
	
#line 406

#line 406

#line 406
	
#line 406
	allow xdm_t device_t:dir { getattr search open };
#line 406
	allow xdm_t framebuf_device_t:chr_file { setattr };
#line 406

#line 406

#line 406
	 	
#line 406
##### end dev_setattr_framebuffer_dev(xdm_t) depth: 0
#line 406
 	
 	 	
#line 407
##### begin dev_getattr_mouse_dev(xdm_t) depth: 1
#line 407
 	
#line 407
	
#line 407
	
#line 407
		require {
#line 407
			
#line 407
		type device_t, mouse_device_t;
#line 407
	
#line 407
		} # end require
#line 407
	
#line 407

#line 407

#line 407
	
#line 407
	allow xdm_t device_t:dir { getattr search open };
#line 407
	allow xdm_t mouse_device_t:chr_file { getattr };
#line 407

#line 407

#line 407
	 	
#line 407
##### end dev_getattr_mouse_dev(xdm_t) depth: 0
#line 407
 	
 	 	
#line 408
##### begin dev_setattr_mouse_dev(xdm_t) depth: 1
#line 408
 	
#line 408
	
#line 408
	
#line 408
		require {
#line 408
			
#line 408
		type device_t, mouse_device_t;
#line 408
	
#line 408
		} # end require
#line 408
	
#line 408

#line 408

#line 408
	
#line 408
	allow xdm_t device_t:dir { getattr search open };
#line 408
	allow xdm_t mouse_device_t:chr_file { setattr };
#line 408

#line 408

#line 408
	 	
#line 408
##### end dev_setattr_mouse_dev(xdm_t) depth: 0
#line 408
 	
 	 	
#line 409
##### begin dev_rw_apm_bios(xdm_t) depth: 1
#line 409
 	
#line 409
	
#line 409
	
#line 409
		require {
#line 409
			
#line 409
		type device_t, apm_bios_t;
#line 409
	
#line 409
		} # end require
#line 409
	
#line 409

#line 409

#line 409
	
#line 409
	allow xdm_t device_t:dir { getattr search open };
#line 409
	allow xdm_t apm_bios_t:chr_file { getattr open read write append ioctl lock };
#line 409

#line 409

#line 409
	 	
#line 409
##### end dev_rw_apm_bios(xdm_t) depth: 0
#line 409
 	
 	 	
#line 410
##### begin dev_setattr_apm_bios_dev(xdm_t) depth: 1
#line 410
 	
#line 410
	
#line 410
	
#line 410
		require {
#line 410
			
#line 410
		type device_t, apm_bios_t;
#line 410
	
#line 410
		} # end require
#line 410
	
#line 410

#line 410

#line 410
	
#line 410
	allow xdm_t device_t:dir { getattr search open };
#line 410
	allow xdm_t apm_bios_t:chr_file { setattr };
#line 410

#line 410

#line 410
	 	
#line 410
##### end dev_setattr_apm_bios_dev(xdm_t) depth: 0
#line 410
 	
 	 	
#line 411
##### begin dev_rw_dri(xdm_t) depth: 1
#line 411
 	
#line 411
	
#line 411
	
#line 411
		require {
#line 411
			
#line 411
		type device_t, dri_device_t;
#line 411
	
#line 411
		} # end require
#line 411
	
#line 411

#line 411

#line 411
	
#line 411
	allow xdm_t device_t:dir { getattr search open };
#line 411
	allow xdm_t dri_device_t:chr_file { getattr open read write append ioctl lock };
#line 411

#line 411

#line 411
	 	
#line 411
##### end dev_rw_dri(xdm_t) depth: 0
#line 411
 	
 	 	
#line 412
##### begin dev_rw_agp(xdm_t) depth: 1
#line 412
 	
#line 412
	
#line 412
	
#line 412
		require {
#line 412
			
#line 412
		type device_t, agp_device_t;
#line 412
	
#line 412
		} # end require
#line 412
	
#line 412

#line 412

#line 412
	
#line 412
	allow xdm_t device_t:dir { getattr search open };
#line 412
	allow xdm_t agp_device_t:chr_file { getattr open read write append ioctl lock };
#line 412

#line 412

#line 412
	 	
#line 412
##### end dev_rw_agp(xdm_t) depth: 0
#line 412
 	
 	 	
#line 413
##### begin dev_getattr_xserver_misc_dev(xdm_t) depth: 1
#line 413
 	
#line 413
	
#line 413
	
#line 413
		require {
#line 413
			
#line 413
		type device_t, xserver_misc_device_t;
#line 413
	
#line 413
		} # end require
#line 413
	
#line 413

#line 413

#line 413
	
#line 413
	allow xdm_t device_t:dir { getattr search open };
#line 413
	allow xdm_t xserver_misc_device_t:chr_file { getattr };
#line 413

#line 413

#line 413
	 	
#line 413
##### end dev_getattr_xserver_misc_dev(xdm_t) depth: 0
#line 413
 	
 	 	
#line 414
##### begin dev_setattr_xserver_misc_dev(xdm_t) depth: 1
#line 414
 	
#line 414
	
#line 414
	
#line 414
		require {
#line 414
			
#line 414
		type device_t, xserver_misc_device_t;
#line 414
	
#line 414
		} # end require
#line 414
	
#line 414

#line 414

#line 414
	
#line 414
	allow xdm_t device_t:dir { getattr search open };
#line 414
	allow xdm_t xserver_misc_device_t:chr_file { setattr };
#line 414

#line 414

#line 414
	 	
#line 414
##### end dev_setattr_xserver_misc_dev(xdm_t) depth: 0
#line 414
 	
 	 	
#line 415
##### begin dev_getattr_misc_dev(xdm_t) depth: 1
#line 415
 	
#line 415
	
#line 415
	
#line 415
		require {
#line 415
			
#line 415
		type device_t, misc_device_t;
#line 415
	
#line 415
		} # end require
#line 415
	
#line 415

#line 415

#line 415
	
#line 415
	allow xdm_t device_t:dir { getattr search open };
#line 415
	allow xdm_t misc_device_t:chr_file { getattr };
#line 415

#line 415

#line 415
	 	
#line 415
##### end dev_getattr_misc_dev(xdm_t) depth: 0
#line 415
 	
 	 	
#line 416
##### begin dev_setattr_misc_dev(xdm_t) depth: 1
#line 416
 	
#line 416
	
#line 416
	
#line 416
		require {
#line 416
			
#line 416
		type device_t, misc_device_t;
#line 416
	
#line 416
		} # end require
#line 416
	
#line 416

#line 416

#line 416
	
#line 416
	allow xdm_t device_t:dir { getattr search open };
#line 416
	allow xdm_t misc_device_t:chr_file { setattr };
#line 416

#line 416

#line 416
	 	
#line 416
##### end dev_setattr_misc_dev(xdm_t) depth: 0
#line 416
 	
 	 	
#line 417
##### begin dev_dontaudit_rw_misc(xdm_t) depth: 1
#line 417
 	
#line 417
	
#line 417
	
#line 417
		require {
#line 417
			
#line 417
		type misc_device_t;
#line 417
	
#line 417
		} # end require
#line 417
	
#line 417

#line 417

#line 417
	dontaudit xdm_t misc_device_t:chr_file { getattr open read write append ioctl lock };
#line 417

#line 417
	 	
#line 417
##### end dev_dontaudit_rw_misc(xdm_t) depth: 0
#line 417
 	
 	 	
#line 418
##### begin dev_getattr_video_dev(xdm_t) depth: 1
#line 418
 	
#line 418
	
#line 418
	
#line 418
		require {
#line 418
			
#line 418
		type device_t, v4l_device_t;
#line 418
	
#line 418
		} # end require
#line 418
	
#line 418

#line 418

#line 418
	
#line 418
	allow xdm_t device_t:dir { getattr search open };
#line 418
	allow xdm_t v4l_device_t:chr_file { getattr };
#line 418

#line 418

#line 418
	 	
#line 418
##### end dev_getattr_video_dev(xdm_t) depth: 0
#line 418
 	
 	 	
#line 419
##### begin dev_setattr_video_dev(xdm_t) depth: 1
#line 419
 	
#line 419
	
#line 419
	
#line 419
		require {
#line 419
			
#line 419
		type device_t, v4l_device_t;
#line 419
	
#line 419
		} # end require
#line 419
	
#line 419

#line 419

#line 419
	
#line 419
	allow xdm_t device_t:dir { getattr search open };
#line 419
	allow xdm_t v4l_device_t:chr_file { setattr };
#line 419

#line 419

#line 419
	 	
#line 419
##### end dev_setattr_video_dev(xdm_t) depth: 0
#line 419
 	
 	 	
#line 420
##### begin dev_getattr_scanner_dev(xdm_t) depth: 1
#line 420
 	
#line 420
	
#line 420
	
#line 420
		require {
#line 420
			
#line 420
		type device_t, scanner_device_t;
#line 420
	
#line 420
		} # end require
#line 420
	
#line 420

#line 420

#line 420
	
#line 420
	allow xdm_t device_t:dir { getattr search open };
#line 420
	allow xdm_t scanner_device_t:chr_file { getattr };
#line 420

#line 420

#line 420
	 	
#line 420
##### end dev_getattr_scanner_dev(xdm_t) depth: 0
#line 420
 	
 	 	
#line 421
##### begin dev_setattr_scanner_dev(xdm_t) depth: 1
#line 421
 	
#line 421
	
#line 421
	
#line 421
		require {
#line 421
			
#line 421
		type device_t, scanner_device_t;
#line 421
	
#line 421
		} # end require
#line 421
	
#line 421

#line 421

#line 421
	
#line 421
	allow xdm_t device_t:dir { getattr search open };
#line 421
	allow xdm_t scanner_device_t:chr_file { setattr };
#line 421

#line 421

#line 421
	 	
#line 421
##### end dev_setattr_scanner_dev(xdm_t) depth: 0
#line 421
 	
 	 	
#line 422
##### begin dev_getattr_sound_dev(xdm_t) depth: 1
#line 422
 	
#line 422
	
#line 422
	
#line 422
		require {
#line 422
			
#line 422
		type device_t, sound_device_t;
#line 422
	
#line 422
		} # end require
#line 422
	
#line 422

#line 422

#line 422
	
#line 422
	allow xdm_t device_t:dir { getattr search open };
#line 422
	allow xdm_t sound_device_t:chr_file { getattr };
#line 422

#line 422

#line 422
	 	
#line 422
##### end dev_getattr_sound_dev(xdm_t) depth: 0
#line 422
 	
 	 	
#line 423
##### begin dev_setattr_sound_dev(xdm_t) depth: 1
#line 423
 	
#line 423
	
#line 423
	
#line 423
		require {
#line 423
			
#line 423
		type device_t, sound_device_t;
#line 423
	
#line 423
		} # end require
#line 423
	
#line 423

#line 423

#line 423
	
#line 423
	allow xdm_t device_t:dir { getattr search open };
#line 423
	allow xdm_t sound_device_t:chr_file { setattr };
#line 423

#line 423

#line 423
	 	
#line 423
##### end dev_setattr_sound_dev(xdm_t) depth: 0
#line 423
 	
 	 	
#line 424
##### begin dev_getattr_power_mgmt_dev(xdm_t) depth: 1
#line 424
 	
#line 424
	
#line 424
	
#line 424
		require {
#line 424
			
#line 424
		type device_t, power_device_t;
#line 424
	
#line 424
		} # end require
#line 424
	
#line 424

#line 424

#line 424
	
#line 424
	allow xdm_t device_t:dir { getattr search open };
#line 424
	allow xdm_t power_device_t:chr_file { getattr };
#line 424

#line 424

#line 424
	 	
#line 424
##### end dev_getattr_power_mgmt_dev(xdm_t) depth: 0
#line 424
 	
 	 	
#line 425
##### begin dev_setattr_power_mgmt_dev(xdm_t) depth: 1
#line 425
 	
#line 425
	
#line 425
	
#line 425
		require {
#line 425
			
#line 425
		type device_t, power_device_t;
#line 425
	
#line 425
		} # end require
#line 425
	
#line 425

#line 425

#line 425
	
#line 425
	allow xdm_t device_t:dir { getattr search open };
#line 425
	allow xdm_t power_device_t:chr_file { setattr };
#line 425

#line 425

#line 425
	 	
#line 425
##### end dev_setattr_power_mgmt_dev(xdm_t) depth: 0
#line 425
 	

 	 	
#line 427
##### begin domain_use_interactive_fds(xdm_t) depth: 1
#line 427
 	
#line 427
	
#line 427
	
#line 427
		require {
#line 427
			
#line 427
		attribute privfd;
#line 427
	
#line 427
		} # end require
#line 427
	
#line 427

#line 427

#line 427
	allow xdm_t privfd:fd use;
#line 427

#line 427
	 	
#line 427
##### end domain_use_interactive_fds(xdm_t) depth: 0
#line 427
 	
# Do not audit denied probes of /proc.
 	 	
#line 429
##### begin domain_dontaudit_read_all_domains_state(xdm_t) depth: 1
#line 429
 	
#line 429
	
#line 429
	
#line 429
		require {
#line 429
			
#line 429
		attribute domain;
#line 429
	
#line 429
		} # end require
#line 429
	
#line 429

#line 429

#line 429
	dontaudit xdm_t domain:dir { getattr search open read lock ioctl };
#line 429
	dontaudit xdm_t domain:lnk_file { getattr read };
#line 429
	dontaudit xdm_t domain:file { getattr open read lock ioctl };
#line 429

#line 429
	# cjp: these should be removed:
#line 429
	dontaudit xdm_t domain:sock_file { getattr open read };
#line 429
	dontaudit xdm_t domain:fifo_file { getattr open read lock ioctl };
#line 429

#line 429
	 	
#line 429
##### end domain_dontaudit_read_all_domains_state(xdm_t) depth: 0
#line 429
 	

 	 	
#line 431
##### begin files_read_etc_files(xdm_t) depth: 1
#line 431
 	
#line 431
	
#line 431
	
#line 431
		require {
#line 431
			
#line 431
		type etc_t;
#line 431
	
#line 431
		} # end require
#line 431
	
#line 431

#line 431

#line 431
	allow xdm_t etc_t:dir { getattr search open read lock ioctl };
#line 431
	
#line 431
	allow xdm_t etc_t:dir { getattr search open };
#line 431
	allow xdm_t etc_t:file { getattr open read lock ioctl };
#line 431

#line 431
	
#line 431
	allow xdm_t etc_t:dir { getattr search open };
#line 431
	allow xdm_t etc_t:lnk_file { getattr read };
#line 431

#line 431

#line 431
	 	
#line 431
##### end files_read_etc_files(xdm_t) depth: 0
#line 431
 	
 	 	
#line 432
##### begin files_read_var_files(xdm_t) depth: 1
#line 432
 	
#line 432
	
#line 432
	
#line 432
		require {
#line 432
			
#line 432
		type var_t;
#line 432
	
#line 432
		} # end require
#line 432
	
#line 432

#line 432

#line 432
	
#line 432
	allow xdm_t var_t:dir { getattr search open };
#line 432
	allow xdm_t var_t:file { getattr open read lock ioctl };
#line 432

#line 432

#line 432
	 	
#line 432
##### end files_read_var_files(xdm_t) depth: 0
#line 432
 	
 	 	
#line 433
##### begin files_read_etc_runtime_files(xdm_t) depth: 1
#line 433
 	
#line 433
	
#line 433
	
#line 433
		require {
#line 433
			
#line 433
		type etc_t, etc_runtime_t;
#line 433
	
#line 433
		} # end require
#line 433
	
#line 433

#line 433

#line 433
	allow xdm_t etc_t:dir { getattr search open read lock ioctl };
#line 433
	
#line 433
	allow xdm_t etc_t:dir { getattr search open };
#line 433
	allow xdm_t etc_runtime_t:file { getattr open read lock ioctl };
#line 433

#line 433
	
#line 433
	allow xdm_t etc_t:dir { getattr search open };
#line 433
	allow xdm_t etc_runtime_t:lnk_file { getattr read };
#line 433

#line 433

#line 433
	 	
#line 433
##### end files_read_etc_runtime_files(xdm_t) depth: 0
#line 433
 	
 	 	
#line 434
##### begin files_exec_etc_files(xdm_t) depth: 1
#line 434
 	
#line 434
	
#line 434
	
#line 434
		require {
#line 434
			
#line 434
		type etc_t;
#line 434
	
#line 434
		} # end require
#line 434
	
#line 434

#line 434

#line 434
	allow xdm_t etc_t:dir { getattr search open read lock ioctl };
#line 434
	
#line 434
	allow xdm_t etc_t:dir { getattr search open };
#line 434
	allow xdm_t etc_t:lnk_file { getattr read };
#line 434

#line 434
	
#line 434
	allow xdm_t etc_t:dir { getattr search open };
#line 434
	allow xdm_t etc_t:file { getattr open read execute ioctl execute_no_trans };
#line 434

#line 434

#line 434
	 	
#line 434
##### end files_exec_etc_files(xdm_t) depth: 0
#line 434
 	
 	 	
#line 435
##### begin files_list_mnt(xdm_t) depth: 1
#line 435
 	
#line 435
	
#line 435
	
#line 435
		require {
#line 435
			
#line 435
		type mnt_t;
#line 435
	
#line 435
		} # end require
#line 435
	
#line 435

#line 435

#line 435
	allow xdm_t mnt_t:dir { getattr search open read lock ioctl };
#line 435

#line 435
	 	
#line 435
##### end files_list_mnt(xdm_t) depth: 0
#line 435
 	
# Read /usr/share/terminfo/l/linux and /usr/share/icons/default/index.theme...
 	 	
#line 437
##### begin files_read_usr_files(xdm_t) depth: 1
#line 437
 	
#line 437
	
#line 437
	
#line 437
		require {
#line 437
			
#line 437
		type usr_t;
#line 437
	
#line 437
		} # end require
#line 437
	
#line 437

#line 437

#line 437
	allow xdm_t usr_t:dir { getattr search open read lock ioctl };
#line 437
	
#line 437
	allow xdm_t usr_t:dir { getattr search open };
#line 437
	allow xdm_t usr_t:file { getattr open read lock ioctl };
#line 437

#line 437
	
#line 437
	allow xdm_t usr_t:dir { getattr search open };
#line 437
	allow xdm_t usr_t:lnk_file { getattr read };
#line 437

#line 437

#line 437
	 	
#line 437
##### end files_read_usr_files(xdm_t) depth: 0
#line 437
 	
# Poweroff wants to create the /poweroff file when run from xdm
 	 	
#line 439
##### begin files_create_boot_flag(xdm_t) depth: 1
#line 439
 	
#line 439
	
#line 439
	
#line 439
		require {
#line 439
			
#line 439
		type root_t, etc_runtime_t;
#line 439
	
#line 439
		} # end require
#line 439
	
#line 439

#line 439

#line 439
	allow xdm_t etc_runtime_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 439
	
#line 439
	allow xdm_t root_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 439
	type_transition xdm_t root_t:file etc_runtime_t ;
#line 439

#line 439

#line 439
	 	
#line 439
##### end files_create_boot_flag(xdm_t) depth: 0
#line 439
 	

 	 	
#line 441
##### begin fs_getattr_all_fs(xdm_t) depth: 1
#line 441
 	
#line 441
	
#line 441
	
#line 441
		require {
#line 441
			
#line 441
		attribute filesystem_type;
#line 441
	
#line 441
		} # end require
#line 441
	
#line 441

#line 441

#line 441
	allow xdm_t filesystem_type:filesystem getattr;
#line 441
	 	 	
#line 441
##### begin files_getattr_all_file_type_fs(xdm_t) depth: 2
#line 441
 	
#line 441
	
#line 441
	
#line 441
		require {
#line 441
			
#line 441
		attribute file_type;
#line 441
	
#line 441
		} # end require
#line 441
	
#line 441

#line 441

#line 441
	allow xdm_t file_type:filesystem getattr;
#line 441

#line 441
	 	
#line 441
##### end files_getattr_all_file_type_fs(xdm_t) depth: 1
#line 441
 	
#line 441

#line 441
	 	
#line 441
##### end fs_getattr_all_fs(xdm_t) depth: 0
#line 441
 	
 	 	
#line 442
##### begin fs_search_auto_mountpoints(xdm_t) depth: 1
#line 442
 	
#line 442
	
#line 442
	
#line 442
		require {
#line 442
			
#line 442
		type autofs_t;
#line 442
	
#line 442
		} # end require
#line 442
	
#line 442

#line 442

#line 442
	allow xdm_t autofs_t:dir { getattr search open };
#line 442

#line 442
	 	
#line 442
##### end fs_search_auto_mountpoints(xdm_t) depth: 0
#line 442
 	

 	 	
#line 444
##### begin storage_dontaudit_read_fixed_disk(xdm_t) depth: 1
#line 444
 	
#line 444
	
#line 444
	
#line 444
		require {
#line 444
			
#line 444
		type fixed_disk_device_t;
#line 444

#line 444
	
#line 444
		} # end require
#line 444
	
#line 444

#line 444

#line 444
	dontaudit xdm_t fixed_disk_device_t:blk_file { getattr open read lock ioctl };
#line 444
	dontaudit xdm_t fixed_disk_device_t:chr_file { getattr open read lock ioctl };
#line 444

#line 444
	 	
#line 444
##### end storage_dontaudit_read_fixed_disk(xdm_t) depth: 0
#line 444
 	
 	 	
#line 445
##### begin storage_dontaudit_write_fixed_disk(xdm_t) depth: 1
#line 445
 	
#line 445
	
#line 445
	
#line 445
		require {
#line 445
			
#line 445
		type fixed_disk_device_t;
#line 445

#line 445
	
#line 445
		} # end require
#line 445
	
#line 445

#line 445

#line 445
	dontaudit xdm_t fixed_disk_device_t:blk_file { getattr open write append lock ioctl };
#line 445

#line 445
	 	
#line 445
##### end storage_dontaudit_write_fixed_disk(xdm_t) depth: 0
#line 445
 	
 	 	
#line 446
##### begin storage_dontaudit_setattr_fixed_disk_dev(xdm_t) depth: 1
#line 446
 	
#line 446
	
#line 446
	
#line 446
		require {
#line 446
			
#line 446
		type fixed_disk_device_t;
#line 446
	
#line 446
		} # end require
#line 446
	
#line 446

#line 446

#line 446
	dontaudit xdm_t fixed_disk_device_t:blk_file setattr;
#line 446

#line 446
	 	
#line 446
##### end storage_dontaudit_setattr_fixed_disk_dev(xdm_t) depth: 0
#line 446
 	
 	 	
#line 447
##### begin storage_dontaudit_raw_read_removable_device(xdm_t) depth: 1
#line 447
 	
#line 447
	
#line 447
	
#line 447
		require {
#line 447
			
#line 447
		type removable_device_t;
#line 447
	
#line 447
		} # end require
#line 447
	
#line 447

#line 447

#line 447
	dontaudit xdm_t removable_device_t:blk_file { getattr open read lock ioctl };
#line 447

#line 447
	 	
#line 447
##### end storage_dontaudit_raw_read_removable_device(xdm_t) depth: 0
#line 447
 	
 	 	
#line 448
##### begin storage_dontaudit_raw_write_removable_device(xdm_t) depth: 1
#line 448
 	
#line 448
	
#line 448
	
#line 448
		require {
#line 448
			
#line 448
		type removable_device_t;
#line 448
	
#line 448
		} # end require
#line 448
	
#line 448

#line 448

#line 448
	dontaudit xdm_t removable_device_t:blk_file { getattr open write append lock ioctl };
#line 448

#line 448
	 	
#line 448
##### end storage_dontaudit_raw_write_removable_device(xdm_t) depth: 0
#line 448
 	
 	 	
#line 449
##### begin storage_dontaudit_setattr_removable_dev(xdm_t) depth: 1
#line 449
 	
#line 449
	
#line 449
	
#line 449
		require {
#line 449
			
#line 449
		type removable_device_t;
#line 449
	
#line 449
		} # end require
#line 449
	
#line 449

#line 449

#line 449
	dontaudit xdm_t removable_device_t:blk_file setattr;
#line 449

#line 449
	 	
#line 449
##### end storage_dontaudit_setattr_removable_dev(xdm_t) depth: 0
#line 449
 	
 	 	
#line 450
##### begin storage_dontaudit_rw_scsi_generic(xdm_t) depth: 1
#line 450
 	
#line 450
	
#line 450
	
#line 450
		require {
#line 450
			
#line 450
		type scsi_generic_device_t;
#line 450
	
#line 450
		} # end require
#line 450
	
#line 450

#line 450

#line 450
	dontaudit xdm_t scsi_generic_device_t:chr_file { getattr open read write append ioctl lock };
#line 450

#line 450
	 	
#line 450
##### end storage_dontaudit_rw_scsi_generic(xdm_t) depth: 0
#line 450
 	

 	 	
#line 452
##### begin term_setattr_console(xdm_t) depth: 1
#line 452
 	
#line 452
	
#line 452
	
#line 452
		require {
#line 452
			
#line 452
		type console_device_t;
#line 452
	
#line 452
		} # end require
#line 452
	
#line 452

#line 452

#line 452
	 	 	
#line 452
##### begin dev_list_all_dev_nodes(xdm_t) depth: 2
#line 452
 	
#line 452
	
#line 452
	
#line 452
		require {
#line 452
			
#line 452
		type device_t;
#line 452
	
#line 452
		} # end require
#line 452
	
#line 452

#line 452

#line 452
	
#line 452
	allow xdm_t device_t:dir { getattr search open };
#line 452
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 452

#line 452
	
#line 452
	allow xdm_t device_t:dir { getattr search open };
#line 452
	allow xdm_t device_t:lnk_file { getattr read };
#line 452

#line 452

#line 452
	 	
#line 452
##### end dev_list_all_dev_nodes(xdm_t) depth: 1
#line 452
 	
#line 452
	allow xdm_t console_device_t:chr_file setattr;
#line 452

#line 452
	 	
#line 452
##### end term_setattr_console(xdm_t) depth: 0
#line 452
 	
 	 	
#line 453
##### begin term_use_unallocated_ttys(xdm_t) depth: 1
#line 453
 	
#line 453
	
#line 453
	
#line 453
		require {
#line 453
			
#line 453
		type tty_device_t;
#line 453
	
#line 453
		} # end require
#line 453
	
#line 453

#line 453

#line 453
	 	 	
#line 453
##### begin dev_list_all_dev_nodes(xdm_t) depth: 2
#line 453
 	
#line 453
	
#line 453
	
#line 453
		require {
#line 453
			
#line 453
		type device_t;
#line 453
	
#line 453
		} # end require
#line 453
	
#line 453

#line 453

#line 453
	
#line 453
	allow xdm_t device_t:dir { getattr search open };
#line 453
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 453

#line 453
	
#line 453
	allow xdm_t device_t:dir { getattr search open };
#line 453
	allow xdm_t device_t:lnk_file { getattr read };
#line 453

#line 453

#line 453
	 	
#line 453
##### end dev_list_all_dev_nodes(xdm_t) depth: 1
#line 453
 	
#line 453
	allow xdm_t tty_device_t:chr_file { getattr open read write append ioctl lock };
#line 453

#line 453
	 	
#line 453
##### end term_use_unallocated_ttys(xdm_t) depth: 0
#line 453
 	
 	 	
#line 454
##### begin term_setattr_unallocated_ttys(xdm_t) depth: 1
#line 454
 	
#line 454
	
#line 454
	
#line 454
		require {
#line 454
			
#line 454
		type tty_device_t;
#line 454
	
#line 454
		} # end require
#line 454
	
#line 454

#line 454

#line 454
	 	 	
#line 454
##### begin dev_list_all_dev_nodes(xdm_t) depth: 2
#line 454
 	
#line 454
	
#line 454
	
#line 454
		require {
#line 454
			
#line 454
		type device_t;
#line 454
	
#line 454
		} # end require
#line 454
	
#line 454

#line 454

#line 454
	
#line 454
	allow xdm_t device_t:dir { getattr search open };
#line 454
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 454

#line 454
	
#line 454
	allow xdm_t device_t:dir { getattr search open };
#line 454
	allow xdm_t device_t:lnk_file { getattr read };
#line 454

#line 454

#line 454
	 	
#line 454
##### end dev_list_all_dev_nodes(xdm_t) depth: 1
#line 454
 	
#line 454
	allow xdm_t tty_device_t:chr_file setattr;
#line 454

#line 454
	 	
#line 454
##### end term_setattr_unallocated_ttys(xdm_t) depth: 0
#line 454
 	

 	 	
#line 456
##### begin auth_domtrans_pam_console(xdm_t) depth: 1
#line 456
 	
#line 456
	
#line 456
	
#line 456
		require {
#line 456
			
#line 456
		type pam_console_t, pam_console_exec_t;
#line 456
	
#line 456
		} # end require
#line 456
	
#line 456

#line 456

#line 456
	
#line 456
	
#line 456
	
#line 456
	allow xdm_t pam_console_exec_t:file { getattr open read execute };
#line 456
	allow xdm_t pam_console_t:process transition;
#line 456
	dontaudit xdm_t pam_console_t:process { noatsecure siginh rlimitinh };
#line 456

#line 456
	type_transition xdm_t pam_console_exec_t:process pam_console_t;
#line 456

#line 456

#line 456
	allow pam_console_t xdm_t:fd use;
#line 456
	allow pam_console_t xdm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 456
	allow pam_console_t xdm_t:process sigchld;
#line 456

#line 456

#line 456
	 	
#line 456
##### end auth_domtrans_pam_console(xdm_t) depth: 0
#line 456
 	
 	 	
#line 457
##### begin auth_manage_pam_pid(xdm_t) depth: 1
#line 457
 	
#line 457
	
#line 457
	
#line 457
		require {
#line 457
			
#line 457
		type pam_var_run_t;
#line 457
	
#line 457
		} # end require
#line 457
	
#line 457

#line 457

#line 457
	 	 	
#line 457
##### begin files_search_pids(xdm_t) depth: 2
#line 457
 	
#line 457
	
#line 457
	
#line 457
		require {
#line 457
			
#line 457
		type var_t, var_run_t;
#line 457
	
#line 457
		} # end require
#line 457
	
#line 457

#line 457

#line 457
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 457
	
#line 457
	allow xdm_t var_t:dir { getattr search open };
#line 457
	allow xdm_t var_run_t:dir { getattr search open };
#line 457

#line 457

#line 457
	 	
#line 457
##### end files_search_pids(xdm_t) depth: 1
#line 457
 	
#line 457
	allow xdm_t pam_var_run_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 457
	allow xdm_t pam_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 457

#line 457
	 	
#line 457
##### end auth_manage_pam_pid(xdm_t) depth: 0
#line 457
 	
 	 	
#line 458
##### begin auth_manage_pam_console_data(xdm_t) depth: 1
#line 458
 	
#line 458
	
#line 458
	
#line 458
		require {
#line 458
			
#line 458
		type pam_var_console_t;
#line 458
	
#line 458
		} # end require
#line 458
	
#line 458

#line 458

#line 458
	 	 	
#line 458
##### begin files_search_pids(xdm_t) depth: 2
#line 458
 	
#line 458
	
#line 458
	
#line 458
		require {
#line 458
			
#line 458
		type var_t, var_run_t;
#line 458
	
#line 458
		} # end require
#line 458
	
#line 458

#line 458

#line 458
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 458
	
#line 458
	allow xdm_t var_t:dir { getattr search open };
#line 458
	allow xdm_t var_run_t:dir { getattr search open };
#line 458

#line 458

#line 458
	 	
#line 458
##### end files_search_pids(xdm_t) depth: 1
#line 458
 	
#line 458
	
#line 458
	allow xdm_t pam_var_console_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 458
	allow xdm_t pam_var_console_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 458

#line 458
	
#line 458
	allow xdm_t pam_var_console_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 458
	allow xdm_t pam_var_console_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 458

#line 458

#line 458
	 	
#line 458
##### end auth_manage_pam_console_data(xdm_t) depth: 0
#line 458
 	
 	 	
#line 459
##### begin auth_rw_faillog(xdm_t) depth: 1
#line 459
 	
#line 459
	
#line 459
	
#line 459
		require {
#line 459
			
#line 459
		type faillog_t;
#line 459
	
#line 459
		} # end require
#line 459
	
#line 459

#line 459

#line 459
	 	 	
#line 459
##### begin logging_search_logs(xdm_t) depth: 2
#line 459
 	
#line 459
	
#line 459
	
#line 459
		require {
#line 459
			
#line 459
		type var_log_t;
#line 459
	
#line 459
		} # end require
#line 459
	
#line 459

#line 459

#line 459
	 	 	
#line 459
##### begin files_search_var(xdm_t) depth: 3
#line 459
 	
#line 459
	
#line 459
	
#line 459
		require {
#line 459
			
#line 459
		type var_t;
#line 459
	
#line 459
		} # end require
#line 459
	
#line 459

#line 459

#line 459
	allow xdm_t var_t:dir { getattr search open };
#line 459

#line 459
	 	
#line 459
##### end files_search_var(xdm_t) depth: 2
#line 459
 	
#line 459
	allow xdm_t var_log_t:dir { getattr search open };
#line 459
	allow xdm_t var_log_t:lnk_file { getattr read };
#line 459

#line 459
	 	
#line 459
##### end logging_search_logs(xdm_t) depth: 1
#line 459
 	
#line 459
	allow xdm_t faillog_t:file { getattr open read write append ioctl lock };
#line 459

#line 459
	 	
#line 459
##### end auth_rw_faillog(xdm_t) depth: 0
#line 459
 	
 	 	
#line 460
##### begin auth_write_login_records(xdm_t) depth: 1
#line 460
 	
#line 460
	
#line 460
	
#line 460
		require {
#line 460
			
#line 460
		type wtmp_t;
#line 460
	
#line 460
		} # end require
#line 460
	
#line 460

#line 460

#line 460
	allow xdm_t wtmp_t:file { { getattr open write append lock ioctl } lock };
#line 460

#line 460
	 	
#line 460
##### end auth_write_login_records(xdm_t) depth: 0
#line 460
 	

# Run telinit->init to shutdown.
 	 	
#line 463
##### begin init_telinit(xdm_t) depth: 1
#line 463
 	
#line 463
	
#line 463
	
#line 463
		require {
#line 463
			
#line 463
		type initctl_t;
#line 463
	
#line 463
		} # end require
#line 463
	
#line 463

#line 463

#line 463
	 	 	
#line 463
##### begin corecmd_exec_bin(xdm_t) depth: 2
#line 463
 	
#line 463
	
#line 463
	
#line 463
		require {
#line 463
			
#line 463
		type bin_t;
#line 463
	
#line 463
		} # end require
#line 463
	
#line 463

#line 463

#line 463
	
#line 463
	allow xdm_t bin_t:dir { getattr search open };
#line 463
	allow xdm_t bin_t:lnk_file { getattr read };
#line 463

#line 463
	
#line 463
	allow xdm_t bin_t:dir { getattr search open };
#line 463
	allow xdm_t bin_t:dir { getattr search open read lock ioctl };
#line 463

#line 463
	allow xdm_t bin_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 463

#line 463
	 	
#line 463
##### end corecmd_exec_bin(xdm_t) depth: 1
#line 463
 	
#line 463

#line 463
	 	 	
#line 463
##### begin dev_list_all_dev_nodes(xdm_t) depth: 2
#line 463
 	
#line 463
	
#line 463
	
#line 463
		require {
#line 463
			
#line 463
		type device_t;
#line 463
	
#line 463
		} # end require
#line 463
	
#line 463

#line 463

#line 463
	
#line 463
	allow xdm_t device_t:dir { getattr search open };
#line 463
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 463

#line 463
	
#line 463
	allow xdm_t device_t:dir { getattr search open };
#line 463
	allow xdm_t device_t:lnk_file { getattr read };
#line 463

#line 463

#line 463
	 	
#line 463
##### end dev_list_all_dev_nodes(xdm_t) depth: 1
#line 463
 	
#line 463
	allow xdm_t initctl_t:fifo_file { open { getattr read write append ioctl lock } };
#line 463

#line 463
	 	 	
#line 463
##### begin init_exec(xdm_t) depth: 2
#line 463
 	
#line 463
	
#line 463
	
#line 463
		require {
#line 463
			
#line 463
		type init_exec_t;
#line 463
	
#line 463
		} # end require
#line 463
	
#line 463

#line 463

#line 463
	 	 	
#line 463
##### begin corecmd_search_bin(xdm_t) depth: 3
#line 463
 	
#line 463
	
#line 463
	
#line 463
		require {
#line 463
			
#line 463
		type bin_t;
#line 463
	
#line 463
		} # end require
#line 463
	
#line 463

#line 463

#line 463
	
#line 463
	allow xdm_t bin_t:dir { getattr search open };
#line 463
	allow xdm_t bin_t:dir { getattr search open };
#line 463

#line 463

#line 463
	 	
#line 463
##### end corecmd_search_bin(xdm_t) depth: 2
#line 463
 	
#line 463
	allow xdm_t init_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 463

#line 463
	 	
#line 463
##### end init_exec(xdm_t) depth: 1
#line 463
 	
#line 463

#line 463
	
#line 463

#line 463
	 	
#line 463
##### end init_telinit(xdm_t) depth: 0
#line 463
 	

 	 	
#line 465
##### begin libs_exec_lib_files(xdm_t) depth: 1
#line 465
 	
#line 465
	
#line 465
	
#line 465
		require {
#line 465
			
#line 465
		type lib_t;
#line 465
	
#line 465
		} # end require
#line 465
	
#line 465

#line 465

#line 465
	 	 	
#line 465
##### begin files_search_usr(xdm_t) depth: 2
#line 465
 	
#line 465
	
#line 465
	
#line 465
		require {
#line 465
			
#line 465
		type usr_t;
#line 465
	
#line 465
		} # end require
#line 465
	
#line 465

#line 465

#line 465
	allow xdm_t usr_t:dir { getattr search open };
#line 465

#line 465
	 	
#line 465
##### end files_search_usr(xdm_t) depth: 1
#line 465
 	
#line 465
	allow xdm_t lib_t:dir { getattr search open read lock ioctl };
#line 465
	
#line 465
	allow xdm_t lib_t:dir { getattr search open };
#line 465
	allow xdm_t lib_t:lnk_file { getattr read };
#line 465

#line 465
	
#line 465
	allow xdm_t lib_t:dir { getattr search open };
#line 465
	allow xdm_t lib_t:file { getattr open read execute ioctl execute_no_trans };
#line 465

#line 465

#line 465
	 	
#line 465
##### end libs_exec_lib_files(xdm_t) depth: 0
#line 465
 	

 	 	
#line 467
##### begin logging_read_generic_logs(xdm_t) depth: 1
#line 467
 	
#line 467
	
#line 467
	
#line 467
		require {
#line 467
			
#line 467
		type var_log_t;
#line 467
	
#line 467
		} # end require
#line 467
	
#line 467

#line 467

#line 467
	 	 	
#line 467
##### begin files_search_var(xdm_t) depth: 2
#line 467
 	
#line 467
	
#line 467
	
#line 467
		require {
#line 467
			
#line 467
		type var_t;
#line 467
	
#line 467
		} # end require
#line 467
	
#line 467

#line 467

#line 467
	allow xdm_t var_t:dir { getattr search open };
#line 467

#line 467
	 	
#line 467
##### end files_search_var(xdm_t) depth: 1
#line 467
 	
#line 467
	allow xdm_t var_log_t:dir { getattr search open read lock ioctl };
#line 467
	
#line 467
	allow xdm_t var_log_t:dir { getattr search open };
#line 467
	allow xdm_t var_log_t:file { getattr open read lock ioctl };
#line 467

#line 467

#line 467
	 	
#line 467
##### end logging_read_generic_logs(xdm_t) depth: 0
#line 467
 	

 	 	
#line 469
##### begin miscfiles_read_localization(xdm_t) depth: 1
#line 469
 	
#line 469
	
#line 469
	
#line 469
		require {
#line 469
			
#line 469
		type locale_t;
#line 469
	
#line 469
		} # end require
#line 469
	
#line 469

#line 469

#line 469
	 	 	
#line 469
##### begin files_read_etc_symlinks(xdm_t) depth: 2
#line 469
 	
#line 469
	
#line 469
	
#line 469
		require {
#line 469
			
#line 469
		type etc_t;
#line 469
	
#line 469
		} # end require
#line 469
	
#line 469

#line 469

#line 469
	
#line 469
	allow xdm_t etc_t:dir { getattr search open };
#line 469
	allow xdm_t etc_t:lnk_file { getattr read };
#line 469

#line 469

#line 469
	 	
#line 469
##### end files_read_etc_symlinks(xdm_t) depth: 1
#line 469
 	
#line 469
	 	 	
#line 469
##### begin files_search_usr(xdm_t) depth: 2
#line 469
 	
#line 469
	
#line 469
	
#line 469
		require {
#line 469
			
#line 469
		type usr_t;
#line 469
	
#line 469
		} # end require
#line 469
	
#line 469

#line 469

#line 469
	allow xdm_t usr_t:dir { getattr search open };
#line 469

#line 469
	 	
#line 469
##### end files_search_usr(xdm_t) depth: 1
#line 469
 	
#line 469
	allow xdm_t locale_t:dir { getattr search open read lock ioctl };
#line 469
	
#line 469
	allow xdm_t locale_t:dir { getattr search open };
#line 469
	allow xdm_t locale_t:file { getattr open read lock ioctl };
#line 469

#line 469
	
#line 469
	allow xdm_t locale_t:dir { getattr search open };
#line 469
	allow xdm_t locale_t:lnk_file { getattr read };
#line 469

#line 469

#line 469
	 	
#line 469
##### end miscfiles_read_localization(xdm_t) depth: 0
#line 469
 	
 	 	
#line 470
##### begin miscfiles_read_fonts(xdm_t) depth: 1
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type fonts_t, fonts_cache_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	# cjp: fonts can be in either of these dirs
#line 470
	 	 	
#line 470
##### begin files_search_usr(xdm_t) depth: 2
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type usr_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	allow xdm_t usr_t:dir { getattr search open };
#line 470

#line 470
	 	
#line 470
##### end files_search_usr(xdm_t) depth: 1
#line 470
 	
#line 470
	 	 	
#line 470
##### begin libs_search_lib(xdm_t) depth: 2
#line 470
 	
#line 470
	
#line 470
	
#line 470
		require {
#line 470
			
#line 470
		type lib_t;
#line 470
	
#line 470
		} # end require
#line 470
	
#line 470

#line 470

#line 470
	allow xdm_t lib_t:dir { getattr search open };
#line 470

#line 470
	 	
#line 470
##### end libs_search_lib(xdm_t) depth: 1
#line 470
 	
#line 470

#line 470
	allow xdm_t fonts_t:dir { getattr search open read lock ioctl };
#line 470
	
#line 470
	allow xdm_t fonts_t:dir { getattr search open };
#line 470
	allow xdm_t fonts_t:file { getattr open read lock ioctl };
#line 470

#line 470
	
#line 470
	allow xdm_t fonts_t:dir { getattr search open };
#line 470
	allow xdm_t fonts_t:lnk_file { getattr read };
#line 470

#line 470

#line 470
	allow xdm_t fonts_cache_t:dir { getattr search open read lock ioctl };
#line 470
	
#line 470
	allow xdm_t fonts_cache_t:dir { getattr search open };
#line 470
	allow xdm_t fonts_cache_t:file { getattr open read lock ioctl };
#line 470

#line 470
	
#line 470
	allow xdm_t fonts_cache_t:dir { getattr search open };
#line 470
	allow xdm_t fonts_cache_t:lnk_file { getattr read };
#line 470

#line 470

#line 470
	 	
#line 470
##### end miscfiles_read_fonts(xdm_t) depth: 0
#line 470
 	

 	 	
#line 472
##### begin sysnet_read_config(xdm_t) depth: 1
#line 472
 	
#line 472
	
#line 472
	
#line 472
		require {
#line 472
			
#line 472
		type net_conf_t;
#line 472
	
#line 472
		} # end require
#line 472
	
#line 472

#line 472

#line 472
	 	 	
#line 472
##### begin files_search_etc(xdm_t) depth: 2
#line 472
 	
#line 472
	
#line 472
	
#line 472
		require {
#line 472
			
#line 472
		type etc_t;
#line 472
	
#line 472
		} # end require
#line 472
	
#line 472

#line 472

#line 472
	allow xdm_t etc_t:dir { getattr search open };
#line 472

#line 472
	 	
#line 472
##### end files_search_etc(xdm_t) depth: 1
#line 472
 	
#line 472
	allow xdm_t net_conf_t:file { getattr open read lock ioctl };
#line 472

#line 472
	
#line 472
		 	 	
#line 472
##### begin files_search_pids(xdm_t) depth: 2
#line 472
 	
#line 472
	
#line 472
	
#line 472
		require {
#line 472
			
#line 472
		type var_t, var_run_t;
#line 472
	
#line 472
		} # end require
#line 472
	
#line 472

#line 472

#line 472
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 472
	
#line 472
	allow xdm_t var_t:dir { getattr search open };
#line 472
	allow xdm_t var_run_t:dir { getattr search open };
#line 472

#line 472

#line 472
	 	
#line 472
##### end files_search_pids(xdm_t) depth: 1
#line 472
 	
#line 472
		allow xdm_t net_conf_t:dir { getattr search open read lock ioctl };
#line 472
		
#line 472
	allow xdm_t net_conf_t:dir { getattr search open };
#line 472
	allow xdm_t net_conf_t:file { getattr open read lock ioctl };
#line 472

#line 472
	
#line 472

#line 472
	
#line 472

#line 472
	 	
#line 472
##### end sysnet_read_config(xdm_t) depth: 0
#line 472
 	

 	 	
#line 474
##### begin userdom_dontaudit_use_unpriv_user_fds(xdm_t) depth: 1
#line 474
 	
#line 474
	
#line 474
	
#line 474
		require {
#line 474
			
#line 474
		attribute unpriv_userdomain;
#line 474
	
#line 474
		} # end require
#line 474
	
#line 474

#line 474

#line 474
	dontaudit xdm_t unpriv_userdomain:fd use;
#line 474

#line 474
	 	
#line 474
##### end userdom_dontaudit_use_unpriv_user_fds(xdm_t) depth: 0
#line 474
 	
 	 	
#line 475
##### begin userdom_create_all_users_keys(xdm_t) depth: 1
#line 475
 	
#line 475
	
#line 475
	
#line 475
		require {
#line 475
			
#line 475
		attribute userdomain;
#line 475
	
#line 475
		} # end require
#line 475
	
#line 475

#line 475

#line 475
	allow xdm_t userdomain:key create;
#line 475

#line 475
	 	
#line 475
##### end userdom_create_all_users_keys(xdm_t) depth: 0
#line 475
 	
# for .dmrc
 	 	
#line 477
##### begin userdom_read_user_home_content_files(xdm_t) depth: 1
#line 477
 	
#line 477
	
#line 477
	
#line 477
		require {
#line 477
			
#line 477
		type user_home_dir_t, user_home_t;
#line 477
	
#line 477
		} # end require
#line 477
	
#line 477

#line 477

#line 477
	
#line 477
	allow xdm_t { user_home_dir_t user_home_t }:dir { getattr search open };
#line 477
	allow xdm_t user_home_t:file { getattr open read lock ioctl };
#line 477

#line 477
	 	 	
#line 477
##### begin files_search_home(xdm_t) depth: 2
#line 477
 	
#line 477
	
#line 477
	
#line 477
		require {
#line 477
			
#line 477
		type home_root_t;
#line 477
	
#line 477
		} # end require
#line 477
	
#line 477

#line 477

#line 477
	allow xdm_t home_root_t:dir { getattr search open };
#line 477
	allow xdm_t home_root_t:lnk_file { getattr read };
#line 477

#line 477
	 	
#line 477
##### end files_search_home(xdm_t) depth: 1
#line 477
 	
#line 477

#line 477
	 	
#line 477
##### end userdom_read_user_home_content_files(xdm_t) depth: 0
#line 477
 	
# Search /proc for any user domain processes.
 	 	
#line 479
##### begin userdom_read_all_users_state(xdm_t) depth: 1
#line 479
 	
#line 479
	
#line 479
	
#line 479
		require {
#line 479
			
#line 479
		attribute userdomain;
#line 479
	
#line 479
		} # end require
#line 479
	
#line 479

#line 479

#line 479
	
#line 479
	allow xdm_t userdomain:dir { getattr search open };
#line 479
	allow xdm_t userdomain:file { getattr open read lock ioctl };
#line 479

#line 479
	 	 	
#line 479
##### begin kernel_search_proc(xdm_t) depth: 2
#line 479
 	
#line 479
	
#line 479
	
#line 479
		require {
#line 479
			
#line 479
		type proc_t;
#line 479
	
#line 479
		} # end require
#line 479
	
#line 479

#line 479

#line 479
	
#line 479
	allow xdm_t proc_t:dir { getattr search open };
#line 479
	allow xdm_t proc_t:dir { getattr search open };
#line 479

#line 479

#line 479
	 	
#line 479
##### end kernel_search_proc(xdm_t) depth: 1
#line 479
 	
#line 479

#line 479
	 	
#line 479
##### end userdom_read_all_users_state(xdm_t) depth: 0
#line 479
 	
 	 	
#line 480
##### begin userdom_signal_all_users(xdm_t) depth: 1
#line 480
 	
#line 480
	
#line 480
	
#line 480
		require {
#line 480
			
#line 480
		attribute userdomain;
#line 480
	
#line 480
		} # end require
#line 480
	
#line 480

#line 480

#line 480
	allow xdm_t userdomain:process signal;
#line 480

#line 480
	 	
#line 480
##### end userdom_signal_all_users(xdm_t) depth: 0
#line 480
 	

 	 	
#line 482
##### begin xserver_rw_session(xdm_t,xdm_tmpfs_t) depth: 1
#line 482
 	
#line 482
	
#line 482
	
#line 482
		require {
#line 482
			
#line 482
		type xserver_t, xserver_tmpfs_t;
#line 482
	
#line 482
		} # end require
#line 482
	
#line 482

#line 482

#line 482
	 	 	
#line 482
##### begin xserver_ro_session(xdm_t,xdm_tmpfs_t) depth: 2
#line 482
 	
#line 482
	
#line 482
	
#line 482
		require {
#line 482
			
#line 482
		type xserver_t, xserver_tmp_t, xserver_tmpfs_t;
#line 482
	
#line 482
		} # end require
#line 482
	
#line 482

#line 482

#line 482
	# Xserver read/write client shm
#line 482
	allow xserver_t xdm_t:fd use;
#line 482
	allow xserver_t xdm_t:shm { associate getattr read write lock unix_read unix_write };
#line 482
	allow xserver_t xdm_tmpfs_t:file { getattr open read write append ioctl lock };
#line 482

#line 482
	# Connect to xserver
#line 482
	allow xdm_t xserver_t:unix_stream_socket connectto;
#line 482
	allow xdm_t xserver_t:process signal;
#line 482

#line 482
	# Read /tmp/.X0-lock
#line 482
	allow xdm_t xserver_tmp_t:file { getattr read };
#line 482

#line 482
	# Client read xserver shm
#line 482
	allow xdm_t xserver_t:fd use;
#line 482
	allow xdm_t xserver_t:shm { associate getattr read unix_read };
#line 482
	allow xdm_t xserver_tmpfs_t:file { getattr open read lock ioctl };
#line 482

#line 482
	 	
#line 482
##### end xserver_ro_session(xdm_t,xdm_tmpfs_t) depth: 1
#line 482
 	
#line 482
	allow xdm_t xserver_t:shm { associate getattr read write lock unix_read unix_write };
#line 482
	allow xdm_t xserver_tmpfs_t:file { getattr open read write append ioctl lock };
#line 482

#line 482
	 	
#line 482
##### end xserver_rw_session(xdm_t,xdm_tmpfs_t) depth: 0
#line 482
 	
 	 	
#line 483
##### begin xserver_unconfined(xdm_t) depth: 1
#line 483
 	
#line 483
	
#line 483
	
#line 483
		require {
#line 483
			
#line 483
		attribute x_domain;
#line 483
		attribute xserver_unconfined_type;
#line 483
	
#line 483
		} # end require
#line 483
	
#line 483

#line 483

#line 483
	typeattribute xdm_t x_domain;
#line 483
	typeattribute xdm_t xserver_unconfined_type;
#line 483

#line 483
	 	
#line 483
##### end xserver_unconfined(xdm_t) depth: 0
#line 483
 	


#line 485
	
#line 485
	
#line 485
		require {
#line 485
			
#line 485
		
#line 485
bool use_nfs_home_dirs;
#line 485

#line 485
  
#line 485
	
#line 485
		} # end require
#line 485
	
#line 485

#line 485
	if (use_nfs_home_dirs) {
#line 485
		
#line 485
	 	 	
#line 485
##### begin fs_manage_nfs_dirs(xdm_t) depth: 1
#line 485
 	
#line 485
	
#line 485
	
#line 485
		require {
#line 485
			
#line 485
		type nfs_t;
#line 485
	
#line 485
		} # end require
#line 485
	
#line 485

#line 485

#line 485
	allow xdm_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 485

#line 485
	 	
#line 485
##### end fs_manage_nfs_dirs(xdm_t) depth: 0
#line 485
 	
#line 485
	 	 	
#line 485
##### begin fs_manage_nfs_files(xdm_t) depth: 1
#line 485
 	
#line 485
	
#line 485
	
#line 485
		require {
#line 485
			
#line 485
		type nfs_t;
#line 485
	
#line 485
		} # end require
#line 485
	
#line 485

#line 485

#line 485
	
#line 485
	allow xdm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 485
	allow xdm_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 485

#line 485

#line 485
	 	
#line 485
##### end fs_manage_nfs_files(xdm_t) depth: 0
#line 485
 	
#line 485
	 	 	
#line 485
##### begin fs_manage_nfs_symlinks(xdm_t) depth: 1
#line 485
 	
#line 485
	
#line 485
	
#line 485
		require {
#line 485
			
#line 485
		type nfs_t;
#line 485
	
#line 485
		} # end require
#line 485
	
#line 485

#line 485

#line 485
	
#line 485
	allow xdm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 485
	allow xdm_t nfs_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 485

#line 485

#line 485
	 	
#line 485
##### end fs_manage_nfs_symlinks(xdm_t) depth: 0
#line 485
 	
#line 485
	 	 	
#line 485
##### begin fs_exec_nfs_files(xdm_t) depth: 1
#line 485
 	
#line 485
	
#line 485
	
#line 485
		require {
#line 485
			
#line 485
		type nfs_t;
#line 485
	
#line 485
		} # end require
#line 485
	
#line 485

#line 485

#line 485
	allow xdm_t nfs_t:dir { getattr search open read lock ioctl };
#line 485
	
#line 485
	allow xdm_t nfs_t:dir { getattr search open };
#line 485
	allow xdm_t nfs_t:file { getattr open read execute ioctl execute_no_trans };
#line 485

#line 485

#line 485
	 	
#line 485
##### end fs_exec_nfs_files(xdm_t) depth: 0
#line 485
 	
#line 485

#line 485
	}
#line 490



#line 492
	
#line 492
	
#line 492
		require {
#line 492
			
#line 492
		
#line 492
bool use_samba_home_dirs;
#line 492

#line 492
  
#line 492
	
#line 492
		} # end require
#line 492
	
#line 492

#line 492
	if (use_samba_home_dirs) {
#line 492
		
#line 492
	 	 	
#line 492
##### begin fs_manage_cifs_dirs(xdm_t) depth: 1
#line 492
 	
#line 492
	
#line 492
	
#line 492
		require {
#line 492
			
#line 492
		type cifs_t;
#line 492
	
#line 492
		} # end require
#line 492
	
#line 492

#line 492

#line 492
	allow xdm_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 492

#line 492
	 	
#line 492
##### end fs_manage_cifs_dirs(xdm_t) depth: 0
#line 492
 	
#line 492
	 	 	
#line 492
##### begin fs_manage_cifs_files(xdm_t) depth: 1
#line 492
 	
#line 492
	
#line 492
	
#line 492
		require {
#line 492
			
#line 492
		type cifs_t;
#line 492
	
#line 492
		} # end require
#line 492
	
#line 492

#line 492

#line 492
	
#line 492
	allow xdm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 492
	allow xdm_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 492

#line 492

#line 492
	 	
#line 492
##### end fs_manage_cifs_files(xdm_t) depth: 0
#line 492
 	
#line 492
	 	 	
#line 492
##### begin fs_manage_cifs_symlinks(xdm_t) depth: 1
#line 492
 	
#line 492
	
#line 492
	
#line 492
		require {
#line 492
			
#line 492
		type cifs_t;
#line 492
	
#line 492
		} # end require
#line 492
	
#line 492

#line 492

#line 492
	
#line 492
	allow xdm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 492
	allow xdm_t cifs_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 492

#line 492

#line 492
	 	
#line 492
##### end fs_manage_cifs_symlinks(xdm_t) depth: 0
#line 492
 	
#line 492
	 	 	
#line 492
##### begin fs_exec_cifs_files(xdm_t) depth: 1
#line 492
 	
#line 492
	
#line 492
	
#line 492
		require {
#line 492
			
#line 492
		type cifs_t;
#line 492
	
#line 492
		} # end require
#line 492
	
#line 492

#line 492

#line 492
	allow xdm_t cifs_t:dir { getattr search open read lock ioctl };
#line 492
	
#line 492
	allow xdm_t cifs_t:dir { getattr search open };
#line 492
	allow xdm_t cifs_t:file { getattr open read execute ioctl execute_no_trans };
#line 492

#line 492

#line 492
	 	
#line 492
##### end fs_exec_cifs_files(xdm_t) depth: 0
#line 492
 	
#line 492

#line 492
	}
#line 497



#line 499
	
#line 499
	
#line 499
		require {
#line 499
			
#line 499
		
#line 499
bool xdm_sysadm_login;
#line 499

#line 499
  
#line 499
	
#line 499
		} # end require
#line 499
	
#line 499

#line 499
	if (xdm_sysadm_login) {
#line 499
		
#line 499
	 	 	
#line 499
##### begin userdom_xsession_spec_domtrans_all_users(xdm_t) depth: 1
#line 499
 	
#line 499
	
#line 499
	
#line 499
		require {
#line 499
			
#line 499
		attribute userdomain;
#line 499
	
#line 499
		} # end require
#line 499
	
#line 499

#line 499

#line 499
	 	 	
#line 499
##### begin xserver_xsession_spec_domtrans(xdm_t,userdomain) depth: 2
#line 499
 	
#line 499
	
#line 499
	
#line 499
		require {
#line 499
			
#line 499
		type xsession_exec_t;
#line 499
	
#line 499
		} # end require
#line 499
	
#line 499

#line 499

#line 499
	
#line 499
	allow xdm_t xsession_exec_t:file { getattr open read execute };
#line 499
	allow xdm_t userdomain:process transition;
#line 499
	dontaudit xdm_t userdomain:process { noatsecure siginh rlimitinh };
#line 499

#line 499

#line 499
	 	
#line 499
##### end xserver_xsession_spec_domtrans(xdm_t,userdomain) depth: 1
#line 499
 	
#line 499
	allow userdomain xdm_t:fd use;
#line 499
	allow userdomain xdm_t:fifo_file { getattr open read write append ioctl lock };
#line 499
	allow userdomain xdm_t:process sigchld;
#line 499

#line 499
	 	
#line 499
##### end userdom_xsession_spec_domtrans_all_users(xdm_t) depth: 0
#line 499
 	
#line 499
	# FIXME:
#line 499
#	xserver_rw_session_template(xdm,userdomain)
#line 499

#line 499
	} else {
#line 499
		
#line 499
	 	 	
#line 499
##### begin userdom_xsession_spec_domtrans_unpriv_users(xdm_t) depth: 1
#line 499
 	
#line 499
	
#line 499
	
#line 499
		require {
#line 499
			
#line 499
		attribute unpriv_userdomain;
#line 499
	
#line 499
		} # end require
#line 499
	
#line 499

#line 499

#line 499
	 	 	
#line 499
##### begin xserver_xsession_spec_domtrans(xdm_t,unpriv_userdomain) depth: 2
#line 499
 	
#line 499
	
#line 499
	
#line 499
		require {
#line 499
			
#line 499
		type xsession_exec_t;
#line 499
	
#line 499
		} # end require
#line 499
	
#line 499

#line 499

#line 499
	
#line 499
	allow xdm_t xsession_exec_t:file { getattr open read execute };
#line 499
	allow xdm_t unpriv_userdomain:process transition;
#line 499
	dontaudit xdm_t unpriv_userdomain:process { noatsecure siginh rlimitinh };
#line 499

#line 499

#line 499
	 	
#line 499
##### end xserver_xsession_spec_domtrans(xdm_t,unpriv_userdomain) depth: 1
#line 499
 	
#line 499
	allow unpriv_userdomain xdm_t:fd use;
#line 499
	allow unpriv_userdomain xdm_t:fifo_file { getattr open read write append ioctl lock };
#line 499
	allow unpriv_userdomain xdm_t:process sigchld;
#line 499

#line 499
	 	
#line 499
##### end userdom_xsession_spec_domtrans_unpriv_users(xdm_t) depth: 0
#line 499
 	
#line 499
	# FIXME:
#line 499
#	xserver_rw_session_template(xdm,unpriv_userdomain)
#line 499
#	dontaudit xserver_t sysadm_t:shm { unix_read unix_write };
#line 499
#	allow xserver_t xdm_tmpfs_t:file rw_file_perms;
#line 499

#line 499
	}
#line 509



#line 511
	optional {
#line 511
		
#line 511
	 	 	
#line 511
##### begin alsa_domtrans(xdm_t) depth: 1
#line 511
 	
#line 511
	
#line 511
	
#line 511
		require {
#line 511
			
#line 511
		type alsa_t, alsa_exec_t;
#line 511
	
#line 511
		} # end require
#line 511
	
#line 511

#line 511

#line 511
	 	 	
#line 511
##### begin corecmd_search_bin(xdm_t) depth: 2
#line 511
 	
#line 511
	
#line 511
	
#line 511
		require {
#line 511
			
#line 511
		type bin_t;
#line 511
	
#line 511
		} # end require
#line 511
	
#line 511

#line 511

#line 511
	
#line 511
	allow xdm_t bin_t:dir { getattr search open };
#line 511
	allow xdm_t bin_t:dir { getattr search open };
#line 511

#line 511

#line 511
	 	
#line 511
##### end corecmd_search_bin(xdm_t) depth: 1
#line 511
 	
#line 511
	
#line 511
	
#line 511
	
#line 511
	allow xdm_t alsa_exec_t:file { getattr open read execute };
#line 511
	allow xdm_t alsa_t:process transition;
#line 511
	dontaudit xdm_t alsa_t:process { noatsecure siginh rlimitinh };
#line 511

#line 511
	type_transition xdm_t alsa_exec_t:process alsa_t;
#line 511

#line 511

#line 511
	allow alsa_t xdm_t:fd use;
#line 511
	allow alsa_t xdm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 511
	allow alsa_t xdm_t:process sigchld;
#line 511

#line 511

#line 511
	 	
#line 511
##### end alsa_domtrans(xdm_t) depth: 0
#line 511
 	
#line 511

#line 511
	} # end optional
#line 513



#line 515
	optional {
#line 515
		
#line 515
	 	 	
#line 515
##### begin colord_dbus_chat(xdm_t) depth: 1
#line 515
 	
#line 515
	
#line 515
	
#line 515
		require {
#line 515
			
#line 515
		type colord_t;
#line 515
		class dbus send_msg;
#line 515
	
#line 515
		} # end require
#line 515
	
#line 515

#line 515

#line 515
	allow xdm_t colord_t:dbus send_msg;
#line 515
	allow colord_t xdm_t:dbus send_msg;
#line 515

#line 515
	 	
#line 515
##### end colord_dbus_chat(xdm_t) depth: 0
#line 515
 	
#line 515

#line 515
	} # end optional
#line 517



#line 519
	optional {
#line 519
		
#line 519
	 	 	
#line 519
##### begin colord_dbus_chat(xdm_t) depth: 1
#line 519
 	
#line 519
	
#line 519
	
#line 519
		require {
#line 519
			
#line 519
		type colord_t;
#line 519
		class dbus send_msg;
#line 519
	
#line 519
		} # end require
#line 519
	
#line 519

#line 519

#line 519
	allow xdm_t colord_t:dbus send_msg;
#line 519
	allow colord_t xdm_t:dbus send_msg;
#line 519

#line 519
	 	
#line 519
##### end colord_dbus_chat(xdm_t) depth: 0
#line 519
 	
#line 519

#line 519
	} # end optional
#line 521



#line 523
	optional {
#line 523
		
#line 523
	 	 	
#line 523
##### begin consolekit_dbus_chat(xdm_t) depth: 1
#line 523
 	
#line 523
	
#line 523
	
#line 523
		require {
#line 523
			
#line 523
		type consolekit_t;
#line 523
		class dbus send_msg;
#line 523
	
#line 523
		} # end require
#line 523
	
#line 523

#line 523

#line 523
	allow xdm_t consolekit_t:dbus send_msg;
#line 523
	allow consolekit_t xdm_t:dbus send_msg;
#line 523

#line 523
	 	
#line 523
##### end consolekit_dbus_chat(xdm_t) depth: 0
#line 523
 	
#line 523

#line 523
	} # end optional
#line 525



#line 527
	optional {
#line 527
		
#line 527
	 	 	
#line 527
##### begin consoletype_exec(xdm_t) depth: 1
#line 527
 	
#line 527
	
#line 527
	
#line 527
		require {
#line 527
			
#line 527
		type consoletype_exec_t;
#line 527
	
#line 527
		} # end require
#line 527
	
#line 527

#line 527

#line 527
	 	 	
#line 527
##### begin corecmd_search_bin(xdm_t) depth: 2
#line 527
 	
#line 527
	
#line 527
	
#line 527
		require {
#line 527
			
#line 527
		type bin_t;
#line 527
	
#line 527
		} # end require
#line 527
	
#line 527

#line 527

#line 527
	
#line 527
	allow xdm_t bin_t:dir { getattr search open };
#line 527
	allow xdm_t bin_t:dir { getattr search open };
#line 527

#line 527

#line 527
	 	
#line 527
##### end corecmd_search_bin(xdm_t) depth: 1
#line 527
 	
#line 527
	allow xdm_t consoletype_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 527

#line 527
	 	
#line 527
##### end consoletype_exec(xdm_t) depth: 0
#line 527
 	
#line 527

#line 527
	} # end optional
#line 529



#line 531
	optional {
#line 531
		
#line 531
	 	 	
#line 531
##### begin dbus_system_bus_client(xdm_t) depth: 1
#line 531
 	
#line 531
	
#line 531
	
#line 531
		require {
#line 531
			
#line 531
		attribute dbusd_system_bus_client;
#line 531
		type system_dbusd_t, system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 531
		class dbus send_msg;
#line 531
	
#line 531
		} # end require
#line 531
	
#line 531

#line 531

#line 531
	typeattribute xdm_t dbusd_system_bus_client;
#line 531

#line 531
	allow xdm_t { system_dbusd_t self }:dbus send_msg;
#line 531
	allow system_dbusd_t xdm_t:dbus send_msg;
#line 531

#line 531
	 	 	
#line 531
##### begin files_search_var_lib(xdm_t) depth: 2
#line 531
 	
#line 531
	
#line 531
	
#line 531
		require {
#line 531
			
#line 531
		type var_t, var_lib_t;
#line 531
	
#line 531
		} # end require
#line 531
	
#line 531

#line 531

#line 531
	
#line 531
	allow xdm_t var_t:dir { getattr search open };
#line 531
	allow xdm_t var_lib_t:dir { getattr search open };
#line 531

#line 531

#line 531
	 	
#line 531
##### end files_search_var_lib(xdm_t) depth: 1
#line 531
 	
#line 531
	
#line 531
	allow xdm_t system_dbusd_var_lib_t:dir { getattr search open };
#line 531
	allow xdm_t system_dbusd_var_lib_t:file { getattr open read lock ioctl };
#line 531

#line 531

#line 531
	 	 	
#line 531
##### begin files_search_pids(xdm_t) depth: 2
#line 531
 	
#line 531
	
#line 531
	
#line 531
		require {
#line 531
			
#line 531
		type var_t, var_run_t;
#line 531
	
#line 531
		} # end require
#line 531
	
#line 531

#line 531

#line 531
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 531
	
#line 531
	allow xdm_t var_t:dir { getattr search open };
#line 531
	allow xdm_t var_run_t:dir { getattr search open };
#line 531

#line 531

#line 531
	 	
#line 531
##### end files_search_pids(xdm_t) depth: 1
#line 531
 	
#line 531
	
#line 531
	allow xdm_t system_dbusd_var_run_t:dir { getattr search open };
#line 531
	allow xdm_t system_dbusd_var_run_t:sock_file { getattr write open append };
#line 531
	allow xdm_t system_dbusd_t:unix_stream_socket connectto;
#line 531

#line 531

#line 531
	 	 	
#line 531
##### begin dbus_read_config(xdm_t) depth: 2
#line 531
 	
#line 531
	
#line 531
	
#line 531
		require {
#line 531
			
#line 531
		type dbusd_etc_t;
#line 531
	
#line 531
		} # end require
#line 531
	
#line 531

#line 531

#line 531
	allow xdm_t dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 531
	allow xdm_t dbusd_etc_t:file { getattr open read lock ioctl };
#line 531

#line 531
	 	
#line 531
##### end dbus_read_config(xdm_t) depth: 1
#line 531
 	
#line 531

#line 531
	 	
#line 531
##### end dbus_system_bus_client(xdm_t) depth: 0
#line 531
 	
#line 531
	 	 	
#line 531
##### begin dbus_connect_system_bus(xdm_t) depth: 1
#line 531
 	
#line 531
	
#line 531
	
#line 531
		require {
#line 531
			
#line 531
		type system_dbusd_t;
#line 531
		class dbus acquire_svc;
#line 531
	
#line 531
		} # end require
#line 531
	
#line 531

#line 531

#line 531
	allow xdm_t system_dbusd_t:dbus acquire_svc;
#line 531

#line 531
	 	
#line 531
##### end dbus_connect_system_bus(xdm_t) depth: 0
#line 531
 	
#line 531

#line 531
	
#line 531
	optional {
#line 531
		
#line 531
		 	 	
#line 531
##### begin accountsd_dbus_chat(xdm_t) depth: 1
#line 531
 	
#line 531
	
#line 531
	
#line 531
		require {
#line 531
			
#line 531
		type accountsd_t;
#line 531
		class dbus send_msg;
#line 531
	
#line 531
		} # end require
#line 531
	
#line 531

#line 531

#line 531
	allow xdm_t accountsd_t:dbus send_msg;
#line 531
	allow accountsd_t xdm_t:dbus send_msg;
#line 531

#line 531
	 	
#line 531
##### end accountsd_dbus_chat(xdm_t) depth: 0
#line 531
 	
#line 531
	
#line 531
	}
#line 531

#line 531

#line 531
	} # end optional
#line 538



#line 540
	optional {
#line 540
		
#line 540
	 	 	
#line 540
##### begin gnome_spec_domtrans_all_gkeyringd(xdm_t) depth: 1
#line 540
 	
#line 540
	
#line 540
	
#line 540
		require {
#line 540
			
#line 540
		attribute gkeyringd_domain;
#line 540
		type gkeyringd_exec_t;
#line 540
	
#line 540
		} # end require
#line 540
	
#line 540

#line 540

#line 540
	 	 	
#line 540
##### begin corecmd_search_bin(xdm_t) depth: 2
#line 540
 	
#line 540
	
#line 540
	
#line 540
		require {
#line 540
			
#line 540
		type bin_t;
#line 540
	
#line 540
		} # end require
#line 540
	
#line 540

#line 540

#line 540
	
#line 540
	allow xdm_t bin_t:dir { getattr search open };
#line 540
	allow xdm_t bin_t:dir { getattr search open };
#line 540

#line 540

#line 540
	 	
#line 540
##### end corecmd_search_bin(xdm_t) depth: 1
#line 540
 	
#line 540
	
#line 540
	allow xdm_t self:process setexec;
#line 540
	
#line 540
	allow xdm_t gkeyringd_exec_t:file { getattr open read execute };
#line 540
	allow xdm_t gkeyringd_domain:process transition;
#line 540
	dontaudit xdm_t gkeyringd_domain:process { noatsecure siginh rlimitinh };
#line 540

#line 540

#line 540
	allow gkeyringd_domain xdm_t:fd use;
#line 540
	allow gkeyringd_domain xdm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 540
	allow gkeyringd_domain xdm_t:process sigchld;
#line 540

#line 540

#line 540
	 	
#line 540
##### end gnome_spec_domtrans_all_gkeyringd(xdm_t) depth: 0
#line 540
 	
#line 540

#line 540
	} # end optional
#line 542



#line 544
	optional {
#line 544
		
#line 544
	# Talk to the console mouse server.
#line 544
	 	 	
#line 544
##### begin gpm_stream_connect(xdm_t) depth: 1
#line 544
 	
#line 544
	
#line 544
	
#line 544
		require {
#line 544
			
#line 544
		type gpmctl_t, gpm_t;
#line 544
	
#line 544
		} # end require
#line 544
	
#line 544

#line 544

#line 544
	 	 	
#line 544
##### begin dev_list_all_dev_nodes(xdm_t) depth: 2
#line 544
 	
#line 544
	
#line 544
	
#line 544
		require {
#line 544
			
#line 544
		type device_t;
#line 544
	
#line 544
		} # end require
#line 544
	
#line 544

#line 544

#line 544
	
#line 544
	allow xdm_t device_t:dir { getattr search open };
#line 544
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 544

#line 544
	
#line 544
	allow xdm_t device_t:dir { getattr search open };
#line 544
	allow xdm_t device_t:lnk_file { getattr read };
#line 544

#line 544

#line 544
	 	
#line 544
##### end dev_list_all_dev_nodes(xdm_t) depth: 1
#line 544
 	
#line 544
	
#line 544
	allow xdm_t gpmctl_t:dir { getattr search open };
#line 544
	allow xdm_t gpmctl_t:sock_file { getattr write open append };
#line 544
	allow xdm_t gpm_t:unix_stream_socket connectto;
#line 544

#line 544

#line 544
	 	
#line 544
##### end gpm_stream_connect(xdm_t) depth: 0
#line 544
 	
#line 544
	 	 	
#line 544
##### begin gpm_setattr_gpmctl(xdm_t) depth: 1
#line 544
 	
#line 544
	
#line 544
	
#line 544
		require {
#line 544
			
#line 544
		type gpmctl_t;
#line 544
	
#line 544
		} # end require
#line 544
	
#line 544

#line 544

#line 544
	 	 	
#line 544
##### begin dev_list_all_dev_nodes(xdm_t) depth: 2
#line 544
 	
#line 544
	
#line 544
	
#line 544
		require {
#line 544
			
#line 544
		type device_t;
#line 544
	
#line 544
		} # end require
#line 544
	
#line 544

#line 544

#line 544
	
#line 544
	allow xdm_t device_t:dir { getattr search open };
#line 544
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 544

#line 544
	
#line 544
	allow xdm_t device_t:dir { getattr search open };
#line 544
	allow xdm_t device_t:lnk_file { getattr read };
#line 544

#line 544

#line 544
	 	
#line 544
##### end dev_list_all_dev_nodes(xdm_t) depth: 1
#line 544
 	
#line 544
	allow xdm_t gpmctl_t:sock_file { setattr };
#line 544

#line 544
	 	
#line 544
##### end gpm_setattr_gpmctl(xdm_t) depth: 0
#line 544
 	
#line 544

#line 544
	} # end optional
#line 548



#line 550
	optional {
#line 550
		
#line 550
	 	 	
#line 550
##### begin hostname_exec(xdm_t) depth: 1
#line 550
 	
#line 550
	
#line 550
	
#line 550
		require {
#line 550
			
#line 550
		type hostname_exec_t;
#line 550
	
#line 550
		} # end require
#line 550
	
#line 550

#line 550

#line 550
	 	 	
#line 550
##### begin corecmd_search_bin(xdm_t) depth: 2
#line 550
 	
#line 550
	
#line 550
	
#line 550
		require {
#line 550
			
#line 550
		type bin_t;
#line 550
	
#line 550
		} # end require
#line 550
	
#line 550

#line 550

#line 550
	
#line 550
	allow xdm_t bin_t:dir { getattr search open };
#line 550
	allow xdm_t bin_t:dir { getattr search open };
#line 550

#line 550

#line 550
	 	
#line 550
##### end corecmd_search_bin(xdm_t) depth: 1
#line 550
 	
#line 550
	allow xdm_t hostname_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 550

#line 550
	 	
#line 550
##### end hostname_exec(xdm_t) depth: 0
#line 550
 	
#line 550

#line 550
	} # end optional
#line 552



#line 554
	optional {
#line 554
		
#line 554
	 	 	
#line 554
##### begin loadkeys_exec(xdm_t) depth: 1
#line 554
 	
#line 554
	
#line 554
	
#line 554
		require {
#line 554
			
#line 554
		type loadkeys_exec_t;
#line 554
	
#line 554
		} # end require
#line 554
	
#line 554

#line 554

#line 554
	 	 	
#line 554
##### begin corecmd_search_bin(xdm_t) depth: 2
#line 554
 	
#line 554
	
#line 554
	
#line 554
		require {
#line 554
			
#line 554
		type bin_t;
#line 554
	
#line 554
		} # end require
#line 554
	
#line 554

#line 554

#line 554
	
#line 554
	allow xdm_t bin_t:dir { getattr search open };
#line 554
	allow xdm_t bin_t:dir { getattr search open };
#line 554

#line 554

#line 554
	 	
#line 554
##### end corecmd_search_bin(xdm_t) depth: 1
#line 554
 	
#line 554
	allow xdm_t loadkeys_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 554

#line 554
	 	
#line 554
##### end loadkeys_exec(xdm_t) depth: 0
#line 554
 	
#line 554

#line 554
	} # end optional
#line 556



#line 558
	optional {
#line 558
		
#line 558
	 	 	
#line 558
##### begin locallogin_signull(xdm_t) depth: 1
#line 558
 	
#line 558
	
#line 558
	
#line 558
		require {
#line 558
			
#line 558
		type local_login_t;
#line 558
	
#line 558
		} # end require
#line 558
	
#line 558

#line 558

#line 558
	allow xdm_t local_login_t:process signull;
#line 558

#line 558
	 	
#line 558
##### end locallogin_signull(xdm_t) depth: 0
#line 558
 	
#line 558

#line 558
	} # end optional
#line 560



#line 562
	optional {
#line 562
		
#line 562
	# Do not audit attempts to check whether user root has email
#line 562
	 	 	
#line 562
##### begin mta_dontaudit_getattr_spool_files(xdm_t) depth: 1
#line 562
 	
#line 562
	
#line 562
	
#line 562
		require {
#line 562
			
#line 562
		type mail_spool_t;
#line 562
	
#line 562
		} # end require
#line 562
	
#line 562

#line 562

#line 562
	 	 	
#line 562
##### begin files_dontaudit_search_spool(xdm_t) depth: 2
#line 562
 	
#line 562
	
#line 562
	
#line 562
		require {
#line 562
			
#line 562
		type var_spool_t;
#line 562
	
#line 562
		} # end require
#line 562
	
#line 562

#line 562

#line 562
	dontaudit xdm_t var_spool_t:dir { getattr search open };
#line 562

#line 562
	 	
#line 562
##### end files_dontaudit_search_spool(xdm_t) depth: 1
#line 562
 	
#line 562
	dontaudit xdm_t mail_spool_t:dir { getattr search open };
#line 562
	dontaudit xdm_t mail_spool_t:lnk_file { getattr read };
#line 562
	dontaudit xdm_t mail_spool_t:file { getattr };
#line 562

#line 562
	 	
#line 562
##### end mta_dontaudit_getattr_spool_files(xdm_t) depth: 0
#line 562
 	
#line 562

#line 562
	} # end optional
#line 565



#line 567
	optional {
#line 567
		
#line 567
	 	 	
#line 567
##### begin resmgr_stream_connect(xdm_t) depth: 1
#line 567
 	
#line 567
	
#line 567
	
#line 567
		require {
#line 567
			
#line 567
		type resmgrd_var_run_t, resmgrd_t;
#line 567
	
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
	 	 	
#line 567
##### begin files_search_pids(xdm_t) depth: 2
#line 567
 	
#line 567
	
#line 567
	
#line 567
		require {
#line 567
			
#line 567
		type var_t, var_run_t;
#line 567
	
#line 567
		} # end require
#line 567
	
#line 567

#line 567

#line 567
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 567
	
#line 567
	allow xdm_t var_t:dir { getattr search open };
#line 567
	allow xdm_t var_run_t:dir { getattr search open };
#line 567

#line 567

#line 567
	 	
#line 567
##### end files_search_pids(xdm_t) depth: 1
#line 567
 	
#line 567
	
#line 567
	allow xdm_t resmgrd_var_run_t:dir { getattr search open };
#line 567
	allow xdm_t resmgrd_var_run_t:sock_file { getattr write open append };
#line 567
	allow xdm_t resmgrd_t:unix_stream_socket connectto;
#line 567

#line 567

#line 567
	 	
#line 567
##### end resmgr_stream_connect(xdm_t) depth: 0
#line 567
 	
#line 567

#line 567
	} # end optional
#line 569



#line 571
	optional {
#line 571
		
#line 571
	 	 	
#line 571
##### begin seutil_sigchld_newrole(xdm_t) depth: 1
#line 571
 	
#line 571
	
#line 571
	
#line 571
		require {
#line 571
			
#line 571
		type newrole_t;
#line 571
	
#line 571
		} # end require
#line 571
	
#line 571

#line 571

#line 571
	allow xdm_t newrole_t:process sigchld;
#line 571

#line 571
	 	
#line 571
##### end seutil_sigchld_newrole(xdm_t) depth: 0
#line 571
 	
#line 571

#line 571
	} # end optional
#line 573



#line 575
	optional {
#line 575
		
#line 575
	 	 	
#line 575
##### begin shutdown_domtrans(xdm_t) depth: 1
#line 575
 	
#line 575
	
#line 575
	
#line 575
		require {
#line 575
			
#line 575
		type shutdown_t, shutdown_exec_t;
#line 575
	
#line 575
		} # end require
#line 575
	
#line 575

#line 575

#line 575
	 	 	
#line 575
##### begin corecmd_search_bin(xdm_t) depth: 2
#line 575
 	
#line 575
	
#line 575
	
#line 575
		require {
#line 575
			
#line 575
		type bin_t;
#line 575
	
#line 575
		} # end require
#line 575
	
#line 575

#line 575

#line 575
	
#line 575
	allow xdm_t bin_t:dir { getattr search open };
#line 575
	allow xdm_t bin_t:dir { getattr search open };
#line 575

#line 575

#line 575
	 	
#line 575
##### end corecmd_search_bin(xdm_t) depth: 1
#line 575
 	
#line 575
	
#line 575
	
#line 575
	
#line 575
	allow xdm_t shutdown_exec_t:file { getattr open read execute };
#line 575
	allow xdm_t shutdown_t:process transition;
#line 575
	dontaudit xdm_t shutdown_t:process { noatsecure siginh rlimitinh };
#line 575

#line 575
	type_transition xdm_t shutdown_exec_t:process shutdown_t;
#line 575

#line 575

#line 575
	allow shutdown_t xdm_t:fd use;
#line 575
	allow shutdown_t xdm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 575
	allow shutdown_t xdm_t:process sigchld;
#line 575

#line 575

#line 575
	 	
#line 575
##### end shutdown_domtrans(xdm_t) depth: 0
#line 575
 	
#line 575

#line 575
	} # end optional
#line 577



#line 579
	optional {
#line 579
		
#line 579
	 	 	
#line 579
##### begin udev_read_db(xdm_t) depth: 1
#line 579
 	
#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		type udev_tbl_t;
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579

#line 579
	allow xdm_t udev_tbl_t:dir { getattr search open read lock ioctl };
#line 579

#line 579
	
#line 579
	allow xdm_t udev_tbl_t:dir { getattr search open };
#line 579
	allow xdm_t udev_tbl_t:file { getattr open read lock ioctl };
#line 579

#line 579
	
#line 579
	allow xdm_t udev_tbl_t:dir { getattr search open };
#line 579
	allow xdm_t udev_tbl_t:lnk_file { getattr read };
#line 579

#line 579

#line 579
	 	 	
#line 579
##### begin dev_list_all_dev_nodes(xdm_t) depth: 2
#line 579
 	
#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		type device_t;
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579

#line 579
	
#line 579
	allow xdm_t device_t:dir { getattr search open };
#line 579
	allow xdm_t device_t:dir { getattr search open read lock ioctl };
#line 579

#line 579
	
#line 579
	allow xdm_t device_t:dir { getattr search open };
#line 579
	allow xdm_t device_t:lnk_file { getattr read };
#line 579

#line 579

#line 579
	 	
#line 579
##### end dev_list_all_dev_nodes(xdm_t) depth: 1
#line 579
 	
#line 579

#line 579
	 	 	
#line 579
##### begin files_search_etc(xdm_t) depth: 2
#line 579
 	
#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		type etc_t;
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579

#line 579
	allow xdm_t etc_t:dir { getattr search open };
#line 579

#line 579
	 	
#line 579
##### end files_search_etc(xdm_t) depth: 1
#line 579
 	
#line 579

#line 579
	 	 	
#line 579
##### begin udev_search_pids(xdm_t) depth: 2
#line 579
 	
#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		type udev_var_run_t;
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579

#line 579
	 	 	
#line 579
##### begin files_search_pids(xdm_t) depth: 3
#line 579
 	
#line 579
	
#line 579
	
#line 579
		require {
#line 579
			
#line 579
		type var_t, var_run_t;
#line 579
	
#line 579
		} # end require
#line 579
	
#line 579

#line 579

#line 579
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 579
	
#line 579
	allow xdm_t var_t:dir { getattr search open };
#line 579
	allow xdm_t var_run_t:dir { getattr search open };
#line 579

#line 579

#line 579
	 	
#line 579
##### end files_search_pids(xdm_t) depth: 2
#line 579
 	
#line 579
	
#line 579
	allow xdm_t udev_var_run_t:dir { getattr search open };
#line 579
	allow xdm_t udev_var_run_t:dir { getattr search open };
#line 579

#line 579

#line 579
	 	
#line 579
##### end udev_search_pids(xdm_t) depth: 1
#line 579
 	
#line 579

#line 579
	 	
#line 579
##### end udev_read_db(xdm_t) depth: 0
#line 579
 	
#line 579

#line 579
	} # end optional
#line 581



#line 583
	optional {
#line 583
		
#line 583
	 	 	
#line 583
##### begin unconfined_domain(xdm_t) depth: 1
#line 583
 	
#line 583
	 	 	
#line 583
##### begin unconfined_domain_noaudit(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type unconfined_t;
#line 583
		class dbus { acquire_svc send_msg };
#line 583
		class nscd { getpwd getgrp gethost getstat admin shmempwd shmemgrp shmemhost getserv shmemserv };
#line 583
		class passwd { passwd chfn chsh rootok crontab };
#line 583
		class service { start stop status reload enable disable };
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	# Use most Linux capabilities
#line 583
	allow xdm_t self:capability ~sys_module;
#line 583
	allow xdm_t self:capability2 { syslog wake_alarm };
#line 583
	allow xdm_t self:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 583

#line 583
	# Transition to myself, to make get_ordered_context_list happy.
#line 583
	allow xdm_t self:process transition;
#line 583

#line 583
	# Write access is for setting attributes under /proc/self/attr.
#line 583
	allow xdm_t self:file { getattr open read write append ioctl lock };
#line 583

#line 583
	# Userland object managers
#line 583
	allow xdm_t self:nscd *;
#line 583
	allow xdm_t self:dbus *;
#line 583
	allow xdm_t self:passwd *;
#line 583
	allow xdm_t self:association *;
#line 583

#line 583
	 	 	
#line 583
##### begin kernel_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute kern_unconfined;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t kern_unconfined;
#line 583
	 	 	
#line 583
##### begin kernel_load_module(xdm_t) depth: 4
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute can_load_kernmodule;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t can_load_kernmodule;
#line 583

#line 583
	 	
#line 583
##### end kernel_load_module(xdm_t) depth: 3
#line 583
 	
#line 583

#line 583
	 	
#line 583
##### end kernel_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin corenet_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute corenet_unconfined_type;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t corenet_unconfined_type;
#line 583

#line 583
	 	
#line 583
##### end corenet_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin dev_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute devices_unconfined_type;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t devices_unconfined_type;
#line 583

#line 583
	 	
#line 583
##### end dev_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin domain_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute set_curr_context;
#line 583
		attribute can_change_object_identity;
#line 583
		attribute unconfined_domain_type;
#line 583
		attribute process_uncond_exempt;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t unconfined_domain_type;
#line 583

#line 583
	# pass constraints
#line 583
	typeattribute xdm_t can_change_object_identity;
#line 583
	typeattribute xdm_t set_curr_context;
#line 583
	typeattribute xdm_t process_uncond_exempt;
#line 583

#line 583
	 	
#line 583
##### end domain_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin domain_dontaudit_read_all_domains_state(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute domain;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	dontaudit xdm_t domain:dir { getattr search open read lock ioctl };
#line 583
	dontaudit xdm_t domain:lnk_file { getattr read };
#line 583
	dontaudit xdm_t domain:file { getattr open read lock ioctl };
#line 583

#line 583
	# cjp: these should be removed:
#line 583
	dontaudit xdm_t domain:sock_file { getattr open read };
#line 583
	dontaudit xdm_t domain:fifo_file { getattr open read lock ioctl };
#line 583

#line 583
	 	
#line 583
##### end domain_dontaudit_read_all_domains_state(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin domain_dontaudit_ptrace_all_domains(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute domain;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	dontaudit xdm_t domain:process ptrace;
#line 583

#line 583
	 	
#line 583
##### end domain_dontaudit_ptrace_all_domains(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin files_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute files_unconfined_type;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t files_unconfined_type;
#line 583

#line 583
	 	
#line 583
##### end files_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin fs_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute filesystem_unconfined_type;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t filesystem_unconfined_type;
#line 583

#line 583
	 	
#line 583
##### end fs_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin selinux_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute selinux_unconfined_type;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t selinux_unconfined_type;
#line 583

#line 583
	 	
#line 583
##### end selinux_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin files_get_etc_unit_status(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type etc_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	allow xdm_t etc_t:service status;
#line 583

#line 583
	 	
#line 583
##### end files_get_etc_unit_status(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin files_etc_unit_start(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type etc_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	allow xdm_t etc_t:service start;
#line 583

#line 583
	 	
#line 583
##### end files_etc_unit_start(xdm_t) depth: 2
#line 583
 	
#line 583
	 	 	
#line 583
##### begin files_etc_unit_stop(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type etc_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	allow xdm_t etc_t:service stop;
#line 583

#line 583
	 	
#line 583
##### end files_etc_unit_stop(xdm_t) depth: 2
#line 583
 	
#line 583

#line 583
	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		
#line 583
bool allow_execheap;
#line 583

#line 583
  
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583
	if (allow_execheap) {
#line 583
		
#line 583
		# Allow making the stack executable via mprotect.
#line 583
		allow xdm_t self:process execheap;
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		
#line 583
bool allow_execmem;
#line 583

#line 583
  
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583
	if (allow_execmem) {
#line 583
		
#line 583
		# Allow making anonymous memory executable, e.g. 
#line 583
		# for runtime-code generation or executable stack.
#line 583
		allow xdm_t self:process execmem;
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		
#line 583
bool allow_execstack;
#line 583

#line 583
  
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583
	if (allow_execstack) {
#line 583
		
#line 583
		# Allow making the stack executable via mprotect;
#line 583
		# execstack implies execmem;
#line 583
		allow xdm_t self:process { execstack execmem };
#line 583
#		auditallow xdm_t self:process execstack;
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	optional {
#line 583
		
#line 583
		 	 	
#line 583
##### begin auth_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute can_read_shadow_passwords;
#line 583
		attribute can_write_shadow_passwords;
#line 583
		attribute can_relabelto_shadow_passwords;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t can_read_shadow_passwords;
#line 583
	typeattribute xdm_t can_write_shadow_passwords;
#line 583
	typeattribute xdm_t can_relabelto_shadow_passwords;
#line 583

#line 583
	 	
#line 583
##### end auth_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	optional {
#line 583
		
#line 583
		 	 	
#line 583
##### begin dbus_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute dbusd_unconfined;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t dbusd_unconfined;
#line 583

#line 583
	 	
#line 583
##### end dbus_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	optional {
#line 583
		
#line 583
		 	 	
#line 583
##### begin ipsec_setcontext_default_spd(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type ipsec_spd_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	allow xdm_t ipsec_spd_t:association setcontext;
#line 583

#line 583
	 	
#line 583
##### end ipsec_setcontext_default_spd(xdm_t) depth: 2
#line 583
 	
#line 583
		 	 	
#line 583
##### begin ipsec_match_default_spd(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type ipsec_spd_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	allow xdm_t ipsec_spd_t:association polmatch;
#line 583
	allow xdm_t self:association sendto;
#line 583

#line 583
	 	
#line 583
##### end ipsec_match_default_spd(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	optional {
#line 583
		
#line 583
		 	 	
#line 583
##### begin nscd_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type nscd_t;
#line 583
		class nscd { getpwd getgrp gethost getstat admin shmempwd shmemgrp shmemhost getserv shmemserv };
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	allow xdm_t nscd_t:nscd *;
#line 583

#line 583
	 	
#line 583
##### end nscd_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	optional {
#line 583
		
#line 583
		 	 	
#line 583
##### begin postgresql_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute sepgsql_unconfined_type;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t sepgsql_unconfined_type;
#line 583

#line 583
	 	
#line 583
##### end postgresql_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	optional {
#line 583
		
#line 583
		 	 	
#line 583
##### begin seutil_create_bin_policy(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
#		attribute can_write_binary_policy;
#line 583
		type selinux_config_t, policy_config_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	 	 	
#line 583
##### begin files_search_etc(xdm_t) depth: 4
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type etc_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	allow xdm_t etc_t:dir { getattr search open };
#line 583

#line 583
	 	
#line 583
##### end files_search_etc(xdm_t) depth: 3
#line 583
 	
#line 583
	allow xdm_t selinux_config_t:dir { getattr search open };
#line 583
	
#line 583
	allow xdm_t policy_config_t:dir { getattr search open lock ioctl write add_name };
#line 583
	allow xdm_t policy_config_t:file { getattr create open };
#line 583

#line 583
	
#line 583
	allow xdm_t policy_config_t:dir { getattr search open };
#line 583
	allow xdm_t policy_config_t:file { getattr open write append lock ioctl };
#line 583

#line 583
#	typeattribute xdm_t can_write_binary_policy;
#line 583

#line 583
	 	
#line 583
##### end seutil_create_bin_policy(xdm_t) depth: 2
#line 583
 	
#line 583
		 	 	
#line 583
##### begin seutil_relabelto_bin_policy(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute can_relabelto_binary_policy;
#line 583
		type policy_config_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	allow xdm_t policy_config_t:file relabelto;
#line 583
	typeattribute xdm_t can_relabelto_binary_policy;
#line 583

#line 583
	 	
#line 583
##### end seutil_relabelto_bin_policy(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	optional {
#line 583
		
#line 583
		 	 	
#line 583
##### begin storage_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute storage_unconfined_type;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t storage_unconfined_type;
#line 583

#line 583
	 	
#line 583
##### end storage_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	
#line 583
	optional {
#line 583
		
#line 583
		 	 	
#line 583
##### begin xserver_unconfined(xdm_t) depth: 3
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		attribute x_domain;
#line 583
		attribute xserver_unconfined_type;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	typeattribute xdm_t x_domain;
#line 583
	typeattribute xdm_t xserver_unconfined_type;
#line 583

#line 583
	 	
#line 583
##### end xserver_unconfined(xdm_t) depth: 2
#line 583
 	
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	 	
#line 583
##### end unconfined_domain_noaudit(xdm_t) depth: 1
#line 583
 	
#line 583

#line 583
	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		
#line 583
bool allow_execheap;
#line 583

#line 583
  
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583
	if (allow_execheap) {
#line 583
		
#line 583
		auditallow xdm_t self:process execheap;
#line 583
	
#line 583
	}
#line 583

#line 583

#line 583
	 	
#line 583
##### end unconfined_domain(xdm_t) depth: 0
#line 583
 	
#line 583
	 	 	
#line 583
##### begin unconfined_domtrans(xdm_t) depth: 1
#line 583
 	
#line 583
	
#line 583
	
#line 583
		require {
#line 583
			
#line 583
		type unconfined_t, unconfined_exec_t;
#line 583
	
#line 583
		} # end require
#line 583
	
#line 583

#line 583

#line 583
	
#line 583
	
#line 583
	
#line 583
	allow xdm_t unconfined_exec_t:file { getattr open read execute };
#line 583
	allow xdm_t unconfined_t:process transition;
#line 583
	dontaudit xdm_t unconfined_t:process { noatsecure siginh rlimitinh };
#line 583

#line 583
	type_transition xdm_t unconfined_exec_t:process unconfined_t;
#line 583

#line 583

#line 583
	allow unconfined_t xdm_t:fd use;
#line 583
	allow unconfined_t xdm_t:fifo_file { open { getattr read write append ioctl lock } };
#line 583
	allow unconfined_t xdm_t:process sigchld;
#line 583

#line 583

#line 583
	 	
#line 583
##### end unconfined_domtrans(xdm_t) depth: 0
#line 583
 	
#line 583

#line 583
	
#line 583
		allow xdm_t self:process { execheap execmem };
#line 583
	
#line 583

#line 583
	} # end optional
#line 590



#line 592
	optional {
#line 592
		
#line 592
	 	 	
#line 592
##### begin userhelper_dontaudit_search_config(xdm_t) depth: 1
#line 592
 	
#line 592
	
#line 592
	
#line 592
		require {
#line 592
			
#line 592
		type userhelper_conf_t;
#line 592
	
#line 592
		} # end require
#line 592
	
#line 592

#line 592

#line 592
	dontaudit xdm_t userhelper_conf_t:dir { getattr search open };
#line 592

#line 592
	 	
#line 592
##### end userhelper_dontaudit_search_config(xdm_t) depth: 0
#line 592
 	
#line 592

#line 592
	} # end optional
#line 594



#line 596
	optional {
#line 596
		
#line 596
	 	 	
#line 596
##### begin usermanage_read_crack_db(xdm_t) depth: 1
#line 596
 	
#line 596
	
#line 596
	
#line 596
		require {
#line 596
			
#line 596
		type crack_db_t;
#line 596
	
#line 596
		} # end require
#line 596
	
#line 596

#line 596

#line 596
	 	 	
#line 596
##### begin files_search_var(xdm_t) depth: 2
#line 596
 	
#line 596
	
#line 596
	
#line 596
		require {
#line 596
			
#line 596
		type var_t;
#line 596
	
#line 596
		} # end require
#line 596
	
#line 596

#line 596

#line 596
	allow xdm_t var_t:dir { getattr search open };
#line 596

#line 596
	 	
#line 596
##### end files_search_var(xdm_t) depth: 1
#line 596
 	
#line 596
	
#line 596
	allow xdm_t crack_db_t:dir { getattr search open };
#line 596
	allow xdm_t crack_db_t:file { getattr open read lock ioctl };
#line 596

#line 596

#line 596
	 	
#line 596
##### end usermanage_read_crack_db(xdm_t) depth: 0
#line 596
 	
#line 596

#line 596
	} # end optional
#line 598



#line 600
	optional {
#line 600
		
#line 600
	 	 	
#line 600
##### begin xfs_stream_connect(xdm_t) depth: 1
#line 600
 	
#line 600
	
#line 600
	
#line 600
		require {
#line 600
			
#line 600
		type xfs_tmp_t, xfs_t;
#line 600
	
#line 600
		} # end require
#line 600
	
#line 600

#line 600

#line 600
	 	 	
#line 600
##### begin files_search_tmp(xdm_t) depth: 2
#line 600
 	
#line 600
	
#line 600
	
#line 600
		require {
#line 600
			
#line 600
		type tmp_t;
#line 600
	
#line 600
		} # end require
#line 600
	
#line 600

#line 600

#line 600
	allow xdm_t tmp_t:dir { getattr search open };
#line 600

#line 600
	 	
#line 600
##### end files_search_tmp(xdm_t) depth: 1
#line 600
 	
#line 600
	
#line 600
	allow xdm_t xfs_tmp_t:dir { getattr search open };
#line 600
	allow xdm_t xfs_tmp_t:sock_file { getattr write open append };
#line 600
	allow xdm_t xfs_t:unix_stream_socket connectto;
#line 600

#line 600

#line 600
	 	
#line 600
##### end xfs_stream_connect(xdm_t) depth: 0
#line 600
 	
#line 600

#line 600
	} # end optional
#line 602


########################################
#
# X server local policy
#

# X Object Manager rules
type_transition xserver_t xserver_t:x_drawable root_xdrawable_t;
type_transition xserver_t xserver_t:x_colormap root_xcolormap_t;
type_transition root_xdrawable_t input_xevent_t:x_event root_input_xevent_t;

allow xserver_t { root_xdrawable_t x_domain }:x_drawable send;
allow xserver_t input_xevent_t:x_event send;

# setuid/setgid for the wrapper program to change UID
# sys_rawio is for iopl access - should not be needed for frame-buffer
# sys_admin, locking shared mem?  chowning IPC message queues or semaphores?
# admin of APM bios?
# sys_nice is so that the X server can set a negative nice value
# execheap needed until the X module loader is fixed.
# NVIDIA Needs execstack

allow xserver_t self:capability { dac_override fowner fsetid setgid setuid ipc_owner sys_rawio sys_admin sys_nice sys_tty_config mknod net_bind_service };
dontaudit xserver_t self:capability chown;
allow xserver_t self:capability2 wake_alarm;
allow xserver_t self:process ~{ ptrace setcurrent setexec setfscreate setrlimit execmem execstack execheap };
allow xserver_t self:fd use;
allow xserver_t self:fifo_file { open { getattr read write append ioctl lock } };
allow xserver_t self:sock_file { getattr open read };
allow xserver_t self:shm { associate getattr setattr create destroy read write lock unix_read unix_write };
allow xserver_t self:sem { associate getattr setattr create destroy read write unix_read unix_write };
allow xserver_t self:msgq { associate getattr setattr create destroy read write enqueue unix_read unix_write };
allow xserver_t self:msg { send receive };
allow xserver_t self:unix_dgram_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } sendto };
allow xserver_t self:unix_stream_socket { { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept } connectto };
allow xserver_t self:tcp_socket { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } listen accept };
allow xserver_t self:udp_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
allow xserver_t self:netlink_kobject_uevent_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };


#line 642
	allow xserver_t xserver_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 642
	allow xserver_t xserver_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 642


#line 643
	allow xserver_t xserver_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 643
	allow xserver_t xserver_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 643


#line 644
	allow xserver_t xserver_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 644
	allow xserver_t xserver_tmp_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 644

 	 	
#line 645
##### begin files_tmp_filetrans(xserver_t,xserver_tmp_t,{ file dir sock_file }) depth: 1
#line 645
 	
#line 645
	
#line 645
	
#line 645
		require {
#line 645
			
#line 645
		type tmp_t;
#line 645
	
#line 645
		} # end require
#line 645
	
#line 645

#line 645

#line 645
	
#line 645
	allow xserver_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 645
	type_transition xserver_t tmp_t:{ file dir sock_file } xserver_tmp_t ;
#line 645

#line 645

#line 645
	 	
#line 645
##### end files_tmp_filetrans(xserver_t,xserver_tmp_t,{ file dir sock_file }) depth: 0
#line 645
 	


#line 647
	allow xserver_t xserver_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 647
	type_transition xserver_t xserver_tmp_t:sock_file xserver_tmp_t ;
#line 647



#line 649
	allow xserver_t xserver_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 649
	allow xserver_t xserver_tmpfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 649


#line 650
	allow xserver_t xserver_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 650
	allow xserver_t xserver_tmpfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 650


#line 651
	allow xserver_t xserver_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 651
	allow xserver_t xserver_tmpfs_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 651


#line 652
	allow xserver_t xserver_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 652
	allow xserver_t xserver_tmpfs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 652


#line 653
	allow xserver_t xserver_tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 653
	allow xserver_t xserver_tmpfs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 653

 	 	
#line 654
##### begin fs_tmpfs_filetrans(xserver_t,xserver_tmpfs_t,{ dir file lnk_file sock_file fifo_file }) depth: 1
#line 654
 	
#line 654
	
#line 654
	
#line 654
		require {
#line 654
			
#line 654
		type tmpfs_t;
#line 654
	
#line 654
		} # end require
#line 654
	
#line 654

#line 654

#line 654
	allow xserver_tmpfs_t tmpfs_t:filesystem associate;
#line 654
	
#line 654
	allow xserver_t tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 654
	type_transition xserver_t tmpfs_t:{ dir file lnk_file sock_file fifo_file } xserver_tmpfs_t ;
#line 654

#line 654

#line 654
	 	
#line 654
##### end fs_tmpfs_filetrans(xserver_t,xserver_tmpfs_t,{ dir file lnk_file sock_file fifo_file }) depth: 0
#line 654
 	


#line 656
	allow xserver_t xkb_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 656
	allow xserver_t xkb_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 656


#line 657
	allow xserver_t xkb_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 657
	allow xserver_t xkb_var_lib_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 657

 	 	
#line 658
##### begin files_search_var_lib(xserver_t) depth: 1
#line 658
 	
#line 658
	
#line 658
	
#line 658
		require {
#line 658
			
#line 658
		type var_t, var_lib_t;
#line 658
	
#line 658
		} # end require
#line 658
	
#line 658

#line 658

#line 658
	
#line 658
	allow xserver_t var_t:dir { getattr search open };
#line 658
	allow xserver_t var_lib_t:dir { getattr search open };
#line 658

#line 658

#line 658
	 	
#line 658
##### end files_search_var_lib(xserver_t) depth: 0
#line 658
 	


#line 660
	
#line 660
	
#line 660
	allow xserver_t xauth_exec_t:file { getattr open read execute };
#line 660
	allow xserver_t xauth_t:process transition;
#line 660
	dontaudit xserver_t xauth_t:process { noatsecure siginh rlimitinh };
#line 660

#line 660
	type_transition xserver_t xauth_exec_t:process xauth_t;
#line 660

#line 660

#line 660
	allow xauth_t xserver_t:fd use;
#line 660
	allow xauth_t xserver_t:fifo_file { open { getattr read write append ioctl lock } };
#line 660
	allow xauth_t xserver_t:process sigchld;
#line 660

allow xserver_t xauth_home_t:file { getattr open read lock ioctl };

# Create files in /var/log with the xserver_log_t type.

#line 664
	allow xserver_t xserver_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 664
	allow xserver_t xserver_log_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 664

 	 	
#line 665
##### begin logging_log_filetrans(xserver_t,xserver_log_t,file) depth: 1
#line 665
 	
#line 665
	
#line 665
	
#line 665
		require {
#line 665
			
#line 665
		type var_log_t;
#line 665
	
#line 665
		} # end require
#line 665
	
#line 665

#line 665

#line 665
	 	 	
#line 665
##### begin files_search_var(xserver_t) depth: 2
#line 665
 	
#line 665
	
#line 665
	
#line 665
		require {
#line 665
			
#line 665
		type var_t;
#line 665
	
#line 665
		} # end require
#line 665
	
#line 665

#line 665

#line 665
	allow xserver_t var_t:dir { getattr search open };
#line 665

#line 665
	 	
#line 665
##### end files_search_var(xserver_t) depth: 1
#line 665
 	
#line 665
	
#line 665
	allow xserver_t var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 665
	type_transition xserver_t var_log_t:file xserver_log_t ;
#line 665

#line 665
	allow xserver_t var_log_t:lnk_file { getattr read };
#line 665

#line 665
	 	
#line 665
##### end logging_log_filetrans(xserver_t,xserver_log_t,file) depth: 0
#line 665
 	

 	 	
#line 667
##### begin kernel_read_system_state(xserver_t) depth: 1
#line 667
 	
#line 667
	
#line 667
	
#line 667
		require {
#line 667
			
#line 667
		type proc_t;
#line 667
	
#line 667
		} # end require
#line 667
	
#line 667

#line 667

#line 667
	
#line 667
	allow xserver_t proc_t:dir { getattr search open };
#line 667
	allow xserver_t proc_t:file { getattr open read lock ioctl };
#line 667

#line 667
	
#line 667
	allow xserver_t proc_t:dir { getattr search open };
#line 667
	allow xserver_t proc_t:lnk_file { getattr read };
#line 667

#line 667

#line 667
	
#line 667
	allow xserver_t proc_t:dir { getattr search open };
#line 667
	allow xserver_t proc_t:dir { getattr search open read lock ioctl };
#line 667

#line 667

#line 667
	 	
#line 667
##### end kernel_read_system_state(xserver_t) depth: 0
#line 667
 	
 	 	
#line 668
##### begin kernel_read_device_sysctls(xserver_t) depth: 1
#line 668
 	
#line 668
	
#line 668
	
#line 668
		require {
#line 668
			
#line 668
		type proc_t, sysctl_t, sysctl_dev_t;
#line 668
	
#line 668
		} # end require
#line 668
	
#line 668

#line 668

#line 668
	
#line 668
	allow xserver_t { proc_t sysctl_t sysctl_dev_t }:dir { getattr search open };
#line 668
	allow xserver_t sysctl_dev_t:file { getattr open read lock ioctl };
#line 668

#line 668

#line 668
	
#line 668
	allow xserver_t { proc_t sysctl_t }:dir { getattr search open };
#line 668
	allow xserver_t sysctl_dev_t:dir { getattr search open read lock ioctl };
#line 668

#line 668

#line 668
	 	
#line 668
##### end kernel_read_device_sysctls(xserver_t) depth: 0
#line 668
 	
 	 	
#line 669
##### begin kernel_read_modprobe_sysctls(xserver_t) depth: 1
#line 669
 	
#line 669
	
#line 669
	
#line 669
		require {
#line 669
			
#line 669
		type proc_t, sysctl_t, sysctl_kernel_t, sysctl_modprobe_t;
#line 669
	
#line 669
		} # end require
#line 669
	
#line 669

#line 669

#line 669
	
#line 669
	allow xserver_t { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 669
	allow xserver_t sysctl_modprobe_t:file { getattr open read lock ioctl };
#line 669

#line 669

#line 669
	
#line 669
	allow xserver_t { proc_t sysctl_t }:dir { getattr search open };
#line 669
	allow xserver_t sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 669

#line 669

#line 669
	 	
#line 669
##### end kernel_read_modprobe_sysctls(xserver_t) depth: 0
#line 669
 	
# Xorg wants to check if kernel is tainted
 	 	
#line 671
##### begin kernel_read_kernel_sysctls(xserver_t) depth: 1
#line 671
 	
#line 671
	
#line 671
	
#line 671
		require {
#line 671
			
#line 671
		type proc_t, sysctl_t, sysctl_kernel_t;
#line 671
	
#line 671
		} # end require
#line 671
	
#line 671

#line 671

#line 671
	
#line 671
	allow xserver_t { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 671
	allow xserver_t sysctl_kernel_t:file { getattr open read lock ioctl };
#line 671

#line 671

#line 671
	
#line 671
	allow xserver_t { proc_t sysctl_t }:dir { getattr search open };
#line 671
	allow xserver_t sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 671

#line 671

#line 671
	 	
#line 671
##### end kernel_read_kernel_sysctls(xserver_t) depth: 0
#line 671
 	
 	 	
#line 672
##### begin kernel_write_proc_files(xserver_t) depth: 1
#line 672
 	
#line 672
	
#line 672
	
#line 672
		require {
#line 672
			
#line 672
		type proc_t;
#line 672
	
#line 672
		} # end require
#line 672
	
#line 672

#line 672

#line 672
	
#line 672
	allow xserver_t proc_t:dir { getattr search open };
#line 672
	allow xserver_t proc_t:file { getattr open write append lock ioctl };
#line 672

#line 672

#line 672
	 	
#line 672
##### end kernel_write_proc_files(xserver_t) depth: 0
#line 672
 	

# Run helper programs in xserver_t.
 	 	
#line 675
##### begin corecmd_exec_bin(xserver_t) depth: 1
#line 675
 	
#line 675
	
#line 675
	
#line 675
		require {
#line 675
			
#line 675
		type bin_t;
#line 675
	
#line 675
		} # end require
#line 675
	
#line 675

#line 675

#line 675
	
#line 675
	allow xserver_t bin_t:dir { getattr search open };
#line 675
	allow xserver_t bin_t:lnk_file { getattr read };
#line 675

#line 675
	
#line 675
	allow xserver_t bin_t:dir { getattr search open };
#line 675
	allow xserver_t bin_t:dir { getattr search open read lock ioctl };
#line 675

#line 675
	allow xserver_t bin_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 675

#line 675
	 	
#line 675
##### end corecmd_exec_bin(xserver_t) depth: 0
#line 675
 	
 	 	
#line 676
##### begin corecmd_exec_shell(xserver_t) depth: 1
#line 676
 	
#line 676
	
#line 676
	
#line 676
		require {
#line 676
			
#line 676
		type bin_t, shell_exec_t;
#line 676
	
#line 676
		} # end require
#line 676
	
#line 676

#line 676

#line 676
	
#line 676
	allow xserver_t bin_t:dir { getattr search open };
#line 676
	allow xserver_t bin_t:dir { getattr search open read lock ioctl };
#line 676

#line 676
	
#line 676
	allow xserver_t bin_t:dir { getattr search open };
#line 676
	allow xserver_t bin_t:lnk_file { getattr read };
#line 676

#line 676
	allow xserver_t shell_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 676

#line 676
	 	
#line 676
##### end corecmd_exec_shell(xserver_t) depth: 0
#line 676
 	

 	 	
#line 678
##### begin corenet_all_recvfrom_unlabeled(xserver_t) depth: 1
#line 678
 	
#line 678
	 	 	
#line 678
##### begin kernel_tcp_recvfrom_unlabeled(xserver_t) depth: 2
#line 678
 	
#line 678
	
#line 678
	
#line 678
		require {
#line 678
			
#line 678
		type unlabeled_t;
#line 678
	
#line 678
		} # end require
#line 678
	
#line 678

#line 678

#line 678
	allow xserver_t unlabeled_t:tcp_socket recvfrom;
#line 678

#line 678
	 	
#line 678
##### end kernel_tcp_recvfrom_unlabeled(xserver_t) depth: 1
#line 678
 	
#line 678
	 	 	
#line 678
##### begin kernel_udp_recvfrom_unlabeled(xserver_t) depth: 2
#line 678
 	
#line 678
	
#line 678
	
#line 678
		require {
#line 678
			
#line 678
		type unlabeled_t;
#line 678
	
#line 678
		} # end require
#line 678
	
#line 678

#line 678

#line 678
	allow xserver_t unlabeled_t:udp_socket recvfrom;
#line 678

#line 678
	 	
#line 678
##### end kernel_udp_recvfrom_unlabeled(xserver_t) depth: 1
#line 678
 	
#line 678
	 	 	
#line 678
##### begin kernel_raw_recvfrom_unlabeled(xserver_t) depth: 2
#line 678
 	
#line 678
	
#line 678
	
#line 678
		require {
#line 678
			
#line 678
		type unlabeled_t;
#line 678
	
#line 678
		} # end require
#line 678
	
#line 678

#line 678

#line 678
	allow xserver_t unlabeled_t:rawip_socket recvfrom;
#line 678

#line 678
	 	
#line 678
##### end kernel_raw_recvfrom_unlabeled(xserver_t) depth: 1
#line 678
 	
#line 678
	 	 	
#line 678
##### begin kernel_recvfrom_unlabeled_peer(xserver_t) depth: 2
#line 678
 	
#line 678
	
#line 678
	
#line 678
		require {
#line 678
			
#line 678
		type unlabeled_t;
#line 678
	
#line 678
		} # end require
#line 678
	
#line 678

#line 678

#line 678
	allow xserver_t unlabeled_t:peer recv;
#line 678

#line 678
	 	
#line 678
##### end kernel_recvfrom_unlabeled_peer(xserver_t) depth: 1
#line 678
 	
#line 678

#line 678
	# XXX - at some point the oubound/send access check will be removed
#line 678
	# but for right now we need to keep this in place so as not to break
#line 678
	# older systems
#line 678
	 	 	
#line 678
##### begin kernel_sendrecv_unlabeled_association(xserver_t) depth: 2
#line 678
 	
#line 678
	
#line 678
	
#line 678
		require {
#line 678
			
#line 678
		type unlabeled_t;
#line 678
	
#line 678
		} # end require
#line 678
	
#line 678

#line 678

#line 678
	allow xserver_t unlabeled_t:association { sendto recvfrom };
#line 678

#line 678
	 	
#line 678
##### end kernel_sendrecv_unlabeled_association(xserver_t) depth: 1
#line 678
 	
#line 678

#line 678
	 	
#line 678
##### end corenet_all_recvfrom_unlabeled(xserver_t) depth: 0
#line 678
 	
 	 	
#line 679
##### begin corenet_all_recvfrom_netlabel(xserver_t) depth: 1
#line 679
 	
#line 679
	
#line 679
	
#line 679
		require {
#line 679
			
#line 679
		type netlabel_peer_t;
#line 679
	
#line 679
		} # end require
#line 679
	
#line 679

#line 679

#line 679
	allow xserver_t netlabel_peer_t:peer recv;
#line 679
	allow xserver_t netlabel_peer_t:{ tcp_socket udp_socket rawip_socket } recvfrom;
#line 679

#line 679
	 	
#line 679
##### end corenet_all_recvfrom_netlabel(xserver_t) depth: 0
#line 679
 	
 	 	
#line 680
##### begin corenet_tcp_sendrecv_generic_if(xserver_t) depth: 1
#line 680
 	
#line 680
	
#line 680
	
#line 680
		require {
#line 680
			
#line 680
		type netif_t;
#line 680
	
#line 680
		} # end require
#line 680
	
#line 680

#line 680

#line 680
	allow xserver_t netif_t:netif { tcp_send tcp_recv egress ingress };
#line 680

#line 680
	 	
#line 680
##### end corenet_tcp_sendrecv_generic_if(xserver_t) depth: 0
#line 680
 	
 	 	
#line 681
##### begin corenet_udp_sendrecv_generic_if(xserver_t) depth: 1
#line 681
 	
#line 681
	 	 	
#line 681
##### begin corenet_udp_send_generic_if(xserver_t) depth: 2
#line 681
 	
#line 681
	
#line 681
	
#line 681
		require {
#line 681
			
#line 681
		type netif_t;
#line 681
	
#line 681
		} # end require
#line 681
	
#line 681

#line 681

#line 681
	allow xserver_t netif_t:netif { udp_send egress };
#line 681

#line 681
	 	
#line 681
##### end corenet_udp_send_generic_if(xserver_t) depth: 1
#line 681
 	
#line 681
	 	 	
#line 681
##### begin corenet_udp_receive_generic_if(xserver_t) depth: 2
#line 681
 	
#line 681
	
#line 681
	
#line 681
		require {
#line 681
			
#line 681
		type netif_t;
#line 681
	
#line 681
		} # end require
#line 681
	
#line 681

#line 681

#line 681
	allow xserver_t netif_t:netif { udp_recv ingress };
#line 681

#line 681
	 	
#line 681
##### end corenet_udp_receive_generic_if(xserver_t) depth: 1
#line 681
 	
#line 681

#line 681
	 	
#line 681
##### end corenet_udp_sendrecv_generic_if(xserver_t) depth: 0
#line 681
 	
 	 	
#line 682
##### begin corenet_tcp_sendrecv_generic_node(xserver_t) depth: 1
#line 682
 	
#line 682
	
#line 682
	
#line 682
		require {
#line 682
			
#line 682
		type node_t;
#line 682
	
#line 682
		} # end require
#line 682
	
#line 682

#line 682

#line 682
	allow xserver_t node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 682

#line 682
	 	
#line 682
##### end corenet_tcp_sendrecv_generic_node(xserver_t) depth: 0
#line 682
 	
 	 	
#line 683
##### begin corenet_udp_sendrecv_generic_node(xserver_t) depth: 1
#line 683
 	
#line 683
	 	 	
#line 683
##### begin corenet_udp_send_generic_node(xserver_t) depth: 2
#line 683
 	
#line 683
	
#line 683
	
#line 683
		require {
#line 683
			
#line 683
		type node_t;
#line 683
	
#line 683
		} # end require
#line 683
	
#line 683

#line 683

#line 683
	allow xserver_t node_t:node { udp_send sendto };
#line 683

#line 683
	 	
#line 683
##### end corenet_udp_send_generic_node(xserver_t) depth: 1
#line 683
 	
#line 683
	 	 	
#line 683
##### begin corenet_udp_receive_generic_node(xserver_t) depth: 2
#line 683
 	
#line 683
	
#line 683
	
#line 683
		require {
#line 683
			
#line 683
		type node_t;
#line 683
	
#line 683
		} # end require
#line 683
	
#line 683

#line 683

#line 683
	allow xserver_t node_t:node { udp_recv recvfrom };
#line 683

#line 683
	 	
#line 683
##### end corenet_udp_receive_generic_node(xserver_t) depth: 1
#line 683
 	
#line 683

#line 683
	 	
#line 683
##### end corenet_udp_sendrecv_generic_node(xserver_t) depth: 0
#line 683
 	
 	 	
#line 684
##### begin corenet_tcp_sendrecv_all_ports(xserver_t) depth: 1
#line 684
 	
#line 684
	
#line 684
	
#line 684
		require {
#line 684
			
#line 684
		attribute port_type;
#line 684
	
#line 684
		} # end require
#line 684
	
#line 684

#line 684

#line 684
	allow xserver_t port_type:tcp_socket { send_msg recv_msg };
#line 684

#line 684
	 	
#line 684
##### end corenet_tcp_sendrecv_all_ports(xserver_t) depth: 0
#line 684
 	
 	 	
#line 685
##### begin corenet_udp_sendrecv_all_ports(xserver_t) depth: 1
#line 685
 	
#line 685
	 	 	
#line 685
##### begin corenet_udp_send_all_ports(xserver_t) depth: 2
#line 685
 	
#line 685
	
#line 685
	
#line 685
		require {
#line 685
			
#line 685
		attribute port_type;
#line 685
	
#line 685
		} # end require
#line 685
	
#line 685

#line 685

#line 685
	allow xserver_t port_type:udp_socket send_msg;
#line 685

#line 685
	 	
#line 685
##### end corenet_udp_send_all_ports(xserver_t) depth: 1
#line 685
 	
#line 685
	 	 	
#line 685
##### begin corenet_udp_receive_all_ports(xserver_t) depth: 2
#line 685
 	
#line 685
	
#line 685
	
#line 685
		require {
#line 685
			
#line 685
		attribute port_type;
#line 685
	
#line 685
		} # end require
#line 685
	
#line 685

#line 685

#line 685
	allow xserver_t port_type:udp_socket recv_msg;
#line 685

#line 685
	 	
#line 685
##### end corenet_udp_receive_all_ports(xserver_t) depth: 1
#line 685
 	
#line 685

#line 685
	 	
#line 685
##### end corenet_udp_sendrecv_all_ports(xserver_t) depth: 0
#line 685
 	
 	 	
#line 686
##### begin corenet_tcp_bind_generic_node(xserver_t) depth: 1
#line 686
 	
#line 686
	
#line 686
	
#line 686
		require {
#line 686
			
#line 686
		type node_t;
#line 686
	
#line 686
		} # end require
#line 686
	
#line 686

#line 686

#line 686
	allow xserver_t node_t:tcp_socket node_bind;
#line 686

#line 686
	 	
#line 686
##### end corenet_tcp_bind_generic_node(xserver_t) depth: 0
#line 686
 	
 	 	
#line 687
##### begin corenet_tcp_bind_xserver_port(xserver_t) depth: 1
#line 687
 	
#line 687
	
#line 687
	
#line 687
		require {
#line 687
			
#line 687
		type xserver_port_t;
#line 687
	
#line 687
		} # end require
#line 687
	
#line 687

#line 687

#line 687
	allow xserver_t xserver_port_t:tcp_socket name_bind;
#line 687
	allow xserver_t self:capability net_bind_service;
#line 687

#line 687
	 	
#line 687
##### end corenet_tcp_bind_xserver_port(xserver_t) depth: 0
#line 687
 	
 	 	
#line 688
##### begin corenet_tcp_connect_all_ports(xserver_t) depth: 1
#line 688
 	
#line 688
	
#line 688
	
#line 688
		require {
#line 688
			
#line 688
		attribute port_type;
#line 688
	
#line 688
		} # end require
#line 688
	
#line 688

#line 688

#line 688
	allow xserver_t port_type:tcp_socket name_connect;
#line 688

#line 688
	 	
#line 688
##### end corenet_tcp_connect_all_ports(xserver_t) depth: 0
#line 688
 	
 	 	
#line 689
##### begin corenet_sendrecv_xserver_server_packets(xserver_t) depth: 1
#line 689
 	
#line 689
	 	 	
#line 689
##### begin corenet_send_xserver_server_packets(xserver_t) depth: 2
#line 689
 	
#line 689
	
#line 689
	
#line 689
		require {
#line 689
			
#line 689
		type xserver_server_packet_t;
#line 689
	
#line 689
		} # end require
#line 689
	
#line 689

#line 689

#line 689
	allow xserver_t xserver_server_packet_t:packet send;
#line 689

#line 689
	 	
#line 689
##### end corenet_send_xserver_server_packets(xserver_t) depth: 1
#line 689
 	
#line 689
	 	 	
#line 689
##### begin corenet_receive_xserver_server_packets(xserver_t) depth: 2
#line 689
 	
#line 689
	
#line 689
	
#line 689
		require {
#line 689
			
#line 689
		type xserver_server_packet_t;
#line 689
	
#line 689
		} # end require
#line 689
	
#line 689

#line 689

#line 689
	allow xserver_t xserver_server_packet_t:packet recv;
#line 689

#line 689
	 	
#line 689
##### end corenet_receive_xserver_server_packets(xserver_t) depth: 1
#line 689
 	
#line 689

#line 689
	 	
#line 689
##### end corenet_sendrecv_xserver_server_packets(xserver_t) depth: 0
#line 689
 	
 	 	
#line 690
##### begin corenet_sendrecv_all_client_packets(xserver_t) depth: 1
#line 690
 	
#line 690
	 	 	
#line 690
##### begin corenet_send_all_client_packets(xserver_t) depth: 2
#line 690
 	
#line 690
	
#line 690
	
#line 690
		require {
#line 690
			
#line 690
		attribute client_packet_type;
#line 690
	
#line 690
		} # end require
#line 690
	
#line 690

#line 690

#line 690
	allow xserver_t client_packet_type:packet send;
#line 690

#line 690
	 	
#line 690
##### end corenet_send_all_client_packets(xserver_t) depth: 1
#line 690
 	
#line 690
	 	 	
#line 690
##### begin corenet_receive_all_client_packets(xserver_t) depth: 2
#line 690
 	
#line 690
	
#line 690
	
#line 690
		require {
#line 690
			
#line 690
		attribute client_packet_type;
#line 690
	
#line 690
		} # end require
#line 690
	
#line 690

#line 690

#line 690
	allow xserver_t client_packet_type:packet recv;
#line 690

#line 690
	 	
#line 690
##### end corenet_receive_all_client_packets(xserver_t) depth: 1
#line 690
 	
#line 690

#line 690
	 	
#line 690
##### end corenet_sendrecv_all_client_packets(xserver_t) depth: 0
#line 690
 	

 	 	
#line 692
##### begin dev_rw_sysfs(xserver_t) depth: 1
#line 692
 	
#line 692
	
#line 692
	
#line 692
		require {
#line 692
			
#line 692
		type sysfs_t;
#line 692
	
#line 692
		} # end require
#line 692
	
#line 692

#line 692

#line 692
	
#line 692
	allow xserver_t sysfs_t:dir { getattr search open };
#line 692
	allow xserver_t sysfs_t:file { getattr open read write append ioctl lock };
#line 692

#line 692
	
#line 692
	allow xserver_t sysfs_t:dir { getattr search open };
#line 692
	allow xserver_t sysfs_t:lnk_file { getattr read };
#line 692

#line 692

#line 692
	
#line 692
	allow xserver_t sysfs_t:dir { getattr search open };
#line 692
	allow xserver_t sysfs_t:dir { getattr search open read lock ioctl };
#line 692

#line 692

#line 692
	 	
#line 692
##### end dev_rw_sysfs(xserver_t) depth: 0
#line 692
 	
 	 	
#line 693
##### begin dev_rw_mouse(xserver_t) depth: 1
#line 693
 	
#line 693
	
#line 693
	
#line 693
		require {
#line 693
			
#line 693
		type device_t, mouse_device_t;
#line 693
	
#line 693
		} # end require
#line 693
	
#line 693

#line 693

#line 693
	
#line 693
	allow xserver_t device_t:dir { getattr search open };
#line 693
	allow xserver_t mouse_device_t:chr_file { getattr open read write append ioctl lock };
#line 693

#line 693

#line 693
	 	
#line 693
##### end dev_rw_mouse(xserver_t) depth: 0
#line 693
 	
 	 	
#line 694
##### begin dev_rw_mtrr(xserver_t) depth: 1
#line 694
 	
#line 694
	
#line 694
	
#line 694
		require {
#line 694
			
#line 694
		type device_t, mtrr_device_t;
#line 694
	
#line 694
		} # end require
#line 694
	
#line 694

#line 694

#line 694
	
#line 694
	allow xserver_t device_t:dir { getattr search open };
#line 694
	allow xserver_t mtrr_device_t:file { getattr open read write append ioctl lock };
#line 694

#line 694
	
#line 694
	allow xserver_t device_t:dir { getattr search open };
#line 694
	allow xserver_t mtrr_device_t:chr_file { getattr open read write append ioctl lock };
#line 694

#line 694

#line 694
	 	
#line 694
##### end dev_rw_mtrr(xserver_t) depth: 0
#line 694
 	
 	 	
#line 695
##### begin dev_rw_apm_bios(xserver_t) depth: 1
#line 695
 	
#line 695
	
#line 695
	
#line 695
		require {
#line 695
			
#line 695
		type device_t, apm_bios_t;
#line 695
	
#line 695
		} # end require
#line 695
	
#line 695

#line 695

#line 695
	
#line 695
	allow xserver_t device_t:dir { getattr search open };
#line 695
	allow xserver_t apm_bios_t:chr_file { getattr open read write append ioctl lock };
#line 695

#line 695

#line 695
	 	
#line 695
##### end dev_rw_apm_bios(xserver_t) depth: 0
#line 695
 	
 	 	
#line 696
##### begin dev_rw_agp(xserver_t) depth: 1
#line 696
 	
#line 696
	
#line 696
	
#line 696
		require {
#line 696
			
#line 696
		type device_t, agp_device_t;
#line 696
	
#line 696
		} # end require
#line 696
	
#line 696

#line 696

#line 696
	
#line 696
	allow xserver_t device_t:dir { getattr search open };
#line 696
	allow xserver_t agp_device_t:chr_file { getattr open read write append ioctl lock };
#line 696

#line 696

#line 696
	 	
#line 696
##### end dev_rw_agp(xserver_t) depth: 0
#line 696
 	
 	 	
#line 697
##### begin dev_rw_framebuffer(xserver_t) depth: 1
#line 697
 	
#line 697
	
#line 697
	
#line 697
		require {
#line 697
			
#line 697
		type device_t, framebuf_device_t;
#line 697
	
#line 697
		} # end require
#line 697
	
#line 697

#line 697

#line 697
	
#line 697
	allow xserver_t device_t:dir { getattr search open };
#line 697
	allow xserver_t framebuf_device_t:chr_file { getattr open read write append ioctl lock };
#line 697

#line 697

#line 697
	 	
#line 697
##### end dev_rw_framebuffer(xserver_t) depth: 0
#line 697
 	
 	 	
#line 698
##### begin dev_manage_dri_dev(xserver_t) depth: 1
#line 698
 	
#line 698
	
#line 698
	
#line 698
		require {
#line 698
			
#line 698
		type device_t, dri_device_t;
#line 698
	
#line 698
		} # end require
#line 698
	
#line 698

#line 698

#line 698
	
#line 698
	allow xserver_t self:capability mknod;
#line 698
	allow xserver_t device_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 698
	allow xserver_t dri_device_t:chr_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 698

#line 698

#line 698
	 	
#line 698
##### end dev_manage_dri_dev(xserver_t) depth: 0
#line 698
 	
 	 	
#line 699
##### begin dev_filetrans_dri(xserver_t) depth: 1
#line 699
 	
#line 699
	
#line 699
	
#line 699
		require {
#line 699
			
#line 699
		type device_t, dri_device_t;
#line 699
	
#line 699
		} # end require
#line 699
	
#line 699

#line 699

#line 699
	
#line 699
	allow xserver_t device_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 699
	type_transition xserver_t device_t:chr_file dri_device_t ;
#line 699

#line 699

#line 699
	 	
#line 699
##### end dev_filetrans_dri(xserver_t) depth: 0
#line 699
 	
 	 	
#line 700
##### begin dev_create_generic_dirs(xserver_t) depth: 1
#line 700
 	
#line 700
	
#line 700
	
#line 700
		require {
#line 700
			
#line 700
		type device_t;
#line 700
	
#line 700
		} # end require
#line 700
	
#line 700

#line 700

#line 700
	allow xserver_t device_t:dir { getattr search open read lock ioctl };
#line 700
	
#line 700
	allow xserver_t device_t:dir { getattr search open lock ioctl write add_name };
#line 700
	allow xserver_t device_t:dir { getattr create };
#line 700

#line 700

#line 700
	 	
#line 700
##### end dev_create_generic_dirs(xserver_t) depth: 0
#line 700
 	
 	 	
#line 701
##### begin dev_setattr_generic_dirs(xserver_t) depth: 1
#line 701
 	
#line 701
	
#line 701
	
#line 701
		require {
#line 701
			
#line 701
		type device_t;
#line 701
	
#line 701
		} # end require
#line 701
	
#line 701

#line 701

#line 701
	
#line 701
	allow xserver_t device_t:dir { getattr search open };
#line 701
	allow xserver_t device_t:dir { setattr };
#line 701

#line 701

#line 701
	 	
#line 701
##### end dev_setattr_generic_dirs(xserver_t) depth: 0
#line 701
 	
# raw memory access is needed if not using the frame buffer
 	 	
#line 703
##### begin dev_read_raw_memory(xserver_t) depth: 1
#line 703
 	
#line 703
	
#line 703
	
#line 703
		require {
#line 703
			
#line 703
		type device_t, memory_device_t;
#line 703
		attribute memory_raw_read;
#line 703
	
#line 703
		} # end require
#line 703
	
#line 703

#line 703

#line 703
	
#line 703
	allow xserver_t device_t:dir { getattr search open };
#line 703
	allow xserver_t memory_device_t:chr_file { getattr open read lock ioctl };
#line 703

#line 703

#line 703
	allow xserver_t self:capability sys_rawio;
#line 703
	typeattribute xserver_t memory_raw_read;
#line 703

#line 703
	 	
#line 703
##### end dev_read_raw_memory(xserver_t) depth: 0
#line 703
 	
 	 	
#line 704
##### begin dev_wx_raw_memory(xserver_t) depth: 1
#line 704
 	
#line 704
	
#line 704
	
#line 704
		require {
#line 704
			
#line 704
		type device_t, memory_device_t;
#line 704
	
#line 704
		} # end require
#line 704
	
#line 704

#line 704

#line 704
	 	 	
#line 704
##### begin dev_write_raw_memory(xserver_t) depth: 2
#line 704
 	
#line 704
	
#line 704
	
#line 704
		require {
#line 704
			
#line 704
		type device_t, memory_device_t;
#line 704
		attribute memory_raw_write;
#line 704
	
#line 704
		} # end require
#line 704
	
#line 704

#line 704

#line 704
	
#line 704
	allow xserver_t device_t:dir { getattr search open };
#line 704
	allow xserver_t memory_device_t:chr_file { getattr open write append lock ioctl };
#line 704

#line 704

#line 704
	allow xserver_t self:capability sys_rawio;
#line 704
	typeattribute xserver_t memory_raw_write;
#line 704

#line 704
	 	
#line 704
##### end dev_write_raw_memory(xserver_t) depth: 1
#line 704
 	
#line 704
	allow xserver_t memory_device_t:chr_file execute;
#line 704

#line 704
	 	
#line 704
##### end dev_wx_raw_memory(xserver_t) depth: 0
#line 704
 	
# for other device nodes such as the NVidia binary-only driver
 	 	
#line 706
##### begin dev_rw_xserver_misc(xserver_t) depth: 1
#line 706
 	
#line 706
	
#line 706
	
#line 706
		require {
#line 706
			
#line 706
		type device_t, xserver_misc_device_t;
#line 706
	
#line 706
		} # end require
#line 706
	
#line 706

#line 706

#line 706
	
#line 706
	allow xserver_t device_t:dir { getattr search open };
#line 706
	allow xserver_t xserver_misc_device_t:chr_file { getattr open read write append ioctl lock };
#line 706

#line 706

#line 706
	 	
#line 706
##### end dev_rw_xserver_misc(xserver_t) depth: 0
#line 706
 	
# read events - the synaptics touchpad driver reads raw events
 	 	
#line 708
##### begin dev_rw_input_dev(xserver_t) depth: 1
#line 708
 	
#line 708
	
#line 708
	
#line 708
		require {
#line 708
			
#line 708
		type device_t, event_device_t;
#line 708
	
#line 708
		} # end require
#line 708
	
#line 708

#line 708

#line 708
	
#line 708
	allow xserver_t device_t:dir { getattr search open };
#line 708
	allow xserver_t event_device_t:chr_file { getattr open read write append ioctl lock };
#line 708

#line 708

#line 708
	 	
#line 708
##### end dev_rw_input_dev(xserver_t) depth: 0
#line 708
 	
 	 	
#line 709
##### begin dev_rwx_zero(xserver_t) depth: 1
#line 709
 	
#line 709
	
#line 709
	
#line 709
		require {
#line 709
			
#line 709
		type zero_device_t;
#line 709
	
#line 709
		} # end require
#line 709
	
#line 709

#line 709

#line 709
	 	 	
#line 709
##### begin dev_rw_zero(xserver_t) depth: 2
#line 709
 	
#line 709
	
#line 709
	
#line 709
		require {
#line 709
			
#line 709
		type device_t, zero_device_t;
#line 709
	
#line 709
		} # end require
#line 709
	
#line 709

#line 709

#line 709
	
#line 709
	allow xserver_t device_t:dir { getattr search open };
#line 709
	allow xserver_t zero_device_t:chr_file { getattr open read write append ioctl lock };
#line 709

#line 709

#line 709
	 	
#line 709
##### end dev_rw_zero(xserver_t) depth: 1
#line 709
 	
#line 709
	allow xserver_t zero_device_t:chr_file execute;
#line 709

#line 709
	 	
#line 709
##### end dev_rwx_zero(xserver_t) depth: 0
#line 709
 	

 	 	
#line 711
##### begin domain_dontaudit_search_all_domains_state(xserver_t) depth: 1
#line 711
 	
#line 711
	
#line 711
	
#line 711
		require {
#line 711
			
#line 711
		attribute domain;
#line 711
	
#line 711
		} # end require
#line 711
	
#line 711

#line 711

#line 711
	dontaudit xserver_t domain:dir { getattr search open };
#line 711

#line 711
	 	
#line 711
##### end domain_dontaudit_search_all_domains_state(xserver_t) depth: 0
#line 711
 	

 	 	
#line 713
##### begin files_read_etc_files(xserver_t) depth: 1
#line 713
 	
#line 713
	
#line 713
	
#line 713
		require {
#line 713
			
#line 713
		type etc_t;
#line 713
	
#line 713
		} # end require
#line 713
	
#line 713

#line 713

#line 713
	allow xserver_t etc_t:dir { getattr search open read lock ioctl };
#line 713
	
#line 713
	allow xserver_t etc_t:dir { getattr search open };
#line 713
	allow xserver_t etc_t:file { getattr open read lock ioctl };
#line 713

#line 713
	
#line 713
	allow xserver_t etc_t:dir { getattr search open };
#line 713
	allow xserver_t etc_t:lnk_file { getattr read };
#line 713

#line 713

#line 713
	 	
#line 713
##### end files_read_etc_files(xserver_t) depth: 0
#line 713
 	
 	 	
#line 714
##### begin files_read_etc_runtime_files(xserver_t) depth: 1
#line 714
 	
#line 714
	
#line 714
	
#line 714
		require {
#line 714
			
#line 714
		type etc_t, etc_runtime_t;
#line 714
	
#line 714
		} # end require
#line 714
	
#line 714

#line 714

#line 714
	allow xserver_t etc_t:dir { getattr search open read lock ioctl };
#line 714
	
#line 714
	allow xserver_t etc_t:dir { getattr search open };
#line 714
	allow xserver_t etc_runtime_t:file { getattr open read lock ioctl };
#line 714

#line 714
	
#line 714
	allow xserver_t etc_t:dir { getattr search open };
#line 714
	allow xserver_t etc_runtime_t:lnk_file { getattr read };
#line 714

#line 714

#line 714
	 	
#line 714
##### end files_read_etc_runtime_files(xserver_t) depth: 0
#line 714
 	
 	 	
#line 715
##### begin files_read_usr_files(xserver_t) depth: 1
#line 715
 	
#line 715
	
#line 715
	
#line 715
		require {
#line 715
			
#line 715
		type usr_t;
#line 715
	
#line 715
		} # end require
#line 715
	
#line 715

#line 715

#line 715
	allow xserver_t usr_t:dir { getattr search open read lock ioctl };
#line 715
	
#line 715
	allow xserver_t usr_t:dir { getattr search open };
#line 715
	allow xserver_t usr_t:file { getattr open read lock ioctl };
#line 715

#line 715
	
#line 715
	allow xserver_t usr_t:dir { getattr search open };
#line 715
	allow xserver_t usr_t:lnk_file { getattr read };
#line 715

#line 715

#line 715
	 	
#line 715
##### end files_read_usr_files(xserver_t) depth: 0
#line 715
 	

# brought on by rhgb
 	 	
#line 718
##### begin files_search_mnt(xserver_t) depth: 1
#line 718
 	
#line 718
	
#line 718
	
#line 718
		require {
#line 718
			
#line 718
		type mnt_t;
#line 718
	
#line 718
		} # end require
#line 718
	
#line 718

#line 718

#line 718
	allow xserver_t mnt_t:dir { getattr search open };
#line 718

#line 718
	 	
#line 718
##### end files_search_mnt(xserver_t) depth: 0
#line 718
 	
# for nscd
 	 	
#line 720
##### begin files_dontaudit_search_pids(xserver_t) depth: 1
#line 720
 	
#line 720
	
#line 720
	
#line 720
		require {
#line 720
			
#line 720
		type var_run_t;
#line 720
	
#line 720
		} # end require
#line 720
	
#line 720

#line 720

#line 720
	dontaudit xserver_t var_run_t:lnk_file { getattr read };
#line 720
	dontaudit xserver_t var_run_t:dir { getattr search open };
#line 720

#line 720
	 	
#line 720
##### end files_dontaudit_search_pids(xserver_t) depth: 0
#line 720
 	

 	 	
#line 722
##### begin fs_getattr_xattr_fs(xserver_t) depth: 1
#line 722
 	
#line 722
	
#line 722
	
#line 722
		require {
#line 722
			
#line 722
		type fs_t;
#line 722
	
#line 722
		} # end require
#line 722
	
#line 722

#line 722

#line 722
	allow xserver_t fs_t:filesystem getattr;
#line 722

#line 722
	 	
#line 722
##### end fs_getattr_xattr_fs(xserver_t) depth: 0
#line 722
 	
 	 	
#line 723
##### begin fs_search_nfs(xserver_t) depth: 1
#line 723
 	
#line 723
	
#line 723
	
#line 723
		require {
#line 723
			
#line 723
		type nfs_t;
#line 723
	
#line 723
		} # end require
#line 723
	
#line 723

#line 723

#line 723
	allow xserver_t nfs_t:dir { getattr search open };
#line 723

#line 723
	 	
#line 723
##### end fs_search_nfs(xserver_t) depth: 0
#line 723
 	
 	 	
#line 724
##### begin fs_search_auto_mountpoints(xserver_t) depth: 1
#line 724
 	
#line 724
	
#line 724
	
#line 724
		require {
#line 724
			
#line 724
		type autofs_t;
#line 724
	
#line 724
		} # end require
#line 724
	
#line 724

#line 724

#line 724
	allow xserver_t autofs_t:dir { getattr search open };
#line 724

#line 724
	 	
#line 724
##### end fs_search_auto_mountpoints(xserver_t) depth: 0
#line 724
 	
 	 	
#line 725
##### begin fs_search_ramfs(xserver_t) depth: 1
#line 725
 	
#line 725
	
#line 725
	
#line 725
		require {
#line 725
			
#line 725
		type ramfs_t;
#line 725
	
#line 725
		} # end require
#line 725
	
#line 725

#line 725

#line 725
	allow xserver_t ramfs_t:dir { getattr search open };
#line 725

#line 725
	 	
#line 725
##### end fs_search_ramfs(xserver_t) depth: 0
#line 725
 	

 	 	
#line 727
##### begin mls_xwin_read_to_clearance(xserver_t) depth: 1
#line 727
 	
#line 727
	
#line 727
	
#line 727
		require {
#line 727
			
#line 727
		attribute mlsxwinreadtoclr;
#line 727
	
#line 727
		} # end require
#line 727
	
#line 727

#line 727

#line 727
	typeattribute xserver_t mlsxwinreadtoclr;
#line 727

#line 727
	 	
#line 727
##### end mls_xwin_read_to_clearance(xserver_t) depth: 0
#line 727
 	

 	 	
#line 729
##### begin selinux_validate_context(xserver_t) depth: 1
#line 729
 	
#line 729
	
#line 729
	
#line 729
		require {
#line 729
			
#line 729
		type security_t;
#line 729
	
#line 729
		} # end require
#line 729
	
#line 729

#line 729

#line 729
	 	 	
#line 729
##### begin dev_search_sysfs(xserver_t) depth: 2
#line 729
 	
#line 729
	
#line 729
	
#line 729
		require {
#line 729
			
#line 729
		type sysfs_t;
#line 729
	
#line 729
		} # end require
#line 729
	
#line 729

#line 729

#line 729
	
#line 729
	allow xserver_t sysfs_t:dir { getattr search open };
#line 729
	allow xserver_t sysfs_t:dir { getattr search open };
#line 729

#line 729

#line 729
	 	
#line 729
##### end dev_search_sysfs(xserver_t) depth: 1
#line 729
 	
#line 729
	allow xserver_t security_t:dir { getattr search open read lock ioctl };
#line 729
	allow xserver_t security_t:file { getattr open read write append ioctl lock };
#line 729
	allow xserver_t security_t:security check_context;
#line 729

#line 729
	 	
#line 729
##### end selinux_validate_context(xserver_t) depth: 0
#line 729
 	
 	 	
#line 730
##### begin selinux_compute_access_vector(xserver_t) depth: 1
#line 730
 	
#line 730
	
#line 730
	
#line 730
		require {
#line 730
			
#line 730
		type security_t;
#line 730
	
#line 730
		} # end require
#line 730
	
#line 730

#line 730

#line 730
	 	 	
#line 730
##### begin dev_search_sysfs(xserver_t) depth: 2
#line 730
 	
#line 730
	
#line 730
	
#line 730
		require {
#line 730
			
#line 730
		type sysfs_t;
#line 730
	
#line 730
		} # end require
#line 730
	
#line 730

#line 730

#line 730
	
#line 730
	allow xserver_t sysfs_t:dir { getattr search open };
#line 730
	allow xserver_t sysfs_t:dir { getattr search open };
#line 730

#line 730

#line 730
	 	
#line 730
##### end dev_search_sysfs(xserver_t) depth: 1
#line 730
 	
#line 730
	allow xserver_t security_t:dir { getattr search open read lock ioctl };
#line 730
	allow xserver_t security_t:file { getattr open read write append ioctl lock };
#line 730
	allow xserver_t security_t:security compute_av;
#line 730

#line 730
	 	
#line 730
##### end selinux_compute_access_vector(xserver_t) depth: 0
#line 730
 	
 	 	
#line 731
##### begin selinux_compute_create_context(xserver_t) depth: 1
#line 731
 	
#line 731
	
#line 731
	
#line 731
		require {
#line 731
			
#line 731
		type security_t;
#line 731
	
#line 731
		} # end require
#line 731
	
#line 731

#line 731

#line 731
	 	 	
#line 731
##### begin dev_search_sysfs(xserver_t) depth: 2
#line 731
 	
#line 731
	
#line 731
	
#line 731
		require {
#line 731
			
#line 731
		type sysfs_t;
#line 731
	
#line 731
		} # end require
#line 731
	
#line 731

#line 731

#line 731
	
#line 731
	allow xserver_t sysfs_t:dir { getattr search open };
#line 731
	allow xserver_t sysfs_t:dir { getattr search open };
#line 731

#line 731

#line 731
	 	
#line 731
##### end dev_search_sysfs(xserver_t) depth: 1
#line 731
 	
#line 731
	allow xserver_t security_t:dir { getattr search open read lock ioctl };
#line 731
	allow xserver_t security_t:file { getattr open read write append ioctl lock };
#line 731
	allow xserver_t security_t:security compute_create;
#line 731

#line 731
	 	
#line 731
##### end selinux_compute_create_context(xserver_t) depth: 0
#line 731
 	

 	 	
#line 733
##### begin auth_use_nsswitch(xserver_t) depth: 1
#line 733
 	
#line 733
    
#line 733
	
#line 733
		require {
#line 733
			
#line 733
        attribute nsswitch_domain;
#line 733
    
#line 733
		} # end require
#line 733
	
#line 733

#line 733

#line 733
	typeattribute xserver_t nsswitch_domain;
#line 733

#line 733
	 	
#line 733
##### end auth_use_nsswitch(xserver_t) depth: 0
#line 733
 	

 	 	
#line 735
##### begin init_getpgid(xserver_t) depth: 1
#line 735
 	
#line 735
	
#line 735
	
#line 735
		require {
#line 735
			
#line 735
		type init_t;
#line 735
	
#line 735
		} # end require
#line 735
	
#line 735

#line 735

#line 735
	allow xserver_t init_t:process getpgid;
#line 735

#line 735
	 	
#line 735
##### end init_getpgid(xserver_t) depth: 0
#line 735
 	

 	 	
#line 737
##### begin term_setattr_unallocated_ttys(xserver_t) depth: 1
#line 737
 	
#line 737
	
#line 737
	
#line 737
		require {
#line 737
			
#line 737
		type tty_device_t;
#line 737
	
#line 737
		} # end require
#line 737
	
#line 737

#line 737

#line 737
	 	 	
#line 737
##### begin dev_list_all_dev_nodes(xserver_t) depth: 2
#line 737
 	
#line 737
	
#line 737
	
#line 737
		require {
#line 737
			
#line 737
		type device_t;
#line 737
	
#line 737
		} # end require
#line 737
	
#line 737

#line 737

#line 737
	
#line 737
	allow xserver_t device_t:dir { getattr search open };
#line 737
	allow xserver_t device_t:dir { getattr search open read lock ioctl };
#line 737

#line 737
	
#line 737
	allow xserver_t device_t:dir { getattr search open };
#line 737
	allow xserver_t device_t:lnk_file { getattr read };
#line 737

#line 737

#line 737
	 	
#line 737
##### end dev_list_all_dev_nodes(xserver_t) depth: 1
#line 737
 	
#line 737
	allow xserver_t tty_device_t:chr_file setattr;
#line 737

#line 737
	 	
#line 737
##### end term_setattr_unallocated_ttys(xserver_t) depth: 0
#line 737
 	
 	 	
#line 738
##### begin term_use_unallocated_ttys(xserver_t) depth: 1
#line 738
 	
#line 738
	
#line 738
	
#line 738
		require {
#line 738
			
#line 738
		type tty_device_t;
#line 738
	
#line 738
		} # end require
#line 738
	
#line 738

#line 738

#line 738
	 	 	
#line 738
##### begin dev_list_all_dev_nodes(xserver_t) depth: 2
#line 738
 	
#line 738
	
#line 738
	
#line 738
		require {
#line 738
			
#line 738
		type device_t;
#line 738
	
#line 738
		} # end require
#line 738
	
#line 738

#line 738

#line 738
	
#line 738
	allow xserver_t device_t:dir { getattr search open };
#line 738
	allow xserver_t device_t:dir { getattr search open read lock ioctl };
#line 738

#line 738
	
#line 738
	allow xserver_t device_t:dir { getattr search open };
#line 738
	allow xserver_t device_t:lnk_file { getattr read };
#line 738

#line 738

#line 738
	 	
#line 738
##### end dev_list_all_dev_nodes(xserver_t) depth: 1
#line 738
 	
#line 738
	allow xserver_t tty_device_t:chr_file { getattr open read write append ioctl lock };
#line 738

#line 738
	 	
#line 738
##### end term_use_unallocated_ttys(xserver_t) depth: 0
#line 738
 	

 	 	
#line 740
##### begin getty_use_fds(xserver_t) depth: 1
#line 740
 	
#line 740
	
#line 740
	
#line 740
		require {
#line 740
			
#line 740
		type getty_t;
#line 740
	
#line 740
		} # end require
#line 740
	
#line 740

#line 740

#line 740
	allow xserver_t getty_t:fd use;
#line 740

#line 740
	 	
#line 740
##### end getty_use_fds(xserver_t) depth: 0
#line 740
 	

 	 	
#line 742
##### begin locallogin_use_fds(xserver_t) depth: 1
#line 742
 	
#line 742
	
#line 742
	
#line 742
		require {
#line 742
			
#line 742
		type local_login_t;
#line 742
	
#line 742
		} # end require
#line 742
	
#line 742

#line 742

#line 742
	allow xserver_t local_login_t:fd use;
#line 742

#line 742
	 	
#line 742
##### end locallogin_use_fds(xserver_t) depth: 0
#line 742
 	

 	 	
#line 744
##### begin logging_send_syslog_msg(xserver_t) depth: 1
#line 744
 	
#line 744
	
#line 744
	
#line 744
		require {
#line 744
			
#line 744
		type syslogd_t, syslogd_var_run_t, devlog_t;
#line 744
	
#line 744
		} # end require
#line 744
	
#line 744

#line 744

#line 744
	allow xserver_t devlog_t:sock_file { getattr write open append };
#line 744

#line 744
	# systemd journal socket is in /run/systemd/journal/dev-log
#line 744
	 	 	
#line 744
##### begin init_search_run(xserver_t) depth: 2
#line 744
 	
#line 744
	
#line 744
	
#line 744
		require {
#line 744
			
#line 744
		type init_var_run_t;
#line 744
	
#line 744
		} # end require
#line 744
	
#line 744

#line 744

#line 744
	 	 	
#line 744
##### begin files_search_pids(xserver_t) depth: 3
#line 744
 	
#line 744
	
#line 744
	
#line 744
		require {
#line 744
			
#line 744
		type var_t, var_run_t;
#line 744
	
#line 744
		} # end require
#line 744
	
#line 744

#line 744

#line 744
	allow xserver_t var_run_t:lnk_file { getattr read };
#line 744
	
#line 744
	allow xserver_t var_t:dir { getattr search open };
#line 744
	allow xserver_t var_run_t:dir { getattr search open };
#line 744

#line 744

#line 744
	 	
#line 744
##### end files_search_pids(xserver_t) depth: 2
#line 744
 	
#line 744
	allow xserver_t init_var_run_t:dir { getattr search open };
#line 744

#line 744
	 	
#line 744
##### end init_search_run(xserver_t) depth: 1
#line 744
 	
#line 744
	allow xserver_t syslogd_var_run_t:dir { getattr search open };
#line 744

#line 744
	# the type of socket depends on the syslog daemon
#line 744
	allow xserver_t syslogd_t:unix_dgram_socket sendto;
#line 744
	allow xserver_t syslogd_t:unix_stream_socket connectto;
#line 744
	allow xserver_t self:unix_dgram_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 744
	allow xserver_t self:unix_stream_socket { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } };
#line 744

#line 744
	# If syslog is down, the glibc syslog() function
#line 744
	# will write to the console.
#line 744
	 	 	
#line 744
##### begin term_write_console(xserver_t) depth: 2
#line 744
 	
#line 744
	
#line 744
	
#line 744
		require {
#line 744
			
#line 744
		type console_device_t;
#line 744
	
#line 744
		} # end require
#line 744
	
#line 744

#line 744

#line 744
	 	 	
#line 744
##### begin dev_list_all_dev_nodes(xserver_t) depth: 3
#line 744
 	
#line 744
	
#line 744
	
#line 744
		require {
#line 744
			
#line 744
		type device_t;
#line 744
	
#line 744
		} # end require
#line 744
	
#line 744

#line 744

#line 744
	
#line 744
	allow xserver_t device_t:dir { getattr search open };
#line 744
	allow xserver_t device_t:dir { getattr search open read lock ioctl };
#line 744

#line 744
	
#line 744
	allow xserver_t device_t:dir { getattr search open };
#line 744
	allow xserver_t device_t:lnk_file { getattr read };
#line 744

#line 744

#line 744
	 	
#line 744
##### end dev_list_all_dev_nodes(xserver_t) depth: 2
#line 744
 	
#line 744
	allow xserver_t console_device_t:chr_file { getattr open write append lock ioctl };
#line 744

#line 744
	 	
#line 744
##### end term_write_console(xserver_t) depth: 1
#line 744
 	
#line 744
	 	 	
#line 744
##### begin term_dontaudit_read_console(xserver_t) depth: 2
#line 744
 	
#line 744
	
#line 744
	
#line 744
		require {
#line 744
			
#line 744
		type console_device_t;
#line 744
	
#line 744
		} # end require
#line 744
	
#line 744

#line 744

#line 744
	dontaudit xserver_t console_device_t:chr_file { getattr open read lock ioctl };
#line 744

#line 744
	 	
#line 744
##### end term_dontaudit_read_console(xserver_t) depth: 1
#line 744
 	
#line 744

#line 744
	# because systemd is now using /run/systemd/journal/dev-log
#line 744
	 	 	
#line 744
##### begin init_search_pid_dirs(xserver_t) depth: 2
#line 744
 	
#line 744
    
#line 744
	
#line 744
		require {
#line 744
			
#line 744
        type init_var_run_t;
#line 744
    
#line 744
		} # end require
#line 744
	
#line 744

#line 744

#line 744
    allow xserver_t init_var_run_t:dir { getattr search open };
#line 744

#line 744
	 	
#line 744
##### end init_search_pid_dirs(xserver_t) depth: 1
#line 744
 	
#line 744

#line 744
	 	
#line 744
##### end logging_send_syslog_msg(xserver_t) depth: 0
#line 744
 	
 	 	
#line 745
##### begin logging_send_audit_msgs(xserver_t) depth: 1
#line 745
 	
#line 745
	allow xserver_t self:capability audit_write;
#line 745
	allow xserver_t self:netlink_audit_socket { { { create { ioctl read getattr write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_relay };
#line 745

#line 745
	 	
#line 745
##### end logging_send_audit_msgs(xserver_t) depth: 0
#line 745
 	

 	 	
#line 747
##### begin miscfiles_read_localization(xserver_t) depth: 1
#line 747
 	
#line 747
	
#line 747
	
#line 747
		require {
#line 747
			
#line 747
		type locale_t;
#line 747
	
#line 747
		} # end require
#line 747
	
#line 747

#line 747

#line 747
	 	 	
#line 747
##### begin files_read_etc_symlinks(xserver_t) depth: 2
#line 747
 	
#line 747
	
#line 747
	
#line 747
		require {
#line 747
			
#line 747
		type etc_t;
#line 747
	
#line 747
		} # end require
#line 747
	
#line 747

#line 747

#line 747
	
#line 747
	allow xserver_t etc_t:dir { getattr search open };
#line 747
	allow xserver_t etc_t:lnk_file { getattr read };
#line 747

#line 747

#line 747
	 	
#line 747
##### end files_read_etc_symlinks(xserver_t) depth: 1
#line 747
 	
#line 747
	 	 	
#line 747
##### begin files_search_usr(xserver_t) depth: 2
#line 747
 	
#line 747
	
#line 747
	
#line 747
		require {
#line 747
			
#line 747
		type usr_t;
#line 747
	
#line 747
		} # end require
#line 747
	
#line 747

#line 747

#line 747
	allow xserver_t usr_t:dir { getattr search open };
#line 747

#line 747
	 	
#line 747
##### end files_search_usr(xserver_t) depth: 1
#line 747
 	
#line 747
	allow xserver_t locale_t:dir { getattr search open read lock ioctl };
#line 747
	
#line 747
	allow xserver_t locale_t:dir { getattr search open };
#line 747
	allow xserver_t locale_t:file { getattr open read lock ioctl };
#line 747

#line 747
	
#line 747
	allow xserver_t locale_t:dir { getattr search open };
#line 747
	allow xserver_t locale_t:lnk_file { getattr read };
#line 747

#line 747

#line 747
	 	
#line 747
##### end miscfiles_read_localization(xserver_t) depth: 0
#line 747
 	
 	 	
#line 748
##### begin miscfiles_read_fonts(xserver_t) depth: 1
#line 748
 	
#line 748
	
#line 748
	
#line 748
		require {
#line 748
			
#line 748
		type fonts_t, fonts_cache_t;
#line 748
	
#line 748
		} # end require
#line 748
	
#line 748

#line 748

#line 748
	# cjp: fonts can be in either of these dirs
#line 748
	 	 	
#line 748
##### begin files_search_usr(xserver_t) depth: 2
#line 748
 	
#line 748
	
#line 748
	
#line 748
		require {
#line 748
			
#line 748
		type usr_t;
#line 748
	
#line 748
		} # end require
#line 748
	
#line 748

#line 748

#line 748
	allow xserver_t usr_t:dir { getattr search open };
#line 748

#line 748
	 	
#line 748
##### end files_search_usr(xserver_t) depth: 1
#line 748
 	
#line 748
	 	 	
#line 748
##### begin libs_search_lib(xserver_t) depth: 2
#line 748
 	
#line 748
	
#line 748
	
#line 748
		require {
#line 748
			
#line 748
		type lib_t;
#line 748
	
#line 748
		} # end require
#line 748
	
#line 748

#line 748

#line 748
	allow xserver_t lib_t:dir { getattr search open };
#line 748

#line 748
	 	
#line 748
##### end libs_search_lib(xserver_t) depth: 1
#line 748
 	
#line 748

#line 748
	allow xserver_t fonts_t:dir { getattr search open read lock ioctl };
#line 748
	
#line 748
	allow xserver_t fonts_t:dir { getattr search open };
#line 748
	allow xserver_t fonts_t:file { getattr open read lock ioctl };
#line 748

#line 748
	
#line 748
	allow xserver_t fonts_t:dir { getattr search open };
#line 748
	allow xserver_t fonts_t:lnk_file { getattr read };
#line 748

#line 748

#line 748
	allow xserver_t fonts_cache_t:dir { getattr search open read lock ioctl };
#line 748
	
#line 748
	allow xserver_t fonts_cache_t:dir { getattr search open };
#line 748
	allow xserver_t fonts_cache_t:file { getattr open read lock ioctl };
#line 748

#line 748
	
#line 748
	allow xserver_t fonts_cache_t:dir { getattr search open };
#line 748
	allow xserver_t fonts_cache_t:lnk_file { getattr read };
#line 748

#line 748

#line 748
	 	
#line 748
##### end miscfiles_read_fonts(xserver_t) depth: 0
#line 748
 	

 	 	
#line 750
##### begin modutils_domtrans_insmod(xserver_t) depth: 1
#line 750
 	
#line 750
	
#line 750
	
#line 750
		require {
#line 750
			
#line 750
		type insmod_t, insmod_exec_t;
#line 750
	
#line 750
		} # end require
#line 750
	
#line 750

#line 750

#line 750
	 	 	
#line 750
##### begin corecmd_search_bin(xserver_t) depth: 2
#line 750
 	
#line 750
	
#line 750
	
#line 750
		require {
#line 750
			
#line 750
		type bin_t;
#line 750
	
#line 750
		} # end require
#line 750
	
#line 750

#line 750

#line 750
	
#line 750
	allow xserver_t bin_t:dir { getattr search open };
#line 750
	allow xserver_t bin_t:dir { getattr search open };
#line 750

#line 750

#line 750
	 	
#line 750
##### end corecmd_search_bin(xserver_t) depth: 1
#line 750
 	
#line 750
	
#line 750
	
#line 750
	
#line 750
	allow xserver_t insmod_exec_t:file { getattr open read execute };
#line 750
	allow xserver_t insmod_t:process transition;
#line 750
	dontaudit xserver_t insmod_t:process { noatsecure siginh rlimitinh };
#line 750

#line 750
	type_transition xserver_t insmod_exec_t:process insmod_t;
#line 750

#line 750

#line 750
	allow insmod_t xserver_t:fd use;
#line 750
	allow insmod_t xserver_t:fifo_file { open { getattr read write append ioctl lock } };
#line 750
	allow insmod_t xserver_t:process sigchld;
#line 750

#line 750

#line 750
	 	
#line 750
##### end modutils_domtrans_insmod(xserver_t) depth: 0
#line 750
 	

# read x_contexts
 	 	
#line 753
##### begin seutil_read_default_contexts(xserver_t) depth: 1
#line 753
 	
#line 753
	
#line 753
	
#line 753
		require {
#line 753
			
#line 753
		type selinux_config_t, default_context_t;
#line 753
	
#line 753
		} # end require
#line 753
	
#line 753

#line 753

#line 753
	 	 	
#line 753
##### begin files_search_etc(xserver_t) depth: 2
#line 753
 	
#line 753
	
#line 753
	
#line 753
		require {
#line 753
			
#line 753
		type etc_t;
#line 753
	
#line 753
		} # end require
#line 753
	
#line 753

#line 753

#line 753
	allow xserver_t etc_t:dir { getattr search open };
#line 753

#line 753
	 	
#line 753
##### end files_search_etc(xserver_t) depth: 1
#line 753
 	
#line 753
	allow xserver_t selinux_config_t:dir { getattr search open };
#line 753
	allow xserver_t default_context_t:dir { getattr search open read lock ioctl };
#line 753
	
#line 753
	allow xserver_t default_context_t:dir { getattr search open };
#line 753
	allow xserver_t default_context_t:file { getattr open read lock ioctl };
#line 753

#line 753

#line 753
	 	
#line 753
##### end seutil_read_default_contexts(xserver_t) depth: 0
#line 753
 	

 	 	
#line 755
##### begin userdom_search_user_home_dirs(xserver_t) depth: 1
#line 755
 	
#line 755
	
#line 755
	
#line 755
		require {
#line 755
			
#line 755
		type user_home_dir_t;
#line 755
	
#line 755
		} # end require
#line 755
	
#line 755

#line 755

#line 755
	allow xserver_t user_home_dir_t:dir { getattr search open };
#line 755
	 	 	
#line 755
##### begin files_search_home(xserver_t) depth: 2
#line 755
 	
#line 755
	
#line 755
	
#line 755
		require {
#line 755
			
#line 755
		type home_root_t;
#line 755
	
#line 755
		} # end require
#line 755
	
#line 755

#line 755

#line 755
	allow xserver_t home_root_t:dir { getattr search open };
#line 755
	allow xserver_t home_root_t:lnk_file { getattr read };
#line 755

#line 755
	 	
#line 755
##### end files_search_home(xserver_t) depth: 1
#line 755
 	
#line 755

#line 755
	 	
#line 755
##### end userdom_search_user_home_dirs(xserver_t) depth: 0
#line 755
 	
 	 	
#line 756
##### begin userdom_use_user_ttys(xserver_t) depth: 1
#line 756
 	
#line 756
	
#line 756
	
#line 756
		require {
#line 756
			
#line 756
		type user_tty_device_t;
#line 756
	
#line 756
		} # end require
#line 756
	
#line 756

#line 756

#line 756
	allow xserver_t user_tty_device_t:chr_file { { getattr read write append ioctl } open };
#line 756

#line 756
	 	
#line 756
##### end userdom_use_user_ttys(xserver_t) depth: 0
#line 756
 	
 	 	
#line 757
##### begin userdom_setattr_user_ttys(xserver_t) depth: 1
#line 757
 	
#line 757
	
#line 757
	
#line 757
		require {
#line 757
			
#line 757
		type user_tty_device_t;
#line 757
	
#line 757
		} # end require
#line 757
	
#line 757

#line 757

#line 757
	allow xserver_t user_tty_device_t:chr_file { setattr };
#line 757

#line 757
	 	
#line 757
##### end userdom_setattr_user_ttys(xserver_t) depth: 0
#line 757
 	
 	 	
#line 758
##### begin userdom_read_user_tmp_files(xserver_t) depth: 1
#line 758
 	
#line 758
	
#line 758
	
#line 758
		require {
#line 758
			
#line 758
		type user_tmp_t;
#line 758
	
#line 758
		} # end require
#line 758
	
#line 758

#line 758

#line 758
	
#line 758
	allow xserver_t user_tmp_t:dir { getattr search open };
#line 758
	allow xserver_t user_tmp_t:file { getattr open read lock ioctl };
#line 758

#line 758
	allow xserver_t user_tmp_t:dir { getattr search open read lock ioctl };
#line 758
	 	 	
#line 758
##### begin files_search_tmp(xserver_t) depth: 2
#line 758
 	
#line 758
	
#line 758
	
#line 758
		require {
#line 758
			
#line 758
		type tmp_t;
#line 758
	
#line 758
		} # end require
#line 758
	
#line 758

#line 758

#line 758
	allow xserver_t tmp_t:dir { getattr search open };
#line 758

#line 758
	 	
#line 758
##### end files_search_tmp(xserver_t) depth: 1
#line 758
 	
#line 758
	 	 	
#line 758
##### begin userdom_search_user_runtime(xserver_t) depth: 2
#line 758
 	
#line 758
	
#line 758
	
#line 758
		require {
#line 758
			
#line 758
		type user_runtime_t;
#line 758
	
#line 758
		} # end require
#line 758
	
#line 758

#line 758

#line 758
	allow xserver_t user_runtime_t:dir { getattr search open };
#line 758
	 	 	
#line 758
##### begin userdom_search_user_runtime_root(xserver_t) depth: 3
#line 758
 	
#line 758
	
#line 758
	
#line 758
		require {
#line 758
			
#line 758
		type user_runtime_root_t;
#line 758
	
#line 758
		} # end require
#line 758
	
#line 758

#line 758

#line 758
	allow xserver_t user_runtime_root_t:dir { getattr search open };
#line 758
	 	 	
#line 758
##### begin files_search_pids(xserver_t) depth: 4
#line 758
 	
#line 758
	
#line 758
	
#line 758
		require {
#line 758
			
#line 758
		type var_t, var_run_t;
#line 758
	
#line 758
		} # end require
#line 758
	
#line 758

#line 758

#line 758
	allow xserver_t var_run_t:lnk_file { getattr read };
#line 758
	
#line 758
	allow xserver_t var_t:dir { getattr search open };
#line 758
	allow xserver_t var_run_t:dir { getattr search open };
#line 758

#line 758

#line 758
	 	
#line 758
##### end files_search_pids(xserver_t) depth: 3
#line 758
 	
#line 758

#line 758
	 	
#line 758
##### end userdom_search_user_runtime_root(xserver_t) depth: 2
#line 758
 	
#line 758

#line 758
	 	
#line 758
##### end userdom_search_user_runtime(xserver_t) depth: 1
#line 758
 	
#line 758

#line 758
	 	
#line 758
##### end userdom_read_user_tmp_files(xserver_t) depth: 0
#line 758
 	
 	 	
#line 759
##### begin userdom_rw_user_tmpfs_files(xserver_t) depth: 1
#line 759
 	
#line 759
	
#line 759
	
#line 759
		require {
#line 759
			
#line 759
		type user_tmpfs_t;
#line 759
	
#line 759
		} # end require
#line 759
	
#line 759

#line 759

#line 759
	
#line 759
	allow xserver_t user_tmpfs_t:dir { getattr search open };
#line 759
	allow xserver_t user_tmpfs_t:file { getattr open read write append ioctl lock };
#line 759

#line 759
	
#line 759
	allow xserver_t user_tmpfs_t:dir { getattr search open };
#line 759
	allow xserver_t user_tmpfs_t:lnk_file { getattr read };
#line 759

#line 759
	allow xserver_t user_tmpfs_t:dir { getattr search open read lock ioctl };
#line 759
	 	 	
#line 759
##### begin fs_search_tmpfs(xserver_t) depth: 2
#line 759
 	
#line 759
	
#line 759
	
#line 759
		require {
#line 759
			
#line 759
		type tmpfs_t;
#line 759
	
#line 759
		} # end require
#line 759
	
#line 759

#line 759

#line 759
	allow xserver_t tmpfs_t:dir { getattr search open };
#line 759

#line 759
	 	
#line 759
##### end fs_search_tmpfs(xserver_t) depth: 1
#line 759
 	
#line 759

#line 759
	 	
#line 759
##### end userdom_rw_user_tmpfs_files(xserver_t) depth: 0
#line 759
 	

 	 	
#line 761
##### begin xserver_use_user_fonts(xserver_t) depth: 1
#line 761
 	
#line 761
	
#line 761
	
#line 761
		require {
#line 761
			
#line 761
		type user_fonts_t, user_fonts_cache_t, user_fonts_config_t;
#line 761
	
#line 761
		} # end require
#line 761
	
#line 761

#line 761

#line 761
	# Read per user fonts
#line 761
	allow xserver_t user_fonts_t:dir { getattr search open read lock ioctl };
#line 761
	allow xserver_t user_fonts_t:file { getattr open read lock ioctl };
#line 761

#line 761
	# Manipulate the global font cache
#line 761
	
#line 761
	allow xserver_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 761
	allow xserver_t user_fonts_cache_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 761

#line 761
	
#line 761
	allow xserver_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 761
	allow xserver_t user_fonts_cache_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 761

#line 761

#line 761
	# Read per user font config
#line 761
	allow xserver_t user_fonts_config_t:dir { getattr search open read lock ioctl };
#line 761
	allow xserver_t user_fonts_config_t:file { getattr open read lock ioctl };
#line 761

#line 761
	 	 	
#line 761
##### begin userdom_search_user_home_dirs(xserver_t) depth: 2
#line 761
 	
#line 761
	
#line 761
	
#line 761
		require {
#line 761
			
#line 761
		type user_home_dir_t;
#line 761
	
#line 761
		} # end require
#line 761
	
#line 761

#line 761

#line 761
	allow xserver_t user_home_dir_t:dir { getattr search open };
#line 761
	 	 	
#line 761
##### begin files_search_home(xserver_t) depth: 3
#line 761
 	
#line 761
	
#line 761
	
#line 761
		require {
#line 761
			
#line 761
		type home_root_t;
#line 761
	
#line 761
		} # end require
#line 761
	
#line 761

#line 761

#line 761
	allow xserver_t home_root_t:dir { getattr search open };
#line 761
	allow xserver_t home_root_t:lnk_file { getattr read };
#line 761

#line 761
	 	
#line 761
##### end files_search_home(xserver_t) depth: 2
#line 761
 	
#line 761

#line 761
	 	
#line 761
##### end userdom_search_user_home_dirs(xserver_t) depth: 1
#line 761
 	
#line 761

#line 761
	 	
#line 761
##### end xserver_use_user_fonts(xserver_t) depth: 0
#line 761
 	

#line 766



#line 768
	
#line 768
	
#line 768
		require {
#line 768
			
#line 768
		
#line 768
bool xserver_object_manager;
#line 768

#line 768
  
#line 768
	
#line 768
		} # end require
#line 768
	
#line 768

#line 768
	if (!xserver_object_manager) {
#line 768
		
#line 768
	# should be xserver_unconfined(xserver_t),
#line 768
	# but typeattribute doesnt work in conditionals
#line 768

#line 768
	allow xserver_t xserver_t:x_server *;
#line 768
	allow xserver_t { x_domain root_xdrawable_t }:x_drawable *;
#line 768
	allow xserver_t xserver_t:x_screen *;
#line 768
	allow xserver_t x_domain:x_gc *;
#line 768
	allow xserver_t { x_domain root_xcolormap_t }:x_colormap *;
#line 768
	allow xserver_t xproperty_type:x_property *;
#line 768
	allow xserver_t xselection_type:x_selection *;
#line 768
	allow xserver_t x_domain:x_cursor *;
#line 768
	allow xserver_t x_domain:x_client *;
#line 768
	allow xserver_t { x_domain xserver_t }:x_device *;
#line 768
	allow xserver_t { x_domain xserver_t }:x_pointer *;
#line 768
	allow xserver_t { x_domain xserver_t }:x_keyboard *;
#line 768
	allow xserver_t xextension_type:x_extension *;
#line 768
	allow xserver_t { x_domain xserver_t }:x_resource *;
#line 768
	allow xserver_t xevent_type:{ x_event x_synthetic_event } *;
#line 768

#line 768
	}
#line 787



#line 789
	optional {
#line 789
		
#line 789
	 	 	
#line 789
##### begin apm_stream_connect(xserver_t) depth: 1
#line 789
 	
#line 789
	
#line 789
	
#line 789
		require {
#line 789
			
#line 789
		type apmd_t, apmd_var_run_t;
#line 789
	
#line 789
		} # end require
#line 789
	
#line 789

#line 789

#line 789
	 	 	
#line 789
##### begin files_search_pids(xserver_t) depth: 2
#line 789
 	
#line 789
	
#line 789
	
#line 789
		require {
#line 789
			
#line 789
		type var_t, var_run_t;
#line 789
	
#line 789
		} # end require
#line 789
	
#line 789

#line 789

#line 789
	allow xserver_t var_run_t:lnk_file { getattr read };
#line 789
	
#line 789
	allow xserver_t var_t:dir { getattr search open };
#line 789
	allow xserver_t var_run_t:dir { getattr search open };
#line 789

#line 789

#line 789
	 	
#line 789
##### end files_search_pids(xserver_t) depth: 1
#line 789
 	
#line 789
	
#line 789
	allow xserver_t apmd_var_run_t:dir { getattr search open };
#line 789
	allow xserver_t apmd_var_run_t:sock_file { getattr write open append };
#line 789
	allow xserver_t apmd_t:unix_stream_socket connectto;
#line 789

#line 789

#line 789
	 	
#line 789
##### end apm_stream_connect(xserver_t) depth: 0
#line 789
 	
#line 789

#line 789
	} # end optional
#line 791



#line 793
	optional {
#line 793
		
#line 793
	 	 	
#line 793
##### begin auth_search_pam_console_data(xserver_t) depth: 1
#line 793
 	
#line 793
	
#line 793
	
#line 793
		require {
#line 793
			
#line 793
		type pam_var_console_t;
#line 793
	
#line 793
		} # end require
#line 793
	
#line 793

#line 793

#line 793
	 	 	
#line 793
##### begin files_search_pids(xserver_t) depth: 2
#line 793
 	
#line 793
	
#line 793
	
#line 793
		require {
#line 793
			
#line 793
		type var_t, var_run_t;
#line 793
	
#line 793
		} # end require
#line 793
	
#line 793

#line 793

#line 793
	allow xserver_t var_run_t:lnk_file { getattr read };
#line 793
	
#line 793
	allow xserver_t var_t:dir { getattr search open };
#line 793
	allow xserver_t var_run_t:dir { getattr search open };
#line 793

#line 793

#line 793
	 	
#line 793
##### end files_search_pids(xserver_t) depth: 1
#line 793
 	
#line 793
	allow xserver_t pam_var_console_t:dir { getattr search open };
#line 793

#line 793
	 	
#line 793
##### end auth_search_pam_console_data(xserver_t) depth: 0
#line 793
 	
#line 793

#line 793
	} # end optional
#line 795



#line 797
	optional {
#line 797
		
#line 797
	 	 	
#line 797
##### begin rhgb_getpgid(xserver_t) depth: 1
#line 797
 	
#line 797
	
#line 797
	
#line 797
		require {
#line 797
			
#line 797
		type rhgb_t;
#line 797
	
#line 797
		} # end require
#line 797
	
#line 797

#line 797

#line 797
	allow xserver_t rhgb_t:process getpgid;
#line 797

#line 797
	 	
#line 797
##### end rhgb_getpgid(xserver_t) depth: 0
#line 797
 	
#line 797
	 	 	
#line 797
##### begin rhgb_signal(xserver_t) depth: 1
#line 797
 	
#line 797
	
#line 797
	
#line 797
		require {
#line 797
			
#line 797
		type rhgb_t;
#line 797
	
#line 797
		} # end require
#line 797
	
#line 797

#line 797

#line 797
	allow xserver_t rhgb_t:process signal;
#line 797

#line 797
	 	
#line 797
##### end rhgb_signal(xserver_t) depth: 0
#line 797
 	
#line 797

#line 797
	} # end optional
#line 800



#line 802
	optional {
#line 802
		
#line 802
	 	 	
#line 802
##### begin udev_read_db(xserver_t) depth: 1
#line 802
 	
#line 802
	
#line 802
	
#line 802
		require {
#line 802
			
#line 802
		type udev_tbl_t;
#line 802
	
#line 802
		} # end require
#line 802
	
#line 802

#line 802

#line 802
	allow xserver_t udev_tbl_t:dir { getattr search open read lock ioctl };
#line 802

#line 802
	
#line 802
	allow xserver_t udev_tbl_t:dir { getattr search open };
#line 802
	allow xserver_t udev_tbl_t:file { getattr open read lock ioctl };
#line 802

#line 802
	
#line 802
	allow xserver_t udev_tbl_t:dir { getattr search open };
#line 802
	allow xserver_t udev_tbl_t:lnk_file { getattr read };
#line 802

#line 802

#line 802
	 	 	
#line 802
##### begin dev_list_all_dev_nodes(xserver_t) depth: 2
#line 802
 	
#line 802
	
#line 802
	
#line 802
		require {
#line 802
			
#line 802
		type device_t;
#line 802
	
#line 802
		} # end require
#line 802
	
#line 802

#line 802

#line 802
	
#line 802
	allow xserver_t device_t:dir { getattr search open };
#line 802
	allow xserver_t device_t:dir { getattr search open read lock ioctl };
#line 802

#line 802
	
#line 802
	allow xserver_t device_t:dir { getattr search open };
#line 802
	allow xserver_t device_t:lnk_file { getattr read };
#line 802

#line 802

#line 802
	 	
#line 802
##### end dev_list_all_dev_nodes(xserver_t) depth: 1
#line 802
 	
#line 802

#line 802
	 	 	
#line 802
##### begin files_search_etc(xserver_t) depth: 2
#line 802
 	
#line 802
	
#line 802
	
#line 802
		require {
#line 802
			
#line 802
		type etc_t;
#line 802
	
#line 802
		} # end require
#line 802
	
#line 802

#line 802

#line 802
	allow xserver_t etc_t:dir { getattr search open };
#line 802

#line 802
	 	
#line 802
##### end files_search_etc(xserver_t) depth: 1
#line 802
 	
#line 802

#line 802
	 	 	
#line 802
##### begin udev_search_pids(xserver_t) depth: 2
#line 802
 	
#line 802
	
#line 802
	
#line 802
		require {
#line 802
			
#line 802
		type udev_var_run_t;
#line 802
	
#line 802
		} # end require
#line 802
	
#line 802

#line 802

#line 802
	 	 	
#line 802
##### begin files_search_pids(xserver_t) depth: 3
#line 802
 	
#line 802
	
#line 802
	
#line 802
		require {
#line 802
			
#line 802
		type var_t, var_run_t;
#line 802
	
#line 802
		} # end require
#line 802
	
#line 802

#line 802

#line 802
	allow xserver_t var_run_t:lnk_file { getattr read };
#line 802
	
#line 802
	allow xserver_t var_t:dir { getattr search open };
#line 802
	allow xserver_t var_run_t:dir { getattr search open };
#line 802

#line 802

#line 802
	 	
#line 802
##### end files_search_pids(xserver_t) depth: 2
#line 802
 	
#line 802
	
#line 802
	allow xserver_t udev_var_run_t:dir { getattr search open };
#line 802
	allow xserver_t udev_var_run_t:dir { getattr search open };
#line 802

#line 802

#line 802
	 	
#line 802
##### end udev_search_pids(xserver_t) depth: 1
#line 802
 	
#line 802

#line 802
	 	
#line 802
##### end udev_read_db(xserver_t) depth: 0
#line 802
 	
#line 802

#line 802
	} # end optional
#line 804



#line 806
	optional {
#line 806
		
#line 806
	 	 	
#line 806
##### begin unconfined_domain_noaudit(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type unconfined_t;
#line 806
		class dbus { acquire_svc send_msg };
#line 806
		class nscd { getpwd getgrp gethost getstat admin shmempwd shmemgrp shmemhost getserv shmemserv };
#line 806
		class passwd { passwd chfn chsh rootok crontab };
#line 806
		class service { start stop status reload enable disable };
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	# Use most Linux capabilities
#line 806
	allow xserver_t self:capability ~sys_module;
#line 806
	allow xserver_t self:capability2 { syslog wake_alarm };
#line 806
	allow xserver_t self:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 806

#line 806
	# Transition to myself, to make get_ordered_context_list happy.
#line 806
	allow xserver_t self:process transition;
#line 806

#line 806
	# Write access is for setting attributes under /proc/self/attr.
#line 806
	allow xserver_t self:file { getattr open read write append ioctl lock };
#line 806

#line 806
	# Userland object managers
#line 806
	allow xserver_t self:nscd *;
#line 806
	allow xserver_t self:dbus *;
#line 806
	allow xserver_t self:passwd *;
#line 806
	allow xserver_t self:association *;
#line 806

#line 806
	 	 	
#line 806
##### begin kernel_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute kern_unconfined;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t kern_unconfined;
#line 806
	 	 	
#line 806
##### begin kernel_load_module(xserver_t) depth: 3
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute can_load_kernmodule;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t can_load_kernmodule;
#line 806

#line 806
	 	
#line 806
##### end kernel_load_module(xserver_t) depth: 2
#line 806
 	
#line 806

#line 806
	 	
#line 806
##### end kernel_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin corenet_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute corenet_unconfined_type;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t corenet_unconfined_type;
#line 806

#line 806
	 	
#line 806
##### end corenet_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin dev_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute devices_unconfined_type;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t devices_unconfined_type;
#line 806

#line 806
	 	
#line 806
##### end dev_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin domain_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute set_curr_context;
#line 806
		attribute can_change_object_identity;
#line 806
		attribute unconfined_domain_type;
#line 806
		attribute process_uncond_exempt;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t unconfined_domain_type;
#line 806

#line 806
	# pass constraints
#line 806
	typeattribute xserver_t can_change_object_identity;
#line 806
	typeattribute xserver_t set_curr_context;
#line 806
	typeattribute xserver_t process_uncond_exempt;
#line 806

#line 806
	 	
#line 806
##### end domain_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin domain_dontaudit_read_all_domains_state(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute domain;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	dontaudit xserver_t domain:dir { getattr search open read lock ioctl };
#line 806
	dontaudit xserver_t domain:lnk_file { getattr read };
#line 806
	dontaudit xserver_t domain:file { getattr open read lock ioctl };
#line 806

#line 806
	# cjp: these should be removed:
#line 806
	dontaudit xserver_t domain:sock_file { getattr open read };
#line 806
	dontaudit xserver_t domain:fifo_file { getattr open read lock ioctl };
#line 806

#line 806
	 	
#line 806
##### end domain_dontaudit_read_all_domains_state(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin domain_dontaudit_ptrace_all_domains(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute domain;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	dontaudit xserver_t domain:process ptrace;
#line 806

#line 806
	 	
#line 806
##### end domain_dontaudit_ptrace_all_domains(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin files_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute files_unconfined_type;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t files_unconfined_type;
#line 806

#line 806
	 	
#line 806
##### end files_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin fs_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute filesystem_unconfined_type;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t filesystem_unconfined_type;
#line 806

#line 806
	 	
#line 806
##### end fs_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin selinux_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute selinux_unconfined_type;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t selinux_unconfined_type;
#line 806

#line 806
	 	
#line 806
##### end selinux_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin files_get_etc_unit_status(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type etc_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	allow xserver_t etc_t:service status;
#line 806

#line 806
	 	
#line 806
##### end files_get_etc_unit_status(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin files_etc_unit_start(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type etc_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	allow xserver_t etc_t:service start;
#line 806

#line 806
	 	
#line 806
##### end files_etc_unit_start(xserver_t) depth: 1
#line 806
 	
#line 806
	 	 	
#line 806
##### begin files_etc_unit_stop(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type etc_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	allow xserver_t etc_t:service stop;
#line 806

#line 806
	 	
#line 806
##### end files_etc_unit_stop(xserver_t) depth: 1
#line 806
 	
#line 806

#line 806
	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		
#line 806
bool allow_execheap;
#line 806

#line 806
  
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806
	if (allow_execheap) {
#line 806
		
#line 806
		# Allow making the stack executable via mprotect.
#line 806
		allow xserver_t self:process execheap;
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		
#line 806
bool allow_execmem;
#line 806

#line 806
  
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806
	if (allow_execmem) {
#line 806
		
#line 806
		# Allow making anonymous memory executable, e.g. 
#line 806
		# for runtime-code generation or executable stack.
#line 806
		allow xserver_t self:process execmem;
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		
#line 806
bool allow_execstack;
#line 806

#line 806
  
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806
	if (allow_execstack) {
#line 806
		
#line 806
		# Allow making the stack executable via mprotect;
#line 806
		# execstack implies execmem;
#line 806
		allow xserver_t self:process { execstack execmem };
#line 806
#		auditallow xserver_t self:process execstack;
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	optional {
#line 806
		
#line 806
		 	 	
#line 806
##### begin auth_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute can_read_shadow_passwords;
#line 806
		attribute can_write_shadow_passwords;
#line 806
		attribute can_relabelto_shadow_passwords;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t can_read_shadow_passwords;
#line 806
	typeattribute xserver_t can_write_shadow_passwords;
#line 806
	typeattribute xserver_t can_relabelto_shadow_passwords;
#line 806

#line 806
	 	
#line 806
##### end auth_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	optional {
#line 806
		
#line 806
		 	 	
#line 806
##### begin dbus_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute dbusd_unconfined;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t dbusd_unconfined;
#line 806

#line 806
	 	
#line 806
##### end dbus_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	optional {
#line 806
		
#line 806
		 	 	
#line 806
##### begin ipsec_setcontext_default_spd(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type ipsec_spd_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	allow xserver_t ipsec_spd_t:association setcontext;
#line 806

#line 806
	 	
#line 806
##### end ipsec_setcontext_default_spd(xserver_t) depth: 1
#line 806
 	
#line 806
		 	 	
#line 806
##### begin ipsec_match_default_spd(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type ipsec_spd_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	allow xserver_t ipsec_spd_t:association polmatch;
#line 806
	allow xserver_t self:association sendto;
#line 806

#line 806
	 	
#line 806
##### end ipsec_match_default_spd(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	optional {
#line 806
		
#line 806
		 	 	
#line 806
##### begin nscd_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type nscd_t;
#line 806
		class nscd { getpwd getgrp gethost getstat admin shmempwd shmemgrp shmemhost getserv shmemserv };
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	allow xserver_t nscd_t:nscd *;
#line 806

#line 806
	 	
#line 806
##### end nscd_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	optional {
#line 806
		
#line 806
		 	 	
#line 806
##### begin postgresql_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute sepgsql_unconfined_type;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t sepgsql_unconfined_type;
#line 806

#line 806
	 	
#line 806
##### end postgresql_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	optional {
#line 806
		
#line 806
		 	 	
#line 806
##### begin seutil_create_bin_policy(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
#		attribute can_write_binary_policy;
#line 806
		type selinux_config_t, policy_config_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	 	 	
#line 806
##### begin files_search_etc(xserver_t) depth: 3
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type etc_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	allow xserver_t etc_t:dir { getattr search open };
#line 806

#line 806
	 	
#line 806
##### end files_search_etc(xserver_t) depth: 2
#line 806
 	
#line 806
	allow xserver_t selinux_config_t:dir { getattr search open };
#line 806
	
#line 806
	allow xserver_t policy_config_t:dir { getattr search open lock ioctl write add_name };
#line 806
	allow xserver_t policy_config_t:file { getattr create open };
#line 806

#line 806
	
#line 806
	allow xserver_t policy_config_t:dir { getattr search open };
#line 806
	allow xserver_t policy_config_t:file { getattr open write append lock ioctl };
#line 806

#line 806
#	typeattribute xserver_t can_write_binary_policy;
#line 806

#line 806
	 	
#line 806
##### end seutil_create_bin_policy(xserver_t) depth: 1
#line 806
 	
#line 806
		 	 	
#line 806
##### begin seutil_relabelto_bin_policy(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute can_relabelto_binary_policy;
#line 806
		type policy_config_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	allow xserver_t policy_config_t:file relabelto;
#line 806
	typeattribute xserver_t can_relabelto_binary_policy;
#line 806

#line 806
	 	
#line 806
##### end seutil_relabelto_bin_policy(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	optional {
#line 806
		
#line 806
		 	 	
#line 806
##### begin storage_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute storage_unconfined_type;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t storage_unconfined_type;
#line 806

#line 806
	 	
#line 806
##### end storage_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	
#line 806
	optional {
#line 806
		
#line 806
		 	 	
#line 806
##### begin xserver_unconfined(xserver_t) depth: 2
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		attribute x_domain;
#line 806
		attribute xserver_unconfined_type;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	typeattribute xserver_t x_domain;
#line 806
	typeattribute xserver_t xserver_unconfined_type;
#line 806

#line 806
	 	
#line 806
##### end xserver_unconfined(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	}
#line 806

#line 806

#line 806
	 	
#line 806
##### end unconfined_domain_noaudit(xserver_t) depth: 0
#line 806
 	
#line 806
	 	 	
#line 806
##### begin unconfined_domtrans(xserver_t) depth: 1
#line 806
 	
#line 806
	
#line 806
	
#line 806
		require {
#line 806
			
#line 806
		type unconfined_t, unconfined_exec_t;
#line 806
	
#line 806
		} # end require
#line 806
	
#line 806

#line 806

#line 806
	
#line 806
	
#line 806
	
#line 806
	allow xserver_t unconfined_exec_t:file { getattr open read execute };
#line 806
	allow xserver_t unconfined_t:process transition;
#line 806
	dontaudit xserver_t unconfined_t:process { noatsecure siginh rlimitinh };
#line 806

#line 806
	type_transition xserver_t unconfined_exec_t:process unconfined_t;
#line 806

#line 806

#line 806
	allow unconfined_t xserver_t:fd use;
#line 806
	allow unconfined_t xserver_t:fifo_file { open { getattr read write append ioctl lock } };
#line 806
	allow unconfined_t xserver_t:process sigchld;
#line 806

#line 806

#line 806
	 	
#line 806
##### end unconfined_domtrans(xserver_t) depth: 0
#line 806
 	
#line 806

#line 806
	} # end optional
#line 809



#line 811
	optional {
#line 811
		
#line 811
	 	 	
#line 811
##### begin userhelper_search_config(xserver_t) depth: 1
#line 811
 	
#line 811
	
#line 811
	
#line 811
		require {
#line 811
			
#line 811
		type userhelper_conf_t;
#line 811
	
#line 811
		} # end require
#line 811
	
#line 811

#line 811

#line 811
	allow xserver_t userhelper_conf_t:dir { getattr search open };
#line 811

#line 811
	 	
#line 811
##### end userhelper_search_config(xserver_t) depth: 0
#line 811
 	
#line 811

#line 811
	} # end optional
#line 813



#line 815
	optional {
#line 815
		
#line 815
	 	 	
#line 815
##### begin xfs_stream_connect(xserver_t) depth: 1
#line 815
 	
#line 815
	
#line 815
	
#line 815
		require {
#line 815
			
#line 815
		type xfs_tmp_t, xfs_t;
#line 815
	
#line 815
		} # end require
#line 815
	
#line 815

#line 815

#line 815
	 	 	
#line 815
##### begin files_search_tmp(xserver_t) depth: 2
#line 815
 	
#line 815
	
#line 815
	
#line 815
		require {
#line 815
			
#line 815
		type tmp_t;
#line 815
	
#line 815
		} # end require
#line 815
	
#line 815

#line 815

#line 815
	allow xserver_t tmp_t:dir { getattr search open };
#line 815

#line 815
	 	
#line 815
##### end files_search_tmp(xserver_t) depth: 1
#line 815
 	
#line 815
	
#line 815
	allow xserver_t xfs_tmp_t:dir { getattr search open };
#line 815
	allow xserver_t xfs_tmp_t:sock_file { getattr write open append };
#line 815
	allow xserver_t xfs_t:unix_stream_socket connectto;
#line 815

#line 815

#line 815
	 	
#line 815
##### end xfs_stream_connect(xserver_t) depth: 0
#line 815
 	
#line 815

#line 815
	} # end optional
#line 817


########################################
#
# XDM Xserver local policy
#
# cjp: when xdm is configurable via tunable these
# rules will be enabled only when xdm is enabled

allow xserver_t xdm_t:process { signal getpgid };
allow xserver_t xdm_t:shm { associate getattr read write lock unix_read unix_write };

# NB we do NOT allow xserver_t xdm_var_lib_t:dir, only access to an open
# handle of a file inside the dir!!!
allow xserver_t xdm_var_lib_t:file { getattr read };
dontaudit xserver_t xdm_var_lib_t:dir search;


#line 834
	allow xserver_t xdm_var_run_t:dir { getattr search open };
#line 834
	allow xserver_t xdm_var_run_t:file { getattr open read lock ioctl };
#line 834


# Label pid and temporary files with derived types.

#line 837
	allow xserver_t xdm_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 837
	allow xserver_t xdm_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 837


#line 838
	allow xserver_t xdm_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 838
	allow xserver_t xdm_tmp_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 838


#line 839
	allow xserver_t xdm_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 839
	allow xserver_t xdm_tmp_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 839


# Run xkbcomp.
allow xserver_t xkb_var_lib_t:lnk_file read;
allow xserver_t xkb_var_lib_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };

# Run Xorg.wrap
allow xserver_t xserver_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };

# VNC v4 module in X server
 	 	
#line 849
##### begin corenet_tcp_bind_vnc_port(xserver_t) depth: 1
#line 849
 	
#line 849
	
#line 849
	
#line 849
		require {
#line 849
			
#line 849
		type vnc_port_t;
#line 849
	
#line 849
		} # end require
#line 849
	
#line 849

#line 849

#line 849
	allow xserver_t vnc_port_t:tcp_socket name_bind;
#line 849
	
#line 849

#line 849
	 	
#line 849
##### end corenet_tcp_bind_vnc_port(xserver_t) depth: 0
#line 849
 	

 	 	
#line 851
##### begin init_use_fds(xserver_t) depth: 1
#line 851
 	
#line 851
	
#line 851
	
#line 851
		require {
#line 851
			
#line 851
		type init_t;
#line 851
	
#line 851
		} # end require
#line 851
	
#line 851

#line 851

#line 851
	allow xserver_t init_t:fd use;
#line 851

#line 851
	 	
#line 851
##### end init_use_fds(xserver_t) depth: 0
#line 851
 	

# FIXME: After per user fonts are properly working
# xserver_t may no longer have any reason
# to read ROLE_home_t - examine this in more detail
# (xauth?)
 	 	
#line 857
##### begin userdom_read_user_home_content_files(xserver_t) depth: 1
#line 857
 	
#line 857
	
#line 857
	
#line 857
		require {
#line 857
			
#line 857
		type user_home_dir_t, user_home_t;
#line 857
	
#line 857
		} # end require
#line 857
	
#line 857

#line 857

#line 857
	
#line 857
	allow xserver_t { user_home_dir_t user_home_t }:dir { getattr search open };
#line 857
	allow xserver_t user_home_t:file { getattr open read lock ioctl };
#line 857

#line 857
	 	 	
#line 857
##### begin files_search_home(xserver_t) depth: 2
#line 857
 	
#line 857
	
#line 857
	
#line 857
		require {
#line 857
			
#line 857
		type home_root_t;
#line 857
	
#line 857
		} # end require
#line 857
	
#line 857

#line 857

#line 857
	allow xserver_t home_root_t:dir { getattr search open };
#line 857
	allow xserver_t home_root_t:lnk_file { getattr read };
#line 857

#line 857
	 	
#line 857
##### end files_search_home(xserver_t) depth: 1
#line 857
 	
#line 857

#line 857
	 	
#line 857
##### end userdom_read_user_home_content_files(xserver_t) depth: 0
#line 857
 	


#line 859
	
#line 859
	
#line 859
		require {
#line 859
			
#line 859
		
#line 859
bool use_nfs_home_dirs;
#line 859

#line 859
  
#line 859
	
#line 859
		} # end require
#line 859
	
#line 859

#line 859
	if (use_nfs_home_dirs) {
#line 859
		
#line 859
	 	 	
#line 859
##### begin fs_manage_nfs_dirs(xserver_t) depth: 1
#line 859
 	
#line 859
	
#line 859
	
#line 859
		require {
#line 859
			
#line 859
		type nfs_t;
#line 859
	
#line 859
		} # end require
#line 859
	
#line 859

#line 859

#line 859
	allow xserver_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 859

#line 859
	 	
#line 859
##### end fs_manage_nfs_dirs(xserver_t) depth: 0
#line 859
 	
#line 859
	 	 	
#line 859
##### begin fs_manage_nfs_files(xserver_t) depth: 1
#line 859
 	
#line 859
	
#line 859
	
#line 859
		require {
#line 859
			
#line 859
		type nfs_t;
#line 859
	
#line 859
		} # end require
#line 859
	
#line 859

#line 859

#line 859
	
#line 859
	allow xserver_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 859
	allow xserver_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 859

#line 859

#line 859
	 	
#line 859
##### end fs_manage_nfs_files(xserver_t) depth: 0
#line 859
 	
#line 859
	 	 	
#line 859
##### begin fs_manage_nfs_symlinks(xserver_t) depth: 1
#line 859
 	
#line 859
	
#line 859
	
#line 859
		require {
#line 859
			
#line 859
		type nfs_t;
#line 859
	
#line 859
		} # end require
#line 859
	
#line 859

#line 859

#line 859
	
#line 859
	allow xserver_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 859
	allow xserver_t nfs_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 859

#line 859

#line 859
	 	
#line 859
##### end fs_manage_nfs_symlinks(xserver_t) depth: 0
#line 859
 	
#line 859

#line 859
	}
#line 863



#line 865
	
#line 865
	
#line 865
		require {
#line 865
			
#line 865
		
#line 865
bool use_samba_home_dirs;
#line 865

#line 865
  
#line 865
	
#line 865
		} # end require
#line 865
	
#line 865

#line 865
	if (use_samba_home_dirs) {
#line 865
		
#line 865
	 	 	
#line 865
##### begin fs_manage_cifs_dirs(xserver_t) depth: 1
#line 865
 	
#line 865
	
#line 865
	
#line 865
		require {
#line 865
			
#line 865
		type cifs_t;
#line 865
	
#line 865
		} # end require
#line 865
	
#line 865

#line 865

#line 865
	allow xserver_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 865

#line 865
	 	
#line 865
##### end fs_manage_cifs_dirs(xserver_t) depth: 0
#line 865
 	
#line 865
	 	 	
#line 865
##### begin fs_manage_cifs_files(xserver_t) depth: 1
#line 865
 	
#line 865
	
#line 865
	
#line 865
		require {
#line 865
			
#line 865
		type cifs_t;
#line 865
	
#line 865
		} # end require
#line 865
	
#line 865

#line 865

#line 865
	
#line 865
	allow xserver_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 865
	allow xserver_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 865

#line 865

#line 865
	 	
#line 865
##### end fs_manage_cifs_files(xserver_t) depth: 0
#line 865
 	
#line 865
	 	 	
#line 865
##### begin fs_manage_cifs_symlinks(xserver_t) depth: 1
#line 865
 	
#line 865
	
#line 865
	
#line 865
		require {
#line 865
			
#line 865
		type cifs_t;
#line 865
	
#line 865
		} # end require
#line 865
	
#line 865

#line 865

#line 865
	
#line 865
	allow xserver_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 865
	allow xserver_t cifs_t:lnk_file { create read write getattr setattr link unlink rename ioctl lock };
#line 865

#line 865

#line 865
	 	
#line 865
##### end fs_manage_cifs_symlinks(xserver_t) depth: 0
#line 865
 	
#line 865

#line 865
	}
#line 869



#line 871
	optional {
#line 871
		
#line 871
	 	 	
#line 871
##### begin dbus_system_bus_client(xserver_t) depth: 1
#line 871
 	
#line 871
	
#line 871
	
#line 871
		require {
#line 871
			
#line 871
		attribute dbusd_system_bus_client;
#line 871
		type system_dbusd_t, system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 871
		class dbus send_msg;
#line 871
	
#line 871
		} # end require
#line 871
	
#line 871

#line 871

#line 871
	typeattribute xserver_t dbusd_system_bus_client;
#line 871

#line 871
	allow xserver_t { system_dbusd_t self }:dbus send_msg;
#line 871
	allow system_dbusd_t xserver_t:dbus send_msg;
#line 871

#line 871
	 	 	
#line 871
##### begin files_search_var_lib(xserver_t) depth: 2
#line 871
 	
#line 871
	
#line 871
	
#line 871
		require {
#line 871
			
#line 871
		type var_t, var_lib_t;
#line 871
	
#line 871
		} # end require
#line 871
	
#line 871

#line 871

#line 871
	
#line 871
	allow xserver_t var_t:dir { getattr search open };
#line 871
	allow xserver_t var_lib_t:dir { getattr search open };
#line 871

#line 871

#line 871
	 	
#line 871
##### end files_search_var_lib(xserver_t) depth: 1
#line 871
 	
#line 871
	
#line 871
	allow xserver_t system_dbusd_var_lib_t:dir { getattr search open };
#line 871
	allow xserver_t system_dbusd_var_lib_t:file { getattr open read lock ioctl };
#line 871

#line 871

#line 871
	 	 	
#line 871
##### begin files_search_pids(xserver_t) depth: 2
#line 871
 	
#line 871
	
#line 871
	
#line 871
		require {
#line 871
			
#line 871
		type var_t, var_run_t;
#line 871
	
#line 871
		} # end require
#line 871
	
#line 871

#line 871

#line 871
	allow xserver_t var_run_t:lnk_file { getattr read };
#line 871
	
#line 871
	allow xserver_t var_t:dir { getattr search open };
#line 871
	allow xserver_t var_run_t:dir { getattr search open };
#line 871

#line 871

#line 871
	 	
#line 871
##### end files_search_pids(xserver_t) depth: 1
#line 871
 	
#line 871
	
#line 871
	allow xserver_t system_dbusd_var_run_t:dir { getattr search open };
#line 871
	allow xserver_t system_dbusd_var_run_t:sock_file { getattr write open append };
#line 871
	allow xserver_t system_dbusd_t:unix_stream_socket connectto;
#line 871

#line 871

#line 871
	 	 	
#line 871
##### begin dbus_read_config(xserver_t) depth: 2
#line 871
 	
#line 871
	
#line 871
	
#line 871
		require {
#line 871
			
#line 871
		type dbusd_etc_t;
#line 871
	
#line 871
		} # end require
#line 871
	
#line 871

#line 871

#line 871
	allow xserver_t dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 871
	allow xserver_t dbusd_etc_t:file { getattr open read lock ioctl };
#line 871

#line 871
	 	
#line 871
##### end dbus_read_config(xserver_t) depth: 1
#line 871
 	
#line 871

#line 871
	 	
#line 871
##### end dbus_system_bus_client(xserver_t) depth: 0
#line 871
 	
#line 871
	 	 	
#line 871
##### begin hal_dbus_chat(xserver_t) depth: 1
#line 871
 	
#line 871
	
#line 871
	
#line 871
		require {
#line 871
			
#line 871
		type hald_t;
#line 871
		class dbus send_msg;
#line 871
	
#line 871
		} # end require
#line 871
	
#line 871

#line 871

#line 871
	allow xserver_t hald_t:dbus send_msg;
#line 871
	allow hald_t xserver_t:dbus send_msg;
#line 871

#line 871
	 	
#line 871
##### end hal_dbus_chat(xserver_t) depth: 0
#line 871
 	
#line 871

#line 871
	} # end optional
#line 874



#line 876
	optional {
#line 876
		
#line 876
	 	 	
#line 876
##### begin resmgr_stream_connect(xdm_t) depth: 1
#line 876
 	
#line 876
	
#line 876
	
#line 876
		require {
#line 876
			
#line 876
		type resmgrd_var_run_t, resmgrd_t;
#line 876
	
#line 876
		} # end require
#line 876
	
#line 876

#line 876

#line 876
	 	 	
#line 876
##### begin files_search_pids(xdm_t) depth: 2
#line 876
 	
#line 876
	
#line 876
	
#line 876
		require {
#line 876
			
#line 876
		type var_t, var_run_t;
#line 876
	
#line 876
		} # end require
#line 876
	
#line 876

#line 876

#line 876
	allow xdm_t var_run_t:lnk_file { getattr read };
#line 876
	
#line 876
	allow xdm_t var_t:dir { getattr search open };
#line 876
	allow xdm_t var_run_t:dir { getattr search open };
#line 876

#line 876

#line 876
	 	
#line 876
##### end files_search_pids(xdm_t) depth: 1
#line 876
 	
#line 876
	
#line 876
	allow xdm_t resmgrd_var_run_t:dir { getattr search open };
#line 876
	allow xdm_t resmgrd_var_run_t:sock_file { getattr write open append };
#line 876
	allow xdm_t resmgrd_t:unix_stream_socket connectto;
#line 876

#line 876

#line 876
	 	
#line 876
##### end resmgr_stream_connect(xdm_t) depth: 0
#line 876
 	
#line 876

#line 876
	} # end optional
#line 878



#line 880
	optional {
#line 880
		
#line 880
	 	 	
#line 880
##### begin rhgb_rw_shm(xserver_t) depth: 1
#line 880
 	
#line 880
	
#line 880
	
#line 880
		require {
#line 880
			
#line 880
		type rhgb_t;
#line 880
	
#line 880
		} # end require
#line 880
	
#line 880

#line 880

#line 880
	allow xserver_t rhgb_t:shm { associate getattr read write lock unix_read unix_write };
#line 880

#line 880
	 	
#line 880
##### end rhgb_rw_shm(xserver_t) depth: 0
#line 880
 	
#line 880
	 	 	
#line 880
##### begin rhgb_rw_tmpfs_files(xserver_t) depth: 1
#line 880
 	
#line 880
	
#line 880
	
#line 880
		require {
#line 880
			
#line 880
		type rhgb_tmpfs_t;
#line 880
	
#line 880
		} # end require
#line 880
	
#line 880

#line 880

#line 880

#line 880
	 	 	
#line 880
##### begin fs_search_tmpfs(xserver_t) depth: 2
#line 880
 	
#line 880
	
#line 880
	
#line 880
		require {
#line 880
			
#line 880
		type tmpfs_t;
#line 880
	
#line 880
		} # end require
#line 880
	
#line 880

#line 880

#line 880
	allow xserver_t tmpfs_t:dir { getattr search open };
#line 880

#line 880
	 	
#line 880
##### end fs_search_tmpfs(xserver_t) depth: 1
#line 880
 	
#line 880
	allow xserver_t rhgb_tmpfs_t:file { getattr open read write append ioctl lock };
#line 880

#line 880
	 	
#line 880
##### end rhgb_rw_tmpfs_files(xserver_t) depth: 0
#line 880
 	
#line 880

#line 880
	} # end optional
#line 883


########################################
#
# Rules common to all X window domains
#

# Hacks
# everyone can do override-redirect windows.
# this could be used to spoof labels
allow x_domain self:x_drawable override;
# firefox gets nosy with other people's windows
allow x_domain x_domain:x_drawable { list_child receive };

# X Server
# can get X server attributes
allow x_domain xserver_t:x_server getattr;
# can grab the server
allow x_domain xserver_t:x_server grab;
# can read and write server-owned generic resources
allow x_domain xserver_t:x_resource { read write };
# can mess with own clients
allow x_domain self:x_client { getattr manage destroy };

# X Protocol Extensions
allow x_domain xextension_t:x_extension { query use };
allow x_domain security_xextension_t:x_extension { query use };

# X Properties
# can change properties of root window
allow x_domain root_xdrawable_t:x_drawable { list_property get_property set_property };
# can change properties of my own windows
allow x_domain self:x_drawable { list_property get_property set_property };
# can read and write cut buffers
allow x_domain clipboard_xproperty_t:x_property { create read write append };
# can read security labels
allow x_domain seclabel_xproperty_t:x_property { getattr read };
# can change all other properties
allow x_domain xproperty_t:x_property { getattr create read write append destroy };

# X Windows
# operations allowed on root windows
allow x_domain root_xdrawable_t:x_drawable { getattr setattr list_child add_child remove_child send receive hide show };
# operations allowed on my windows
allow x_domain self:x_drawable { create destroy getattr setattr read write show hide list_child add_child remove_child manage send receive };
allow x_domain self:x_drawable { blend };
# operations allowed on all windows
allow x_domain x_domain:x_drawable { getattr get_property set_property remove_child };

# X Colormaps
# can use the default colormap
allow x_domain root_xcolormap_t:x_colormap { read use add_color remove_color install uninstall };
# can create and use colormaps
allow x_domain self:x_colormap *;

# X Devices
# operations allowed on my own devices
allow x_domain self:{ x_device x_pointer x_keyboard } *;
# operations allowed on generic devices
allow x_domain xserver_t:x_device { use getattr setattr getfocus setfocus bell grab freeze force_cursor };
# operations allowed on core keyboard
allow x_domain xserver_t:x_keyboard { use getattr setattr getfocus setfocus bell grab };
# operations allowed on core pointer
allow x_domain xserver_t:x_pointer { read use getattr setattr getfocus setfocus bell grab freeze force_cursor };

# all devices can generate input events
allow x_domain root_xdrawable_t:x_drawable send;
allow x_domain x_domain:x_drawable send;
allow x_domain input_xevent_t:x_event send;

# dontaudit keyloggers repeatedly polling
#dontaudit x_domain xserver_t:x_keyboard read;

# X Input
# can receive default events
allow x_domain xevent_t:{ x_event x_synthetic_event } receive;
# can receive ICCCM events
allow x_domain client_xevent_t:{ x_event x_synthetic_event } receive;
# can send ICCCM events to the root window
allow x_domain client_xevent_t:x_synthetic_event send;
# can receive root window input events
allow x_domain root_input_xevent_t:x_event receive;

# X Selections
# can use the clipboard
allow x_domain clipboard_xselection_t:x_selection { getattr setattr read };
# can use default selections
allow x_domain xselection_t:x_selection { getattr setattr read };

# Other X Objects
# can create and use cursors
allow x_domain self:x_cursor *;
# can create and use graphics contexts
allow x_domain self:x_gc *;
# can read and write own objects
allow x_domain self:x_resource { read write };
# can mess with the screensaver
allow x_domain xserver_t:x_screen { getattr saver_getattr };

########################################
#
# Rules for unconfined access to this module
#


#line 987
	
#line 987
	
#line 987
		require {
#line 987
			
#line 987
		
#line 987
bool xserver_object_manager;
#line 987

#line 987
  
#line 987
	
#line 987
		} # end require
#line 987
	
#line 987

#line 987
	if (! xserver_object_manager) {
#line 987
		
#line 987
	# should be xserver_unconfined(x_domain),
#line 987
	# but typeattribute doesnt work in conditionals
#line 987

#line 987
	allow x_domain xserver_t:x_server *;
#line 987
	allow x_domain xdrawable_type:x_drawable *;
#line 987
	allow x_domain xserver_t:x_screen *;
#line 987
	allow x_domain x_domain:x_gc *;
#line 987
	allow x_domain xcolormap_type:x_colormap *;
#line 987
	allow x_domain xproperty_type:x_property *;
#line 987
	allow x_domain xselection_type:x_selection *;
#line 987
	allow x_domain x_domain:x_cursor *;
#line 987
	allow x_domain x_domain:x_client *;
#line 987
	allow x_domain { x_domain xserver_t }:x_device *;
#line 987
	allow x_domain { x_domain xserver_t }:x_pointer *;
#line 987
	allow x_domain { x_domain xserver_t }:x_keyboard *;
#line 987
	allow x_domain xextension_type:x_extension *;
#line 987
	allow x_domain { x_domain xserver_t }:x_resource *;
#line 987
	allow x_domain xevent_type:{ x_event x_synthetic_event } *;
#line 987

#line 987
	}
#line 1006


allow xserver_unconfined_type xserver_t:x_server *;
allow xserver_unconfined_type xdrawable_type:x_drawable *;
allow xserver_unconfined_type xserver_t:x_screen *;
allow xserver_unconfined_type x_domain:x_gc *;
allow xserver_unconfined_type xcolormap_type:x_colormap *;
allow xserver_unconfined_type xproperty_type:x_property *;
allow xserver_unconfined_type xselection_type:x_selection *;
allow xserver_unconfined_type x_domain:x_cursor *;
allow xserver_unconfined_type x_domain:x_client *;
allow xserver_unconfined_type { x_domain xserver_t }:x_device *;
allow xserver_unconfined_type { x_domain xserver_t }:x_pointer *;
allow xserver_unconfined_type { x_domain xserver_t }:x_keyboard *;
allow xserver_unconfined_type xextension_type:x_extension *;
allow xserver_unconfined_type { x_domain xserver_t }:x_resource *;
allow xserver_unconfined_type xevent_type:{ x_event x_synthetic_event } *;
